---
title: "Пошаговое руководство. Разработка настраиваемого приложения с помощью веб-служб Excel"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.assetid: 2f9bf243-281a-4d70-917e-9eaf0b867631
ms.openlocfilehash: 96cbe71ced7143b9888645b3b455c3738f0030a6
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="walkthrough-developing-a-custom-application-using-excel-web-services"></a>Пошаговое руководство. Разработка настраиваемого приложения с помощью веб-служб Excel

В этом разделе представлено пошаговое руководство, в котором описывается порядок доступа к веб-службам Веб-службы Excel из приложения, созданного с помощью Microsoft Visual C#.
  
    
    

В этом пошаговом руководстве рассматривается порядок выполнения следующих действий:
- Создание клиентского приложения с использованием шаблона проекта консольного приложения Visual Studio.
    
  
- Добавление веб-ссылки для веб-служб Веб-службы Excel.
    
  
- Написание кода для доступа к веб-службе. В этом разделе приведены инструкции по открытию рабочей книги, получению идентификатора сеанса, передаче учетных данных по умолчанию, получению сведений о версии веб-службы, определению объекта координат диапазона, получению диапазона, в котором используется объект координат, а также по закрытию рабочей книги и перехвату исключения SOAP.
    
  
- Тестирование и запуск консольного приложения в режиме отладки.
    
  
Клиентское консольное приложение  это всего лишь один из возможных способов доступа к веб-службе. Гораздо чаще для этих целей используются серверные приложения, например приложения Microsoft ASP.NET. В этом пошаговом руководстве для большего удобства используется пример консольного приложения, основное внимание в котором уделяется вопросам использования API-интерфейса веб-службы Веб-службы Excel.
## <a name="prerequisites"></a>Необходимые требования

Для выполнения этой процедуры требуется установить следующие компоненты: 
  
    
    

- Microsoft SharePoint Server 2010.
    
  
- Visual Studio или аналогичное средство разработки, совместимое с Microsoft .NET Framework.
    
  
- Достаточные разрешения (как минимум разрешения на просмотр) для доступа к веб-службам Веб-службы Excel на компьютере, на котором располагаются SharePoint Server 2010. 
    
    > **Примечание:** Дополнительные сведения о разрешениях книги в следующем разделе, книги» разрешения «. 
- Пример рабочей книги, установленный на локальном диске или в локальной библиотеке документов SharePoint. 
    
  
- Надежное расположение для хранения рабочих книг, доступ к которым будет осуществляться с помощью веб-служб Веб-службы Excel. Если рабочие книги хранятся не в надежном расположении, вызовы веб-служб Веб-службы Excel для открытия таких книг завершаются сбоем. В этом пошаговом руководстве подразумевается, что рабочая книга размещается на локальном компьютере. 
    
    > **Примечание:** Сведения о том, как надежного расположения можно [как: надежного расположения](how-to-trust-a-location.md) и [как: доверия Workbook Locations Using Script](http://msdn.microsoft.com/library/79ab6ced-7a0c-4275-b852-bb246fc6be57%28Office.15%29.aspx). 
- Возможность создания книги с помощью Excel.
    
  
- Сохранение рабочей книги в формате XLSX или XLSB.
    
  
В рабочей книге, используемой в этом примере, представлен лист "Sheet1", в котором содержатся 11 столбцов и 19 строк. В каждой ячейке в диапазоне от A1 до K19 содержится числовое значение, например, 4245,955, 6960,673 и т. д.
  
    
    

## <a name="workbook-permissions"></a>Разрешения рабочих книг


- Для получения рабочей книги целиком (например, с помощью метода **GetWorkbook**) вызывающий объект должен обладать разрешениями на ее открытие.
    
  
- Для вызова метода **GetApiVersion** не требуется никаких разрешений.
    
  
- Для остальных методов веб-служб Веб-службы Excel вызывающему объекту требуются разрешения на просмотр (в Microsoft SharePoint Foundation) или чтение (на общем файловом ресурсе) рабочей книги.
    
    > **Примечание:** Дополнительные сведения о настройке разрешений обратитесь к документации SharePoint Foundation. 

## <a name="see-also"></a>См. также


#### <a name="concepts"></a>Основные понятия


  
    
    
 [Доступ к API SOAP](accessing-the-soap-api.md)
  
    
    
 [Excel Services Alerts](excel-services-alerts.md)
  
    
    
 [Excel Services Known Issues and Tips](excel-services-known-issues-and-tips.md)
  
    
    
 [Loop-Back SOAP Calls and Direct Linking](loop-back-soap-calls-and-direct-linking.md)
#### <a name="other-resources"></a>Другие ресурсы


  
    
    
 [Шаг 1. Создание проекта клиента веб-службы](step-1-creating-the-web-service-client-project.md)
  
    
    
 [Этап 2. Добавление веб-ссылки](step-2-adding-a-web-reference.md)
  
    
    
 [Этап 3. Получение доступа к веб-службе](step-3-accessing-the-web-service.md)
  
    
    
 [Этап 4. Построение и тестирование приложения](step-4-building-and-testing-the-application.md)
