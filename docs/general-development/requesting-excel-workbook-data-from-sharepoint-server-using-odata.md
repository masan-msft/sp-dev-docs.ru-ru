---
title: "Запрашивает данные книги Excel с SharePoint Server с помощью OData"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.assetid: 2f846e96-6c9e-4ed2-9602-4081ad0ab135
ms.openlocfilehash: 79e7a64b88e54105ad5ad846939836121621cc45
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="requesting-excel-workbook-data-from-sharepoint-server-using-odata"></a><span data-ttu-id="bad06-102">Запрашивает данные книги Excel с SharePoint Server с помощью OData</span><span class="sxs-lookup"><span data-stu-id="bad06-102">Requesting Excel workbook data from SharePoint Server using OData</span></span>

> <span data-ttu-id="bad06-103">**Примечание:** API REST служб Excel применяется к SharePoint и SharePoint 2016 локально.</span><span class="sxs-lookup"><span data-stu-id="bad06-103">**Note:** The Excel Services REST API applies to SharePoint and SharePoint 2016 on-premises.</span></span> <span data-ttu-id="bad06-104">Для образовательных учреждений Office 365, бизнеса и корпоративных учетных записей используйте Excel API-интерфейсы REST, входящих в состав [Microsoft Graph](http://graph.microsoft.io/ru-ru/docs/api-reference/v1.0/resources/excel) конечной точки.</span><span class="sxs-lookup"><span data-stu-id="bad06-104">For Office 365 Education, Business, and Enterprise accounts, use the Excel REST APIs that are part of the  [Microsoft Graph](http://graph.microsoft.io/ru-ru/docs/api-reference/v1.0/resources/excel) endpoint.</span></span>
  
    
    

<span data-ttu-id="bad06-p102">URL-адреса использует OData для запроса сведений из ресурса. URL-адрес создавать определенным образом, используя параметры запроса, чтобы возвратить сведения, которые вы запрашиваете. Следующий URL-адрес показано, как выглядит типичное запросов OData. http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$top=20</span><span class="sxs-lookup"><span data-stu-id="bad06-p102">OData uses URLs to request information from a resource. You craft the URL in a specific way, using query options, to return the information that you are requesting. The following URL shows what a typical OData request looks like. http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$top=20</span></span>
  
    
    

<span data-ttu-id="bad06-p103">Таким образом, чтобы он получает первых 20 строк в таблице с именем Table1 в книге ProductSales.xlsx, которая хранится в папку «документы» на сервере contoso1 структурирован этого примера запроса OData. URL-адрес использует параметр запроса система **$top** чтобы указать количество возвращаемых строк.Глядя близко URL-адрес, могут видеть его структуры три части: служба корневой URI; путь к ресурсу; и параметры запроса.</span><span class="sxs-lookup"><span data-stu-id="bad06-p103">This sample OData request is structured so that it gets the first 20 rows from a table named Table1 in the workbook ProductSales.xlsx which is stored in the Documents folder on the contoso1 server. The URL uses the system query option **$top** to specify the number of rows to return.Looking closely at the URL, you can see its three part structure: the service root URI; the resource path; and the query options.</span></span>
## <a name="service-root-uri"></a><span data-ttu-id="bad06-111">Корень URI службы</span><span class="sxs-lookup"><span data-stu-id="bad06-111">Service root URI</span></span>

<span data-ttu-id="bad06-112">Начальной части URL-адреса называется корневой службы и остаются неизменными для каждого запроса OData, вносимые в SharePoint server за исключением имени сервера.</span><span class="sxs-lookup"><span data-stu-id="bad06-112">The initial part of the URL is called the service root and remains the same for every OData request that you make to a SharePoint server except for the name of the server.</span></span> <span data-ttu-id="bad06-113">Он содержит имя сервера SharePoint, где хранится книга и путь, _vti_bin/ExcelRest.aspx, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="bad06-113">It includes the name of the SharePoint server where the workbook is stored and the path, _vti_bin/ExcelRest.aspx, as in the following example.</span></span>
  
    
    
<span data-ttu-id="bad06-114">http://contoso1/_vti_bin/ExcelRest.aspx</span><span class="sxs-lookup"><span data-stu-id="bad06-114">http://contoso1/_vti_bin/ExcelRest.aspx</span></span>
  
    
    

## <a name="resource-path"></a><span data-ttu-id="bad06-115">Путь к ресурсу</span><span class="sxs-lookup"><span data-stu-id="bad06-115">Resource path</span></span>

<span data-ttu-id="bad06-116">Вторая часть URL-адрес имеет путь к книге Excel и указывает, что это запроса OData.</span><span class="sxs-lookup"><span data-stu-id="bad06-116">The second part of the URL has the path to the Excel workbook and specifies that this is an OData request.</span></span>
  
    
    
<span data-ttu-id="bad06-117">/Documents/ProductSales.xlsx/OData</span><span class="sxs-lookup"><span data-stu-id="bad06-117">/Documents/ProductSales.xlsx/OData</span></span>
  
    
    

## <a name="system-query-options"></a><span data-ttu-id="bad06-118">Системные параметры запросов</span><span class="sxs-lookup"><span data-stu-id="bad06-118">System query options</span></span>

<span data-ttu-id="bad06-p105">Третья часть URL-адреса дает система параметров запросов для запроса. Параметры запроса всегда начинаются с символа доллара ($) и добавляются в конец URI как параметры запроса. В этом примере для первых 20 строк в таблице с именем Table1  запрос.</span><span class="sxs-lookup"><span data-stu-id="bad06-p105">The third part of the URL gives the system query options for the request. Query options always begin with a dollar sign ($) and are appended to the end of the URI as query parameters. In this example, the request is for the first 20 rows in the table named Table1.</span></span>
  
    
    
<span data-ttu-id="bad06-122">/ Table1? $top = 20</span><span class="sxs-lookup"><span data-stu-id="bad06-122">/Table1?$top=20</span></span>
  
    
    
<span data-ttu-id="bad06-p106">Системные параметры запросов позволяют получить данные из ресурса. Реализация OData служб Excel поддерживает ряд параметров запроса, перечисленные в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="bad06-p106">System query options provide a way to get specific data from a resource. The Excel Services OData implementation supports a number of query options as listed in the following section.</span></span>
  
    
    

## <a name="system-query-options"></a><span data-ttu-id="bad06-125">Системные параметры запросов</span><span class="sxs-lookup"><span data-stu-id="bad06-125">System query options</span></span>
<span data-ttu-id="bad06-126"><a name="xlsSystemQueryOptions"> </a></span><span class="sxs-lookup"><span data-stu-id="bad06-126"><a name="xlsSystemQueryOptions"> </a></span></span>

<span data-ttu-id="bad06-p107">Реализация служб Excel OData поддерживает ряд стандартные параметры запроса OData система. Эти параметры запроса являются основой запросов OData с момента параметры используются для указания, какие данные требуется получить из ресурса. В следующей таблице приведены параметры запросов системы, реализация службами Excel OData в настоящее время поддерживает.</span><span class="sxs-lookup"><span data-stu-id="bad06-p107">The Excel Services implementation of OData supports a number of the standard OData system query options. These query options are at the heart of OData requests since you use the options to specify what data you want to get from a resource. The following table lists the system query options that Excel Services implementation of OData currently supports.</span></span>
  
    
    

<span data-ttu-id="bad06-130">**В таблице 1. Системные параметры запросов OData служб Excel**</span><span class="sxs-lookup"><span data-stu-id="bad06-130">**Table 1. Excel Services OData system query options**</span></span>


|<span data-ttu-id="bad06-131">**Системный параметр запроса**</span><span class="sxs-lookup"><span data-stu-id="bad06-131">**System Query Option**</span></span>|<span data-ttu-id="bad06-132">**Description**</span><span class="sxs-lookup"><span data-stu-id="bad06-132">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="bad06-133">/\<tableName\></span><span class="sxs-lookup"><span data-stu-id="bad06-133">/\<tableName\></span></span>  <br/> |<span data-ttu-id="bad06-134">Возвращает все строки в таблице, указанный с \<tableName\>, где \<tableName\> — это имя таблицы в книгу Excel, которая содержит строки, которую необходимо получить.</span><span class="sxs-lookup"><span data-stu-id="bad06-134">Returns all rows for the table specified by \<tableName\>, where \<tableName\> is the name of a table in an Excel workbook that contains the rows that you want to retrieve.</span></span>  <br/> <span data-ttu-id="bad06-135">**Важные:** Эта форма запроса OData возвращает не более 500 строк за раз.</span><span class="sxs-lookup"><span data-stu-id="bad06-135">**Important:** This form of OData request returns no more than 500 rows at a time.</span></span> <span data-ttu-id="bad06-136">Каждый набор строк, 500 состоит из одной страницы.</span><span class="sxs-lookup"><span data-stu-id="bad06-136">Each set of 500 rows is one page.</span></span> <span data-ttu-id="bad06-137">Для получения строк в дальнейшем страниц в таблице, имеющей более 500 строк, используйте параметр запроса **$skiptoken** (см. ниже).</span><span class="sxs-lookup"><span data-stu-id="bad06-137">To get rows in further pages in a table that has more than 500 rows, use the **$skiptoken** query option (see below).</span></span><br/><span data-ttu-id="bad06-138">Следующий пример возвращает все строки до 500th строк в Table1 ProductSales.xlsx книги.</span><span class="sxs-lookup"><span data-stu-id="bad06-138">The following example returns all rows up to the 500th row in Table1 in the ProductSales.xlsx workbook.</span></span>  <br/> |
|<span data-ttu-id="bad06-139">**$metadata**</span><span class="sxs-lookup"><span data-stu-id="bad06-139">**$metadata**</span></span> <br/> |<span data-ttu-id="bad06-140">Возвращает все доступные таблицы и сведения о типе для всех строк в каждой таблице в указанной книге.</span><span class="sxs-lookup"><span data-stu-id="bad06-140">Returns all the available tables and the type information for all rows in each table in the specified workbook.</span></span>  <br/> <span data-ttu-id="bad06-141">Следующий пример возвращает таблиц и сведения о типе для таблиц в книге ProductSales.xlsx.</span><span class="sxs-lookup"><span data-stu-id="bad06-141">The following example returns the tables and type information for the tables in the ProductSales.xlsx workbook.</span></span>  <br/> <span data-ttu-id="bad06-142">http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/$ метаданных</span><span class="sxs-lookup"><span data-stu-id="bad06-142">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/$metadata</span></span>  <br/> |
|<span data-ttu-id="bad06-143">**$orderby**</span><span class="sxs-lookup"><span data-stu-id="bad06-143">**$orderby**</span></span> <br/> |<span data-ttu-id="bad06-144">Возвращает строк в указанной таблице, отсортированные по значения, указанного в **$orderby**.</span><span class="sxs-lookup"><span data-stu-id="bad06-144">Returns rows in the specified table, sorted by the value specified by **$orderby**.</span></span>  <br/> <span data-ttu-id="bad06-145">Следующий пример возвращает все строки в таблице 1, отсортированные по столбце имя в книге ProductSales.xlsx.</span><span class="sxs-lookup"><span data-stu-id="bad06-145">The following example returns all rows from Table 1, sorted by the Name column, in the ProductSales.xlsx workbook.</span></span>  <br/> <span data-ttu-id="bad06-146">**Примечание:** Значение по умолчанию для **$orderby** по возрастанию.</span><span class="sxs-lookup"><span data-stu-id="bad06-146">**Note:** The default value for **$orderby** is ascending.</span></span>          <span data-ttu-id="bad06-147">http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$ orderby = имя</span><span class="sxs-lookup"><span data-stu-id="bad06-147">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$orderby=Name</span></span>  <br/> |
|<span data-ttu-id="bad06-148">**$top**</span><span class="sxs-lookup"><span data-stu-id="bad06-148">**$top**</span></span> <br/> |<span data-ttu-id="bad06-149">Возвращает N строк из таблицы, где N  число указанное значение **$top**.</span><span class="sxs-lookup"><span data-stu-id="bad06-149">Returns N rows from the table where N is a number specified by the value of **$top**.</span></span>  <br/> <span data-ttu-id="bad06-150">Следующий пример возвращает первые 5 строк из Table1, отсортированные по имени столбца в книге ProductSales.xlsx.</span><span class="sxs-lookup"><span data-stu-id="bad06-150">The following example returns the first 5 rows from Table1, sorted by the Name column, in the ProductSales.xlsx workbook.</span></span>  <br/> <span data-ttu-id="bad06-151">http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1_qM _ $orderby = имя&amp;$top = 5</span><span class="sxs-lookup"><span data-stu-id="bad06-151">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$orderby=Name&amp;$top=5</span></span>  <br/> |
|<span data-ttu-id="bad06-152">**$skip**</span><span class="sxs-lookup"><span data-stu-id="bad06-152">**$skip**</span></span> <br/> |<span data-ttu-id="bad06-153">Пропускает N строк, N  номер, указанный по значению **$skip**и затем возвращает остальных строк таблицы.</span><span class="sxs-lookup"><span data-stu-id="bad06-153">Skips N rows, where N is the number specified by the value of **$skip**, and then returns the remaining rows of the table.</span></span>  <br/> <span data-ttu-id="bad06-154">Следующий пример возвращает все оставшиеся строки после пятой из Table1 ProductSales.xlsx книги.</span><span class="sxs-lookup"><span data-stu-id="bad06-154">The following example returns all remaining rows after the fifth row from Table1 in the ProductSales.xlsx workbook.</span></span>  <br/> <span data-ttu-id="bad06-155">Пропустить $ http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1? = 5</span><span class="sxs-lookup"><span data-stu-id="bad06-155">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$skip=5</span></span>  <br/> |
|<span data-ttu-id="bad06-156">**$skiptoken**</span><span class="sxs-lookup"><span data-stu-id="bad06-156">**$skiptoken**</span></span> <br/> |<span data-ttu-id="bad06-p110">Операций поиска n-й строке, где N  это положение строки порядковый номер, указанный в параметре значение **$skiptoken**и затем возвращает всех оставшихся строк, начиная с строки N + 1. Коллекция начинается с нуля, поэтому второй строке, например, обозначается $skiptoken = 1.</span><span class="sxs-lookup"><span data-stu-id="bad06-p110">Seeks to the Nth row, where N is the row ordinal position indicated by the value of **$skiptoken**, and then returns all remaining rows, beginning at row N + 1. The collection is zero-based, so the second row, for example, is indicated by $skiptoken=1.  </span></span><br/> <span data-ttu-id="bad06-159">Следующий пример возвращает все оставшиеся строки после второй строке из Table1 ProductSales.xlsx книги.</span><span class="sxs-lookup"><span data-stu-id="bad06-159">The following example returns all remaining rows after the second row from Table1 in the ProductSales.xlsx workbook.</span></span>  <br/> <span data-ttu-id="bad06-160">http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$ skiptoken = 1</span><span class="sxs-lookup"><span data-stu-id="bad06-160">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$skiptoken=1</span></span>  <br/> <span data-ttu-id="bad06-p111">Можно также использовать параметр запроса **$skiptoken** для получения строк в страницы после первой страницы из таблицы, содержащее более 500 строк. Следующем примере показано, как получить строку 500th и более поздних версий, из таблицы с более чем 500 строк.</span><span class="sxs-lookup"><span data-stu-id="bad06-p111">You can also use the **$skiptoken** query option to get rows in pages after the first page from a table that contains more than 500 rows. The following example shows how to get the 500th row and greater from a table with more than 500 rows. </span></span><br/> <span data-ttu-id="bad06-163">http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$ skiptoken = 499</span><span class="sxs-lookup"><span data-stu-id="bad06-163">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$skiptoken=499</span></span>  <br/> |
|<span data-ttu-id="bad06-164">**$filter**</span><span class="sxs-lookup"><span data-stu-id="bad06-164">**$filter**</span></span> <br/> |<span data-ttu-id="bad06-p112">Возвращает набор строк, которые удовлетворяют условиям, указанным в значении **$filter**. Дополнительные сведения об операторах и набор функций, которые можно использовать с **$filter**OData  [документации](http://www.odata.org/documentation/odata-version-2-0/uri-conventions/)см. </span><span class="sxs-lookup"><span data-stu-id="bad06-p112">Returns the subset of rows that satisfy the conditions specified in the value of **$filter**. For more information about the operators and set of functions that you can use with **$filter**, see the OData  [documentation](http://www.odata.org/documentation/odata-version-2-0/uri-conventions/).  </span></span><br/> <span data-ttu-id="bad06-167">Следующий пример возвращает только строки, где значение столбца Price больше 100.</span><span class="sxs-lookup"><span data-stu-id="bad06-167">The following example returns only those rows where the value of the Price column is greater than 100.</span></span>  <br/> <span data-ttu-id="bad06-168">Фильтр $ http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1? = цена gt 100</span><span class="sxs-lookup"><span data-stu-id="bad06-168">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$filter=Price gt 100</span></span>  <br/> |
|<span data-ttu-id="bad06-169">**$format**</span><span class="sxs-lookup"><span data-stu-id="bad06-169">**$format**</span></span> <br/> |<span data-ttu-id="bad06-170">Формат Atom XML поддерживается только значение и используется по умолчанию для параметра **$format** запрос.</span><span class="sxs-lookup"><span data-stu-id="bad06-170">The Atom XML format is the only supported value and is the default for the **$format** query option.</span></span> <br/> |
|<span data-ttu-id="bad06-171">**$select**</span><span class="sxs-lookup"><span data-stu-id="bad06-171">**$select**</span></span> <br/> |<span data-ttu-id="bad06-172">Возвращает сущности, указанной атрибутом **$select**.</span><span class="sxs-lookup"><span data-stu-id="bad06-172">Returns the entity specified by **$select**.</span></span>  <br/> <span data-ttu-id="bad06-173">Следующий пример выбирает в столбце имя из Table1 в книге ProductSales.xlsx.</span><span class="sxs-lookup"><span data-stu-id="bad06-173">The following example selects the Name column from Table1 in the ProductSales.xlsx workbook.</span></span>  <br/> <span data-ttu-id="bad06-174">http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$ select = имя</span><span class="sxs-lookup"><span data-stu-id="bad06-174">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$select=Name</span></span>  <br/> |
|<span data-ttu-id="bad06-175">**$inlinecount**</span><span class="sxs-lookup"><span data-stu-id="bad06-175">**$inlinecount**</span></span> <br/> | <span data-ttu-id="bad06-176">Возвращает количество строк в указанной таблице.</span><span class="sxs-lookup"><span data-stu-id="bad06-176">Returns the number of rows in the specified table.</span></span> <br/>  <span data-ttu-id="bad06-177">$ **inlinecount** можно использовать только 1 из 2 из следующих значений.</span><span class="sxs-lookup"><span data-stu-id="bad06-177">$ **inlinecount** can only use 1 of 2 of the following values.</span></span> <br/><ul><li><span data-ttu-id="bad06-178">**allpages**  возвращает количество для всех строк в таблице.</span><span class="sxs-lookup"><span data-stu-id="bad06-178">**allpages** - Returns the count for all rows in the table.</span></span></li><li><span data-ttu-id="bad06-179">**none** - не включает число строк в таблице.</span><span class="sxs-lookup"><span data-stu-id="bad06-179">**none** - Does not include a count of rows in the table.</span></span></li></ul><br/><span data-ttu-id="bad06-180">В следующем примере возвращается количество для общее число строк в Table1 в книге ProductSales.xlsx.</span><span class="sxs-lookup"><span data-stu-id="bad06-180">The following example returns the count for the total number of rows in Table1 in the ProductSales.xlsx workbook.</span></span> <br/>  <span data-ttu-id="bad06-181">http://Contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$ inlinecount = allpages</span><span class="sxs-lookup"><span data-stu-id="bad06-181">http://contoso1/_vti_bin/ExcelRest.aspx/Documents/ProductSales.xlsx/OData/Table1?$inlinecount=allpages</span></span> <br/> |
   

## <a name="additional-resources"></a><span data-ttu-id="bad06-182">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="bad06-182">Additional resources</span></span>
<span data-ttu-id="bad06-183"><a name="xlsAdditionalResources"> </a></span><span class="sxs-lookup"><span data-stu-id="bad06-183"></span></span>


-  [<span data-ttu-id="bad06-184">С помощью OData с помощью служб Excel REST в SharePoint</span><span class="sxs-lookup"><span data-stu-id="bad06-184">Using OData with Excel Services REST in SharePoint</span></span>](using-odata-with-excel-services-rest-in-sharepoint.md)
    
  
-  [<span data-ttu-id="bad06-185">Новые возможности служб Excel для разработчиков</span><span class="sxs-lookup"><span data-stu-id="bad06-185">What's new in Excel Services for developers</span></span>](http://msdn.microsoft.com/library/09e96c8b-cb55-4fd1-a797-b50fbf0f9296.aspx)
    
  
-  [<span data-ttu-id="bad06-186">Документация по спецификации OData</span><span class="sxs-lookup"><span data-stu-id="bad06-186">OData specification documentation</span></span>](http://www.odata.org)
    
  
