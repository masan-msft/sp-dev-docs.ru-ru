---
title: "Разработка рабочих процессов SharePoint с помощью Visual Studio"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.assetid: 28f5d3b1-6fe8-4b1f-8c4e-b11105fe6f46
ms.openlocfilehash: 8968b1f15a929aed1bb713cb2dccccc495f18743
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="develop-sharepoint-workflows-using-visual-studio"></a>Разработка рабочих процессов SharePoint с помощью Visual Studio
SharePointподдерживает две основных среды разработки среды рабочих процессов: SharePoint Designer и Visual Studio. В этой статье описаны обе среды, а также преимущества и недостатки каждой из них.
## <a name="authoring-basics-for-sharepoint-workflows"></a>Основы создания рабочих процессов SharePoint
<a name="bkm_AuthoringBasics"> </a>

> [!NOTE]
> Руководство по установке и настройке Microsoft SharePoint и сервера Workflow Manager Client 1.0 см. в статье [Установка и настройка Workflow Manager SharePoint](set-up-and-configure-sharepoint-workflow-manager.md). 
  
    
    

Как и в предыдущих версиях, Microsoft SharePoint предоставляет две основных среды разработки рабочих процессов: Microsoft SharePoint Designer и Microsoft Visual Studio. Однако отличие от предыдущих версий состоит в том, что при использовании Visual Studio больше нет стратегии разработки на основе кода. Вместо этого и SharePoint Designer, и Visual Studio реализуют полностью декларативную среду разработки без кода независимо от выбранного средства разработки.
  
> [!NOTE]
> Вы можете не только разрабатывать рабочие процессы в SharePoint Designer, но и использовать фигуры Microsoft Visio 2013 для структурирования логики рабочих процессов, а затем импортировать логику в SharePoint Designer 2013. Сведения о разработке логики рабочих процессов с помощью Visio 2013 см. в статье [Разработка рабочих процессов в SharePoint Designer и Visio](workflow-development-in-sharepoint-designer-and-visio.md). 
  
    
    


### <a name="declarative-workflows"></a>Декларативные рабочие процессы

Сначала поясним, что подразумевается под "декларативными" рабочими процессами. Этот термин означает, что вместо написания кода и компиляции в управляемые сборки рабочий процесс описывается (буквально) в XAML и затем интерпретируется во время выполнения.
  
    
    
XAML формируется на основе стандартных блоков рабочего процесса, которыми вы управляете в Конструктор рабочих процессов (при использовании Visual Studio) или в области конструктора рабочих процессов SharePoint Designer (или Visio, но об этом поговорим позже). Стандартные блоки  это визуальные объекты проектирования рабочего процесса в панели инструментов конструктора: стадии, условия, этапы, события и т. д. Набор инструментов в соответствующих панелях инструментов (Visual Studio или SharePoint Designer) отличается, но концепция декларативных рабочих процессов остается неизменным.
  
    
    

## <a name="decision-tree-sharepoint-designer-vs-visual-studio"></a>Дерево принятия решений: SharePoint Designer и Visual Studio
<a name="bkm_DecisionTree"> </a>

Одно из основных преимуществ платформы рабочих процессов в SharePoint  это простота использования среды без кода SharePoint Designer для создания мощных рабочих процессов. Кроме того, декларативная среда разработки, такая как Visual Studio, обеспечивает высокую степень гибкости и настройки.
  
    
    
Обе этих среды, SharePoint Designer и Visual Studio, обладают определенными преимуществами и недостатками. В этом разделе мы расскажем, как определить, какая среда разработки больше всего подходит вам.
  
    
    

### <a name="using-sharepoint-designer"></a>Использование SharePoint Designer


- **Целевые пользователи:** информационные работники, бизнес-аналитики, разработчики SharePoint.
    
  
- **Уровень сложности:** знакомство SharePoint Designer, в том числе с основными компонентами рабочего процесса, такими как стадии, шлюзы, этапы, условия и циклы.
    
  
В SharePoint Designer можно создать рабочий процесс, который присоединяется к списку, библиотеке или сайту, с помощью текстового конструктора без кода. Или они могут использовать новую визуальную среду разработки, в которой графические элементы размещаются на поверхности разработки и представляют логический поток бизнес-процесса. SharePoint Designer позволяет быстро создавать рабочие процессы даже нетехническим специалистам.
  
    
    

### <a name="using-visual-studio"></a>Использование Visual Studio


- **Целевые пользователи:** разработчики программного обеспечения среднего или высокого уровня.
    
  
- **Уровень сложности:** знакомство с Visual Studio, в том числе с концепциями разработки программного обеспечения, приемниками событий, упаковкой, развертыванием и безопасностью.
    
  
Visual Studio позволяет гибко создавать рабочие процессы для поддержки практически любого бизнес-процесса независимо от его сложности. Разработчики также могут выполнять отладку и повторно использовать определения рабочих процессов. Возможно, наиболее важное преимущество Visual Studio состоит в том, что разработчики могут добавлять рабочие процессы SharePoint в рамках более крупного решения SharePoint или Надстройка SharePoint.
  
    
    
Visual Studioпозволяет разработчикам создавать настраиваемые действия для SharePoint Designer и предоставляет средства для выполнения настраиваемой логики. С помощью Visual Studio разработчики также могут создавать шаблоны рабочих процессов, которые можно развернуть на нескольких сайтах.
  
    
    

## <a name="comparing-sharepoint-designer-with-visual-studio"></a>Сравнение SharePoint Designer с Visual Studio
<a name="bkm_Comparing"> </a>

В таблице ниже сравниваются функции создания рабочих процессов SharePoint SharePoint Designer и Visual Studio, а также требования к их использованию.
  
    
    

**Таблица 1. Сравнение инструментов создания рабочих процессов**


|**Функции и требования**|**SharePoint Designer**|**Visual Studio**|
|:-----|:-----|:-----|
|Быстрое создание рабочих процессов  <br/> |Да  <br/> |Да  <br/> |
|Повторное использование рабочих процессов  <br/> |Рабочий процесс может использоваться только списком или библиотекой, в котором он был создан. Однако SharePoint Designer предоставляет рабочие процессы, которые могут использоваться несколько раз на одном сайте.  <br/> |Рабочий процесс можно создать как шаблон, чтобы после развертывания его можно было повторно использовать и связывать с любым списком или библиотекой.  <br/> |
|Позволяет добавить рабочий процесс в решение SharePoint или Надстройка SharePoint  <br/> |Нет  <br/> |Да  <br/> |
|Позволяет создавать настраиваемые действия  <br/> |Нет. Однако SharePoint Designer может использовать и реализовать настраиваемые действия, которые создаются и развертываются с помощью Visual Studio.  <br/> |Да. Однако помните, что в Visual Studio используются базовые действия, а не соответствующие им действия.  <br/> |
|Позволяет создавать пользовательский код  <br/> |Нет  <br/> |Нет  <br/> **Примечание.** Эта возможность, доступная в таком виде в предыдущих версиях, изменилась. В SharePoint используются только декларативные рабочие процессы, а в Visual Studio для разработки рабочих процессов применяется рабочая область визуального конструирования.           |
|Возможность создавать логику рабочих процессов с помощью Visio профессиональный  <br/> |Да  <br/> |Нет  <br/> |
|развертывание, —  <br/> |Автоматическое развертывание в списке, библиотеке или на сайте, на котором они созданы.  <br/> |Создание файла пакета (WSP-файла) решения SharePoint и развертывание пакета на сайте (SPWeb).  <br/> |
|Публикация рабочих процессов одним щелчком  <br/> |Да  <br/> |Да  <br/> |
|Рабочие процессы можно упаковать и развернуть на удаленном сервере  <br/> |Да  <br/> |Да  <br/> |
|отладка  <br/> |Отладка не поддерживается.  <br/> |Рабочий процесс можно отлаживать с помощью Visual Studio.  <br/> |
|Можно использовать только действия, которые утверждены администратором сайта  <br/> |Да  <br/> |Да  <br/> **Примечание.** Эта возможность, доступная в таком виде в предыдущих версиях, изменилась. Ранее рабочие процессы и действия, созданные с помощью Visual Studio, были основаны на коде и развертывались на уровне фермы, поэтому утверждение администратора не требовалось.           |
   

## <a name="developing-workflows-using-visual-studio"></a>Разработка рабочих процессов с помощью Visual Studio
<a name="bkm_Developing"> </a>

В отличие от более ранних версий рабочие процессы в SharePoint полностью декларативные. Visual Studio предоставляет визуальную поверхность разработки рабочих процессов на основе Windows Workflow Foundation 4, которая позволяет создавать собственные рабочие процессы, шаблоны рабочих процессов, формы и настраиваемые действия рабочих процессов исключительно в среде конструктора. Затем рабочий процесс упаковывается и развертывается как компонент SharePoint. Сведения об упаковке см. в статье  [Использование компонентов в SharePoint Foundation](http://msdn.microsoft.com/ru-RU/library/ms461324.aspx).
  
    
    
Возможно, наиболее значительное изменение для разработчиков Visual Studio состоит в том, что настраиваемые рабочие процессы больше не компилируются и не развертываются как сборки .NET Framework. Кроме того, SharePoint больше использует не формы Microsoft InfoPath, а формы Microsoft ASP.NET. 
  
    
    
Наконец, изменились шаблоны проекта рабочего процесса Visual Studio. Ранее шаблоны были предоставлены для конечного автомата и последовательных рабочих процессов, эти различия больше не имеют смысла. Теперь шаблоны проектов Visual Studio доступны в сборке Visual Studio на виртуальной машине (ВМ).
  
    
    

## <a name="enabling-on-premises-workflow-debugging"></a>Включение локальной отладки рабочего процесса
<a name="bkm_Enabling"> </a>

Для отладки локальных рабочих процессов в Visual Studio необходимо временно разрешить средствам диспетчера рабочих процессов доступ к системе в брандмауэре.
  
    
    

1. В **панели управления** выберите элемент **Система и безопасность** и щелкните **Брандмауэр Windows**.
    
  
2. В списке в **основном окне панели управления** щелкните ссылку **Дополнительные параметры**.
    
  
3. В левой области брандмауэра Windows щелкните **Правила для входящих подключений**.
    
  
4. В списке **Правила для входящих подключений** выберите **Workflow Manager Tools 1.0 for Visual Studio 2012 - Test Service Host**.
    
  
5. В списке **Действия** выберите **Включить правило**.
    
  
6. На странице свойств проекта SharePoint перейдите на вкладку **SharePoint**, а затем установите флажок **Включить отладку рабочего процесса**.
    
  

## <a name="debugging-sharepoint-online-workflows-using-visual-studio"></a>Отладка рабочих процессов SharePoint Online с помощью Visual Studio
<a name="bkm_Debug"> </a>

Для отладки рабочих процессов SharePoint Online в Visual Studio выполните следующие действия.
  
    
    

1. Если ваша сеть защищена брандмауэром, может потребоваться установить прокси-клиент (например,  [Клиент Forefront Threat Management Gateway (TMG)](http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&amp;id=10504)) в зависимости от топологии сети организации.
    
  
2. Если у вас еще нет учетной записи Microsoft Azure, зарегистрируйте ее, а затем выполните вход в эту учетную запись.
    
    Сведения о том, как зарегистрировать учетную запись Microsoft Azure, см. в статье  [Microsoft Azure](http://www.windowsazure.com).
    
  
3. Создайте пространство имен шины обслуживания Microsoft Azure, которое можно использовать для отладки рабочих процессов. Это можно сделать на  [портале управления Microsoft Azure](http://manage.windowsazure.com).
    
    Дополнительные сведения о служебной шине Microsoft Azure см. в статье [Управление пространствами имен служебной шины](http://msdn.microsoft.com/ru-RU/library/windowsazure/hh690928.aspx).
    
    > [!NOTE]
    > Для отладки рабочих процессов SharePoint Online используется компонент "Служба ретрансляции" служебной шины Microsoft Azure, поэтому за использование служебной шины будет взиматься плата. См. статью [Часто задаваемые вопросы о стоимости служебной шины](http://msdn.microsoft.com/library/hh667438.aspx). Вы бесплатно получаете доступ к Microsoft Azure в течение каждого месяца подписки на Visual Studio Professional с подпиской MSDN, Visual Studio Premium с подпиской MSDN или Visual Studio Ultimate с подпиской MSDN. При наличии такого доступа вы можете использовать ретрансляцию служебной шины в течение 1500 или 3000 часов (в зависимости от того, какова подписка на MSDN). Узнайте больше о [доступе к службам Microsoft Azure каждый месяц без дополнительной оплаты](http://www.windowsazure.com/ru-RU/pricing/member-offers/msdn-benefits/). 
4. В Microsoft Azure выберите пространство имен службы, перейдите по ссылке **Ключ доступа**, а затем скопируйте текст из поля **Строка подключения**.
    
  
5. На странице свойств проекта Надстройка SharePoint перейдите на вкладку **SharePoint**, а затем установите флажок **Включить отладку рабочего процесса**.
    
    Необходимо включить эту функцию, чтобы выполнять отладку рабочих процессов событий в SharePoint Online. Это свойство применяется ко всем проектам SharePoint в Visual Studio. Visual Studio автоматически выключает отладку рабочих процессов при упаковке приложения для отправки в Магазин Office.
    
  
6. Установите флажок **Включить отладку через шину обслуживания Microsoft Azure**. В поле **Строка подключения шины обслуживания Microsoft Azure** вставьте ранее скопированную строку подключения.
    
  
Включив отладку рабочих процессов и указав действительную строку подключения для служебной шины Microsoft Azure, вы можете приступить к отладке рабочих процессов SharePoint Online.
  
> [!NOTE]
> Если отладка рабочих процессов не включена и вы не хотите получать уведомления, если проект содержит рабочий процесс, снимите флажок **Уведомлять меня, если отладка шины обслуживания Microsoft Azure не настроена**.
  
    
    


## <a name="see-also"></a>См. также
<a name="workflowbk_addres"> </a>

Большая часть процесса создания рабочих процессов SharePoint в Visual Studio для разработчика осталась неизменной. Основные разделы документации для SharePoint 2010 сохраняют свою актуальность:
  
    
    

- Сведения об использовании Visual StudioКонструктор рабочих процессов см. в статье  [Обзор конструктора Visual Studio для Windows Workflow Foundation](http://msdn.microsoft.com/ru-RU/library/ms441543.aspx).
    
  
- Сведения о создании форм с помощью Microsoft ASP.NET см. в статье  [Общие сведения о формах рабочего процесса](http://msdn.microsoft.com/ru-RU/library/ms457061.aspx).
    
  
- Сведения об упаковке см. в статье  [Использование компонентов в SharePoint Foundation](http://msdn.microsoft.com/ru-RU/library/ms461324.aspx).
    
  
