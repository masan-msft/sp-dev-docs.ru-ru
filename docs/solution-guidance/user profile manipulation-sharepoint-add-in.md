---
title: "Обработка профилей пользователей в объектная модель SharePoint"
ms.date: 11/03/2017
ms.openlocfilehash: 6512313eb59dc62cab4f09d109a3b67f87e67b68
ms.sourcegitcommit: 65e885f547ca9055617fe0871a13c7fc85086032
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2017
---
<a name="user-profile-manipulation-in-the-sharepoint-add-in-model"></a>Обработка профилей пользователей в объектная модель SharePoint
========================================================

<a name="summary"></a>Summary
-------

Подхода, можно выполнять операции создания, чтения, обновления и удаления (CRUD) в службе профилей пользователей (UPS) отличается в новой модели надстройки SharePoint не был с кодом полного доверия. В типичных полного доверия кода (FTC) и сценарий решения фермы операций CRUD ИБП были созданы с помощью кода на сервере объектной модели SharePoint или веб-службы профилей пользователей и развернуты с помощью решений фермы. 

В модели сценарий надстройки SharePoint операций CRUD ИБП выполняются с помощью клиентской объектной модели (CSOM) или веб-службы профилей пользователей.  

<a name="high-level-guidelines"></a>Рекомендации по высокого уровня
---------------------

Как правило эскиз рекомендуется использовать следующие инструкции высокого уровня для выполнения операций CRUD ИБП.

- В следующей таблице описываются типы операций поддерживаются в Office 365 и локальной сред SharePoint для CSOM и API-интерфейсы службы Web профиля пользователя.

    Операция  | API | Локально | Office 365
    ---------| -----| ---------| ------
    ЧТЕНИЕ | CSOM | Поддерживается | Поддерживается
    СОЗДАНИЕ | CSOM | Не поддерживается | Поддерживается
    ОБНОВЛЕНИЕ | CSOM | Не поддерживается | Поддерживается
    DELETE | CSOM | Не поддерживается | Поддерживается
    ЧТЕНИЕ | Веб-служба профиля пользователя | Поддерживается | Не поддерживается
    СОЗДАНИЕ | Веб-служба профиля пользователя | Поддерживается | Не поддерживается
    ОБНОВЛЕНИЕ | Веб-служба профиля пользователя | Поддерживается | Не поддерживается
    DELETE | Веб-служба профиля пользователя | Поддерживается | Не поддерживается

- Обычно не развертываются надстройки для клиента SharePoint для обработки данных ИБП копирование или синхронизации.  Как правило надстройки имеет форму консольное приложение под управлением как запланированная задача или длительным облачная служба например задание Web с Azure.
    + В разделе [задания таймера удаленного (добавить в SharePoint модель набора команд)](remote-timer-jobs-sharepoint-add-in.md) Дополнительные сведения об этих технологий и как их использовать в модели надстройки SharePoint.
- С помощью AppOnly проверки подлинности не поддерживается для любых операций службы профилей пользователей.
- Выполнение кода CSOM с использованием учетной записи, имеющей соответствующие разрешения на выполнение операций CRUD ИБП.
- При синхронизации Active Directory для службы профилей пользователей по умолчанию синхронизируются некоторые атрибуты.
    + [Сопоставления свойств профилей пользователей по умолчанию в SharePoint Server 2013 (статья TechNet)](https://technet.microsoft.com/en-us/library/hh147510.aspx) содержит список атрибутов, синхронизируются по умолчанию.
    + Если вам нужно синхронизировать дополнительные атрибуты, необходимо создать настраиваемое средство, с помощью одного из способов, описанных в этой статье.

<a name="options-to-copy-and-synchronize-ups-data"></a>Параметры для копирования и синхронизации данных ИБП
----------------------------------------

У вас есть две возможности для копирования и синхронизации данных ИБП.

- Локальные
    + Копия базы данных
    + Использование веб-службы профилей пользователей для копирования данных
    + Использование веб-службы профилей пользователей для синхронизации данных
- Office 365
    + Использование CSOM для копирования данных
    + Использование CSOM для синхронизации данных

<a name="on-premises---copy-database"></a>Локальные - копию базы данных
---------------------------
Если у вас есть в локальной среде SharePoint ИБП базы данных можно скопировать из одной фермы в другую для быстро репликации атрибуты.

**Когда это подходит?**

Когда в локальной среде SharePoint и выполнении односторонней копию атрибутов профиля, это является хорошим выбором, так как он может быть реализован быстро и легко без какого-либо кода.

<a name="on-premises---use-the-user-profile-web-service-to-copy-data"></a>Использование локальных - веб-службы профилей пользователей для копирования данных
-----------------------------------------------------------
Если у вас есть в локальной среде SharePoint можно использовать веб-службы профилей пользователей для копирования ИБП данных из одной фермы.

**Когда это подходит?**

При наличии в локальной среде SharePoint и копирования ИБП данных между двумя или более фермах SharePoint это является хорошим выбором, поскольку он обеспечивает гибкость для копирования данных ИБП из одной фермы.

**Приступая к работе**

Следующий пример демонстрирует для выполнения операций CRUD ИБП с веб-службы профилей пользователей.

- [Core.UserProfilePropertyUpdater (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.UserProfilePropertyUpdater)

<a name="on-premises---use-the-user-profile-web-service-to-sync-data"></a>Локальные - использовать веб-службы профилей пользователей для синхронизации данных
-----------------------------------------------------------
Если у вас есть в локальной среде SharePoint для синхронизации данных ИБП между фермами можно использовать веб-службы профилей пользователей.

**Когда это подходит?**

При наличии в локальной среде SharePoint и выполняется синхронизация данных ИБП между двумя или более фермах SharePoint это является хорошим выбором, поскольку он обеспечивает гибкость в значение true, синхронизации и включать любое количество источников.

**Приступая к работе**

[Core.UserProfilePropertyUpdater (PnP образец O365)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.UserProfilePropertyUpdater) демонстрируется, как для выполнения операций CRUD ИБП с веб-службы профилей пользователей.

[Core.MMSSync (PnP образец O365)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.MMSSync) демонстрируется создание средства синхронизации для службы управляемых метаданных (MMS данные).  Хотя в этом примере в центре внимания API-интерфейсы MMS, общий шаблон, используемый для синхронизации может применяться ИБП также к данным.

<a name="office-365---use-csom-to-copy-data"></a>Office 365 — использование CSOM для копирования данных
----------------------------------
Если в среде Office 365 SharePoint CSOM можно использовать для копирования данных ИБП из одного клиента.  

**Когда это подходит?**

При наличии среде Office 365 и копирования ИБП данных между двумя или более участки SharePoint это является хорошим выбором, поскольку он обеспечивает гибкость для копирования данных ИБП из одного клиента.

**Приступая к работе**

[UserProfile.Manipulation.CSOM (PnP образец O365)](https://github.com/SharePoint/PnP/tree/master/Samples/UserProfile.Manipulation.CSOM) демонстрируется, как для выполнения операций CRUD ИБП с помощью CSOM.

[Профиль пользователя CSOM для чтения и обновления (O365 PnP видео)](https://channel9.msdn.com/blogs/OfficeDevPnP/User-profile-CSOM-for-reading-and-updates) — описание [UserProfile.Manipulation.CSOM (образец O365 PnP)](https://github.com/SharePoint/PnP/tree/master/Samples/UserProfile.Manipulation.CSOM).

<a name="office-365---use-csom-to-sync-data"></a>Office 365 — использование CSOM для синхронизации данных
----------------------------------
Когда в среде Office 365 SharePoint и выполняется синхронизация данных ИБП между двумя или более клиенты это является хорошим выбором, поскольку он обеспечивает гибкость в значение true, синхронизации и включать любое количество источников.

**Когда это подходит?**

При наличии среде Office 365 и синхронизации данных ИБП между двумя или более участки SharePoint это является хорошим выбором, поскольку он обеспечивает гибкость в значение true, синхронизации и включать любое количество источников.

**Приступая к работе**

[Core.UserProfiles.Sync (PnP образец O365)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.UserProfiles.Sync) показано, как создавать средства синхронизации данных службы профилей пользователей.

<a name="hybrid-environments"></a>Гибридные среды
-------------------

В сценарии, где у вас есть локальной и среды Office 365 SharePoint и сведения о профилях пользователей должна поддерживаться в обеих сред, которые можно использовать для предоставления возможности для выполнения CUD сочетание веб-службы профилей пользователей и CSOM операции с данными ИБП.

<a name="related-links"></a>Ссылки по теме
=============
- [Профиль пользователя CSOM для чтения и обновления (O365 PnP видео)](https://channel9.msdn.com/blogs/OfficeDevPnP/User-profile-CSOM-for-reading-and-updates)
- [Задания таймера удаленного (добавить в SharePoint модель набора команд)](remote-timer-jobs-sharepoint-add-in.md)
- [Сопоставления свойств профилей пользователей по умолчанию в SharePoint Server 2013 (статья TechNet)](https://technet.microsoft.com/en-us/library/hh147510.aspx)
- Руководств по [http://aka.ms/OfficeDevPnPGuidance](http://aka.ms/OfficeDevPnPGuidance "Руководств")
- Справочные материалы в библиотеке MSDN по [http://aka.ms/OfficeDevPnPMSDN](http://aka.ms/OfficeDevPnPMSDN "Справочные материалы в библиотеке MSDN")
- Видеозаписи по [http://aka.ms/OfficeDevPnPVideos](http://aka.ms/OfficeDevPnPVideos "видео")

<a name="related-pnp-samples"></a>Примеры связанных с ними PnP
===================
- [Core.UserProfilePropertyUpdater (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.UserProfilePropertyUpdater)
- [Core.MMSSync (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.MMSSync)
- [UserProfile.Manipulation.CSOM (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/UserProfile.Manipulation.CSOM)
- [Core.UserProfiles.Sync (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.UserProfiles.Sync) 
- Примеры и содержимое в [http://aka.ms/OfficeDevPnP](http://aka.ms/OfficeDevPnP)

<a name="applies-to"></a>Применимо к
==========
- Office 365 нескольких клиентов (MT)
- Office 365 выделенных (D)
- SharePoint 2013 в локальной
