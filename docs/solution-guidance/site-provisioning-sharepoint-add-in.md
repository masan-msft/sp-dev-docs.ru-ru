---
title: "Подготовка сайта в объектная модель SharePoint"
ms.date: 11/03/2017
ms.openlocfilehash: c45236c0c66aafdad1669354b50291fc2c009495
ms.sourcegitcommit: 65e885f547ca9055617fe0871a13c7fc85086032
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2017
---
<a name="site-provisioning-in-the-sharepoint-add-in-model"></a>Подготовка сайта в объектная модель SharePoint
================================================

<a name="summary"></a>Summary
-------

Выбор подхода для подготовки семейств веб-сайтов и sub сайтам будет разным в новой надстройки SharePoint модели, по сравнению с как было в коде полного доверия. В типичных полного доверия кода (FTC) / сценарий решения фермы, вам нужно создать sub сайтов и семейств веб-сайтов с помощью определений сайтов и веб-шаблоны и использовать декларативные код для настройки сайтов и применение настроек. В этой модели декларативного кода обычно используется для создания столбцов сайта, типы контента и списки, определенные в формате XML, а затем использовать элементы компонента SharePoint для их упаковки и развертывания.

В SharePoint надстройки модели сценарии можно использовать SharePoint клиента со стороны объектной модели (CSOM) для создания и настройки семейств веб-сайтов и sub сайтам. Этот шаблон обычно называемую *удаленного подготовки шаблон*.

На высоком уровне удаленного подготовки шаблон выглядит следующим образом:

![(1) A удаленного таймер, переходит (2) начальное подготовки на основании вне поля сайта. Обычно либо группы сайта или веб-сайт публикации. Активы загружаются из модуля подготовки, с помощью CSOM/REST. (3) примените необходимые изменения (конфигурации и т.д.) на основе вне поля сайта на основе выбранного пользователя для создания сайта проекта, организации или веб-сайт рабочей группы. Это часть специализации, но поскольку мы начинаются с сайта готовые, мы всегда получайте последние усовершенствования в нее как основу.](media/Recipes/SiteProvisioning/overview.png)

<a name="high-level-guidelines"></a>Рекомендации по высокого уровня
---------------------

Как правило эскиз рекомендуется следующее высокого уровня для создания семейств веб-сайтов и sub сайтам.

- Подготовка семейства веб-сайтов и sub сайтов на основе шаблонов сайта ожидания введите, поставляемых с SharePoint.
    + Использование SharePoint CSOM для создания семейства веб-сайтов и sub сайтам.
- Применить настройки и параметры для семейств сайтов ожидания введите и sub сайтам в соответствии с требованиями.
    + Используйте SharePoint CSOM, чтобы применить настройки и параметры.
- Мы рекомендуем не использовать элементов framework функции в создании создание семейств сайтов и sub сайтам.
    + Единственное исключение это правило — при использовании декларативного XML-based подготовки-Add-in сети в SharePoint хостингом SharePoint надстройки. Это так, как CSOM недоступен в SharePoint хостингом SharePoint надстройки.

<a name="challenges-when-creating-site-collections-and-sub-sites"></a>Проблемы, связанные с при создании сайтов и семейств сайтов sub
--------------------------------------------------

**Создание в веб-браузере и создание с помощью кода** 

Он важно понимать, что создание семейств веб-сайтов и sub-сайтов в веб-браузере и с помощью кода различны. В этом списке описаны различные параметры.

- **Создание веб-браузер**
    + В этот параметр пользователям получить доступ к сайту SharePoint, веб-браузер и использовать страницы администрирования для создания семейств веб-сайтов и sub сайтам.
    + Обычно только времени, которые необходимы для использования веб-браузер — вручную создание семейств веб-сайтов и сайты sub является после создания прототипов или изменение одного сайта SharePoint, которого не запланировано на случай увеличения для включения других семейств веб-сайтов или sub сайтам.  
- **Создание с помощью кода**
    + В этот параметр будет выполнен код SharePoint CSOM для создания семейств веб-сайтов и sub сайтам. 
    + Далее в этой статье вы найдете сведения несколько способов, что можно использовать для выполнения кода SharePoint CSOM.

При **создании веб-браузер** , необходимо учитывать следующее.

- Создание семейств веб-сайтов и сайтов sub через веб-браузер — это обычно процесс сложным и много времени.
    + Эти факторы сделать создание семейств веб-сайтов и sub сайтам с помощью web браузера **может привести к ошибкам**.   
- Нет возможности повторное создание семейств веб-сайтов и создания веб-сайтов sub (и компонентов, которые они содержат) в веб-браузере повторяющихся образом. 
    + Это делает **трудно** быстро и постоянно развертывание семейств веб-сайтов и sub сайтов для различных сред, при перемещении из среды разработки для тестирования в рабочей среде.

При **создании с кодом**, необходимо учитывать следующие моменты.

- Создание семейств веб-сайтов и sub сайтам с помощью кода обычно включает использование библиотек пользовательских служебной программы для выполнения кода SharePoint CSOM.
    + Вы найдете эти библиотеки, доступные в количество проектов в репозитории PnP репозиториев разработчик офисных решений. Они также ссылок на них в статье и в конце.
    + Эти факторы сделать создание семейств веб-сайтов и sub сайтам, содержащим кода **может привести к успеха**.
- Можно **легко и постоянно реплицировать** семейств веб-сайтов и создания веб-сайтов sub (и компонентов, содержащихся в них) с помощью кода фрагментарное образом.
    + Можно **легко** развернуть семейств веб-сайтов и sub сайтам в различных средах и ссылки на них при перемещении из среды разработки для тестирования в рабочей среде.

**Должны быть выполнены быстро!**

Конечные пользователи не будет принимать не через несколько нескольких часов для их новых сайтов SharePoint подготовить к работе.

**Должен быть согласованно идеальным!**

Семейств веб-сайтов и сайтов sub, а также различные компоненты они включают такие как столбцы сайта, контента типов, списки, главные страницы, файлы JavaScript, изображения, и др., являются принципах, определение информационной архитектуры, *они должны иметь идеальным*!

Неправильный веб-сайтов и подготовки сайта sub могут влиять на всю бизнес-приложения на сайте SharePoint, где они будут иметь доступ и других компонентов SharePoint и других бизнес-приложений, доступ к службам SharePoint .

Например: при наличии сайтов SharePoint, используемый для управления проектами в вашей компании, вероятнее всего создается распространенные схемы списка для всех из них. Для этого потребуется создать типы контента и столбцы сайта. При выполнении поиска данных на этих сайтах с помощью страницы поиска SharePoint, фильтрация результатов по типу содержимого или тег (столбец сайта). Столбцы сайта и типы контента не вполне соответствуют по всем сайтам проекта, не получат точных результатов.

В этом примере также могут быть применены к содержимого с веб-частей поиска, надстройки SharePoint, мобильных приложений и других систем, доступ к данным на сайтах SharePoint.

<a name="options-to-create-site-collections-and-sub-sites"></a>Параметры для создания семейств веб-сайтов и sub сайтам
------------------------------------------------

Существует несколько вариантов, которые можно использовать для создания семейств веб-сайтов и sub сайтам с помощью новой модели надстройки SharePoint. Эти параметры все могут быть разделены на параметр **Создание с кодом** , описанных выше.

- Переопределить ссылку Создать сайт
- Переопределить ссылку Создать sub сайта
- Используйте размещение у поставщика в SharePoint надстройки
- С помощью приложения .NET/Java/Objective-C или скриптов PowerShell

<a name="override-the-create-site-link"></a>Переопределить ссылку Создать сайт
-----------------------------

В этом шаблоне с помощью ссылок, указывающий на размещение у поставщика в SharePoint Add-in переопределяется ссылка на создание семейства веб-сайтов. CSOM код, выполняющийся в размещенном у поставщика SharePoint Add-in выполняется с помощью удаленного подготовки шаблон в рамках процесса создания сайта.

- Шаблон используется только в том случае, когда предназначенные для создания семейства сайтов; он не используется для создания сайтов sub.
- Переопределение URL-адрес настроен в центре администрирования SharePoint. Этот URL-адрес указывает на размещение у поставщика в SharePoint надстройки.
- Размещение у поставщика в SharePoint надстройки используются интерфейсы API CSOM создание семейств веб-сайтов.
    + API-интерфейсы REST или CSOM также могут быть использованы для настройки других аспектов сайта во время процесса подготовки.
- Этот подход может использоваться в клиентов Office 365 и в локальном SharePoint.
- Обеспечивает большую гибкость для создания и настройки семейств веб-сайтов SharePoint.
- Простой и недорогим внедрение и обслуживание в короткие и длинные терминов.

**Конфигурация**

Чтобы переопределить ссылку Создать сайт откройте страницу параметров в центре администрирования SharePoint (как показано ниже).

![SharePoint admin center меню, меню «Параметры» с выделением.](media/Recipes/SiteProvisioning/sp-admin-center.png)

Затем установите флажок использовать формы при этом URL-адрес в систему и введите URL-адрес для Provider-hosted SharePoint надстройки, реализующий функциональные возможности создания сайта (как показано ниже).

![Диалоговое окно с ОК Отмена право сообщение с веб-страницы, в котором говорится, с помощью изменения расположения, где пользователи создавать сайты, вам может разрешение их для запуска пользовательского скрипт, который может получать доступ к другим сайтам (для получения дополнительных сведений см. http://go.microsoft.com/fwlink/?LinkId=164264). Чтобы избежать этого, выполните следующую команду консоли SharePoint Online: Set-SPOsite < SiteURL > - DenyAddAndCustomizePages 1 вы по-прежнему требуется изменить расположение, где пользователи создавать сайты?](media/Recipes/SiteProvisioning/override-warning.png)

Обратите внимание на то, предупреждающем (в диалоговом окне ниже) влияние на безопасность связанного при использовании этого подхода SharePoint, а также возможность отключения функции этого типа.

![На этой странице, Стрелка указывает флажок право, использования формы в этот URL-адрес, который не установлен. Другие текст и элементы управления на этой странице: предоставить пользователям ярлык для создания новых сайтов группы в определенном месте. Скрыть ссылку не выбран, переключатель Показать ссылку установлен переключатель. Сайт классификации поле скрыто от пользователей. Дополнительного контакта поля не является обязательным.](media/Recipes/SiteProvisioning/override-form.png)

**Когда это подходит?**

Этот параметр используется, когда необходимо предоставить пользователям возможность самостоятельного создания семейств сайтов SharePoint на основе настраиваемых шаблонов.

**Приступая к работе**

В следующих статьях описывается переопределение создайте шаблон сайта ссылок и предоставьте примеры кода для начала.

- [Самостоятельное подготовки сайта с помощью надстройки для SharePoint 2013 (блог MSDN)](http://blogs.msdn.com/b/richard_dizeregas_blog/archive/2013/04/04/self-service-site-provisioning-using-apps-for-sharepoint-2013.aspx)
    + Статья начала до конца об этом шаблоне с видеороликами.
- [Provisioning.Cloud.Sync (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Provisioning.Cloud.Sync)
    + В этом решении показана модель за предоставление синхронного сайта семейства сайтов или sub сайта создания интерфейса должна представлена модель шаблоны сайтов без использования фактический изолированные решения или stp-файлы. 

<a name="override-the-create-sub-site-link"></a>Переопределить ссылку Создать sub сайта
---------------------------------

В этом шаблоне с помощью ссылок, указывающий на размещение у поставщика в SharePoint Add-in переопределяется ссылка на создание веб-узла. CSOM код, выполняющийся в размещенном у поставщика SharePoint Add-in выполняется с помощью удаленного подготовки шаблон в рамках процесса создания сайта.
 
- Шаблон используется только при настройке sub создания сайтов; не используется для создания семейств веб-сайтов.
- Переопределение URL-адрес настроен с настраиваемым действием, использующего JavaScript для изменения ссылки. Этот URL-адрес указывает на размещение у поставщика в SharePoint надстройки.
- Размещение у поставщика в SharePoint надстройки используются интерфейсы API CSOM для создания сайтов sub.
    + API-интерфейсы REST или CSOM также могут быть использованы для настройки других аспектов сайта во время процесса подготовки.
- Этот подход может использоваться в клиентов Office 365 и в локальном SharePoint.
- Обеспечивает большую гибкость для создания и настройки сайтов SharePoint.
- Простой и недорогим внедрение и обслуживание в короткие и длинные терминов.

**Когда это подходит?**

Этот параметр используется, когда необходимо предоставить конечным пользователям возможности самообслуживания для создания на основе настраиваемых шаблонов сайтов SharePoint sub.

**Приступая к работе**

В следующих статьях описывается переопределение создайте шаблон сайта ссылку sub и предоставьте примеры кода для начала.

- [Provisioning.Cloud.Sync (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Provisioning.Cloud.Sync)
    + В этом решении показана модель за предоставление синхронного сайта семейства сайтов или sub сайта создания интерфейса должна представлена модель шаблоны сайтов без использования фактический изолированные решения или stp-файлы. 
- [Provisioning.SubSiteCreationApp (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.SubSiteCreationApp)
    + Это решение использует так называемые удаленного подготовки шаблон для предоставления как система шаблона сайта гибкие sub максимально возможной. Он также включает сопутствующий видео.


<a name="use-a-provider-hosted-sharepoint-add-in"></a>Используйте размещение у поставщика в SharePoint надстройки
---------------------------------------

В этом шаблоне CSOM кода, выполняющегося в размещенном у поставщика SharePoint Add-in выполняется с помощью удаленного подготовки шаблон в рамках процесса создания сайта.
 
- Шаблон могут быть использованы для целевого сайта семейства сайтов и sub создания сайтов
- Надстройка SharePoint хостингом должны быть предоставлены разрешения на полный доступ к среде SharePoint.
    + Нельзя использовать этот шаблон в Microsoft Marketplace, из-за разрешений на полный доступ.
- Размещение у поставщика в SharePoint Add-in используются интерфейсы API CSOM создание семейств веб-сайтов и sub сайтам.
    + API-интерфейсы REST или CSOM также могут быть использованы для настройки других аспектов сайта во время процесса подготовки.
- Этот подход может использоваться в клиентов Office 365 и в локальном SharePoint.
- Обеспечивает большую гибкость для создания и настройки сайтов SharePoint.
- Простой и недорогим внедрение и обслуживание в короткие и длинные терминов.

**Когда это подходит?**

Этот параметр работает также в том случае, если вам необходимо предоставить конечным пользователям возможность Самостоятельное создание семейств веб-сайтов SharePoint и sub на основе настраиваемых шаблонов сайтов. *Обратите внимание, что необходимо предоставить пользователям ссылку для приложений у поставщика, поэтому они могут обращаться к ней.*

- [Подготовка Async с помощью гибридных сценариев (статья блога MSDN)](http://blogs.msdn.com/b/vesku/archive/2015/03/05/hybrid-site-collection-provisioning-from-azure-to-on-premises-sharepoint.aspx)
- [Provisioning.Hybrid.Simple (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Hybrid.Simple)
    + В этом примере демонстрируется простой установки возможных гибридных с очередями хранилища Azure шине обслуживания и WebJobs ретрансляции. Это Демонстрация размещения поставщика надстройки SharePoint в веб-сайта Azure, которую можно использовать для размещения нового настраиваемого с фирменной символикой семейств веб-сайтов в локальной ферме без любого инфраструктуры SharePoint Add-in требования к локальной.
- [Provisioning.Services.SiteManager (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Services.SiteManager)
    + В этом примере показано, как расширить локальную ферму для поддержки создания семейства сайтов с размещением у поставщика SharePoint надстройки.
- [Provisioning.SiteCollectionCreation (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.SiteCollectionCreation)
    + Демонстрируется создание семейств веб-сайтов с помощью CSOM для Office 365 с размещением у поставщика SharePoint надстройки.

<a name="use-netjavaobjective-c-applications-or-powershell-scripts"></a>С помощью приложения .NET/Java/Objective-C или скриптов PowerShell
----------------------------------------------------

В этом шаблоне CSOM код выполняется с помощью приложения .NET/Objective-C/iOS или скриптов PowerShell.  Этот шаблон также включает в себя с помощью задания таймера удаленного; Например, задание Web с Azure.
 
- Шаблон может использоваться для целевого сайта семейства сайтов и sub создания сайтов.
- Надстройки SharePoint должны быть предоставлены разрешения на полный доступ к среде SharePoint.
- Проверка подлинности может оказаться сложной задачей, в зависимости от типа SharePoint Add-in создается и параметры безопасности SharePoint.
- Размещение у поставщика в SharePoint надстройки используются интерфейсы API CSOM создание семейств веб-сайтов и sub сайтам.
    + API-интерфейсы REST или CSOM также могут быть использованы для настройки других аспектов сайта во время процесса подготовки.
- Этот подход может использоваться в клиентов Office 365 и в локальном SharePoint.
- Обеспечивает большую гибкость для создания и настройки сайтов SharePoint.
- Простой и недорогим внедрение и обслуживание в короткие и длинные терминов.

**Когда это подходит?**

Этот параметр хорошо работает в сценариях разработки операций. Она позволяет создавать пользовательские приложения или сценарии, предназначенный для работы с процессы Dev операций. Этот параметр предоставляет максимальный уровень автоматизации, так как для запуска без взаимодействия с пользователем можно создавать надстройки SharePoint и скрипты. 

-   [Подготовка Async для Office 365 с помощью WebJobs (статья блога MSDN)](http://blogs.msdn.com/b/vesku/archive/2015/03/04/asynchronous-on-demand-site-collection-provisioning-to-office-365-with-azure-webjobs.aspx) 
- [Provisioning.Cloud.Async.WebJob (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Cloud.Async.WebJob)
    + Решение демонстрируется, как создать коллекцию асинхронных самостоятельного создания сайтов с помощью хранилища очереди Azure и Azure WebJobs решения по подготовке.
-   [Provisioning.Framework.Console (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/samples/Provisioning.Framework.Console) — пример инфраструктуры подготовки сайта для отображения power новый модуль.
-   [Provisioning.Cloud.Async (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Cloud.Async) - демонстрируется создание семейств веб-сайтов в Office 365/SharePoint асинхронно. Запросы будут сохранены в виде списка в пределах веб-сайт SharePoint. Консольное приложение, в этом примере развернут в Azure или в локальную среду & расписанию. 
 

<a name="related-links"></a>Ссылки по теме
=============
- [Самостоятельное подготовки сайта с помощью надстройки для SharePoint 2013 (блог MSDN)](http://blogs.msdn.com/b/richard_dizeregas_blog/archive/2013/04/04/self-service-site-provisioning-using-apps-for-sharepoint-2013.aspx)
- Руководств по [http://aka.ms/OfficeDevPnPGuidance](http://aka.ms/OfficeDevPnPGuidance "Руководств")
- Справочные материалы в библиотеке MSDN по [http://aka.ms/OfficeDevPnPMSDN](http://aka.ms/OfficeDevPnPMSDN "Справочные материалы в библиотеке MSDN")
- Видеозаписи по [http://aka.ms/OfficeDevPnPVideos](http://aka.ms/OfficeDevPnPVideos "видео")

<a name="related-pnp-samples"></a>Примеры связанных с ними PnP
===================

- [Provisioning.Cloud.Sync (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Provisioning.Cloud.Sync)
- [Provisioning.SubSiteCreationApp (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.SubSiteCreationApp)
- [Provisioning.Services.SiteManager (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Services.SiteManager)
- [Provisioning.SiteCollectionCreation (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.SiteCollectionCreation)
- Примеры и содержимое в https://github.com/SharePoint/PnP

<a name="applies-to"></a>Применимо к
==========
- Office 365 нескольких клиентов (MT)
- Office 365 выделенных (D) *частично*
- SharePoint 2013 в локальной — *частично*

*Шаблоны для выделенных и локальной идентичны с помощью надстройки SharePoint методики модели, но возможных технологий, которые могут использоваться отличаются.*
