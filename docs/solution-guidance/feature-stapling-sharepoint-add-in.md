---
title: "Ассоциация в объектная модель SharePoint"
ms.date: 11/03/2017
ms.openlocfilehash: 204f53d47256b51ef6c2495deae4c69ce810fa23
ms.sourcegitcommit: e157d51378190ddfed6394ba154ce66141c8ca33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2018
---
<a name="feature-stapling-in-the-sharepoint-add-in-model"></a>Ассоциация в объектная модель SharePoint
===============================================

<a name="summary"></a>Summary
-------

Подхода, можно выполнять код и развертывание артефактов при подготовке сайта SharePoint будет разным в новой модели надстройки SharePoint не был с кодом полного доверия.  В типичных полного доверия кода (FTC) / сценарий решения фермы, определения были изменены с сайта ожидания введите сшивания функций.  Функции использовались для упаковки и развертывания артефактов, конфигураций и фирменной настройки основных средств, связанных с сайтом SharePoint и были сшивания функций для определения сайта.  Затем сшитого функции были автоматически устанавливается и активируется при инициализации сайта.

В SharePoint надстройки модели сценарии может сшивания функций, сшивания надстройки или с помощью SharePoint клиента со стороны объектной модели (CSOM) Создание и настройка семейств веб-сайтов и sub сайтам затем развертывание артефактов, конфигураций и фирменной настройки ресурсов. Этот шаблон обычно называемую *удаленного подготовки шаблон*.

<a name="high-level-guidelines"></a>Рекомендации по высокого уровня
---------------------

Как правило эскиз мы предлагаем для обеспечения высокого уровня следующее Создание и настройка семейств веб-сайтов и sub сайтам затем развертывание артефактов, конфигураций и фирменной настройки ресурсов.

- Единственным способом, можно использовать функции ассоциация при Ассоциация возможности для семейств веб-сайтов и развертывание определения сайта и сшитого возможности с помощью изолированных решений.    
- Можно использовать надстройку ассоциация модели с помощью клиента развернут надстройки для реализации функциональные возможности, аналогичные ассоциации возможности.
- Удаленный подготовки шаблон можно использовать для реализации функциональные возможности, аналогичные прикреплять по активации дополнительных функций на основе определения сайта ожидания введите поле с помощью API удаленного.

<a name="options-to-create-and-configure-site-collections-and-sub-sites-then-deploy-artifacts-configurations-and-branding-assets-to-them"></a>Параметры, чтобы создание и настройка семейств веб-сайтов и затем sub сайтам развертывания артефактов, конфигураций и фирменной настройки средств им
---------------------------------------------------------------------------------------------------------------------------------

Необходимо некоторые параметры, чтобы создать и настроить семейств веб-сайтов и sub сайтам затем развертывание артефактов, конфигураций и фирменной настройки средств.

- Функции скобка
- Скобка надстроек
- Использование удаленных подготовки схемы   

<a name="staple-features"></a>Функции скобка
---------------
В этом шаблоне сшивания функций для определения сайтов.
    
- Этот шаблон доступен только на уровне семейства сайтов.
- Не поддерживается для сшивания функций для вложенных сайтов.
- Это не оптимальную или рекомендуемый подход, так как он использует не рекомендуемые для использования изолированных решений и не настроена вы контейнер для обновлений.

**Когда это подходит?**

При переносе кода прежних версий в локальной среде SharePoint и у вас время повторно создавать должным образом.

**Приступая к работе**

Следующие статьи описывается сшивания функций для определения сайта.

- [Ассоциации возможности в SharePoint 2010 (статья блога MSDN)](http://blogs.msdn.com/b/kunal_mukherjee/archive/2011/01/11/feature-stapling-in-sharepoint-2010.aspx)

<a name="staple-add-ins"></a>Скобка надстроек
--------------
В этом шаблоне развертывание надстройки хранятся в каталоге приложений для определенных семейств сайтов, управляемых путей и шаблонах сайтов.

- В разделе [Развертывание приложений SharePoint 2013 через «приложение ассоциация» (блог статья MSDN - Richard DiZerega)](http://blogs.msdn.com/b/richard_dizeregas_blog/archive/2013/09/18/10399333.aspx) для получения дополнительных сведений о сшивания модели надстройки.
- Так как надстройки помещается администратором, владельцы веб-сайтов не будет возможность удалить надстройку из сайта, отвечающую критерии развертывания.  Даже не администратором семейства сайтов можно удалить надстройку.
- В этом централизованного развертывания также использует те же централизованного надстройки ресурсы (Add-in веб-серверы и удаленного сайта).  По сути добавить в развертывание, но не установлен на веб-сайтах.  Все сайты значение будет использовать Add-in Web и удаленного веб-из экземпляра, установленные в каталоге приложений.
- Из-за централизованного развертывания удаленных событий, таких как «Управление установленными приложениями», «Обработка удалении приложения» и «Обработка обновления приложения» возникает только один раз (если надстройка установлен в каталог приложений).
    + Это может усложнить использование сшивания шаблон надстройки для автоматически применить изменения к сайтам, где он будет развернут, так как эти события не возникают при развертывании на сайты.
- Добавить в части не поддерживаются при Add-ins сшивания на сайты.
- Этот шаблон требует ручной пользовательских действий для развертывания надстройки.

<a name="use-the-remote-provisioning-pattern"></a>Использование удаленных подготовки схемы
-----------------------------------

В этом шаблоне используйте SharePoint клиента со стороны объектной модели (CSOM) для создания и настройка семейств веб-сайтов и sub сайтам затем развертывание артефактов, конфигураций и фирменной настройки средств.

- Этот шаблон не требует упаковки артефакты, конфигураций и фирменной символики активами в отдельные функции или надстроек.  Все, что может упакованный в одной надстройки.
- При использовании этого шаблона для подготовки сайта обычно переопределить вне поля страницы, чтобы создать новый сайт.
- Дополнительные сведения об этом шаблоне можно [Подготовки сайта (добавить в SharePoint набора команд)](site-provisioning-sharepoint-add-in.md)
- Если вы хотите развернуть надстройки на сайте SharePoint, это можно сделать с помощью CSOM.  Ниже приведен пример которого надстройка Office с помощью файла манифеста .app загружает и устанавливает ее на сайте SharePoint.

    ```
    //Create a FileStream object to access the Mail Office Add-in .app file 
    using (FileStream fsSource = new FileStream(System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath + "Innovation.Management.AFO.app",
    FileMode.Open, FileAccess.Read))
    {
        //Return the subweb where you want to install the Add-in
        var subweb = ctx.Web;
        ctx.Load(subweb);
        ctx.ExecuteQuery();

        //Load and Install the Add-in on the subweb
        AppInstance appInstance = subweb.LoadAndInstallApp(fsSource);
        ctx.Load(appInstance);
        ctx.ExecuteQuery();
    }
    ```

    + Контрольное значение [Создание облачных размещенных строки из бизнес-приложения с помощью надстройки для Office, O365, Azure и WP8 (Todd Baginski, Майкл Sherman - конференции SharePoint 2014 г.)](https://channel9.msdn.com/Events/SharePoint-Conference/2014/SPC361) видео, чтобы увидеть, как этот подход был использован для установки надстройки Office на сайтах SharePoint После подготовки сайта.
    + Полный автоматизации можно только с помощью надстройки COM, иметь разрешение полного клиента, которые уже были надежные.
        + В разделе [Core.Sideloading (PnP образец O365)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.SideLoading) в качестве примера. 

<a name="related-links"></a>Ссылки по теме
=============
- [Ассоциации возможности в SharePoint 2010 (статья блога MSDN)](http://blogs.msdn.com/b/kunal_mukherjee/archive/2011/01/11/feature-stapling-in-sharepoint-2010.aspx)
- [Самостоятельное подготовки сайта с помощью надстройки для SharePoint 2013 (блог MSDN)](http://blogs.msdn.com/b/richard_dizeregas_blog/archive/2013/04/04/self-service-site-provisioning-using-apps-for-sharepoint-2013.aspx)
- [Развертывание приложений SharePoint 2013 через «Ассоциация приложения» (блог статья MSDN - Richard DiZerega)](http://blogs.msdn.com/b/richard_dizeregas_blog/archive/2013/09/18/10399333.aspx)
- [(Надстройка SharePoint набора команд) по подготовке сайта](site-provisioning-sharepoint-add-in.md)
- [Создание облачных размещенных бизнес-приложения с помощью надстройки для Office, O365, Azure и WP8 (Todd Baginski, Майкл Sherman - конференции SharePoint 2014 г.)](https://channel9.msdn.com/Events/SharePoint-Conference/2014/SPC361)
- Руководств по [http://aka.ms/OfficeDevPnPGuidance](http://aka.ms/OfficeDevPnPGuidance "Руководств")
- Справочные материалы в библиотеке MSDN по [http://aka.ms/OfficeDevPnPMSDN](http://aka.ms/OfficeDevPnPMSDN "Справочные материалы в библиотеке MSDN")
- Видеозаписи по [http://aka.ms/OfficeDevPnPVideos](http://aka.ms/OfficeDevPnPVideos "видео")

<a name="related-pnp-samples"></a>Примеры связанных с ними PnP
===================

- [Provisioning.Cloud.Sync (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Provisioning.Cloud.Sync)
- [Provisioning.SubSiteCreationApp (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.SubSiteCreationApp)
- [Provisioning.Services.SiteManager (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Services.SiteManager)
- [Provisioning.SiteCollectionCreation (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.SiteCollectionCreation)
- Примеры и содержимое в [http://aka.ms/OfficeDevPnP](http://aka.ms/OfficeDevPnP)

<a name="applies-to"></a>Применимо к
==========
- Office 365 нескольких клиентов (MT)
- Office 365 выделенных (D)
- SharePoint 2013 в локальной
