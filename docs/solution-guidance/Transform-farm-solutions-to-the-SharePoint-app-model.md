---
title: "Преобразование решений фермы для объектная модель SharePoint"
ms.date: 11/03/2017
ms.openlocfilehash: 1a85b977905013c129be5a8d2eb8febdd8b4d5c1
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="transform-farm-solutions-to-the-sharepoint-add-in-model"></a>Преобразование решений фермы для объектная модель SharePoint
Преобразование или преобразование решений фермы объектная модель SharePoint. Узнайте, как преобразовать веб-частей, макеты страниц, главные страницы, задания таймера и так далее в объектная модель SharePoint.

_**Применимо к:** надстройки для SharePoint | SharePoint 2013 | SharePoint Online_

Если нужно перенести расширений объектная модель SharePoint для облегчения перехода к SharePoint Online расширили среды SharePoint с помощью решений фермы, необходимые для преобразования решений фермы в SharePoint модель. Преобразование решений фермы к SharePoint объектная модель включает в себя анализ существующих расширений, проектирование и Разработка новой надстройки для SharePoint и затем тестирование и развертывание надстройки в рабочей среде. В этой статье описывается процесс и рекомендациями для использования при преобразовании решений фермы в SharePoint модель.

## <a name="plan-the-transformation-process"></a>Планирование процесса преобразования
<a name="sectionSection0"> </a>

При преобразовании решений фермы в SharePoint модель необходимо обеспечить минимальное влияние на пользователей. Тщательно анализировать текущего решений фермы и затем создать новой надстройки для SharePoint в соответствии с требованиями вашей организации. Мы рекомендуем следующий процесс для обеспечения успешного преобразования.


1. Готовность. Дополнительные сведения о:
    
    - Надстройки модели SharePoint, различные виды надстройки и варианты размещения. Для получения дополнительных сведений см [надстроек для SharePoint](https://msdn.microsoft.com/library/office/fp179930.aspx).
    
    - Технологии удаленного доступа для доступа к локальные данные.
    
2. Оценка решения. Анализ работы и бизнес-требований по: 
    
    - Идентификация развертывание решений фермы в текущей среде. Подумайте об использовании средств сторонних производителей для определения развернутое расширения. Подробный анализ каждого определенного решения фермы.
    
    - Проверка требований к с вашими пользователями. Рассмотрите возможность запросом пользователей для демонстрации, как их использовать существующие решения фермы для выполнения своих ежедневной работы.
    
    - Определение, документирования и разработке новых возможностей для включения в новой надстройки для SharePoint. Рассмотрите возможность просмотра списка новых компонентов запросов от пользователей дополнительные идеи.
    
    - Определение неиспользуемых функций и согласие с вашими пользователями, чтобы пропустить эту функцию из новой надстройки для SharePoint. 
    
    - Для каждого решения фермы определения, следует ли заменить ее надстройки для SharePoint. Некоторые решения, такие как расширения для администрирования SharePoint, не дублируются в объектная модель SharePoint. Для получения дополнительных сведений см [надстройки для SharePoint, по сравнению с решениями SharePoint](http://msdn.microsoft.com/library/0e9efadb-aaf2-4c0d-afd5-d6cf25c4e7a8.aspx) и [Выбор между надстроек для SharePoint и SharePoint решений](http://msdn.microsoft.com/library/8459e265-b8fd-4bf8-911e-d63cae8bf96f.aspx).
    
3.  Планирование решения. Разработка нового приложения с помощью надстройки модели SharePoint на основе:
    
    - Требования, собранные на шаге 2.
    
    - Анализ существующего кода. Во время анализа кода, необходимо учитывать идентифицирующий фрагменты кода, который может быть удален (например, код больше не используется или требования были изменены).
    
4. Разработка и тестирование версии объектная модель SharePoint из приложения. Обычно это наиболее занимать много времени шаг в процессе преобразования. 
    
5. Развертывание новой надстройки. В зависимости от требований может потребоваться сохранить решений фермы, выполнив параллельно с новой надстройки для SharePoint, или можно отозвать решение фермы и только пользователи могли использовать новой надстройки для SharePoint. В любом случае убедитесь, что развертывания является стабильным и отправить соответствующие связи для пользователей. Если содержимое в существующего сайта, семейства сайтов зависит от решений фермы (например, контент был создан с помощью типа контента), прежде чем вы полностью отозвать решение фермы, необходимые для преобразования существующего контента для использования новой модели надстройки SharePoint решение. Убедитесь, что вы включили достаточно времени для выполнения этой задачи, так как он может занять много времени.

## <a name="transformation-approaches-to-deploy-your-new-add-in-for-sharepoint"></a>Преобразование подходы к развертыванию вашей новой надстройки для SharePoint
<a name="sectionSection1"> </a>

После завершения разработки и тестирования модулей новые надстройки для SharePoint, начать преобразование решения фермы для новой надстройки для SharePoint, используя один из способов преобразования, перечисленные в следующей таблице.

|**Преобразование подход**|**Описание**|**Преимущества**|**Недостатки**|
|:-----|:-----|:-----|:-----|
|На месте|Развертывание новой надстройки для SharePoint в существующую среду SharePoint. Необходимо убедиться, что веб-узла — это с помощью новой надстройки для SharePoint до отзыв решения фермы.|<ul><li>Меньше общей влияние пользователя.</li><li>Меньше ресурсов, необходимых при использовании существующей среды SharePoint.</li><li>Не требуется выполнять средств сторонних производителей.</li><li>Время простоя минимальной сайта.</li><li>Обновление одного семейства веб-сайтов, а не обновление за один раз для всей фермы.</li><li>Не изменяйте URL-адреса.</li></ul>|<ul><li>Трудно для отслеживания хода выполнения завершения всех затронутых средств на сайте.</li><li>Повысить вероятность создания потерянные элементы. Если актива указывает на файл в файловой системе, которая не существует, это называется потерянным.</li></ul>|
|Две или переноса содержимого|Извлеките содержимое из вашего существующих семейств сайтов, где в настоящее время развернутых решений фермы и развертывания контента в новое семейство сайтов, который использует новой надстройки для SharePoint. Этот процесс обычно используется при переносе контента в SharePoint Online.|<ul><li>Чистая среда SharePoint предыдущей независимо решения фермы.</li><li>На новое семейство сайтов не знает производственной среды. Освобождение коллекции обновленной веб-сайтов при готовы. < / li.</ul>|<ul><li>Требуется инструментов сторонних производителей для переноса содержимого.</li><li>Требует дополнительных среды SharePoint.</li><li>Время, необходимое для сайта.</li><li>URL-адреса может изменяться, если вы сохраните обоих сайтов выполняется параллельно на определенный период времени.</li>|

## <a name="best-practices-for-specific-farm-solutions"></a>Советы и рекомендации для решения конкретных фермы
<a name="sectionSection2"> </a>

При преобразование конкретных решений необходимо учитывать следующие рекомендации.


- Макеты страниц и главных страниц. Пользовательские макеты страниц и главных страниц могут существовать в публикация сайтов или веб-сайтов групп с помощью функции публикации включен. Чтобы заменить макеты страниц и главных страниц:
    
  1. Загрузите новые страницы макета главной странице или в веб-узла. Загрузите новые главные страницы и макеты страниц в семействе веб-сайтов вручную или с помощью API удаленного. API удаленного включают клиентской объектной модели (CSOM) и REST. Это гарантирует, что главные страницы и макеты страниц не зависимости на решение фермы. 
    
  2. Настройки сайта для использования нового макеты страниц и главных страниц.
    
  3. Извлечь предыдущую версию макеты страниц и главных страниц.
    
- Веб-частей и элементов управления. Чтобы заменить веб-частей и элементов управления:
    
  1. Проверка всех существующих страниц определяет, какие страницы веб-частей.
    
  2. (Необязательно) Просмотрите ожидания введите веб-частей, чтобы определить, какие-либо можно заменить настраиваемой веб-части.
    
  3. Замените существующих веб-частей часть экземпляров приложения или с помощью других методов (например, внедренных JavaScript в страницы или макеты страниц) в той же функциональности.

  4. Использование внедренных JavaScript для работы с элементы пользовательского интерфейса.
    
    > [!NOTE] 
    > Чтобы заменить существующие веб-части части приложения, необходимо:

    - Включите загрузку со стороны надстроек в подписки Office 365. Обратитесь к администратору Office 365.
    - Используйте CSOM, чтобы включить загрузку со стороны надстройки на вашем сайте. Дополнительные сведения см в образце кода Core.SideLoading.
    - Установка вашей веб-части приложения на вашем сайте.
    - Отключение загрузки со стороны надстроек на вашем сайте.
    - Отключение загрузки со стороны надстроек на подписки Office 365. Обратитесь к администратору Office 365.

- Управление страницами. Может понадобиться для реализации обработки страницы во время настраиваемой процедуры подготовки сайта. Пример кода [Provisioning.Pages](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Pages) показаны методы обработки страницы, включая создание вики-страниц, Добавление HTML контента на страницу Создание список рекомендуемых ссылок, создание страниц с помощью различные макеты, добавление ожидания введите веб-частей на страницу и их удаление страницы.
    
- Столбцы сайта, определений списков и типов контента. Если столбцы сайта, определений списков и типов контента были созданы с помощью элементов framework функции, которые были развернуты с помощью решений фермы, затем необходимо использовать две или подход преобразования переноса содержимого. Это не относится к элементам framework компонента развернуты с помощью изолированных решений. Чтобы использовать подход преобразования переноса содержимого, необходимо использовать средства сторонних производителей для удаления зависимости решения фермы.
    
- Модули или структура компонентов. Модули использовать указатели на файлы, что означает, что файлы не настроены и развернуты в файловой системе. Если решений фермы используйте модули, настройте эти файлы, развернув альтернативного версии из файлов базы данных контента, scan и обновление решений для указания на новые файлы, хранящиеся в базе данных контента и затем отозвать решение фермы, на который указывает файлы, хранящиеся в файловой системе.
    
- Шаблоны сайтов и веб-шаблоны. Вы должны быть направлены на преобразование элементов framework функции развертывания с помощью шаблона сайта или веб-шаблона. Например убедитесь, что страница default.aspx сайта не будет заменен при отзыве решения фермы.
    
- Задания таймера. При использовании SharePoint Online, не могут создавать и управление заданиями таймера. Вместо этого можно создать консольное приложение, которое использует планировщик задач Windows или [Задание Web Azure](http://azure.microsoft.com/documentation/articles/web-sites-create-web-jobs/) для планирования и запуск консольного приложения в удаленном режиме. При создании настраиваемого задания таймера, определите, нужно ли использовать учетную запись или на основе OAuth маркером только для приложений. Пример кода [Core.TimerJobs.Samples](https://github.com/SharePoint/PnP/tree/master/Solutions/Core.TimerJobs.Samples) показано, как создавать свои собственные настраиваемого задания таймера.
    
    > [!NOTE] 
    > Если ваше задание таймера используется код на стороне сервера, необходимо изменить вашего задания таймера для использования CSOM или другой метод.

|**Статья**|**Показано, как для**|
|:-----|:-----|
|[Замените типов контента и столбцы сайта](replace-sharepoint-content-types-and-site-columns.md)|Замените контента типов и столбцов сайта, добавьте столбцы сайта новые типы контента и замените типов контента новые типы контента SharePoint с помощью CSOM.|
|[Замените файлы развертывания с использованием модулей в решения фермы](replace-files-deployed-using-modules-in-sharepoint-farm-solutions.md)|Замените файлы, такие как главные страницы и макеты страниц в SharePoint, которые были развернуты с использованием модулей в решениях фермы, отправка и обновление ссылок для использования новых файлов.|
|[Замените списков, созданных из определений списков](replace-sharepoint-lists-created-from-list-definitions.md)|Замените списков и библиотек, которые были созданы с помощью определения списка в SharePoint.|
|[Замените надстройки части веб-частей](replace-sharepoint-web-parts-with-add-in-parts.md)|Используйте процесс преобразования для замены веб-частей с помощью надстройки частей с помощью объектной модели клиента SharePoint (CSOM).|

## <a name="see-also"></a>См. также
<a name="bk_addresources"> </a>

-  [Шаблоны и рекомендации решений разработки Office 365](Office-365-development-patterns-and-practices-solution-guidance.md)
-  [Создание надстроек для SharePoint](https://msdn.microsoft.com/library/jj163230.aspx)
