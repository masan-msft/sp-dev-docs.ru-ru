---
title: "Изолированная преобразования руководство по решениям для-получатели компонентов."
ms.date: 11/03/2017
ms.openlocfilehash: 91430d1523ad40acba163b86d369958f7273f219
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="sandbox-solution-transformation-guidance---feature-receivers"></a><span data-ttu-id="0d6c8-102">Изолированная преобразования руководство по решениям для-получатели компонентов.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-102">Sandbox solution transformation guidance - Feature receivers</span></span> 
<span data-ttu-id="0d6c8-103">Преобразования или преобразования на основе кода изолированных решений в объектная модель SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-103">Transform or convert your code-based sandbox solutions to the SharePoint add-in model.</span></span> <span data-ttu-id="0d6c8-104">Сведения о стратегии преобразования существующей функциональности объектная модель SharePoint или альтернативных решений и параметры.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-104">Learn about the options and strategies of converting existing functionality to SharePoint add-in model or alternative solutions.</span></span>

<span data-ttu-id="0d6c8-105">_**Применимо к:** Add-ins for SharePoint | SharePoint 2013 | SharePoint 2016 | SharePoint Online_</span><span class="sxs-lookup"><span data-stu-id="0d6c8-105">_**Applies to:** Add-ins for SharePoint | SharePoint 2013 | SharePoint 2016 | SharePoint Online_</span></span>


## <a name="summary"></a><span data-ttu-id="0d6c8-106">Summary</span><span class="sxs-lookup"><span data-stu-id="0d6c8-106">Summary</span></span>
<span data-ttu-id="0d6c8-107">Приемники компонентов обычно используются для применения к сайтам SharePoint вида конфигурации или параметры при активации компонента или при создании сайта (если в веб-шаблон аудио- и веб-шаблон, соответствующий компонент).</span><span class="sxs-lookup"><span data-stu-id="0d6c8-107">Feature receivers are typically used to apply different kind of configurations or settings to SharePoint sites when feature is activated or when site is created (if feature associated to site template / web template).</span></span> <span data-ttu-id="0d6c8-108">Приемники компонентов были развернуты с помощью изолированных решений в SharePoint Online, но с момента с возможностью настройки не могут не logner использоваться, альтернативные разработки необходимо принять.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-108">Feature receivers have been deployed using Sandbox solutions in the SharePoint Online, but since code-based customizations cannot no logner be used, alternative design will need to be taken.</span></span> 

<span data-ttu-id="0d6c8-109">Подхода, можно обрабатывать приемники компонента в SharePoint немного отличаться в объектная модель SharePoint, от полного доверия кодом или в закодированные изолированные решения.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-109">The approach you take to handle feature receivers in SharePoint is slightly different in the SharePoint add-in model than it was with Full Trust Code or in coded-sandbox solutions.</span></span> <span data-ttu-id="0d6c8-110">Необходимо будет повторно создать решение в нет на месте, использование удаленных интерфейсов API (CSOM/REST) для применения необходимых конфигураций на сайты, которые ранее существовавшего в receiver(s) компонента.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-110">You will need to re-design the solution in away that you use remote APIs (CSOM/REST) to apply the needed configurations to your sites, which previously existed in the feature receiver(s).</span></span> 


## <a name="options-for-replacing-feature-receivers"></a><span data-ttu-id="0d6c8-111">Параметры для замены получатели компонентов.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-111">Options for replacing Feature Receivers</span></span>
<span data-ttu-id="0d6c8-112"><a name="sectionSection2"> </a></span><span class="sxs-lookup"><span data-stu-id="0d6c8-112"></span></span>

|<span data-ttu-id="0d6c8-113">**Подход**</span><span class="sxs-lookup"><span data-stu-id="0d6c8-113">**Approach**</span></span>|<span data-ttu-id="0d6c8-114">**Дополнительные сведения**</span><span class="sxs-lookup"><span data-stu-id="0d6c8-114">**Additional Information**</span></span>|
|:-----|:-----|
|<span data-ttu-id="0d6c8-115">PowerShell на основе настроек</span><span class="sxs-lookup"><span data-stu-id="0d6c8-115">PowerShell based customizations</span></span>|<p><span data-ttu-id="0d6c8-116">Использование скриптов PowerShell для подготовки новых семейств сайтов (и потенциально sub сайтам) там, где необходимых настроек, применяются использование удаленных интерфейсов API.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-116">You use PowerShell scripts to provision new site collections (and potentially sub sites) where needed customizations are applied using remote APIs.</span></span> <span data-ttu-id="0d6c8-117">Обычно это делается в приложениях с помощью CSOM и напрямую скриптов PowerShell или с помощью команды PnP PowerShell, который предоставляет простой способ изменения сайтов и контента удаленно.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-117">Typically this is done by using CSOM/REST directly in the PowerShell scripts or by using PnP PowerShell commands, which provides easy way to modify sites and content remotely.</span></span></p><p><lu><li>[<span data-ttu-id="0d6c8-118">PnP модуля подготовки</span><span class="sxs-lookup"><span data-stu-id="0d6c8-118">PnP Provisioning Engine</span></span>](https://github.com/SharePoint/PnP-PowerShell)</li><li>[<span data-ttu-id="0d6c8-119">PnP PowerShell - Приступая к работе с последними обновлениями</span><span class="sxs-lookup"><span data-stu-id="0d6c8-119">PnP PowerShell - Getting started with latest updates</span></span>](http://dev.office.com/blogs/pnp-powershell-getting-started-with-latest-updates)</li></lu></p>|
|<span data-ttu-id="0d6c8-120">Настройки на основе кода</span><span class="sxs-lookup"><span data-stu-id="0d6c8-120">Code based customizations</span></span>|<p><span data-ttu-id="0d6c8-121">Можно применить необходимые настройки, также с помощью управляемого кода с помощью API удаленного.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-121">You can apply the needed customizations also using managed code with remote APIs.</span></span> <span data-ttu-id="0d6c8-122">Это означает, что либо применяются их как часть административные операции при создании сайта или применить настройки для SharePoint, которое будет подключено в коде в качестве части элементов пользовательского интерфейса, как, overiding логику создания сайта sub , таким образом, можно связать настроек в рамках подготовки логики.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-122">This means that you will either apply them as part of the administrative operation when the site is created or you apply customizations to SharePoint, which will hook in your code to be part of the UI elements, like by overiding the sub site creation logic, so that you can associate customizations as part of the provisioning logic.</span></span></p><p><lu><li>[<span data-ttu-id="0d6c8-123">Удаленный подготовки шаблон для создания сайтов sub</span><span class="sxs-lookup"><span data-stu-id="0d6c8-123">Remote provisioning pattern for sub site creation</span></span>](https://channel9.msdn.com/blogs/OfficeDevPnP/Using-remote-provisioning-pattern-for-sub-site-creation)</li><li>[<span data-ttu-id="0d6c8-124">Компонент основной PnP CSOM</span><span class="sxs-lookup"><span data-stu-id="0d6c8-124">PnP CSOM Core Component</span></span>](https://github.com/SharePoint/PnP-sites-core)</li></lu></p>|

## <a name="design-considerations"></a><span data-ttu-id="0d6c8-125">Рекомендации по проектированию</span><span class="sxs-lookup"><span data-stu-id="0d6c8-125">Design Considerations</span></span>
### <a name="powershell-based-provisioning"></a><span data-ttu-id="0d6c8-126">PowerShell на основе подготовки</span><span class="sxs-lookup"><span data-stu-id="0d6c8-126">PowerShell based provisioning</span></span>
<span data-ttu-id="0d6c8-127">В этой модели прекрасно работает, если вашей подготовки модели сайтов основано на административных действий.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-127">This model works great if your site provisioning model is based on administrative actions.</span></span>
- <span data-ttu-id="0d6c8-128">Требуется ли скрипт для выполнения, который применяет необходимые настройки создаваемые сайты</span><span class="sxs-lookup"><span data-stu-id="0d6c8-128">Does require script to be executed which applies needed customizations to created sites</span></span>
- <span data-ttu-id="0d6c8-129">Можно сочетать процедуры создания сайтов, если выполняемые административные операции</span><span class="sxs-lookup"><span data-stu-id="0d6c8-129">Can be combined to site creation process, if performed by as administrative operation</span></span>
- <span data-ttu-id="0d6c8-130">Не требуется инфраструктуры размещения.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-130">Does not require hosting infrastructure</span></span>
- <span data-ttu-id="0d6c8-131">Невозможно автоматически объединить в рамках процесса создания сайта sub</span><span class="sxs-lookup"><span data-stu-id="0d6c8-131">No way to combine automatically as part of the sub site creation process</span></span>

### <a name="code-based-provisioning"></a><span data-ttu-id="0d6c8-132">На основе кода подготовки</span><span class="sxs-lookup"><span data-stu-id="0d6c8-132">Code based provisioning</span></span>
- <span data-ttu-id="0d6c8-133">Может потребоваться инфраструктуры, размещения, если в сочетании с операций конечного пользователя</span><span class="sxs-lookup"><span data-stu-id="0d6c8-133">Can require hosting infrastructure, if combined with end user operations</span></span>
- <span data-ttu-id="0d6c8-134">Можно использовать управляемый код, который выполняется в любом месте с помощью API-интерфейсы CSOM/REST для необходимых операций</span><span class="sxs-lookup"><span data-stu-id="0d6c8-134">You can use managed code which is executed anywhere using CSOM/REST APIs for the needed operations</span></span>
- <span data-ttu-id="0d6c8-135">Можно использовать для переопределения Создание ссылки на сайт sub позволяют интегрировать в SharePoint</span><span class="sxs-lookup"><span data-stu-id="0d6c8-135">Can be used to integrate to SharePoint by overriding sub site creation link</span></span>
- <span data-ttu-id="0d6c8-136">Можно автоматизировать семейства веб-сайтов и дочерних сайта подготовки использование удаленных интерфейсов API</span><span class="sxs-lookup"><span data-stu-id="0d6c8-136">You can automate site collection and subsite provisioning using remote APIs</span></span>

> <span data-ttu-id="0d6c8-137">Если вы хотите предоставить автоматического способ применения необходимые удаленный код в процессе создания логики сайта sub, необходимо переопределить sub ссылки на сайт с помощью пользовательских дополнительных действий.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-137">If you want to provide automatic way to apply needed remote code as part of the sub site creation logic, you'll need to override sub site link using user custom actions.</span></span> <span data-ttu-id="0d6c8-138">Этот параметр используется только availale на сайтах, которые используете классический режим вокруг библиотек и списков.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-138">This option is only availale in sites, which are using classic mode around libraries and lists.</span></span> 


## <a name="reference-approaches"></a><span data-ttu-id="0d6c8-139">Справочник по подходов</span><span class="sxs-lookup"><span data-stu-id="0d6c8-139">Reference approaches</span></span>
### <a name="applying-needed-customizations-to-sites-using-powershell"></a><span data-ttu-id="0d6c8-140">Применение необходимые настройки сайтов с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="0d6c8-140">Applying needed customizations to sites using PowerShell</span></span>
<span data-ttu-id="0d6c8-141">Вот простой скрипт, который использует PnP PowerShell Отправка цвет темы файла с компьютера к SharePoint Online и активирует, на сайте SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-141">Here's a simple script which is using PnP PowerShell to upload a theme color file from computer to SharePoint Online and activates that in SharePoint site.</span></span> 

> <span data-ttu-id="0d6c8-142">В этом примере использует [PnP PowerShell](https://github.com/SharePoint/PnP-PowerShell), который содержит более 150 командлеты PowerShell предназначены для конфигурации сайта и управления активами.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-142">This sample is using [PnP PowerShell](https://github.com/SharePoint/PnP-PowerShell), which provides more than 150 additional PowerShell cmdlets targeted for site configuration and asset management.</span></span> 

```postscript 

Connect-SPOnline –Url https://yoursite.sharepoint.com/ –Credentials (Get-Credential)
Add-SPOFile -Path c:\temp\company.spcolor -Folder /_catalogs/theme/15/
Set-SPOTheme -ColorPaletteUrl /_catalogs/theme/15/company.spcolor

```

### <a name="applying-needed-customizations-to-sites-using-code"></a><span data-ttu-id="0d6c8-143">Применение необходимые настройки сайтов, с помощью кода</span><span class="sxs-lookup"><span data-stu-id="0d6c8-143">Applying needed customizations to sites using code</span></span>
<span data-ttu-id="0d6c8-144">Здесь — это простой код, использующий SharePoint Online CSOM для активации пользовательской темы, сначала Отправка активов на сайт SharePoint и последующей активации пользовательской темы.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-144">Here's a simple code piece which uses SharePoint Online CSOM to activate custom theme by first uploading the assets to SharePoint site and then activating custom theme.</span></span> 

> <span data-ttu-id="0d6c8-145">В этом примере использует [PnP CSOM основных компонента](https://github.com/SharePoint/PnP-sites-core), который расширяет собственным из поля операций, краткие сведения о дополнительных набор методов для общих операций.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-145">This sample is using [PnP CSOM Core Component](https://github.com/SharePoint/PnP-sites-core), which extends the native out of the box operations by introducing additional set of extension methods for common operations.</span></span> <span data-ttu-id="0d6c8-146">Также же операции можно выполнить с помощью собственного CSOM, но будет значительно более сложного кода.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-146">You can perform similar operations also by using native CSOM, but code would be significantly more complex.</span></span>

```csharp

// Upload assets to theme folder
clientContext.Site.RootWeb.UploadThemeFile(
        HostingEnvironment.MapPath(string.Format("~/{0}", "Resources/Themes/SPC/SPCTheme.spcolor")));
clientContext.Site.RootWeb.UploadThemeFile(
        HostingEnvironment.MapPath(string.Format("~/{0}", "Resources/Themes/SPC/SPCbg.jpg")));

Web web = clientContext.Web;
// loading RootWeb.ServerRelativeUrl property;
clientContext.Load(clientContext.Site, w => w.RootWeb.ServerRelativeUrl); 
clientContext.ExecuteQuery();
// Let's first upload the contoso theme to host web, if it does not exist there
web.CreateComposedLookByUrl("Contoso",
                clientContext.Site.RootWeb.ServerRelativeUrl + "/_catalogs/theme/15/SPCTheme.spcolor",
                null,
                clientContext.Site.RootWeb.ServerRelativeUrl + "/_catalogs/theme/15/SPCbg.jpg",
                string.Empty);

// Setting the Contoos theme to host web
web.SetComposedLookByUrl("Green");

```

<span data-ttu-id="0d6c8-147">При использовании подхода на основе кода, рекомендуется использовать для управления шаблона, который будет существенно упростить разработку [PnP модуля подготовки](http://dev.office.com/blogs/sharepoint-pnp-remote-provisioning-engine-august-2016) .</span><span class="sxs-lookup"><span data-stu-id="0d6c8-147">When you are using code based approaches, we recommend using [PnP Provisioning Engine](http://dev.office.com/blogs/sharepoint-pnp-remote-provisioning-engine-august-2016) for the template management, which will dramatically simplify the development efforts.</span></span> 

## <a name="removing-sandbox-solution-containing-feature-receiver-code-from-your-site"></a><span data-ttu-id="0d6c8-148">Удаление изолированного решения, содержащий код приемника компонента с веб-узла</span><span class="sxs-lookup"><span data-stu-id="0d6c8-148">Removing sandbox solution containing feature receiver code from your site</span></span>
<span data-ttu-id="0d6c8-149"><a name="sectionSection3"></a> При решении изолированной среды содержит логику приемников компонента для отключения компонента и не важно, что те, которые выполняются, перед окончательным удалением с возможностью поддержки, следует убедиться, отключаются, что подобные возможности перед Поддержка с возможностью отключена из SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-149"><a name="sectionSection3"> </a> If your sandbox solution contains feature receivers logic for feature deactivation and it's important that those are being executed, before code-based support is completely removed, you should ensure that these kind of features are deactivated before the code-based support is disabled from SharePoint Online.</span></span> <span data-ttu-id="0d6c8-150">Изолированные решения можно удалить из SharePoint Online после поддержка с возможностью отключена, но не будет выполняться код приемника компонента, несмотря на то, что функции начало перемещаются из сайта.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-150">You can uninstall sandbox solutions from SharePoint Online after the code-based support is disabled, but your faeture receiver code would not be executed even though features are getting moved from the site.</span></span> 

<span data-ttu-id="0d6c8-151">При отключении существующего изолированного решения с сайтов, все файлы развернуты с помощью декларативных параметров не будут удалены, однако или активы компонента автоматически быть отключена.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-151">When you deactivate your existing sandbox solution from your sites, any assets or files deployed using declarative options will not be removed however, the feature will automatically be deactivated.</span></span> <span data-ttu-id="0d6c8-152">Выполнение кода в приемник компонента, зависит от времени при отключении изолированные решения.</span><span class="sxs-lookup"><span data-stu-id="0d6c8-152">Execution of the code in the feature receiver, is dependent on the timing when the sandbox solution is deactivated.</span></span> 


## <a name="see-also"></a><span data-ttu-id="0d6c8-153">См. также</span><span class="sxs-lookup"><span data-stu-id="0d6c8-153">See also</span></span>
<span data-ttu-id="0d6c8-154"><a name="bk_addresources"> </a></span><span class="sxs-lookup"><span data-stu-id="0d6c8-154"></span></span>
-  [<span data-ttu-id="0d6c8-155">Удаление на основе кода изолированных решений в SharePoint Online</span><span class="sxs-lookup"><span data-stu-id="0d6c8-155">Removing Code-Based Sandbox Solutions in SharePoint Online</span></span>](http://dev.office.com/blogs/removing-code-based-sandbox-solutions-in-sharepoint-online)
-  [<span data-ttu-id="0d6c8-156">Руководство по преобразованию изолированных решений</span><span class="sxs-lookup"><span data-stu-id="0d6c8-156">Sandbox solution transformation guidance</span></span>](https://msdn.microsoft.com/en-us/pnp_articles/sandbox-solution-transformation-guidance)
-  <span data-ttu-id="0d6c8-157">[PnP PowerShell](https://github.com/SharePoint/PnP-PowerShell/blob/master/README.md) - сценарий на основе настроек</span><span class="sxs-lookup"><span data-stu-id="0d6c8-157">[PnP PowerShell](https://github.com/SharePoint/PnP-PowerShell/blob/master/README.md) - Script based customizations</span></span>
-  <span data-ttu-id="0d6c8-158">[Обучение PnP основных CSOM](https://blogs.msdn.microsoft.com/vesku/2016/04/12/office-dev-pnp-core-componenttraining-package/) - кода на основе параметров</span><span class="sxs-lookup"><span data-stu-id="0d6c8-158">[PnP CSOM Core training](https://blogs.msdn.microsoft.com/vesku/2016/04/12/office-dev-pnp-core-componenttraining-package/) - For code based options</span></span>
