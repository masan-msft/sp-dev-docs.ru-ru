---
title: "Задания таймера удаленного в объектная модель SharePoint"
ms.date: 11/03/2017
ms.openlocfilehash: edd7747655afb18aee647a17e7c4e47d7af0b394
ms.sourcegitcommit: 65e885f547ca9055617fe0871a13c7fc85086032
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2017
---
<a name="remote-timer-jobs-in-the-sharepoint-add-in-model"></a>Задания таймера удаленного в объектная модель SharePoint
================================================

<a name="summary"></a>Summary
-------

Подхода, можно реализовать задания таймера отличается в новой модели надстройки SharePoint не был с кодом полного доверия.  В типичных полного доверия кода (FTC) / сценарий решения фермы, задания таймера SharePoint были созданы с помощью объектной модели SharePoint Server со стороны кода, развернутые с помощью решений фермы и управления в веб-сайта центра администрирования SharePoint. SharePoint обрабатывает планирование и выполнение задания таймера в этом сценарии. 

В сценарии модели надстройки SharePoint задания таймера создаются и вне SharePoint.  SharePoint не отвечает за планирование и выполнение задания таймера в этом сценарии.

<a name="high-level-guidelines"></a>Рекомендации по высокого уровня
---------------------

Как правило эскиз мы предлагаем обеспечивает следующие рекомендации высокого уровня для создания задания таймера.

- Задания таймера должен быть реализован за пределами SharePoint.
- Планирование заданий таймера должен быть реализован за пределами SharePoint.
- Задания таймера должны проходить проверку подлинности с помощью учетной записи службы или OAuth.

<a name="challenges-creating-timer-jobs"></a>Проблемы, связанные с создание заданий таймера
------------------------------

Самой сложной задачей, связанные с созданием задания таймера в Office 365 клиенты — того факта, что нельзя развертывание фермы областью действия решений для клиента Office 365. Без решения уровня фермы нельзя развернуть задания таймера SharePoint.

Новый способ создания задания таймера — для построения за пределами SharePoint и обработка планирование за пределами SharePoint также. Необходимо учитывайте следующие факторы, связанные с заданиями таймера SharePoint для локальной среды SharePoint.

- SharePoint поставляется с сотни заданий таймера ожидания введите, планировщик SharePoint недостаток справиться с.  
можно сократить объем памяти и мощность процессора ОК-требуется на сервере SharePoint путем перемещения реализация кода в Azure или другой среде.
- Планирование и реализацию код, связанный с задания таймера на другой сервер при перемещении SharePoint server легче масштабируются и с достаточно постоянным как результат.

<a name="options-to-schedule-timer-jobs"></a>Параметры для планирования заданий таймера
----------------------------

У вас есть две возможности для реализации планирования для задания таймера.

- Планировщик Windows
    + Службы Windows
- Azure WebJob
    + Azure рабочего процесса

<a name="windows-scheduler"></a>Планировщик Windows
-----------------
В этом шаблоне планировщик Windows обрабатывает аспекты планирования, связанные с задания таймера.  Код реализации может быть консольное приложение или сценарий PowerShell или другой код, который можно было вызвать планировщик Windows.

**Параметр Sub обновления Windows** Службы Windows имеет те же характеристики, что планировщик Windows. Не рекомендуется этому шаблону, но это упомянуть, так как она используется часто.

**При планировщик Windows подходит?**

При отсутствии доступа к Azure подписки для планирования заданий таймера с помощью Azure WebJobs использование планировщика Windows является хорошим выбором, поскольку этот параметр может быть реализован на любом компьютере с операционной системой Windows.

- Требуется дополнительное оборудование для запуска планировщик Windows.
- Требуется дополнительное оборудование выполнение задания таймера.

**Приступая к работе**

Следующие статьи использовать шаблон, планировщик Windows и предоставляют примеры кода для начала.

- [Core.SimpleTimerJob (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.SimpleTimerJob)
    + Статья начала до конца об этом шаблоне с видеороликами.
- [Core.TimerJobs.Samples (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Core.TimerJobs.Samples)
    + Примеры кода великолепную, включающая 10 различных примеров. *Примечание: Не все примеры десять кода могут быть применены шаблон планировщик Windows.*

<a name="azure-webjob"></a>Azure WebJob
------------
В этом шаблоне Azure WebJob обрабатывает аспекты планирования, связанные с задания таймера, а также код реализации.

- Не требуется дополнительное оборудование для запуска WebJob Azure (код планирования и реализации).
- Выгодно, так как они используют Azure WebJob для планирования и реализации кода, который позволяет легко управлять в одном месте.

**Параметр Sub роль Azure работника** Рабочая роль Azure имеет те же характеристики, что WebJob Azure. Не рекомендуется этому шаблону, но это упомянуть, так как она используется часто.

**При Azure WebJob подходит?**

При наличии доступа к Azure подписки для планирования заданий таймера с помощью Azure WebJobs.

**Приступая к работе**

Следующие статьи описывается шаблон Azure WebJob и приводятся примеры кода для начала.

- [Начало работы с azure WebJobs («задания таймера») для сайтов Office 365 (O365 PnP статья)](https://github.com/SharePoint/PnP-Guidance/blob/master/articles/Getting-Started-with-building-Azure-WebJobs-for-your-Office365-sites.md)
    + Описывается создание WebJob Azure в качестве запланированного задания для Office 365 или локальной среды SharePoint. Включает в себя публикации и отслеживания информации.
- [Core.SimpleTimerJob (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Core.TimerJobs.Samples)
    + Примеры кода великолепную, включающая 10 различных примеров. *Примечание: Не все примеры десять кода могут быть применены шаблон Azure WebJob.*

<a name="authentication-options"></a>Параметры проверки подлинности
----------------------

В порядке для заданий таймера для взаимодействия с SharePoint они должны проходить проверку подлинности. На данный момент существует два варианта, которые можно использовать для проверки подлинности задания таймера.

- Использование учетной записи службы
- Использование OAuth

<a name="use-a-service-account"></a>Использование учетной записи службы
---------------------
В этом шаблоне можно определить один или несколько учетных записей служб, используемый для проверки подлинности заданий таймера.

- Учетные записи служб, определяются в SharePoint.
    + В клиента Office 365 в зависимости от функциональных возможностей у задания таймера, учетные записи служб может потребоваться лицензии Office 365, назначенные им.
    + Можно создать учетные записи служб на отдельных основы задание таймера или использование одной учетной записи для всех заданий таймера.
    + Создание понятными и описательными имен для учетных записей служб, можно легко отслеживать операций, выполняемых ими.
    
    Например: Если ваше задание таймера выполняется изменение элементов списка, в столбце Автор изменений для элементов списка отображаются имя учетной записи службы, связанные с задания таймера.

- При проверке подлинности с помощью учетных записей служб, вы должны получить имя пользователя и пароль для учетной записи службы.
    + Приведенный ниже фрагмент кода иллюстрирует, используя имя пользователя и пароль для проверки подлинности.
    + Будьте внимательны для хранения и извлечения имя пользователя и пароль безопасным образом.

    ```
    using (ClientContext context = new ClientContext("https://tenancy.sharepoint.com"))
    {   
        // Use default authentication mode
        context.AuthenticationMode = ClientAuthenticationMode.Default;  
        // Specify the credentials for the account that will execute the request
        context.Credentials = new SharePointOnlineCredentials("User Name", "Password");
    }
    ```

**Приступая к работе**

В следующих статьях описываются как можно использовать шаблон службы учетной записи проверки подлинности и предоставляются примеры кода для начала.

- [Построение приложений SharePoint как задания таймера (блог MSDN)](http://blogs.msdn.com/b/kaevans/archive/2014/03/02/building-a-sharepoint-app-as-a-timer-job.aspx)
    + Статья начала до конца по этому шаблону.
- [Core.SimpleTimerJob (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.SimpleTimerJob)
    + Статья начала до конца об этом шаблоне с видеороликами.
- [Core.TimerJobs.Samples (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Core.TimerJobs.Samples)
    + Примеры кода великолепную, включающая 10 различных примеров. *Примечание: Не все примеры десять кода могут быть применены к шаблону проверки подлинности учетной записи службы.*

<a name="use-oauth"></a>Использование OAuth
-----------
В этом шаблоне определение приложения в SharePoint или Azure Active Directory и использовании маркеры проверки подлинности, связанных с приложением для проверки подлинности.

- При использовании приложения SharePoint для проверки подлинности создания участника приложения и назначить ему разрешения.
    + В этом шаблоне задания таймера может реализовать с помощью Provider-hosted SharePoint Add-in или консольное приложение.
    + Чтобы зарегистрировать субъект приложения для Provider-hosted SharePoint надстройки или консольное приложение, используйте страницу AppRegNew в SharePoint.
    
    На этой странице осуществляется на следующий URL-адрес http://<tenancy>/<site>/_layouts/AppRegNew.aspx

    + Чтобы предоставить разрешения на субъекта приложения, используйте страницу AppInv в SharePoint.
    
    На этой странице осуществляется на следующий URL-адрес http://<tenancy>/<site>/_layouts/AppInv.aspx

- Задания таймера использовать приложение только разрешения, так как у них нет интерактивного пользователя, связанные с ними. 
    + Приведенный ниже фрагмент кода иллюстрирует получение маркер доступа и с помощью приложения только разрешения проходить проверку подлинности в SharePoint.

    ```
    string accessToken = TokenHelper.GetAppOnlyAccessToken(TokenHelper.SharePointPrincipal, siteUri.Authority, realm).AccessToken;
    
    using(var clientContext = TokenHelper.GetClientContextWithAccessToken(siteUri.ToString(),accessToken))
    {
        //Implement timer job code
    }
    ```

- При использовании приложения Azure Active Directory для проверки подлинности, можно создать приложение Azure Active Directory в портала управления Azure и назначить ему разрешения.
    + В этом шаблоне задания таймера может реализовать с помощью Provider-hosted SharePoint Add-in или консольное приложение.
    + В этом шаблоне взаимодействия с библиотеке проверки подлинности Active Directory или Microsoft Graph API для получения маркера доступа.
    + Маркер доступа используется для проверки подлинности в SharePoint (и, возможно, другие службы Office 365 в клиенте Office 365).

**Приступая к работе**

Следующие статьи описывается шаблон проверки подлинности OAUth и приводятся примеры кода для начала.

- [Построение приложений SharePoint как задания таймера (блог MSDN)](http://blogs.msdn.com/b/kaevans/archive/2014/03/02/building-a-sharepoint-app-as-a-timer-job.aspx)
    + Статья начала до конца по этому шаблону.
- [Core.TimerJobs.Samples (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Core.TimerJobs.Samples)
    + Примеры кода великолепную, включающая 10 различных примеров. *Примечание: Не все примеры десять кода могут быть применены к шаблону проверки подлинности OAUth.*

<a name="related-links"></a>Ссылки по теме
=============
- [Ресурсы Azure WebJob (Azure документации)](http://azure.microsoft.com/en-us/documentation/articles/websites-webjobs-resources/)
- [Развертывание WebJobs, с помощью Visual Studio (Azure документации)](http://azure.microsoft.com/en-us/documentation/articles/websites-dotnet-deploy-webjobs/)
- Руководств по [http://aka.ms/OfficeDevPnPGuidance](http://aka.ms/OfficeDevPnPGuidance "Руководств")
- Справочные материалы в библиотеке MSDN по [http://aka.ms/OfficeDevPnPMSDN](http://aka.ms/OfficeDevPnPMSDN "Справочные материалы в библиотеке MSDN")
- Видеозаписи по [http://aka.ms/OfficeDevPnPVideos](http://aka.ms/OfficeDevPnPVideos "видео")

<a name="related-pnp-samples"></a>Примеры связанных с ними PnP
===================

- [Core.SimpleTimerJob (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Core.SimpleTimerJob)
- [Core.TimerJobs.Samples (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Solutions/Core.TimerJobs.Samples)
- [Provisioning.Services.SiteManager (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.Services.SiteManager)
- [Provisioning.SiteCollectionCreation (O365 PnP образец)](https://github.com/SharePoint/PnP/tree/master/Samples/Provisioning.SiteCollectionCreation)
- Примеры и содержимое в https://github.com/SharePoint/PnP

<a name="applies-to"></a>Применимо к
==========
- Office 365 нескольких клиентов (MT)
- Office 365 выделенных (D) *частично*
- SharePoint 2013 в локальной — *частично*

*Шаблоны для выделенных и локальной идентичны с помощью надстройки SharePoint методики модели, но возможных технологий, которые могут использоваться отличаются.*
