---
title: "Перенос настроек JSLink в настройщики полей SharePoint Framework"
description: "Преимущества переноса, а также сходства и различия платформ."
ms.date: 01/11/2018
ms.prod: sharepoint
ms.openlocfilehash: 3891acf0798c1e021ff1bc8631e960c5eb425646
ms.sourcegitcommit: 6b547679670b719f2222f9709732382739956f90
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/18/2018
---
# <a name="migrating-jslink-customizations-to-sharepoint-framework-field-customizers"></a>Перенос настроек JSLink в настройщики полей SharePoint Framework

SharePoint Framework — это новая модель, позволяющая создавать настройки для SharePoint. Если вы настраивали поля и представления списка SharePoint с помощью JSLink, вам может быть интересно узнать, зачем их переносить на новую платформу SharePoint Framework.

Сначала давайте познакомимся с вариантами расширений SharePoint Framework:

* **Настройщик заполнителей**. Расширьте встроенный "современный" пользовательский интерфейс SharePoint Online, добавив собственные элементы HTML и клиентский код к стандартным заполнителям "современных" страниц. На момент написания этой статьи настройщик заполнителей может настраивать верхний и нижний колонтитулы всех "современных" страниц.
* **Набор команд**. Добавьте собственные элементы меню ECB или кнопки на панель команд списка или библиотеки. С этими командами можно связать любое действие JavaScript (TypeScript).
* **Настройщик полей**. Настройте отрисовку поля в списке, используя собственные элементы HTML и клиентский код.

Выбор варианта зависит от цели настройки. Например, **настройщики полей** могут заменить собой настройки полей JSLink.

## <a name="benefits-of-migrating-existing-jslink-customizations-to-the-sharepoint-framework"></a>Преимущества переноса существующих настроек JSLink на SharePoint Framework

При создании SharePoint Framework учитывались новые "современные" возможности SharePoint, доступные на "современных" сайтах групп и сайтах для общения, на любом устройстве и любой платформе.

### <a name="the-only-supported-way-of-customizing-modern-lists-and-libraries"></a>Единственный поддерживаемый способ настройки "современных" списков и библиотек

Одним из основных преимуществ переноса старых настроек JSLink на SharePoint Framework является то, что это единственный поддерживаемый способ настройки пользовательского интерфейса "современных" списков и библиотек на современных сайтах. Из-за инфраструктуры отрисовки и флага no-script, включенного на "современных" сайтах, в "современных" списках и библиотеках не могут использоваться настройки JSLink. Поэтому, если вы действительно хотите расширить "современный" пользовательский интерфейс, вам необходимо перейти на SharePoint Framework.

### <a name="easier-access-to-information-in-sharepoint-and-office-365"></a>Удобство доступа к данным в SharePoint и Office 365

Кроме того, следует учитывать, что в старых настройках JSLink было нелегко задействовать контент и данные SharePoint. Для этого нужно было использовать JSOM (клиентскую объектную модель SharePoint на JavaScript) или низкоуровневые REST API. Кроме того, полный набор служб Office 365 было почти невозможно задействовать без автономного использования ADAL.JS (библиотеки аутентификации Azure Active Directory для JavaScript) и пользовательского кода JavaScript.

Используя платформу и расширения SharePoint Framework, легко задействовать REST API SharePoint и Microsoft Graph. Теперь вы можете создавать более мощные решения, которые могут взаимодействовать с полным набором служб Microsoft Office 365.

## <a name="similarities-between-sharepoint-framework-solutions-and-sharepoint-feature-framework-customizations"></a>Сходства решений SharePoint Framework и настроек SharePoint Feature Framework

Тем не менее, у настроек JSLink и SharePoint Feature Framework есть некоторых сходства. 

### <a name="provisioning-model"></a>Модель подготовки

Как для расширений SharePoint Framework, так и для дополнительных действий пользователя и элементов меню ECB используется XML-файл манифеста, написанный с помощью синтаксиса SharePoint Feature Framework. Таким образом, развертывание основано на одних и тех же методах. Однако новые настройщики полей позволяют настроить отрисовку поля, а не отрисовку отдельного представления списка или библиотеки. Конечно же, настроенное поле можно использовать в любом количестве списков и библиотек.

### <a name="run-as-a-part-of-the-page"></a>Выполнение в составе страницы

Точно так же, как дополнительные действия пользователя и элементы ECB SharePoint Feature Framework, расширения SharePoint Framework являются частью страницы. Благодаря этому у таких решений есть доступ к модели DOM страницы и возможность взаимодействовать с другими компонентами на этой странице. Кроме того, это помогает разработчикам создавать решения, которые адаптируются к различным форм-факторам, в которых может отображаться страница SharePoint, включая мобильное приложение SharePoint.

Так как расширения SharePoint Framework выполняются в составе страницы, другим элементам на странице доступны те же ресурсы, что и настройке. Это важно учитывать при создании решений, использующих неявный поток OAuth с маркерами доступа носителя, файлы cookie или хранилище браузера для хранения конфиденциальной информации. Так как расширения SharePoint Framework выполняются в составе страницы, другим элементам этой страницы также доступны все эти ресурсы.

### <a name="use-any-library-to-build-your-extensions"></a>Использование любой библиотеки для создания расширений

Добавляя на страницы дополнительные действия, вы могли использовать такие библиотеки, как jQuery и Knockout, чтобы настройки были более динамичными и лучше взаимодействовали с пользователем. Создавая расширения SharePoint Framework, вы можете совершенствовать свои решения, используя любую клиентскую библиотеку, как и раньше. 

Еще одно преимущество SharePoint Framework — изоляция скрипта. Несмотря на то что веб-часть выполняется в составе страницы, ее скрипт упаковывается в виде модуля, что позволяет, например, различным расширениям на одной странице использовать разные версии jQuery, не конфликтуя друг с другом. Это полезная функция, которая позволяет сосредоточиться на совершенствовании рабочих процессов, а не на миграции и сохранении функциональности.

### <a name="run-as-the-current-user"></a>Запуск от имени текущего пользователя

В настройках, созданных с помощью JSLink, для связи с SharePoint достаточно было вызвать соответствующий API. Клиентское решение работало в браузере в контексте текущего пользователя, а благодаря автоматической отправке с запросом файла cookie для аутентификации решение могло подключаться к SharePoint напрямую. Для связи с SharePoint не требовалась дополнительная аутентификация, как, например, при использовании надстроек SharePoint. 

Такой же механизм применяется к настройкам на платформе SharePoint Framework, которые также работают в контексте текущего пользователя, поэтому для связи с SharePoint им не требуется дополнительная аутентификация. Конечно, контекст безопасности определяется одним из подключенных пользователей, поэтому будьте осторожны при установке расширений SharePoint Framework в целевых семействах веб-сайтов.

### <a name="use-only-client-side-code"></a>Использование только клиентского кода

Как расширения SharePoint Framework, так и настройки JSLink выполняются в браузере и могут содержать только клиентский код JavaScript. У клиентских решений есть ряд ограничений. Например, они не могут повышать разрешения в SharePoint и подключаться ко внешним API, не поддерживающим связь между источниками (CORS) и аутентификацию с помощью неявного потока OAuth. В таких случаях клиентское решение может использовать удаленный серверный API, чтобы выполнить необходимую операцию и вернуть результаты клиенту.

### <a name="hosting-model-self-consistent-and-based-on-office-365"></a>Модель размещения непротиворечива и основана на Office 365

Как расширения SharePoint Framework, так и файлы JavaScript для настроек JSLink можно размещать в SharePoint Online, в сети доставки содержимого Office 365 (для этого не нужны внешние службы или среды внешнего размещения).

Хотя размещение решений SharePoint Framework в сети CDN имеет много преимуществ, оно необязательно, и вы можете разместить код в библиотеке документов SharePoint. Пакеты SharePoint Framework (SPPKG-файлы), развернутые в каталоге приложений, задают URL-адрес, по которому SharePoint Framework может найти код решения. Этот URL-адрес может быть каким угодно при условии, что пользователь, просматривающий страницу с расширением, может скачать скрипт из указанного расположения.

Office 365 позволяет публиковать в сети CDN файлы из определенной библиотеки документов SharePoint. Общедоступные сети CDN Office 365 сочетают в себе преимущества использования сетей CDN и простоту размещения файлов с кодом в библиотеке документов SharePoint. Если общедоступность файлов с кодом не является проблемой для организации, рекомендуем использовать общедоступную сеть CDN Office 365.

## <a name="differences-between-sharepoint-framework-solutions-and-jslink-customizations"></a>Различия между решениями SharePoint Framework и настройками JSLink

Однако между двумя моделями разработки также существуют различия, которые необходимо учитывать при создании архитектуры решений.

### <a name="run-in-no-script-sites-and-in-modern-lists-and-libraries"></a>Работа на сайтах без скриптов и в "современных" списках и библиотеках

Решения SharePoint Framework, в том числе расширения, развертываются через каталог приложений с предварительным утверждением, поэтому на них не распространяются ограничения работы без скриптов. Эти решения работают на всех "современных" сайтах. Кроме того, как мы уже видели, настройщики полей SharePoint Framework работают в "современных" списках и библиотеках, а старые настройки JSLink — нет.

### <a name="field-customizers-support-view-only-scenarios"></a>Настройщики полей позволяют настроить только представление

Настройка JSLink позволяет настроить не только представление поля в списке или библиотеке, но и отображение, а также представления редактирования поля для отдельного элемента.

На момент написания этой статьи настройщик полей SharePoint Framework может настраивать отрисовку поля только в режиме отрисовки представления списка. Использовать настройку в представлениях редактирования и отображения отдельного элемента нельзя.

### <a name="use-typescript-for-building-more-robust-and-easier-to-maintain-solutions"></a>Использование TypeScript для создания надежных и простых в обслуживании решений

Создавая настройки с помощью JSLink, разработчики часто использовали обычный код JavaScript. Зачастую в таких решениях не были предусмотрены автоматические проверки, что могло приводить к ошибкам при рефакторинге.

SharePoint Framework позволяет разработчикам использовать при создании решений систему типов TypeScript. Благодаря системе типов вы можете находить ошибки во время разработки, а не во время выполнения. Кроме того, рефакторинг стал проще, так как TypeScript защищает изменения кода. Так как JavaScript полностью совместим с TypeScript, переход не вызовет особых затруднений. Вы можете перенести обычный код JavaScript в TypeScript, постепенно расширяя возможности поддержки решений.

### <a name="no-access-to-sharepoint-javascript-object-model-by-default"></a>Отсутствие доступа к объектной модели JavaScript SharePoint по умолчанию

Создавая клиентские настройки для классического пользовательского интерфейса SharePoint, многие разработчики использовали для взаимодействия с SharePoint объектную модель JavaScript (JSOM). Модель JSOM обеспечивала автодополнение IntelliSense и удобный доступ к API SharePoint подобно клиентской объектной модели (CSOM). Основной компонент модели JSOM по умолчанию присутствовал на классических страницах SharePoint, а разработчики могли загружать дополнительные компоненты, например для взаимодействия со службой поиска SharePoint.

Современный пользовательский интерфейс SharePoint по умолчанию не включает модель SharePoint JSOM. Хотя разработчики могут загружать ее самостоятельно, рекомендуем использовать REST API или основную библиотеку JavaScript SharePoint PnP (JS PnP), которая использует REST API SharePoint на внутреннем уровне. Модель REST более универсальна и поддерживается в различных клиентских библиотеках, таких как jQuery, Angular и React.

Корпорация Майкрософт больше не занимается разработкой модели JSOM. Если вы предпочитаете работать с API, можете использовать библиотеку JS PnP, которая содержит текучий API и определения типов TypeScript.

## <a name="migrate-existing-customization-to-the-sharepoint-framework-extensions"></a>Перенос существующих настроек в расширения SharePoint Framework

Перенос существующих настроек в расширения SharePoint Framework дает ряд преимуществ как пользователям, так и разработчикам. Вы можете использовать по большей части существующие скрипты JavaScript или полностью переписать настройку, используя TypeScript.

### <a name="reuse-existing-scripts"></a>Использование существующих сценариев

При переносе существующих настроек в расширения SharePoint Framework можно использовать существующие скрипты. Несмотря на то что платформа SharePoint Framework ориентирована на TypeScript, вы можете использовать обычный код JavaScript и постепенно преобразовывать его в TypeScript. Для краткосрочной поддержки решения или в условиях ограниченного бюджета этого может быть достаточно.

Однако в решении SharePoint Framework не всегда можно использовать существующие скрипты. Например, учитывая разнообразие библиотек JavaScript, сложно сказать заранее, можно ли использовать существующие скрипты в решении SharePoint Framework или все-таки нужно их переписывать. Единственный способ узнать это — пробовать перемещать разные компоненты в решение SharePoint Framework и проверять их работу.

### <a name="rewrite-the-customization"></a>Переписывание настройки

Если вам требуются дополнительные возможности SharePoint Framework или долгосрочная поддержка решения либо существующие скрипты невозможно использовать в SharePoint Framework, настройку необходимо полностью переписать. Хотя это дороже, чем использовать существующие скрипты, в долгосрочной перспективе это более эффективно. Такое решение будет лучше работать, и его будет проще обслуживать и использовать.

Переписывая существующую настройку для SharePoint Framework, для начала следует задуматься о необходимых функциях. Для реализации пользовательского интерфейса советуем использовать Office UI Fabric, чтобы решение выглядело как неотъемлемая часть SharePoint. 

## <a name="see-also"></a>См. также

- [Переход с JSLink на расширения SharePoint Framework](./migrate-from-jslink-to-spfx-extensions.md)
- [Обзор расширений SharePoint Framework](../overview-extensions.md)