---
title: "Создание первого расширения SharePoint Framework (Hello World, часть 1)"
description: "Создайте проект расширения, а затем напишите и отладьте настройщик заполнителей."
ms.date: 01/11/2018
ms.prod: sharepoint
ms.openlocfilehash: 7b67d724a404f0576ac446fcce5cb0a87a3a22aa
ms.sourcegitcommit: e157d51378190ddfed6394ba154ce66141c8ca33
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2018
---
# <a name="build-your-first-sharepoint-framework-extension-hello-world-part-1"></a>Создание первого расширения SharePoint Framework (Hello World, часть 1)

Расширения SharePoint Framework (SPFx) — это клиентские компоненты, которые запускаются в контексте страницы SharePoint. Расширения можно развертывать в SharePoint Online, используя для их создания современные инструменты и библиотеки JavaScript.

Действия, описанные в этой статье, также показаны в видео на [канале SharePoint PnP в YouTube](https://www.youtube.com/watch?v=0BeS0HukW24&list=PLR9nK3mnD-OXtWO5AIIr7nCR3sWutACpV). 

<a href="https://www.youtube.com/watch?v=yrFNu6K7iuU">
<img src="../../../images/spfx-ext-youtube-tutorial1.png" alt="Screenshot of the YouTube video player for this tutorial" />
</a>

## <a name="create-an-extension-project"></a>Создание проекта расширения

1. Создайте каталог проекта в любом расположении.

    ```
    md app-extension
    ```

2. Перейдите к каталогу проекта.

    ```
    cd app-extension
    ```

3. Создайте расширение HelloWorld, запустив генератор Yeoman для SharePoint.

    ```
    yo @microsoft/sharepoint
    ```

4. Когда появится запрос:

    * Оставьте имя решения по умолчанию **app-extension** и нажмите клавишу ВВОД.
    * Выберите **SharePoint Online only (latest)** (Только SharePoint Online, последняя версия) и нажмите клавишу ВВОД.
    * Выберите **Use the current folder** (Использовать текущую папку) и нажмите клавишу ВВОД.
    * Выберите **N**, чтобы сделать установку расширения, выполняемую напрямую, обязательной на каждом сайте при его использовании. 
    * Выберите **Extension** (Расширение) в качестве типа создаваемого клиентского компонента. 
    * Выберите для создаваемого расширения тип **Настройщик заполнителей**.

5. Дальше требуется указать информацию о расширении. Когда появится запрос:

    * Оставьте значение по умолчанию (**HelloWorld**) для имени расширения и нажмите клавишу ВВОД.
    * Оставьте значение по умолчанию (**HelloWorld description**) для описания расширения и нажмите клавишу ВВОД.

    <br/>

    ![Генератор Yeoman для SharePoint предлагает создать решение расширения](../../../images/ext-yeoman-app-prompts.png)

    > [!NOTE] 
    > Если использовать слишком длинное имя для расширения, могут возникнуть проблемы. Предоставленные записи используются для создания псевдонима для манифеста настройщика заполнителей в формате JSON. Если длина псевдонима превышает 40 знаков, система выдает исключение при выполнении команды `gulp serve --nobrowser`. Чтобы решить эту проблему, обновите запись псевдонима.

    На этом этапе Yeoman устанавливает необходимые зависимости и формирует шаблон файлов решения вместе с расширением **HelloWorld**. Это может занять несколько минут. 

    Когда скаффолдинг успешно закончится, появится следующее сообщение:

    !["Скаффолдинг клиентского решения SharePoint успешно выполнен".](../../../images/ext-yeoman-app-complete.png)

    Сведения об устранении неполадок см. в статье [Известные проблемы](../../known-issues-and-common-questions.md).

6. После завершения скаффолдинга заблокируйте версию зависимостей проекта, выполнив следующую команду:

    ```sh
    npm shrinkwrap
    ```

7. Далее введите в консоли приведенную ниже команду, чтобы запустить Visual Studio Code.

    ```
    code .
    ```

    > [!NOTE] 
    > Так как клиентское решение SharePoint основано на HTML и TypeScript, для разработки расширения можно использовать любой редактор кода, поддерживающий клиентскую разработку.

    Обратите внимание, что стандартная структура решения аналогична структуре клиентских веб-частей. Это базовая структура решения SharePoint Framework, многие параметры которой не зависят от типа решения.

    ![Решение SharePoint Framework, открытое после первоначального формирования](../../../images/ext-app-vscode-solution-structure.png)

8. Откройте файл **HelloWorldApplicationCustomizer.manifest.json** в папке src\extensions\helloWorld.

    В этом файле определяются тип расширения и уникальный идентификатор для него. Этот идентификатор потребуется позже, при отладке и развертывании расширения в SharePoint.

    ![Содержимое манифеста настройщика заполнителей в формате JSON](../../../images/ext-app-vscode-manifest.png)

## <a name="code-your-application-customizer"></a>Написание кода настройщика заполнителей 

Откройте файл **HelloWorldApplicationCustomizer.ts** в папке **src\extensions\helloWorld**.

Обратите внимание, что базовый класс для настройщика заполнителей импортируется из пакета **sp-application-base**, который содержит код платформы SharePoint Framework, необходимый для настройщика заполнителей. 

![Оператор импорта ресурса BaseApplicationCustomizer из каталога @microsoft/sp-application-base](../../../images/ext-app-vscode-app-base.png)

Логика настройщика заполнителей содержится в методе **onInit**, который вызывается при первой активации клиентского расширения на странице. Это событие происходит после назначения классов `this.context` и `this.properties`. Как и в случае с веб-частями, метод `onInit()` возвращает обещание, которое можно использовать для выполнения асинхронных операций.

> [!NOTE] 
> Конструктор класса вызывается вначале, когда классы `this.context` и `this.properties` не определены. Пользовательская логика инициализации здесь не поддерживается.

Ниже представлено содержимое методов **onInit()** в решении по умолчанию. Оно просто записывает журнал на панель мониторинга для разработчиков, а затем выводит простое предупреждение JavaScript при отрисовке страницы.

![Метод onInit по умолчанию в коде](../../../images/ext-app-vscode-methods.png)

Если настройщик заполнителей использует входные данные **ClientSideComponentProperties** в формате JSON, он десериализуется в объект **BaseExtension.properties**. Вы можете определить интерфейс для его описания. Шаблон по умолчанию ищет свойство под названием **testMessage**. Если это свойство указано, он выводит его в предупреждении.

## <a name="debug-your-application-customizer"></a>Отладка настройщика заполнителей

В настоящее время для проверки расширений SharePoint Framework нельзя использовать локальную версию Workbench. Их необходимо проверять на активном сайте SharePoint Online. Для этого не нужно развертывать настройку в каталоге приложений, что делает процесс отладки простым и эффективным. 

1. Скомпилируйте код и разместите скомпилированные файлы на локальном компьютере, выполнив следующую команду:

    ```
    gulp serve --nobrowser
    ```

    > [!NOTE] 
    > Если у вас не установлен сертификат разработчика SPFx, Workbench сообщит вам, что он не загружает скрипты с домена localhost. В этом случае остановите выполняющийся в окне консоли процесс, выполните команду `gulp trust-dev-cert` в консоли каталога проекта, чтобы установить сертификат разработчика, а затем выполните команду `gulp serve --nobrowser` еще раз.

    Параметр `--nobrowser` используется, так как запускать локальную версию Workbench не нужно (локальная отладка расширений невозможна).

    Когда компиляция кода завершится без ошибок, полученный манифест будет доступен по адресу https://localhost:4321.

    ![Gulp serve](../../../images/ext-app-gulp-serve.png)

2. Чтобы протестировать расширение, перейдите на современную страницу представления списка в среде SharePoint и добавьте к URL-адресу следующие параметры строки запроса. Обратите внимание, что идентификатор необходимо обновить в соответствии с идентификатором вашего расширения. Он указан в файле **HelloWorldApplicationCustomizer.manifest.json**.

    ```json
        ?loadSPFX=true&debugManifestsFile=https://localhost:4321/temp/manifests.js&customActions={"e5625e23-5c5a-4007-a335-e6c2c3afa485":{"location":"ClientSideExtension.ApplicationCustomizer","properties":{"testMessage":"Hello as property!"}}}
    ```

    Дополнительные сведения о параметрах запросов URL-адресов:

    * **loadSPFX=true** проверяет, загружена ли на странице платформа SharePoint Framework. Для загрузки платформы должно быть зарегистрировано по крайней мере одно расширение. Так как компоненты еще не зарегистрированы, платформу нужно загрузить вручную.

    * **debugManifestsFile** указывает, что нужно загрузить компоненты SPFx, сохраненные локально. Загрузчик ищет компоненты только в каталоге приложений (для развернутого решения) и на сервере манифестов SharePoint (для системных библиотек).

    * **customActions** имитируют дополнительное действие. При развертывании и регистрации этого компонента на сайте вы создадите объект **CustomAction** и опишете все свойства, которые можно задать для него. 
        * **Key**. Используйте GUID расширения в качестве ключа, связываемого с дополнительным действием. Он должен соответствовать идентификатору расширения, указанному в файле manifest.json.
        * **Location**. Тип дополнительного действия. Используйте `ClientSideExtension.ApplicationCustomizer` для расширения "Настройщик заполнителей".
        * **Properties**. Необязательный объект JSON, содержащий свойства, доступные через элемент **this.properties**. В этом примере HelloWorld он определяет свойство `testMessage`.


3. Перейдите в современный список в SharePoint Online. Это может быть список или библиотека. Настройщики заполнителей также поддерживаются на современных страницах и на странице "Содержимое сайта". 

4. Дополните URL-адрес описанными параметрами запроса. Обратите внимание, что GUID необходимо обновить в соответствии с идентификатором вашего настройщика заполнителей. 

    Полный URL-адрес должен выглядеть примерно следующим образом:

    ```json
    contoso.sharepoint.com/Lists/Contoso/AllItems.aspx?loadSPFX=true&debugManifestsFile=https://localhost:4321/temp/manifests.js&customActions={"e5625e23-5c5a-4007-a335-e6c2c3afa485":{"location":"ClientSideExtension.ApplicationCustomizer","properties":{"testMessage":"Hello as property!"}}}
    ```

5. Выберите **Загрузить скрипты отладки**, чтобы продолжить загрузку скриптов с домена localhost.

    ![Запрос разрешения на отладку манифеста на странице](../../../images/ext-app-debug-manifest-message.png)

    <br/>

    На странице должно появиться сообщение с запросом.

    ![Hello как предупреждение свойства](../../../images/ext-app-alert-sp-page.png)

    Это диалоговое окно выводится вашим расширением SharePoint Framework. Обратите внимание: так как вы указали свойство `testMessage` в составе параметров запроса отладки, оно включено в предупреждение. Вы можете настроить экземпляры расширения на основе свойств компонента клиента, которые передаются в режиме выполнения.

> [!NOTE] 
> Если у вас возникли проблемы с отладкой, проверьте используемые параметры запроса URL-адреса. Некоторые браузеры кодируют параметры, что иногда влияет на поведение запросов.

## <a name="next-steps"></a>Дальнейшие действия

Поздравляем, вы создали свое первое расширение SharePoint Framework! 

Продолжение читайте в статье [Использование заполнителей страниц в настройщике заполнителей (Hello World, часть 2)](./using-page-placeholder-with-extensions.md). Вы будете работать с тем же проектом и получите доступ к специальным заполнителям для изменения пользовательского интерфейса SharePoint. Обратите внимание, что команда `gulp serve` по-прежнему запущена в окне консоли (или в Visual Studio Code, если вы используете этот редактор). Можете переходить к следующей статье, не останавливая ее.

> [!NOTE]
> Если вы обнаружили ошибку в документации или SharePoint Framework, сообщите о ней разработчикам SharePoint, указав в [списке проблем для репозитория sp-dev-docs](https://github.com/SharePoint/sp-dev-docs/issues). Заранее спасибо!