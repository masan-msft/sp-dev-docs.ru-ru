---
title: "Перенос существующих модификаций на основе веб-части \"Редактор скриптов\" в SharePoint Framework"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: 89a8252798287bf0e668d5f8a9538d1c28381eb6
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="migrate-existing-script-editor-web-part-customizations-to-the-sharepoint-framework"></a><span data-ttu-id="b6810-102">Перенос существующих модификаций на основе веб-части "Редактор скриптов" в SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="b6810-102">Migrate existing Script Editor Web Part customizations to the SharePoint Framework</span></span>

<span data-ttu-id="b6810-p101">SharePoint Framework — это новая модель для разработки модификаций SharePoint. Если в прошлом вы создавали клиентские решения SharePoint с помощью веб-части редактора скриптов, возможно, вы хотите узнать о преимуществах переноса этих решений на новую платформу SharePoint Framework. В этой статье рассматриваются различные преимущества переноса существующих клиентских модификаций на новую платформу SharePoint Framework и представлен ряд факторов, которые следует учитывать при планировании переноса.</span><span class="sxs-lookup"><span data-stu-id="b6810-p101">SharePoint Framework is a new model for building SharePoint customizations. If you have been building client-side SharePoint solutions using the Script Editor Web Part in the past, you might be wondering what the possible advantages are of migrating them to the new SharePoint Framework. This article highlights the different benefits of migrating existing client-side customizations to the new SharePoint Framework and points out a number of considerations that you should take into account when planning the migration.</span></span>

> <span data-ttu-id="b6810-106">Примечание. Сведения в этой статье применимы к модификациям, созданным на основе веб-частей "Редактор контента" и "Редактор скриптов".</span><span class="sxs-lookup"><span data-stu-id="b6810-106">Note: The information in this article applies to customizations built using both the Content- and the Script Editor Web Part. Wherever there is a reference to the Script Editor Web Part, you should read Content Editor Web Part and Script Editor Web Part.</span></span> <span data-ttu-id="b6810-107">Любое упоминание веб-части "Редактор скриптов" следует толковать как такое, которое относится _и к веб-части "Редактор контента", и к веб-части "Редактор скриптов"_.</span><span class="sxs-lookup"><span data-stu-id="b6810-107">Note: The information in this article applies to customizations built using both the Content- and the Script Editor Web Part. Wherever there is a reference to the Script Editor Web Part, you should read _Content Editor Web Part and Script Editor Web Part_.</span></span>

## <a name="benefit-of-migrating-existing-client-side-customizations-to-the-sharepoint-framework"></a><span data-ttu-id="b6810-108">Преимущества переноса существующих клиентских модификаций в SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="b6810-108">Benefit of migrating existing client-side customizations to the SharePoint Framework</span></span>

<span data-ttu-id="b6810-p103">SharePoint Framework была создана с нуля как модель разработки для SharePoint с ориентацией на клиентскую разработку. В первую очередь она предоставляет возможности расширения современных сайтов групп, но модификации на платформе SharePoint Framework также совместимы с классическим интерфейсом SharePoint. Создавая модификации с помощью SharePoint Framework, вы получите ряд преимуществ, недоступных ни в одной другой модели разработки для SharePoint, доступной на данный момент.</span><span class="sxs-lookup"><span data-stu-id="b6810-p103">SharePoint Framework has been built from the ground up as a SharePoint development model focusing on client-side development. While it primarily offers extensibility capabilities for modern team sites, customizations built on the SharePoint Framework also work with the classic SharePoint experience. Building your customizations using the SharePoint Framework offers you a number of benefits over using any other SharePoint development model available to date.</span></span>

### <a name="build-once-reuse-across-all-devices"></a><span data-ttu-id="b6810-112">Возможность использования на всех устройствах</span><span class="sxs-lookup"><span data-stu-id="b6810-112">Build once, reuse across all devices</span></span>

<span data-ttu-id="b6810-p104">Современный пользовательский интерфейс SharePoint обеспечивает встроенную поддержку доступа к данным, хранящимся в SharePoint, с любого устройства. Кроме того, он поддерживает мобильное приложение SharePoint. Решения, созданные с помощью SharePoint Framework, органично вписываются в современный интерфейс SharePoint. Кроме того, их можно использовать на различных устройствах, а также в мобильном приложении SharePoint. Так как решения SharePoint Framework также совместимы с классическим интерфейсом SharePoint, их можно использовать в организациях, которые еще не перешли на современный интерфейс.</span><span class="sxs-lookup"><span data-stu-id="b6810-p104">The modern SharePoint user experience has been designed to natively support access to information stored in SharePoint on any device. Additionally, the modern experience supports the SharePoint mobile app. Solutions built using the SharePoint Framework seamlessly integrate with the modern SharePoint experience and can be used across the different devices as well as inside the SharePoint mobile app. Because SharePoint Framework solutions also work with the classic SharePoint experience, they can be also used by organizations that haven't migrated to the modern experience yet.</span></span>

### <a name="more-robust-and-future-proof"></a><span data-ttu-id="b6810-117">Надежность и готовность к будущему</span><span class="sxs-lookup"><span data-stu-id="b6810-117">More robust and future-proof</span></span>

<span data-ttu-id="b6810-p105">Раньше разработчики модифицировали SharePoint путем присоединения к определенным элементам модели DOM в пользовательском интерфейсе. С помощью этого подхода они могли менять стандартный пользовательский интерфейс или предоставлять дополнительные функции пользователям. Тем не менее в таких решениях часто возникали ошибки. Так как модель DOM для страниц SharePoint никогда не рассматривалась как платформа для расширения, каждое ее изменение приводило к ошибкам в зависящих от нее решениях.</span><span class="sxs-lookup"><span data-stu-id="b6810-p105">In the past, developers were customizing SharePoint by attaching to specific DOM elements in the user interface. Using this approach, they could change the standard user experience or provide additional functionality to end users. Such solutions were however error-prone. Because the SharePoint page DOM was never meant as an extensibility surface, whenever it changed, solutions relying on it would break.</span></span>

<span data-ttu-id="b6810-p106">SharePoint Framework предоставляет разработчикам стандартизированный API и точки расширяемости для создания клиентских решений и предоставления дополнительных возможностей пользователям. С помощью SharePoint Framework разработчики могут создавать решения поддерживаемым современным способом, не беспокоясь о том, как будущие изменения пользовательского интерфейса SharePoint повлияют на решение.</span><span class="sxs-lookup"><span data-stu-id="b6810-p106">SharePoint Framework offers developers standardized API and extensibility points to build client-side solutions and provide end-users with additional capabilities. Developers can use the SharePoint Framework to build solutions in a supported and future-proof way and don't need to be concerned with how future changes to the SharePoint user interface could affect your solution.</span></span>

### <a name="easier-access-to-information-in-sharepoint-and-office-365"></a><span data-ttu-id="b6810-124">Удобство доступа к данным в SharePoint и Office 365</span><span class="sxs-lookup"><span data-stu-id="b6810-124">Easier access to information in SharePoint and Office 365</span></span>

<span data-ttu-id="b6810-p107">Корпорация Майкрософт постоянно расширяет возможности SharePoint и Office 365. По мере того как организации применяют обе платформы, для разработчиков становится все важнее возможность доступа к сведениям и аналитическим данным, хранящимся в Office 365, для создания функциональных решений. Одна из задач SharePoint Framework — помочь разработчикам подключаться к различным API SharePoint и Office 365.</span><span class="sxs-lookup"><span data-stu-id="b6810-p107">Microsoft is continuously extending capabilities of SharePoint and Office 365. As organizations make more use of both platforms, it's becoming increasingly important for developers to be able to tap into the information and insights stored in Office 365 to build rich solutions. One of the goals of the SharePoint Framework is to make it easy for developers to connect to various SharePoint and Office 365 APIs.</span></span>

### <a name="enable-users-to-configure-solutions-to-their-needs"></a><span data-ttu-id="b6810-128">Возможность настройки решений пользователями</span><span class="sxs-lookup"><span data-stu-id="b6810-128">Enable users to configure solutions to their needs</span></span>

<span data-ttu-id="b6810-p108">Зачастую у пользователей не было простого способа настройки клиентских решений, созданных путем внедрения кода, в соответствии со своими потребностями. Настроить такое решение можно было только путем изменения его кода или с помощью специального пользовательского интерфейса, созданного исключительно для этой цели.</span><span class="sxs-lookup"><span data-stu-id="b6810-p108">Client-side solutions built through script embedding often didn't offer end-users an easy way to configure them to their needs. The only way to configure such solution, was by altering its code or through a custom user interface built specifically for that purpose.</span></span>

<span data-ttu-id="b6810-p109">Клиентские веб-части SharePoint Framework можно настраивать с помощью стандартной области свойств, знакомой пользователям, которые уже работали с классическими веб-частями. Создавая клиентские веб-части, разработчики могут выбирать между реактивной областью свойств (она выбрана по умолчанию), где каждое изменение свойства веб-части непосредственно влияет на ее текст, и нереактивной областью свойств, в которой изменения свойств веб-части необходимо применять в явном виде.</span><span class="sxs-lookup"><span data-stu-id="b6810-p109">SharePoint Framework client-side web parts offer a standard way for configuring web parts using a property pane - familiar to users who worked with classic web parts in the past. Developers building client-side web parts can choose whether their web part should have a reactive property pane (default), where each change to a web part property is directly reflected in the web part body, or a non-reactive property pane, where changes to web part properties must be explicitly applied.</span></span>

### <a name="work-on-no-script-sites"></a><span data-ttu-id="b6810-133">Работа на сайтах без скриптов</span><span class="sxs-lookup"><span data-stu-id="b6810-133">Work on no-script sites</span></span>

<span data-ttu-id="b6810-p110">Чтобы помочь организациям управлять модификациями, корпорация Майкрософт добавила возможность работы без скриптов в SharePoint Online. Если в клиенте или определенном семействе веб-сайтов установлен флаг работы без скриптов, то модификации, использующие вставку и внедрение скриптов, отключаются.</span><span class="sxs-lookup"><span data-stu-id="b6810-p110">To helps organizations govern their customizations, Microsoft released the no-script capability in SharePoint Online. When the tenant or a particular site collection has the no-script flag enabled, customizations relying on script injection and embedding are disabled.</span></span>

<span data-ttu-id="b6810-p111">Так как клиентские веб-части SharePoint Framework развертываются через каталог приложений с предварительным утверждением, их разрешается использовать на сайтах без скриптов. По умолчанию на современных сайтах групп включен параметр работы без скриптов, поэтому на этих сайтах невозможно внедрять скрипты. Следовательно, в настоящее время использование SharePoint Framework — единственный поддерживаемый способ создания клиентских модификаций на современных сайтах групп.</span><span class="sxs-lookup"><span data-stu-id="b6810-p111">Because SharePoint Framework client-side web part are deployed through the app catalog with a prior approval, they are allowed to run in no-script sites. By default, modern team sites have the no-script setting enabled and it's not possible to embed scripts in these sites. This makes at this moment, using the SharePoint Framework the only supported way to build client-side customizations in modern team sites.</span></span>

## <a name="similarities-between-sharepoint-framework-solutions-and-script-editor-web-part-customizations"></a><span data-ttu-id="b6810-139">Сходство между решениями SharePoint Framework и модификациями на основе веб-части редактора скриптов</span><span class="sxs-lookup"><span data-stu-id="b6810-139">Similarities between SharePoint Framework solutions and Script Editor Web Part customizations</span></span>

<span data-ttu-id="b6810-p112">Решения SharePoint Framework создаются на основе новой модели разработки с использованием новой цепочки инструментов, но во многом они похожи на модификации на основе веб-части редактора скриптов, которые создавались в прошлом. Так как они основаны на одних и тех же понятиях, вам будет проще перенести их на новую платформу SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="b6810-p112">While built on a new development model using a new toolchain, SharePoint Framework solutions are similar to the Script Editor Web Part customizations you have built in the past. Because they share the same concepts, it makes it easier for you to migrate them to the new SharePoint Framework.</span></span>

### <a name="run-as-a-part-of-the-page"></a><span data-ttu-id="b6810-142">Выполнение в составе страницы</span><span class="sxs-lookup"><span data-stu-id="b6810-142">Run as a part of the page</span></span>

<span data-ttu-id="b6810-p113">Подобно встроенным модификациям и веб-частям редактора скриптов, решения SharePoint Framework являются частью страницы. Благодаря этому у таких решений есть доступ к модели DOM страницы и возможность взаимодействовать с другими компонентами на этой странице. Кроме того, это помогает разработчикам создавать решения, которые адаптируются к различным форм-факторам, в которых может отображаться страница SharePoint, включая мобильное приложение SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6810-p113">Similarly to customizations embedded in and Script Editor Web Parts, SharePoint Framework solutions are a part of the page. This gives these solutions access to the page's DOM and allows them to communicate with other components on the same page. Also, it allows developers to more easily make their solutions responsive to adapt to the different form factors on which a SharePoint page could be displayed, including the SharePoint mobile app.</span></span>

<span data-ttu-id="b6810-p114">В отличие от надстроек SharePoint, клиентские веб-части SharePoint Framework не изолируются в объекте iframe. Как следствие, все ресурсы, доступные той или иной клиентской веб-части, также доступны другим элементам страницы. Это важно учитывать при создании решений, использующих неявный поток OAuth с маркерами доступа носителя либо файлы cookie или хранилище браузера для хранения конфиденциальной информации. Так как клиентские веб-части работают в составе страницы, другим элементам этой страницы также доступны все эти ресурсы.</span><span class="sxs-lookup"><span data-stu-id="b6810-p114">Unlike SharePoint add-ins, SharePoint Framework client-side web parts are not isolated in an iframe. As a consequence, whatever resources the particular client-side web part has access to, other elements on the page can access as well. This is important to keep in mind when building solutions that rely on OAuth implicit flow with bearer access tokens or use cookies or browser storage for storing sensitive information. Because client-side web parts run as a part of the page, other elements on that page are able to access all these resources as well.</span></span>

### <a name="use-any-library-to-build-your-web-part"></a><span data-ttu-id="b6810-150">Создание веб-части с помощью любой библиотеки</span><span class="sxs-lookup"><span data-stu-id="b6810-150">Use any library to build your web part</span></span>

<span data-ttu-id="b6810-p115">При создании модификаций с помощью веб-части редактора скриптов вы могли использовать такие библиотеки, как jQuery и Knockout, чтобы ваши модификации были более динамичными и лучше реагировали на действия пользователя. При создании клиентских веб-частей SharePoint Framework вы можете совершенствовать свои решения с помощью любой клиентской библиотеки, как и раньше. Еще одно преимущество SharePoint Framework — изоляция скрипта. Несмотря на то что веб-часть выполняется в составе страницы, ее скрипт упаковывается в виде модуля, который, к примеру, позволяет различным веб-частям на одной странице использовать разные версии jQuery, не конфликтуя друг с другом. Благодаря этой полезной функции вы можете сосредоточиться на коммерческой ценности решения, а не на технических особенностях миграции и компромиссах, связанных с функциональностью.</span><span class="sxs-lookup"><span data-stu-id="b6810-p115">When building customizations using the Script Editor Web Part you might have used libraries such as jQuery or Knockout to make your customization dynamic and better respond to user interaction. When building SharePoint Framework client-side web parts you can use any client-side library to enrich your solution, the same way you would have done it in the past. Additional benefit that the SharePoint Framework offers you, is isolation of your script. Even though the web part is executed as a part of the page, its script is packaged as a module allowing for example different web parts on the same page to use a different version of jQuery without colliding with each other. This is a powerful feature that allows you to focus on delivering business value instead of technical migrations and compromising on functionality.</span></span>

### <a name="run-as-the-current-user"></a><span data-ttu-id="b6810-156">Запуск от имени текущего пользователя</span><span class="sxs-lookup"><span data-stu-id="b6810-156">Run as the current user</span></span>

<span data-ttu-id="b6810-p116">В модификациях, созданных с помощью веб-части редактора скриптов, для связи с SharePoint достаточно было вызвать API. Клиентское решение работало в браузере в контексте текущего пользователя, а благодаря автоматической отправке файла cookie для проверки подлинности вместе с запросом решение могло подключаться к SharePoint напрямую. Для связи с SharePoint не требовалось дополнительной проверки подлинности, как, например, при использовании надстроек SharePoint. Такой же механизм применяется к модификациям на платформе SharePoint Framework, которые также работают в контексте текущего пользователя, поэтому для связи с SharePoint им не требуется дополнительных операций проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="b6810-p116">In customizations built using the Script Editor Web Part, whenever you needed to communicate with SharePoint, all you had to do was to call its API. The client-side solution was running in the browser in the context of the current user, and by automatically sending the authentication cookie along with the request, your solution could directly connect to SharePoint. No additional authentication, like when using SharePoint add-ins, was necessary to communicate with SharePoint. The same mechanism applies to customizations built on the SharePoint Framework, that also run under the context of the currently authenticated user and also don't require any additional authentication steps in order to communicate with SharePoint.</span></span>

### <a name="use-only-client-side-code"></a><span data-ttu-id="b6810-161">Использование клиентского кода</span><span class="sxs-lookup"><span data-stu-id="b6810-161">Use only client-side code</span></span>

<span data-ttu-id="b6810-p117">Как решения SharePoint Framework, так и модификации на основе веб-части редактора скриптов выполняются в браузере и могут содержать только клиентский код JavaScript. У клиентских решений есть ряд ограничений, например они не могут повышать разрешения в SharePoint и подключаться ко внешним API, не поддерживающим связь между источниками (CORS) и проверку подлинности с помощью неявного потока OAuth. В таких случаях клиентское решение может использовать удаленный серверный API, чтобы выполнить необходимую операцию и вернуть результаты клиенту.</span><span class="sxs-lookup"><span data-stu-id="b6810-p117">Both SharePoint Framework and Script Editor Web Part solutions run in the browser and can contain only client-side JavaScript code. Client-side solutions have a number of limitations, such as not being able to elevate permissions in SharePoint or reach out to external APIs that don't support cross-origin communication (CORS) or authentication using OAuth implicit flow. In such cases, the client-side solution could leverage a remote server-side API to perform the necessary operation and return the results to the client.</span></span>

### <a name="host-solution-in-sharepoint"></a><span data-ttu-id="b6810-165">Размещение решения в SharePoint</span><span class="sxs-lookup"><span data-stu-id="b6810-165">Host solution in SharePoint</span></span>

<span data-ttu-id="b6810-p118">Одним из преимуществ создания модификаций SharePoint с помощью веб-части редактора скриптов было то, что их код можно было размещать в обычной библиотеке документов SharePoint. По сравнению с надстройками SharePoint для этого требовалось меньше инфраструктуры, а размещать решение было проще. Кроме того, организации могли использовать разрешения SharePoint для управления доступом к файлам решения.</span><span class="sxs-lookup"><span data-stu-id="b6810-p118">One of the benefits of building SharePoint customizations using Script Editor Web Parts was the fact, that their code could be hosted in a regular SharePoint document library. Comparing to SharePoint add-ins, it required less infrastructure and simplified hosting the solution. Additionally, organizations could use SharePoint permissions to control access to the solution files.</span></span>

<span data-ttu-id="b6810-p119">Хотя размещение решений SharePoint Framework в сети CDN имеет ряд преимуществ, оно необязательно, и вы можете разместить код решений в обычной библиотеке документов SharePoint. Пакеты SharePoint Framework (SPPKG-файлы), развернутые в каталоге приложений, задают URL-адрес, по которому SharePoint Framework может найти код решения. Этот URL-адрес может быть каким угодно, при условии что пользователь, просматривающий страницу с веб-частью, может скачать скрипт из указанного расположения.</span><span class="sxs-lookup"><span data-stu-id="b6810-p119">While hosting SharePoint Framework solutions on a CDN offers a number of advantages, it is not required, and you could choose to host their code in a regular SharePoint document library. SharePoint Framework packages (.sppkg files) deployed to the app catalog specify the URL at which SharePoint Framework can find the solution's code. There are no restrictions with regards to what that URL must be, as long as the user browsing the page with the web part on it, can download the script from the specified location.</span></span>

<span data-ttu-id="b6810-172">[Office 365 позволяет публиковать в сети CDN](https://dev.office.com/blogs/office-365-public-cdn-developer-preview-release) файлы из определенной библиотеки документов SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6810-172">[Office 365 offers the public CDN capability](https://dev.office.com/blogs/office-365-public-cdn-developer-preview-release) that allows you to publish files from a specific SharePoint document library to a CDN.</span></span> <span data-ttu-id="b6810-173">Общедоступные сети CDN Office 365 сочетают в себе преимущества использования сетей CDN и простоту размещения файлов с кодом в библиотеке документов SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6810-173">Office 365 public CDN strikes a nice balance between the benefits of using a CDN and the simplicity of hosting code files in a SharePoint document library.</span></span> <span data-ttu-id="b6810-174">Если общедоступность файлов с кодом не является проблемой для организации, рекомендуем использовать общедоступную сеть CDN Office 365.</span><span class="sxs-lookup"><span data-stu-id="b6810-174">If your organization doesn't mind their code files being publicly available, using the Office 365 public CDN is an option worth considering.</span></span>

## <a name="differences-between-sharepoint-framework-solutions-and-script-editor-web-part-customizations"></a><span data-ttu-id="b6810-175">Различия между решениями SharePoint Framework и модификациями на основе веб-части "Редактор скриптов"</span><span class="sxs-lookup"><span data-stu-id="b6810-175">Differences between SharePoint Framework solutions and Script Editor Web Part customizations</span></span>

<span data-ttu-id="b6810-p121">Модификации SharePoint, созданные с помощью SharePoint Framework и веб-части редактора скриптов, очень похожи между собой. Все они выполняются в составе страницы в контексте текущего пользователя и создаются с помощью клиентского кода JavaScript. Однако существует несколько значительных различий, которые могут повлиять на принятие решений, связанных с архитектурой, и которые следует учитывать при разработке решения.</span><span class="sxs-lookup"><span data-stu-id="b6810-p121">SharePoint customizations built using the SharePoint Framework and Script Editor Web Part are very similar. They all run as a part of the page under the context of the current user and are built using client-side JavaScript. But there are also some significant differences that might influence your architectural decisions and which you should keep in mind when design your solution.</span></span>

### <a name="run-in-no-script-sites"></a><span data-ttu-id="b6810-179">Выполнение на сайтах без скриптов</span><span class="sxs-lookup"><span data-stu-id="b6810-179">Run in no-script sites</span></span>

<span data-ttu-id="b6810-p122">При использовании веб-части редактора скриптов, если сайт, для которого создавалась модификация, был сайтом без скриптов, приходилось либо просить администратора отключить параметр работы без скриптов, либо создавать решение по-другому, например с помощью модели надстроек.</span><span class="sxs-lookup"><span data-stu-id="b6810-p122">When building client-side customizations using the Script Editor Web Part, you had to take into account whether the site, where the customization would be used, was a no-script site or not. If the site was a no-script site, you either had to request the admin to disable the no-script setting or build your solution differently, for example using the add-in model.</span></span>

<span data-ttu-id="b6810-182">Решения SharePoint Framework развертываются через каталог приложений с предварительным утверждением, поэтому на них не распространяются ограничения работы без скриптов. Эти решения работают на всех сайтах.</span><span class="sxs-lookup"><span data-stu-id="b6810-182">Because SharePoint Framework solutions are deployed through the app catalog with a prior approval, they are not subject to the no-script restrictions and work on all sites.</span></span>

### <a name="deployed-and-updated-through-it"></a><span data-ttu-id="b6810-183">Развертывание и обновление через ИТ-отдел</span><span class="sxs-lookup"><span data-stu-id="b6810-183">Deployed and updated through IT</span></span>

<span data-ttu-id="b6810-p123">Созданием модификаций SharePoint с помощью веб-части редактора скриптов занимались в основном разработчики-любители. Располагая только разрешениями владельца сайта, разработчики-любители могут создавать привлекательные модификации SharePoint, представляющие коммерческую ценность. Каждый раз, когда требуется обновить модификацию, пользователи с необходимыми разрешениями могут применять обновления к файлам скриптов решения. При этом изменения сразу становятся видны всем пользователям.</span><span class="sxs-lookup"><span data-stu-id="b6810-p123">Script Editor Web Parts are used to build SharePoint customizations primarily by citizen developers. With nothing more than site owner permissions, citizen developers can build compelling SharePoint customizations that add business value. Whenever the customization needs to be updated, users with the necessary permissions can apply updates to the solution's script files and the changes will be immediately visible to all users.</span></span>

<span data-ttu-id="b6810-p124">При использовании решений на основе веб-части редактора скриптов сотрудникам ИТ-организаций сложно отслеживать, какие модификации используются и где. Кроме того, организациям не могут определить, какие внешние скрипты используются в их интрасети, и получить доступ к их данным.</span><span class="sxs-lookup"><span data-stu-id="b6810-p124">Script Editor Web Part solutions make it hard for IT organizations to keep track of what customizations are being used and where they are being used. Additionally, organizations can't tell which external scripts are being used in their intranet and have access to their data.</span></span>

<span data-ttu-id="b6810-p125">SharePoint Framework возвращает контроль ИТ-отделам. Развертывание решений SharePoint Framework и управление ими выполняются централизованно через каталог приложений, поэтому представители организации могут изучить решение, прежде чем развертывать его. Кроме того, все обновления также развертываются через каталог приложений, позволяя организациям проверять и утверждать их перед развертыванием.</span><span class="sxs-lookup"><span data-stu-id="b6810-p125">SharePoint Framework gives the control back to the IT. Because SharePoint Framework solutions are deployed and managed centrally in the app catalog, organizations have the opportunity to review the solution before deploying it. Additionally, any updates are deployed via the app catalog as well, allowing organizations to verify and approve them before deployment.</span></span>

### <a name="focus-more-on-uniform-user-experience"></a><span data-ttu-id="b6810-192">Стандартизация пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="b6810-192">Focus more on uniform user experience</span></span>

<span data-ttu-id="b6810-p126">При создании модификаций с помощью веб-части редактора скриптов разработчикам-любителям полностью принадлежала соответствующая модель DOM. Не существовало никаких рекомендаций касательно пользовательского интерфейса и работы таких модификаций. Как следствие, разные разработчики создавали модификации по-разному, в результате чего пользовательский интерфейс становился несогласованным.</span><span class="sxs-lookup"><span data-stu-id="b6810-p126">When building customizations using the Script Editor Web Part, citizen developers owned the complete DOM of their customization. There were no guidelines related to the user experience and how such customization should work. As a result, different developers built customizations in a different way what lead to an inconsistent user experience for the end-users.</span></span>

<span data-ttu-id="b6810-196">Одна из задач SharePoint Framework — стандартизировать клиентские модификации в отношении развертывания, обслуживания и пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="b6810-196">One of the goals of the SharePoint Framework is to standardize building client-side customizations so that they are uniform from the deployment, maintenance and user experience point of view.</span></span> <span data-ttu-id="b6810-197">С помощью [Office UI Fabric](http://dev.office.com/fabric) разработчики могут без труда сделать так, чтобы их решения выглядели и работали как неотъемлемая часть SharePoint, что повышает их привлекательность для пользователей.</span><span class="sxs-lookup"><span data-stu-id="b6810-197">Using [Office UI Fabric](http://dev.office.com/fabric) developers can more easily make their custom solutions look and behave like they were an integral part of SharePoint, simplifying the user adoption.</span></span> <span data-ttu-id="b6810-198">Цепочка инструментов SharePoint Framework создает файлы пакетов для решений, которые развертываются в каталоге приложений, и пакеты скриптов, которые развертываются в выбранном вами расположении.</span><span class="sxs-lookup"><span data-stu-id="b6810-198">SharePoint Framework toolchain generates package files for the solutions, that are deployed to the app catalog, and script bundles, that are deployed to the hosting location of your choice.</span></span> <span data-ttu-id="b6810-199">Все решения идентичны с точки зрения структуры и управления.</span><span class="sxs-lookup"><span data-stu-id="b6810-199">Every solution is structured and managed in the same way.</span></span>

### <a name="dont-modify-dom-outside-of-the-customization"></a><span data-ttu-id="b6810-200">Не меняйте модель DOM вне модификации</span><span class="sxs-lookup"><span data-stu-id="b6810-200">Don't modify DOM outside of the customization</span></span>

<span data-ttu-id="b6810-p128">В прошлом веб-части редактора скриптов часто использовались для изменения фрагментов страниц, например добавления кнопок на панель инструментов либо изменения заголовка или фирменной символики страницы. Такие модификации зависели от наличия определенных элементов модели DOM. Следовательно, при каждом обновлении пользовательского интерфейса SharePoint существовала опасность того, что такая модификация перестанет работать.</span><span class="sxs-lookup"><span data-stu-id="b6810-p128">Script Editor Web Parts were frequently used in the past to modify parts of the page, such as adding buttons to toolbar or changing the heading or branding of the page. Such customizations relied on the existence of specific DOM elements and whenever SharePoint UI would be updated, there was a chance that such customization would break.</span></span>

<span data-ttu-id="b6810-203">В SharePoint Framework доступен более структурированный и надежный подход к настройке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6810-203">SharePoint Framework encourages a more structured and reliable approach to customizing SharePoint.</span></span> <span data-ttu-id="b6810-204">Вместо того чтобы использовать определенные элементы модели DOM для настройки SharePoint, SharePoint Framework предоставляет разработчикам общедоступный API, с помощью которого они могут расширять SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6810-204">Rather than using specific DOM elements to customize SharePoint, SharePoint Framework provides developers with a public API that they can use to extend SharePoint.</span></span> <span data-ttu-id="b6810-205">В настоящее время SharePoint Framework поддерживает только клиентские веб-части, но [рассматривается возможность добавления](https://dev.office.com/sharepoint/docs/spfx/roadmap) других форматов, таких как JSLink и настраиваемые действия пользователей, чтобы разработчики могли реализовывать наиболее распространенные сценарии с помощью SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="b6810-205">SharePoint Framework encourages a more structured and reliable approach to customizing SharePoint. Rather than using specific DOM elements to customize SharePoint, SharePoint Framework provides developers with a public API that they can use to extend SharePoint. At this moment client-side web part are the only shape supported by the SharePoint Framework, but other shapes, such as equivalents of JSLink and User Custom Actions, are being [taken into consideration for the future](https://dev.office.com/sharepoint/docs/spfx/roadmap) so that developers can implement the most common customization scenarios using the SharePoint Framework.</span></span>

### <a name="distributed-as-packages"></a><span data-ttu-id="b6810-206">Распространение в виде пакетов</span><span class="sxs-lookup"><span data-stu-id="b6810-206">Distributed as packages</span></span>

<span data-ttu-id="b6810-p130">Клиентские модификации SharePoint часто использовали списки и библиотеки SharePoint для хранения своих данных. При создании решений с помощью веб-части редактора скриптов было сложно обеспечить автоматическую подготовку необходимых компонентов. Для развертывания той же модификации на другом сайте часто требовалось скопировать веб-часть, а также правильно воссоздать и обеспечить функционирование хранилища необходимых данных.</span><span class="sxs-lookup"><span data-stu-id="b6810-p130">SharePoint client-side customizations often used SharePoint lists and libraries to store their data. When built using the Script Editor Web Part, there was no easy way to automatically provision the necessary prerequisites. Deploying the same customization to another site often meant copying the web part but also correctly recreating and maintaining the necessary data storage.</span></span>

<span data-ttu-id="b6810-p131">Решения SharePoint Framework распространяются в виде пакетов, которые могут автоматически подготавливать необходимые компоненты, такие как поля, типы контента и списки. Разработчики, создающие пакет, могут указывать артефакты, необходимые решению. Указанные артефакты создаются при установке решения на сайте. Это значительно упрощает развертывание решения на нескольких сайтах и управление им.</span><span class="sxs-lookup"><span data-stu-id="b6810-p131">SharePoint Framework solutions are distributed as packages capable of provisioning their prerequisites, such as fields, content types or lists, automatically. Developers building the package can specify which artifacts are required by the solution, and whenever it's installed in a site, the specified artifacts will be created. This significantly simplifies the process of deploying and managing the solution on multiple sites.</span></span>

### <a name="use-typescript-for-building-more-robust-and-easier-to-maintain-solution"></a><span data-ttu-id="b6810-213">Использование TypeScript для создания надежного и простого в обслуживании решения</span><span class="sxs-lookup"><span data-stu-id="b6810-213">Use TypeScript for building more robust and easier to maintain solution</span></span>

<span data-ttu-id="b6810-p132">При создании модификаций с помощью веб-части редактора скриптов разработчики-любители часто использовали обычный код JavaScript. Зачастую такие решения не содержали автоматических проверок, что могло приводить к ошибкам при рефакторинге.</span><span class="sxs-lookup"><span data-stu-id="b6810-p132">When building customizations using the Script Editor Web Part, citizen developers often used plain JavaScript. Often such solutions didn't contain any automated tests and refactoring the code was error-prone.</span></span>

<span data-ttu-id="b6810-p133">SharePoint Framework позволяет разработчикам использовать систему типов TypeScript при создании решений. Благодаря системе типов вы можете находить ошибки во время разработки, а не во время выполнения. Кроме того, рефакторинг стал проще, так как TypeScript защищает изменения кода. Так как любой код JavaScript является допустимым кодом TypeScript, переход не вызовет особых затруднений. Вы можете перенести обычный код JavaScript в TypeScript, постепенно расширяя возможности поддержки решения.</span><span class="sxs-lookup"><span data-stu-id="b6810-p133">SharePoint Framework allows developers to benefit of the TypeScript type system when building solutions. Thanks to the type system, errors are caught during development rather than on runtime. Also, refactoring code can be done more easily as changes to the code are safeguarded by TypeScript. Because all JavaScript is valid TypeScript, the entry barrier is low and you can migrate your plain JavaScript to TypeScript gradually over time increasing the maintainability of your solution.</span></span>

### <a name="cant-rely-on-the-sppagecontextinfo-object"></a><span data-ttu-id="b6810-220">Ненадежный объект spPageContextInfo</span><span class="sxs-lookup"><span data-stu-id="b6810-220">Can't rely on the spPageContextInfo object</span></span>

<span data-ttu-id="b6810-221">Раньше при создании клиентских модификаций для разных сайтов разработчики использовали объект JavaScript **spPageContextInfo** для получения сведений о текущей странице, сайте или пользователе.</span><span class="sxs-lookup"><span data-stu-id="b6810-221">When building reusable client-side customizations, in the past developers used the **spPageContextInfo** JavaScript object to get information about the current page, site or user. This object offered them an easy way to make their solution reusable across the different sites in SharePoint and not have to use fixed URLs.</span></span> <span data-ttu-id="b6810-222">С помощью этого объекта было легко сделать решение пригодным для использования на разных сайтах в SharePoint, не используя фиксированные URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="b6810-222">When building reusable client-side customizations, in the past developers used the spPageContextInfo JavaScript object to get information about the current page, site or user. This object offered them an easy way to make their solution reusable across the different sites in SharePoint and not have to use fixed URLs.</span></span>

<span data-ttu-id="b6810-223">Объект **spPageContextInfo** все еще присутствует на классических страницах SharePoint, но он ненадежен при использовании с современными страницами и библиотеками SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6810-223">While the **spPageContextInfo** object is still present on classic SharePoint pages, it cannot be reliably used with modern SharePoint pages and libraries. When building solutions on the SharePoint Framework developers are recommended to use the IWebPartContext.pageContext object instead, which contains the context information for the particular solution.</span></span> <span data-ttu-id="b6810-224">При создании решений на платформе SharePoint Framework разработчикам рекомендуется использовать объект **[IWebPartContext.pageContext](https://dev.office.com/sharepoint/reference/spfx/sp-webpart-base/iwebpartcontext)**, который содержит контекстные сведения для определенного решения.</span><span class="sxs-lookup"><span data-stu-id="b6810-224">While the spPageContextInfo object is still present on classic SharePoint pages, it cannot be reliably used with modern SharePoint pages and libraries. When building solutions on the SharePoint Framework developers are recommended to use the **[IWebPartContext.pageContext](https://dev.office.com/sharepoint/reference/spfx/sp-webpart-base/iwebpartcontext)** object instead, which contains the context information for the particular solution.</span></span>

### <a name="no-access-to-sharepoint-javascript-object-model-by-default"></a><span data-ttu-id="b6810-225">Отсутствие доступа к объектной модели JavaScript SharePoint по умолчанию</span><span class="sxs-lookup"><span data-stu-id="b6810-225">No access to SharePoint JavaScript Object Model by default</span></span>

<span data-ttu-id="b6810-p136">При создании клиентских модификаций для классического пользовательского интерфейса SharePoint многие разработчики применяли объектную модель JavaScript (JSOM) для взаимодействия с SharePoint. Модель JSOM предоставляла функцию IntelliSense и удобный доступ к API SharePoint подобно клиентской объектной модели (CSOM). На классических страницах SharePoint основной компонент модели JSOM по умолчанию присутствовал на странице, а разработчики могли загружать дополнительные компоненты, например для взаимодействия со службой поиска SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6810-p136">When building client-side customizations for the classic SharePoint user experience, many developers used the JavaScript Object Model (JSOM) to communicate with SharePoint. JSOM offered them intellisense and easy access to the SharePoint API in a way similar to the Client-Side Object Model (CSOM). In classic SharePoint pages, the core piece of JSOM was by default present on the page, and developers could load additional pieces to for example communicate with SharePoint Search.</span></span>

<span data-ttu-id="b6810-p137">Современный пользовательский интерфейс SharePoint по умолчанию не включает модель SharePoint JSOM. Разработчики могут загружать ее самостоятельно, но рекомендуем использовать вместо нее REST API. Модель REST более универсальна и поддерживается в различных клиентских библиотеках, таких как jQuery, Angular и React.</span><span class="sxs-lookup"><span data-stu-id="b6810-p137">The modern SharePoint user experience doesn't include SharePoint JSOM by default. While developers can load it themselves, the recommendation is to use the REST API instead. Using REST is more universal and interchangeable between the different client-side libraries such as jQuery, Angular or React.</span></span>

<span data-ttu-id="b6810-232">Корпорация Майкрософт больше не занимается разработкой модели JSOM.</span><span class="sxs-lookup"><span data-stu-id="b6810-232">Microsoft is not actively investing in JSOM anymore.</span></span> <span data-ttu-id="b6810-233">Если вы предпочитаете работать с API, вы также можете использовать [корневую библиотеку JavaScript для SharePoint Patterns and Practices](https://github.com/SharePoint/PnP-JS-Core), предоставляющую удобный API и определения типов TypeScript.</span><span class="sxs-lookup"><span data-stu-id="b6810-233">Microsoft is not actively investing in JSOM anymore. If you prefer working with an API, you could alternatively use the [SharePoint Patterns and Practices JavaScript Core Library](https://github.com/SharePoint/PnP-JS-Core) which offers you a fluent API and TypeScript typings.</span></span>

## <a name="migrate-existing-customization-to-the-sharepoint-framework"></a><span data-ttu-id="b6810-234">Перенос существующих модификаций в SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="b6810-234">Migrate existing customization to the SharePoint Framework</span></span>

<span data-ttu-id="b6810-p139">Перенос существующих модификаций на основе веб-части редактора скриптов в SharePoint Framework предоставляет ряд преимуществ как для пользователей, так и для разработчиков. Вы можете либо повторно использовать как можно больше существующих сценариев, либо полностью переписать модификацию.</span><span class="sxs-lookup"><span data-stu-id="b6810-p139">Migrating existing Script Editor Web Part customizations to the SharePoint Framework offers both end-users and developers a number of benefits. When considering migrating existing customizations to the SharePoint Framework you can either choose to reuse as much of the existing scripts as possible or to completely rewrite the customization.</span></span>

### <a name="reuse-existing-scripts"></a><span data-ttu-id="b6810-237">Повторное использование существующих сценариев</span><span class="sxs-lookup"><span data-stu-id="b6810-237">Reuse existing scripts</span></span>

<span data-ttu-id="b6810-p140">При переносе существующих модификаций на основе веб-части редактора скриптов в SharePoint Framework вы можете использовать существующие сценарии. Несмотря на то что платформа SharePoint Framework ориентирована на TypeScript, вы можете использовать обычный код JavaScript и постепенно преобразовывать его в TypeScript. Для краткосрочной поддержки определенного решения или в условиях ограниченного бюджета этого может быть достаточно.</span><span class="sxs-lookup"><span data-stu-id="b6810-p140">When migrating existing Script Editor Web Part customizations to the SharePoint Framework you can choose to reuse your existing scripts. Even though the SharePoint Framework encourages using TypeScript, you can perfectly well use plain JavaScript and gradually transform it to TypeScript. If you need to support a particular solution for a limited period of time or have a limited budget, this approach might be good enough for you.</span></span>

<span data-ttu-id="b6810-241">В решении SharePoint Framework не всегда можно повторно использовать существующие скрипты.</span><span class="sxs-lookup"><span data-stu-id="b6810-241">Reusing existing scripts in a SharePoint Framework solution is not always possible.</span></span> <span data-ttu-id="b6810-242">Например, решения SharePoint Framework упаковываются в виде модулей JavaScript и асинхронно загружаются на странице.</span><span class="sxs-lookup"><span data-stu-id="b6810-242">SharePoint Framework solutions for example are packaged as JavaScript modules and load asynchronously on a page.</span></span> <span data-ttu-id="b6810-243">Некоторые библиотеки JavaScript некорректно работают, если ссылаться на них из модуля, а на некоторые необходимо ссылаться определенным способом.</span><span class="sxs-lookup"><span data-stu-id="b6810-243">Some JavaScript libraries don't work correctly when referenced in a module or have to be referenced in a specific way.</span></span> <span data-ttu-id="b6810-244">Кроме того, использование событий страниц (например, `onload`) или функции jQuery `ready` может привести к нежелательным результатам.</span><span class="sxs-lookup"><span data-stu-id="b6810-244">Additionally, relying on page events such as `onload` or using the jQuery `ready` function, might lead to undesirable results.</span></span>

<span data-ttu-id="b6810-p142">Учитывая разнообразие библиотек JavaScript, сложно сказать заранее, можно ли будет использовать существующие сценарии в решении SharePoint Framework или все-таки придется переписывать их. Единственный способ узнать это — пробовать перемещать разные компоненты в решение SharePoint Framework и проверять их работу.</span><span class="sxs-lookup"><span data-stu-id="b6810-p142">Given the variety of JavaScript libraries, there is no easy way to tell upfront if your existing scripts can be reused in a SharePoint Framework solution or if you will need to rewrite it after all. The only way to determine this, is by trying to move the different pieces to a SharePoint Framework solution and see if they work as expected.</span></span>

### <a name="rewrite-the-customization"></a><span data-ttu-id="b6810-247">Повторное создание модификации</span><span class="sxs-lookup"><span data-stu-id="b6810-247">Rewrite the customization</span></span>

<span data-ttu-id="b6810-p143">Если вам нужны дополнительные возможности SharePoint Framework, долгосрочная поддержка решения или существующие скрипты невозможно использовать в SharePoint Framework, необходимо полностью переписать модификацию. Хотя это дороже, чем использовать существующие скрипты, в долгосрочной перспективе это более эффективно. Такое решение будет лучше работать, и его будет проще обслуживать и использовать.</span><span class="sxs-lookup"><span data-stu-id="b6810-p143">If you need to support your solution for a longer period of time, would like to make better use of the SharePoint Framework or if it turns out that your existing scripts cannot be reused with the SharePoint Framework, you might need to completely rewrite your customization. While it's more costly than reusing existing scripts, it offers you better results over a longer period of time: a solution that is better performing, easier to maintain and to use.</span></span>

<span data-ttu-id="b6810-p144">Переписывая существующую модификацию на основе веб-части редактора скриптов для SharePoint Framework, для начала следует задуматься о необходимых функциях. Для реализации пользовательского интерфейса советуем использовать Office UI Fabric, чтобы решение выглядело как неотъемлемая часть SharePoint. Для определенных компонентов, таких как диаграммы и ползунки, следует искать современные библиотеки, которые распространяются в виде модулей и включают определения типов TypeScript. Так вам будет легче внедрить компонент в решение.</span><span class="sxs-lookup"><span data-stu-id="b6810-p144">When rewriting an existing Script Editor Web Part customization to a SharePoint Framework solution, you should start with the desired functionality in mind. For implementing the user experience you should consider using the Office UI Fabric so that your solution looks like an integral part of SharePoint. For specific components such as charts or sliders, you should try looking for modern libraries that are distributed as modules and have TypeScript typings. This will make it easier for you to integrate the component in your solution.</span></span>

<span data-ttu-id="b6810-254">Невозможно однозначно сказать, какой компонент лучше всего подходит для того или иного сценария, но SharePoint Framework поддерживает все наиболее популярные сценарии, и вы сможете преобразовать существующие клиентские модификации в полноценные решения SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="b6810-254">While there is no single answer which component is the best to use for which scenario, the SharePoint Framework is flexible enough to accommodate most popular scenarios and you should be able to transform your existing client-side customizations into fully-featured SharePoint Framework solutions.</span></span>

### <a name="migration-tips"></a><span data-ttu-id="b6810-255">Советы по миграции</span><span class="sxs-lookup"><span data-stu-id="b6810-255">Migration tips</span></span>

<span data-ttu-id="b6810-256">Существует несколько общих шаблонов преобразования существующих модификаций на основе веб-части редактора скриптов в решения SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="b6810-256">When transforming existing Script Editor Web Part customizations to the SharePoint Framework there are a few common patterns.</span></span>

#### <a name="move-existing-code-to-sharepoint-framework"></a><span data-ttu-id="b6810-257">Перемещение существующего кода в SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="b6810-257">Move existing code to SharePoint Framework</span></span>

<span data-ttu-id="b6810-258">Модификации SharePoint, созданные с помощью веб-части редактора скриптов, обычно состоят из разметки HTML, включенной в веб-часть, и одной или нескольких ссылок на файлы JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b6810-258">SharePoint customizations built using the Script Editor Web Part often consist of some HTML markup, included in the web part, and one or more references to JavaScript files.</span></span> <span data-ttu-id="b6810-259">При преобразовании существующих модификаций в решение SharePoint Framework, скорее всего, потребуется переместить разметку HTML из веб-части "Редактор скриптов" в метод **render** клиентской веб-части SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="b6810-259">When transforming your existing customization to a SharePoint Framework solution, the HTML markup from the Script Editor Web Part would most likely have to be moved to the **render** method of the SharePoint Framework client-side web part.</span></span> <span data-ttu-id="b6810-260">Ссылки на внешние скрипты будут заменены ссылками в свойстве **externals** из файла **config.json**.</span><span class="sxs-lookup"><span data-stu-id="b6810-260">References to external scripts would be changed to references in the **externals** property in the **config.json** file.</span></span> <span data-ttu-id="b6810-261">Необходимо скопировать внутренние скрипты в исходную папку веб-части, а затем сослаться на них из класса веб-части с помощью операторов **require()**.</span><span class="sxs-lookup"><span data-stu-id="b6810-261">Internal scripts would be copied to the web part source folder and referenced from the web part class using **require()** statements.</span></span>

#### <a name="reference-functions-from-script-files"></a><span data-ttu-id="b6810-262">Ссылки на функции из файлов сценариев</span><span class="sxs-lookup"><span data-stu-id="b6810-262">Reference functions from script files</span></span>

<span data-ttu-id="b6810-p146">Чтобы ссылаться на функции из файлов сценариев, необходимо определить эти функции как экспортированные. Допустим, у вас есть файл JavaScript, который вы хотите использовать в клиентской веб-части SharePoint Framework:</span><span class="sxs-lookup"><span data-stu-id="b6810-p146">In order to reference functions from script files, these functions need to be defined as an export. Consider an existing JavaScript file, that you would like to use in a SharePoint Framework client-side web part:</span></span>

```js
var greeting = function() {
  alert('How are you doing?');
  return false;
}
```

<span data-ttu-id="b6810-265">Чтобы иметь возможность вызвать функцию **greeting** из класса веб-части, необходимо изменить содержимое файла JavaScript на следующее:</span><span class="sxs-lookup"><span data-stu-id="b6810-265">In order to be able to call the **greeting** function from the web part class, you would need to change the JavaScript file to:</span></span>

```js
var greeting = function() {  
  alert('How are you doing?');
  return false;
}

module.exports = {  
  greeting: greeting
};
```

<span data-ttu-id="b6810-266">Затем вы сможете сослаться на скрипт в классе веб-части и вызвать функцию **greeting**:</span><span class="sxs-lookup"><span data-stu-id="b6810-266">Then, in the web part class you can refer to the script and call the **greeting** function:</span></span>

```ts
public render(): void {  
  this.domElement.innerHTML = `
    <input type="button" value="Click me"/>`;

  const myScript = require('./my-script.js');
  this.domElement.querySelector('input').addEventListener('click', myScript.greeting);
}
```

#### <a name="execute-ajax-calls"></a><span data-ttu-id="b6810-267">Выполнение вызовов AJAX</span><span class="sxs-lookup"><span data-stu-id="b6810-267">Execute AJAX calls</span></span>

<span data-ttu-id="b6810-268">Многие клиентские модификации используют библиотеку jQuery для выполнения запросов AJAX из-за ее простоты и совместимости с разными браузерами.</span><span class="sxs-lookup"><span data-stu-id="b6810-268">Many client-side customizations use jQuery for executing AJAX requests for its simplicity and cross-browser compatibility.</span></span> <span data-ttu-id="b6810-269">Если вы используете jQuery только из-за этого, вы можете совершать вызовы AJAX с помощью стандартного клиента HTTP, входящего в состав SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="b6810-269">If this is all that you're using jQuery for, you can execute the AJAX calls using the standard HTTP client provided with the SharePoint Framework.</span></span> <span data-ttu-id="b6810-270">В SharePoint Framework есть два клиента HTTP: [SPHttpClient](https://dev.office.com/sharepoint/reference/spfx/sp-http/sphttpclient), предназначенный для отправки запросов REST API SharePoint, и [HttpClient](https://dev.office.com/sharepoint/reference/spfx/sp-http/httpclient), предназначенный для отправки веб-запросов других REST API.</span><span class="sxs-lookup"><span data-stu-id="b6810-270">SharePoint Framework offers you two types of HTTP client: the [SPHttpClient](https://dev.office.com/sharepoint/reference/spfx/sp-http/sphttpclient), meant for executing requests to the SharePoint REST API, and the [HttpClient](https://dev.office.com/sharepoint/reference/spfx/sp-http/httpclient) designed for issuing web requests to other REST APIs.</span></span> <span data-ttu-id="b6810-271">Вот как выполнить вызов с помощью SPHttpClient для получения заголовка текущего сайта SharePoint:</span><span class="sxs-lookup"><span data-stu-id="b6810-271">Here is how you would execute a call using the SPHttpClient to get the title of the current SharePoint site:</span></span>

```ts
this.context.spHttpClient.get(`${this.context.pageContext.web.absoluteUrl}/_api/web?$select=Title`,
SPHttpClient.configurations.v1,
{
  headers: {
    'Accept': 'application/json;odata=nometadata',
    'odata-version': ''
  }
})
.then((response: SPHttpClientResponse): Promise<{Title: string}> => {
  return response.json();
})
.then((web: {Title: string}): void => {
  // web.Title
}, (error: any): void => {
  // error
});
```

## <a name="more-information"></a><span data-ttu-id="b6810-272">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="b6810-272">More information</span></span>

- [<span data-ttu-id="b6810-273">Перенос модификаций SharePoint с использованием JavaScript в SharePoint Framework: ссылки на функции из файлов сценариев</span><span class="sxs-lookup"><span data-stu-id="b6810-273">Migrate SharePoint JavaScript customizations to SharePoint Framework - reference functions from script files</span></span>](https://blog.mastykarz.nl/migrate-sharepoint-javascript-customizations-sharepoint-framework-reference-functions/)
- [<span data-ttu-id="b6810-274">Перенос модификаций SharePoint на JavaScript в SharePoint Framework: вызовы AJAX и отображение данных с помощью jQuery</span><span class="sxs-lookup"><span data-stu-id="b6810-274">Migrate SharePoint JavaScript customizations to SharePoint Framework – jQuery AJAX calls and showing data</span></span>](https://rencore.com/blog/migrate-sharepoint-javascript-customizations-to-sharepoint-framework-jquery-ajax-calls-and-showing-data/)
