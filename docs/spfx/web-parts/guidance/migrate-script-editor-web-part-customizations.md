---
title: "Перенос существующих модификаций на основе веб-части \"Редактор скриптов\" в SharePoint Framework"
description: "Преимущества переноса клиентских настроек на платформу SharePoint Framework и факторы, которые следует учитывать при его планировании."
ms.date: 01/09/2018
ms.prod: sharepoint
ms.openlocfilehash: 5bd6bce189bf56ce892ba066974fa4b2cdd59bd3
ms.sourcegitcommit: 2188f21ce207c9d62d7d8af93822bd101058ba2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/10/2018
---
# <a name="migrate-existing-script-editor-web-part-customizations-to-the-sharepoint-framework"></a><span data-ttu-id="a20bc-103">Перенос настроек на основе веб-части "Редактор скриптов" в SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="a20bc-103">Migrate existing Script Editor Web Part customizations to the SharePoint Framework</span></span>

<span data-ttu-id="a20bc-104">SharePoint Framework — это модель, с помощью которой можно создавать настройки для SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-104">SharePoint Framework is a new model for building SharePoint customizations.</span></span> <span data-ttu-id="a20bc-105">Если вы создавали клиентские решения SharePoint с помощью веб-части редактора скриптов, возможно, вы хотите узнать о преимуществах переноса этих решений на платформу SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="a20bc-105">If you have been building client-side SharePoint solutions by using the Script Editor Web Part, you might be wondering what the possible advantages are of migrating them to the SharePoint Framework.</span></span> 

<span data-ttu-id="a20bc-106">В этой статье рассматриваются преимущества переноса клиентских настроек на платформу SharePoint Framework и представлен ряд факторов, которые следует учитывать при его планировании.</span><span class="sxs-lookup"><span data-stu-id="a20bc-106">This article highlights the benefits of migrating existing client-side customizations to the SharePoint Framework and points out a number of considerations that you should take into account when planning the migration.</span></span>

> [!NOTE] 
> <span data-ttu-id="a20bc-107">Сведения в этой статье применимы к настройкам, созданным с помощью веб-частей редактора содержимого и редактора скриптов.</span><span class="sxs-lookup"><span data-stu-id="a20bc-107">Note: The information in this article applies to customizations built using both the Content- and the Script Editor Web Part.</span></span> <span data-ttu-id="a20bc-108">Любое упоминание веб-части "Редактор скриптов" относится _и к веб-части "Редактор контента", и к веб-части "Редактор скриптов"_.</span><span class="sxs-lookup"><span data-stu-id="a20bc-108">Wherever there is a reference to the Script Editor Web Part, you should read _Content Editor Web Part and Script Editor Web Part_.</span></span>

## <a name="benefits-of-migrating-existing-client-side-customizations-to-the-sharepoint-framework"></a><span data-ttu-id="a20bc-109">Преимущества переноса клиентских настроек на платформу SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="a20bc-109">Benefit of migrating existing client-side customizations to the SharePoint Framework</span></span>

<span data-ttu-id="a20bc-110">Платформа SharePoint Framework была создана с нуля как модель разработки для SharePoint с ориентацией на клиентскую разработку.</span><span class="sxs-lookup"><span data-stu-id="a20bc-110">SharePoint Framework has been built from the ground up as a SharePoint development model focusing on client-side development.</span></span> <span data-ttu-id="a20bc-111">В первую очередь она предоставляет возможности расширения современных сайтов групп, но настройки на платформе SharePoint Framework также совместимы с классическим интерфейсом SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-111">While it primarily offers extensibility capabilities for modern team sites, customizations built on the SharePoint Framework also work with the classic SharePoint experience.</span></span> <span data-ttu-id="a20bc-112">Создавая настройки с помощью SharePoint Framework, вы получите ряд преимуществ, которыми не обладает ни одна другая модель разработки для SharePoint, доступная на данный момент.</span><span class="sxs-lookup"><span data-stu-id="a20bc-112">Building your customizations by using the SharePoint Framework offers you a number of benefits over using any other SharePoint development model available to date.</span></span>

### <a name="build-once-reuse-across-all-devices"></a><span data-ttu-id="a20bc-113">Возможность использования на всех устройствах</span><span class="sxs-lookup"><span data-stu-id="a20bc-113">Build once, reuse across all devices</span></span>

<span data-ttu-id="a20bc-114">Современный пользовательский интерфейс SharePoint обеспечивает встроенную поддержку доступа к данным, хранящимся в SharePoint, с любого устройства.</span><span class="sxs-lookup"><span data-stu-id="a20bc-114">The modern SharePoint user experience has been designed to natively support access to information stored in SharePoint on any device.</span></span> <span data-ttu-id="a20bc-115">Кроме того, он поддерживает мобильное приложение SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-115">Additionally, the modern experience supports the SharePoint mobile app.</span></span> <span data-ttu-id="a20bc-116">Решения, созданные с помощью SharePoint Framework, органично вписываются в современный интерфейс SharePoint. Кроме того, их можно использовать на различных устройствах, а также в мобильном приложении SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-116">Solutions built using the SharePoint Framework seamlessly integrate with the modern SharePoint experience and can be used across the different devices as well as inside the SharePoint mobile app.</span></span> <span data-ttu-id="a20bc-117">Так как решения SharePoint Framework совместимы с классическим интерфейсом SharePoint, их можно использовать в организациях, которые еще не перешли на современный интерфейс.</span><span class="sxs-lookup"><span data-stu-id="a20bc-117">Because SharePoint Framework solutions also work with the classic SharePoint experience, they can be used by organizations that haven't migrated to the modern experience yet.</span></span>

### <a name="more-robust-and-future-proof"></a><span data-ttu-id="a20bc-118">Надежность и готовность к будущему</span><span class="sxs-lookup"><span data-stu-id="a20bc-118">More robust and future-proof</span></span>

<span data-ttu-id="a20bc-p105">Раньше разработчики модифицировали SharePoint путем присоединения к определенным элементам модели DOM в пользовательском интерфейсе. С помощью этого подхода они могли менять стандартный пользовательский интерфейс или предоставлять дополнительные функции пользователям. Тем не менее в таких решениях часто возникали ошибки. Так как модель DOM для страниц SharePoint никогда не рассматривалась как платформа для расширения, каждое ее изменение приводило к ошибкам в зависящих от нее решениях.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p105">In the past, developers were customizing SharePoint by attaching to specific DOM elements in the user interface. Using this approach, they could change the standard user experience or provide additional functionality to end users. Such solutions were however error-prone. Because the SharePoint page DOM was never meant as an extensibility surface, whenever it changed, solutions relying on it would break.</span></span>

<span data-ttu-id="a20bc-123">SharePoint Framework предоставляет разработчикам стандартизованный API и точки расширяемости для создания клиентских решений и предоставления дополнительных возможностей пользователям.</span><span class="sxs-lookup"><span data-stu-id="a20bc-123">SharePoint Framework offers developers standardized API and extensibility points to build client-side solutions and provide end-users with additional capabilities.</span></span> <span data-ttu-id="a20bc-124">С помощью SharePoint Framework разработчики могут создавать решения поддерживаемым современным способом, не беспокоясь о том, как будущие изменения пользовательского интерфейса SharePoint повлияют на решение.</span><span class="sxs-lookup"><span data-stu-id="a20bc-124">SharePoint Framework offers developers standardized API and extensibility points to build client-side solutions and provide end-users with additional capabilities. Developers can use the SharePoint Framework to build solutions in a supported and future-proof way and don't need to be concerned with how future changes to the SharePoint user interface could affect your solution.</span></span>

### <a name="easier-access-to-information-in-sharepoint-and-office-365"></a><span data-ttu-id="a20bc-125">Удобство доступа к данным в SharePoint и Office 365</span><span class="sxs-lookup"><span data-stu-id="a20bc-125">Easier access to information in SharePoint and Office 365</span></span>

<span data-ttu-id="a20bc-p107">Корпорация Майкрософт постоянно расширяет возможности SharePoint и Office 365. По мере того как организации применяют обе платформы, для разработчиков становится все важнее возможность доступа к сведениям и аналитическим данным, хранящимся в Office 365, для создания функциональных решений. Одна из задач SharePoint Framework — помочь разработчикам подключаться к различным API SharePoint и Office 365.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p107">Microsoft is continuously extending capabilities of SharePoint and Office 365. As organizations make more use of both platforms, it's becoming increasingly important for developers to be able to tap into the information and insights stored in Office 365 to build rich solutions. One of the goals of the SharePoint Framework is to make it easy for developers to connect to various SharePoint and Office 365 APIs.</span></span>

### <a name="enable-users-to-configure-solutions-to-their-needs"></a><span data-ttu-id="a20bc-129">Возможность настройки решений пользователями</span><span class="sxs-lookup"><span data-stu-id="a20bc-129">Enable users to configure solutions to their needs</span></span>

<span data-ttu-id="a20bc-p108">Зачастую у пользователей не было простого способа настройки клиентских решений, созданных путем внедрения кода, в соответствии со своими потребностями. Настроить такое решение можно было только путем изменения его кода или с помощью специального пользовательского интерфейса, созданного исключительно для этой цели.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p108">Client-side solutions built through script embedding often didn't offer end-users an easy way to configure them to their needs. The only way to configure such solution, was by altering its code or through a custom user interface built specifically for that purpose.</span></span>

<span data-ttu-id="a20bc-p109">Клиентские веб-части SharePoint Framework можно настраивать с помощью стандартной области свойств, знакомой пользователям, которые уже работали с классическими веб-частями. Создавая клиентские веб-части, разработчики могут выбирать между реактивной областью свойств (она выбрана по умолчанию), где каждое изменение свойства веб-части непосредственно влияет на ее текст, и нереактивной областью свойств, в которой изменения свойств веб-части необходимо применять в явном виде.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p109">SharePoint Framework client-side web parts offer a standard way for configuring web parts using a property pane - familiar to users who worked with classic web parts in the past. Developers building client-side web parts can choose whether their web part should have a reactive property pane (default), where each change to a web part property is directly reflected in the web part body, or a non-reactive property pane, where changes to web part properties must be explicitly applied.</span></span>

### <a name="work-on-no-script-sites"></a><span data-ttu-id="a20bc-134">Работа на сайтах без скриптов</span><span class="sxs-lookup"><span data-stu-id="a20bc-134">Work on no-script sites</span></span>

<span data-ttu-id="a20bc-135">Чтобы помочь организациям управлять настройками, корпорация Майкрософт добавила возможность работы без скриптов в SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="a20bc-135">To help organizations govern their customizations, Microsoft released the no-script capability in SharePoint Online.</span></span> <span data-ttu-id="a20bc-136">Если в клиенте или определенном семействе веб-сайтов установлен флаг работы без скриптов, то настройки, использующие вставку и внедрение скриптов, отключаются.</span><span class="sxs-lookup"><span data-stu-id="a20bc-136">To helps organizations govern their customizations, Microsoft released the no-script capability in SharePoint Online. When the tenant or a particular site collection has the no-script flag enabled, customizations relying on script injection and embedding are disabled.</span></span>

<span data-ttu-id="a20bc-137">Так как клиентские веб-части SharePoint Framework развертываются через каталог приложений с предварительным утверждением, их разрешается использовать на сайтах без скриптов.</span><span class="sxs-lookup"><span data-stu-id="a20bc-137">Because SharePoint Framework client-side web parts are deployed through the App Catalog with a prior approval, they are allowed to run in no-script sites.</span></span> <span data-ttu-id="a20bc-138">По умолчанию на современных сайтах групп включен параметр работы без скриптов, поэтому на этих сайтах невозможно внедрять скрипты.</span><span class="sxs-lookup"><span data-stu-id="a20bc-138">By default, modern team sites have the no-script setting enabled and it's not possible to embed scripts in these sites.</span></span> <span data-ttu-id="a20bc-139">Следовательно, использование SharePoint Framework — единственный поддерживаемый способ создания клиентских настроек на современных сайтах групп.</span><span class="sxs-lookup"><span data-stu-id="a20bc-139">This makes using the SharePoint Framework the only supported way to build client-side customizations in modern team sites.</span></span>

## <a name="similarities-between-sharepoint-framework-solutions-and-script-editor-web-part-customizations"></a><span data-ttu-id="a20bc-140">Сходство между решениями SharePoint Framework и настройками на основе веб-части редактора скриптов</span><span class="sxs-lookup"><span data-stu-id="a20bc-140">Similarities between SharePoint Framework solutions and Script Editor Web Part customizations</span></span>

<span data-ttu-id="a20bc-p112">Решения SharePoint Framework создаются на основе новой модели разработки с использованием новой цепочки инструментов, но во многом они похожи на модификации на основе веб-части редактора скриптов, которые создавались в прошлом. Так как они основаны на одних и тех же понятиях, вам будет проще перенести их на новую платформу SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p112">While built on a new development model using a new toolchain, SharePoint Framework solutions are similar to the Script Editor Web Part customizations you have built in the past. Because they share the same concepts, it makes it easier for you to migrate them to the new SharePoint Framework.</span></span>

### <a name="run-as-a-part-of-the-page"></a><span data-ttu-id="a20bc-143">Выполнение в составе страницы</span><span class="sxs-lookup"><span data-stu-id="a20bc-143">Run as a part of the page</span></span>

<span data-ttu-id="a20bc-144">Подобно настройкам, встроенным в веб-части редактора скриптов, решения SharePoint Framework являются частью страницы.</span><span class="sxs-lookup"><span data-stu-id="a20bc-144">Similar to customizations embedded in Script Editor Web Parts, SharePoint Framework solutions are part of the page.</span></span> <span data-ttu-id="a20bc-145">Благодаря этому у таких решений есть доступ к модели DOM страницы и возможность взаимодействовать с другими компонентами на этой странице.</span><span class="sxs-lookup"><span data-stu-id="a20bc-145">This gives these solutions access to the page's DOM and allows them to communicate with other components on the same page.</span></span> <span data-ttu-id="a20bc-146">Кроме того, это помогает разработчикам создавать решения, которые адаптируются к различным форм-факторам, в которых может отображаться страница SharePoint, включая мобильное приложение SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-146">Also, it allows developers to more easily make their solutions responsive to adapt to the different form factors on which a SharePoint page could be displayed, including the SharePoint mobile app.</span></span>

<span data-ttu-id="a20bc-147">В отличие от надстроек SharePoint, клиентские веб-части SharePoint Framework не изолируются в объекте iframe.</span><span class="sxs-lookup"><span data-stu-id="a20bc-147">Unlike SharePoint Add-ins, SharePoint Framework client-side web parts are not isolated in an iframe.</span></span> <span data-ttu-id="a20bc-148">Как следствие, все ресурсы, доступные той или иной клиентской веб-части, также доступны другим элементам страницы.</span><span class="sxs-lookup"><span data-stu-id="a20bc-148">As a consequence, whatever resources the particular client-side web part has access to, other elements on the page can access as well.</span></span> <span data-ttu-id="a20bc-149">Это важно учитывать при создании решений, использующих неявный поток OAuth с маркерами доступа носителя либо файлы cookie или хранилище браузера для хранения конфиденциальной информации.</span><span class="sxs-lookup"><span data-stu-id="a20bc-149">This is important to keep in mind when building solutions that rely on OAuth implicit flow with bearer access tokens or use cookies or browser storage for storing sensitive information.</span></span> <span data-ttu-id="a20bc-150">Так как клиентские веб-части работают в составе страницы, другим элементам этой страницы также доступны все эти ресурсы.</span><span class="sxs-lookup"><span data-stu-id="a20bc-150">Because SharePoint Framework Extensions run as a part of the page, other elements on that page are able to access all these resources as well.</span></span>

### <a name="use-any-library-to-build-your-web-part"></a><span data-ttu-id="a20bc-151">Создание веб-части с помощью любой библиотеки</span><span class="sxs-lookup"><span data-stu-id="a20bc-151">Use any library to build your web part</span></span>

<span data-ttu-id="a20bc-152">При создании настроек с помощью веб-части редактора скриптов вы могли использовать такие библиотеки, как jQuery и Knockout, чтобы ваши настройки были более динамичными и лучше реагировали на действия пользователя.</span><span class="sxs-lookup"><span data-stu-id="a20bc-152">When building pages customizations using user custom actions you might have used libraries such as jQuery or Knockout to make your customization dynamic and better respond to user interaction.</span></span> <span data-ttu-id="a20bc-153">При создании клиентских веб-частей SharePoint Framework вы можете совершенствовать свои решения с помощью любой клиентской библиотеки, как и раньше.</span><span class="sxs-lookup"><span data-stu-id="a20bc-153">When building SharePoint Framework Extensions you can use any client-side library to enrich your solution, the same way you would have done it in the past.</span></span> <span data-ttu-id="a20bc-154">Еще одно преимущество SharePoint Framework — изоляция скрипта.</span><span class="sxs-lookup"><span data-stu-id="a20bc-154">Additional benefit that the SharePoint Framework offers you, is isolation of your script.</span></span> <span data-ttu-id="a20bc-155">Несмотря на то что веб-часть выполняется в составе страницы, ее скрипт упаковывается в виде модуля, который, к примеру, позволяет различным веб-частям на одной странице использовать разные версии jQuery, не конфликтуя друг с другом.</span><span class="sxs-lookup"><span data-stu-id="a20bc-155">Even though the web part is executed as a part of the page, its script is packaged as a module allowing for example different extensions on the same page to use a different version of jQuery without colliding with each other.</span></span> <span data-ttu-id="a20bc-156">Благодаря этой полезной функции вы можете сосредоточиться на коммерческой ценности решения, а не на технических особенностях миграции и компромиссах, связанных с функциональностью.</span><span class="sxs-lookup"><span data-stu-id="a20bc-156">This is a powerful feature that allows you to focus on delivering business value instead of technical migrations and compromising on functionality.</span></span>

### <a name="run-as-the-current-user"></a><span data-ttu-id="a20bc-157">Запуск от имени текущего пользователя</span><span class="sxs-lookup"><span data-stu-id="a20bc-157">Run as the current user</span></span>

<span data-ttu-id="a20bc-158">В модификациях, созданных с помощью веб-части редактора скриптов, для связи с SharePoint достаточно было вызвать API.</span><span class="sxs-lookup"><span data-stu-id="a20bc-158">In customizations built using JSLink, whenever you needed to communicate with SharePoint, all you had to do was to call its API.</span></span> <span data-ttu-id="a20bc-159">Клиентское решение работало в браузере в контексте текущего пользователя, а благодаря автоматической отправке с запросом файла cookie для аутентификации решение могло подключаться к SharePoint напрямую.</span><span class="sxs-lookup"><span data-stu-id="a20bc-159">The client-side solution was running in the browser in the context of the current user, and by automatically sending the authentication cookie along with the request, your solution could directly connect to SharePoint.</span></span> <span data-ttu-id="a20bc-160">Для связи с SharePoint не требовалась дополнительная аутентификация, как, например, при использовании надстроек SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-160">No additional authentication, like when using SharePoint add-ins, was necessary to communicate with SharePoint.</span></span> <span data-ttu-id="a20bc-161">Такой же механизм применяется к настройкам на платформе SharePoint Framework, которые также работают в контексте текущего пользователя, поэтому для связи с SharePoint им не требуется дополнительная аутентификация.</span><span class="sxs-lookup"><span data-stu-id="a20bc-161">The same mechanism applies to customizations built on the SharePoint Framework, that also run under the context of the currently authenticated user and also don't require any additional authentication steps in order to communicate with SharePoint.</span></span>

### <a name="use-only-client-side-code"></a><span data-ttu-id="a20bc-162">Использование клиентского кода</span><span class="sxs-lookup"><span data-stu-id="a20bc-162">Use only client-side code</span></span>

<span data-ttu-id="a20bc-p117">Как решения SharePoint Framework, так и модификации на основе веб-части редактора скриптов выполняются в браузере и могут содержать только клиентский код JavaScript. У клиентских решений есть ряд ограничений, например они не могут повышать разрешения в SharePoint и подключаться ко внешним API, не поддерживающим связь между источниками (CORS) и проверку подлинности с помощью неявного потока OAuth. В таких случаях клиентское решение может использовать удаленный серверный API, чтобы выполнить необходимую операцию и вернуть результаты клиенту.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p117">Both SharePoint Framework and Script Editor Web Part solutions run in the browser and can contain only client-side JavaScript code. Client-side solutions have a number of limitations, such as not being able to elevate permissions in SharePoint or reach out to external APIs that don't support cross-origin communication (CORS) or authentication using OAuth implicit flow. In such cases, the client-side solution could leverage a remote server-side API to perform the necessary operation and return the results to the client.</span></span>

### <a name="host-solution-in-sharepoint"></a><span data-ttu-id="a20bc-166">Размещение решения в SharePoint</span><span class="sxs-lookup"><span data-stu-id="a20bc-166">Host solution in SharePoint</span></span>

<span data-ttu-id="a20bc-167">Одним из преимуществ создания настроек SharePoint с помощью веб-части редактора скриптов было то, что их код можно было размещать в обычной библиотеке документов SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-167">One of the benefits of building SharePoint customizations using Script Editor Web Parts was the fact, that their code could be hosted in a regular SharePoint document library. Comparing to SharePoint add-ins, it required less infrastructure and simplified hosting the solution. Additionally, organizations could use SharePoint permissions to control access to the solution files.</span></span> <span data-ttu-id="a20bc-168">По сравнению с надстройками SharePoint для этого требовалось меньше инфраструктуры, а размещать решение было проще.</span><span class="sxs-lookup"><span data-stu-id="a20bc-168">Compared to SharePoint Add-ins, it required less infrastructure and simplified hosting the solution.</span></span> <span data-ttu-id="a20bc-169">Кроме того, организации могли использовать разрешения SharePoint для управления доступом к файлам решения.</span><span class="sxs-lookup"><span data-stu-id="a20bc-169">Additionally, organizations could use SharePoint permissions to control access to the solution files.</span></span>

<span data-ttu-id="a20bc-170">Хотя размещение решений SharePoint Framework в сети CDN имеет ряд преимуществ, оно необязательно, и вы можете разместить код решений в обычной библиотеке документов SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-170">While hosting SharePoint Framework solutions on a CDN offers a number of advantages, it is not required, and you could choose to host their code in a regular SharePoint document library.</span></span> <span data-ttu-id="a20bc-171">Пакеты SharePoint Framework (SPPKG-файлы), развернутые в каталоге приложений, задают URL-адрес, по которому SharePoint Framework может найти код решения.</span><span class="sxs-lookup"><span data-stu-id="a20bc-171">SharePoint Framework packages (.sppkg files) deployed to the App Catalog specify the URL at which SharePoint Framework can find the solution's code.</span></span> <span data-ttu-id="a20bc-172">Этот URL-адрес может быть каким угодно, при условии что пользователь, просматривающий страницу с веб-частью, может скачать скрипт из указанного расположения.</span><span class="sxs-lookup"><span data-stu-id="a20bc-172">There are no restrictions with regards to what that URL must be, as long as the user browsing the page with the extension on it, can download the script from the specified location.</span></span>

<span data-ttu-id="a20bc-173">[Office 365 позволяет публиковать в общедоступной сети CDN](https://dev.office.com/blogs/office-365-public-cdn-developer-preview-release) файлы из определенной библиотеки документов SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-173">[Office 365 offers the public CDN capability](https://dev.office.com/blogs/office-365-public-cdn-developer-preview-release) that allows you to publish files from a specific SharePoint document library to a CDN.</span></span> <span data-ttu-id="a20bc-174">Общедоступные сети CDN Office 365 сочетают в себе преимущества использования сетей CDN и простоту размещения файлов с кодом в библиотеке документов SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-174">Office 365 public CDN strikes a nice balance between the benefits of using a CDN and the simplicity of hosting code files in a SharePoint document library.</span></span> <span data-ttu-id="a20bc-175">Если общедоступность файлов с кодом не является проблемой для организации, рекомендуем использовать общедоступную сеть CDN Office 365.</span><span class="sxs-lookup"><span data-stu-id="a20bc-175">If your organization doesn't mind their code files being publicly available, using the Office 365 public CDN is an option worth considering.</span></span>

## <a name="differences-between-sharepoint-framework-solutions-and-script-editor-web-part-customizations"></a><span data-ttu-id="a20bc-176">Различия между решениями SharePoint Framework и модификациями на основе веб-части редактора скриптов</span><span class="sxs-lookup"><span data-stu-id="a20bc-176">Differences between SharePoint Framework solutions and Script Editor Web Part customizations</span></span>

<span data-ttu-id="a20bc-177">Модификации SharePoint, созданные с помощью SharePoint Framework и веб-части редактора скриптов, очень похожи между собой.</span><span class="sxs-lookup"><span data-stu-id="a20bc-177">SharePoint customizations built using the SharePoint Framework and Script Editor Web Part are very similar.</span></span> <span data-ttu-id="a20bc-178">Все они выполняются в составе страницы в контексте текущего пользователя и создаются с помощью клиентского кода JavaScript.</span><span class="sxs-lookup"><span data-stu-id="a20bc-178">They all run as a part of the page under the context of the current user and are built using client-side JavaScript.</span></span> <span data-ttu-id="a20bc-179">Однако существует несколько значительных различий, которые могут повлиять на принятие решений, связанных с архитектурой, и которые следует учитывать при разработке решения.</span><span class="sxs-lookup"><span data-stu-id="a20bc-179">But there are also some significant differences that might influence your architectural decisions and which you should keep in mind when designing your solution.</span></span>

### <a name="run-in-no-script-sites"></a><span data-ttu-id="a20bc-180">Работа на сайтах без скриптов</span><span class="sxs-lookup"><span data-stu-id="a20bc-180">Run in no-script sites</span></span>

<span data-ttu-id="a20bc-181">При использовании веб-части редактора скриптов, если сайт, для которого создавалась настройка, был сайтом без скриптов,</span><span class="sxs-lookup"><span data-stu-id="a20bc-181">When building client-side customizations using the Script Editor Web Part, you had to take into account whether the site, where the customization would be used, was a no-script site or not. If the site was a no-script site, you either had to request the admin to disable the no-script setting or build your solution differently, for example using the add-in model.</span></span> <span data-ttu-id="a20bc-182">приходилось либо просить администратора отключить параметр работы без скриптов, либо создавать решение по-другому, например с помощью модели надстроек.</span><span class="sxs-lookup"><span data-stu-id="a20bc-182">When building client-side customizations using the Script Editor Web Part, you had to take into account whether the site, where the customization would be used, was a no-script site or not. If the site was a no-script site, you either had to request the admin to disable the no-script setting or build your solution differently, for example using the add-in model.</span></span>

<span data-ttu-id="a20bc-183">Решения SharePoint Framework развертываются через каталог приложений с предварительным утверждением, поэтому на них не распространяются ограничения работы без скриптов. Эти решения работают на всех сайтах.</span><span class="sxs-lookup"><span data-stu-id="a20bc-183">Because SharePoint Framework solutions are deployed through the app catalog with a prior approval, they are not subject to the no-script restrictions and work on all sites.</span></span>

### <a name="deployed-and-updated-through-it"></a><span data-ttu-id="a20bc-184">Развертывание и обновление через ИТ-отдел</span><span class="sxs-lookup"><span data-stu-id="a20bc-184">Deployed and updated through IT</span></span>

<span data-ttu-id="a20bc-185">Созданием модификаций SharePoint с помощью веб-части редактора скриптов занимались в основном разработчики-любители.</span><span class="sxs-lookup"><span data-stu-id="a20bc-185">Script Editor Web Parts are used to build SharePoint customizations primarily by citizen developers.</span></span> <span data-ttu-id="a20bc-186">Располагая только разрешениями владельца сайта, разработчики-любители могут создавать привлекательные настройки SharePoint, представляющие коммерческую ценность.</span><span class="sxs-lookup"><span data-stu-id="a20bc-186">With nothing more than site owner permissions, citizen developers can build compelling SharePoint customizations that add business value.</span></span> <span data-ttu-id="a20bc-187">Каждый раз, когда требуется обновить настройку, пользователи с необходимыми разрешениями могут применять обновления к файлам скриптов решения. При этом изменения сразу становятся видны всем пользователям.</span><span class="sxs-lookup"><span data-stu-id="a20bc-187">Script Editor Web Parts are used to build SharePoint customizations primarily by citizen developers. With nothing more than site owner permissions, citizen developers can build compelling SharePoint customizations that add business value. Whenever the customization needs to be updated, users with the necessary permissions can apply updates to the solution's script files and the changes will be immediately visible to all users.</span></span>

<span data-ttu-id="a20bc-p124">При использовании решений на основе веб-части редактора скриптов сотрудникам ИТ-организаций сложно отслеживать, какие модификации используются и где. Кроме того, организациям не могут определить, какие внешние скрипты используются в их интрасети, и получить доступ к их данным.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p124">Script Editor Web Part solutions make it hard for IT organizations to keep track of what customizations are being used and where they are being used. Additionally, organizations can't tell which external scripts are being used in their intranet and have access to their data.</span></span>

<span data-ttu-id="a20bc-190">SharePoint Framework возвращает контроль ИТ-отделам.</span><span class="sxs-lookup"><span data-stu-id="a20bc-190">SharePoint Framework gives the control back to the IT.</span></span> <span data-ttu-id="a20bc-191">Развертывание решений SharePoint Framework и управление ими выполняются централизованно через каталог приложений, поэтому представители организации могут изучить решение, прежде чем развертывать его.</span><span class="sxs-lookup"><span data-stu-id="a20bc-191">Because SharePoint Framework solutions are deployed and managed centrally in the App Catalog, organizations have the opportunity to review the solution before deploying it.</span></span> <span data-ttu-id="a20bc-192">Кроме того, все обновления также развертываются через каталог приложений, позволяя организациям проверять и утверждать их перед развертыванием.</span><span class="sxs-lookup"><span data-stu-id="a20bc-192">Additionally, any updates are deployed via the App Catalog as well, allowing organizations to verify and approve them before deployment.</span></span>

### <a name="focus-more-on-uniform-user-experience"></a><span data-ttu-id="a20bc-193">Стандартизация пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="a20bc-193">Focus more on uniform user experience</span></span>

<span data-ttu-id="a20bc-194">При создании модификаций с помощью веб-части редактора скриптов разработчикам-любителям полностью принадлежала соответствующая модель DOM.</span><span class="sxs-lookup"><span data-stu-id="a20bc-194">When building customizations using the Script Editor Web Part, citizen developers owned the complete DOM of their customization.</span></span> <span data-ttu-id="a20bc-195">Не существовало никаких рекомендаций касательно пользовательского интерфейса и работы таких настроек.</span><span class="sxs-lookup"><span data-stu-id="a20bc-195">There were no guidelines related to the user experience and how such customization should work.</span></span> <span data-ttu-id="a20bc-196">Как следствие, разные разработчики создавали настройки по-разному, в результате чего пользовательский интерфейс становился несогласованным.</span><span class="sxs-lookup"><span data-stu-id="a20bc-196">As a result, different developers built customizations in different ways, which led to an inconsistent user experience for end users.</span></span>

<span data-ttu-id="a20bc-197">Одна из задач SharePoint Framework — стандартизировать клиентские настройки в отношении развертывания, обслуживания и пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a20bc-197">One of the goals of the SharePoint Framework is to standardize building client-side customizations so that they are uniform from the deployment, maintenance and user experience point of view.</span></span> <span data-ttu-id="a20bc-198">С помощью [Office UI Fabric](http://dev.office.com/fabric) разработчики могут без труда сделать так, чтобы их решения выглядели и работали как неотъемлемая часть SharePoint, что повышает их привлекательность для пользователей.</span><span class="sxs-lookup"><span data-stu-id="a20bc-198">Using [Office UI Fabric](http://dev.office.com/fabric) developers can more easily make their custom solutions look and behave like they were an integral part of SharePoint, simplifying the user adoption.</span></span> <span data-ttu-id="a20bc-199">Цепочка инструментов SharePoint Framework создает файлы пакетов для решений, которые развертываются в каталоге приложений, и пакеты скриптов, которые развертываются в выбранном вами расположении.</span><span class="sxs-lookup"><span data-stu-id="a20bc-199">SharePoint Framework toolchain generates package files for the solutions, that are deployed to the app catalog, and script bundles, that are deployed to the hosting location of your choice.</span></span> <span data-ttu-id="a20bc-200">Все решения идентичны с точки зрения структуры и управления.</span><span class="sxs-lookup"><span data-stu-id="a20bc-200">Every solution is structured and managed in the same way.</span></span>

### <a name="dont-modify-dom-outside-of-the-customization"></a><span data-ttu-id="a20bc-201">Не меняйте модель DOM вне настройки</span><span class="sxs-lookup"><span data-stu-id="a20bc-201">Don't modify DOM outside of the customization</span></span>

<span data-ttu-id="a20bc-202">В прошлом веб-части редактора скриптов часто использовались для изменения фрагментов страниц, например добавления кнопок на панель инструментов либо изменения заголовка или фирменной символики страницы.</span><span class="sxs-lookup"><span data-stu-id="a20bc-202">Script Editor Web Parts were frequently used in the past to modify parts of the page, such as adding buttons to toolbar or changing the heading or branding of the page. Such customizations relied on the existence of specific DOM elements and whenever SharePoint UI would be updated, there was a chance that such customization would break.</span></span> <span data-ttu-id="a20bc-203">Такие настройки зависели от наличия определенных элементов модели DOM. Следовательно, при каждом обновлении пользовательского интерфейса SharePoint существовала опасность того, что такая настройка перестанет работать.</span><span class="sxs-lookup"><span data-stu-id="a20bc-203">Script Editor Web Parts were frequently used in the past to modify parts of the page, such as adding buttons to toolbar or changing the heading or branding of the page. Such customizations relied on the existence of specific DOM elements and whenever SharePoint UI would be updated, there was a chance that such customization would break.</span></span>

<span data-ttu-id="a20bc-204">В SharePoint Framework доступен более структурированный и надежный подход к настройке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-204">SharePoint Framework encourages a more structured and reliable approach to customizing SharePoint.</span></span> <span data-ttu-id="a20bc-205">Вместо того чтобы использовать определенные элементы модели DOM для настройки SharePoint, SharePoint Framework предоставляет разработчикам общедоступный API, с помощью которого они могут расширять SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-205">Rather than using specific DOM elements to customize SharePoint, SharePoint Framework provides developers with a public API that they can use to extend SharePoint.</span></span> <span data-ttu-id="a20bc-206">SharePoint Framework поддерживает только клиентские веб-части, но [рассматривается возможность добавления](../../roadmap.md) других форматов, таких как JSLink и настраиваемые действия пользователей, чтобы разработчики могли реализовывать наиболее распространенные сценарии с помощью SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="a20bc-206">At this moment client-side web part are the only shape supported by the SharePoint Framework, but other shapes, such as equivalents of JSLink and User Custom Actions, are being [taken into consideration for the future](../../roadmap.md) so that developers can implement the most common customization scenarios using the SharePoint Framework.</span></span>

### <a name="distributed-as-packages"></a><span data-ttu-id="a20bc-207">Распространение в виде пакетов</span><span class="sxs-lookup"><span data-stu-id="a20bc-207">Distributed as packages</span></span>

<span data-ttu-id="a20bc-p130">Клиентские модификации SharePoint часто использовали списки и библиотеки SharePoint для хранения своих данных. При создании решений с помощью веб-части редактора скриптов было сложно обеспечить автоматическую подготовку необходимых компонентов. Для развертывания той же модификации на другом сайте часто требовалось скопировать веб-часть, а также правильно воссоздать и обеспечить функционирование хранилища необходимых данных.</span><span class="sxs-lookup"><span data-stu-id="a20bc-p130">SharePoint client-side customizations often used SharePoint lists and libraries to store their data. When built using the Script Editor Web Part, there was no easy way to automatically provision the necessary prerequisites. Deploying the same customization to another site often meant copying the web part but also correctly recreating and maintaining the necessary data storage.</span></span>

<span data-ttu-id="a20bc-211">Решения SharePoint Framework распространяются в виде пакетов, которые могут автоматически подготавливать необходимые компоненты, такие как поля, типы контента и списки.</span><span class="sxs-lookup"><span data-stu-id="a20bc-211">SharePoint Framework solutions are distributed as packages capable of provisioning their prerequisites, such as fields, content types, or lists, automatically.</span></span> <span data-ttu-id="a20bc-212">Разработчики, создающие пакет, могут указывать артефакты, необходимые решению. Указанные артефакты создаются при установке решения на сайте.</span><span class="sxs-lookup"><span data-stu-id="a20bc-212">Developers building the package can specify which artifacts are required by the solution, and whenever it's installed in a site, the specified artifacts are created.</span></span> <span data-ttu-id="a20bc-213">Это значительно упрощает развертывание решения на нескольких сайтах и управление им.</span><span class="sxs-lookup"><span data-stu-id="a20bc-213">This significantly simplifies the process of deploying and managing the solution on multiple sites.</span></span>

### <a name="use-typescript-for-building-more-robust-and-easier-to-maintain-solutions"></a><span data-ttu-id="a20bc-214">Использование TypeScript для создания надежных и простых в обслуживании решений</span><span class="sxs-lookup"><span data-stu-id="a20bc-214">Use TypeScript for building more robust and easier to maintain solution</span></span>

<span data-ttu-id="a20bc-215">При создании настроек с помощью веб-части редактора скриптов разработчики-любители часто использовали обычный код JavaScript.</span><span class="sxs-lookup"><span data-stu-id="a20bc-215">When building customizations using the Script Editor Web Part, citizen developers often used plain JavaScript. Often such solutions didn't contain any automated tests and refactoring the code was error-prone.</span></span> <span data-ttu-id="a20bc-216">Зачастую в таких решениях не были предусмотрены автоматические проверки, что могло приводить к ошибкам при рефакторинге.</span><span class="sxs-lookup"><span data-stu-id="a20bc-216">Often such solutions didn't contain any automated tests and refactoring the code was error-prone.</span></span>

<span data-ttu-id="a20bc-217">На платформе SharePoint Framework разработчики могут использовать систему типов TypeScript при создании решений.</span><span class="sxs-lookup"><span data-stu-id="a20bc-217">SharePoint Framework allows developers to benefit of the TypeScript type system when building solutions.</span></span> <span data-ttu-id="a20bc-218">Благодаря системе типов вы можете находить ошибки во время разработки, а не во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="a20bc-218">Thanks to the type system, errors are caught during development rather than on runtime.</span></span> <span data-ttu-id="a20bc-219">Кроме того, рефакторинг стал проще, так как TypeScript защищает изменения кода.</span><span class="sxs-lookup"><span data-stu-id="a20bc-219">Also, refactoring code can be done more easily as changes to the code are safeguarded by TypeScript.</span></span> <span data-ttu-id="a20bc-220">Так как любой код JavaScript является допустимым кодом TypeScript, переход не вызовет особых затруднений. Вы можете перенести обычный код JavaScript в TypeScript, постепенно расширяя возможности поддержки решения.</span><span class="sxs-lookup"><span data-stu-id="a20bc-220">Because all JavaScript is valid TypeScript, the entry barrier is low and you can migrate your plain JavaScript to TypeScript gradually over time, increasing the maintainability of your solutions.</span></span>

### <a name="cant-rely-on-the-sppagecontextinfo-object"></a><span data-ttu-id="a20bc-221">Ненадежный объект spPageContextInfo</span><span class="sxs-lookup"><span data-stu-id="a20bc-221">Can't rely on the spPageContextInfo object</span></span>

<span data-ttu-id="a20bc-222">Раньше при создании клиентских настроек для разных сайтов разработчики использовали объект JavaScript **spPageContextInfo**, чтобы получать сведения о текущей странице, сайте или пользователе.</span><span class="sxs-lookup"><span data-stu-id="a20bc-222">When building reusable client-side customizations, in the past developers used the **spPageContextInfo** JavaScript object to get information about the current page, site or user.</span></span> <span data-ttu-id="a20bc-223">С помощью этого объекта было легко сделать решение пригодным для использования на разных сайтах в SharePoint, не используя фиксированные URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="a20bc-223">This object offered them an easy way to make their solution reusable across the different sites in SharePoint and not have to use fixed URLs.</span></span>

<span data-ttu-id="a20bc-224">Объект **spPageContextInfo** все еще присутствует на классических страницах SharePoint, но он ненадежен при использовании с современными страницами и библиотеками SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-224">While the **spPageContextInfo** object is still present on classic SharePoint pages, it cannot be reliably used with modern SharePoint pages and libraries.</span></span> <span data-ttu-id="a20bc-225">При создании решений на платформе SharePoint Framework разработчикам рекомендуется использовать объект **[IWebPartContext.pageContext](https://dev.office.com/sharepoint/reference/spfx/sp-webpart-base/iwebpartcontext)**, который содержит контекстные сведения для определенного решения.</span><span class="sxs-lookup"><span data-stu-id="a20bc-225">When building solutions on the SharePoint Framework developers are recommended to use the **[IWebPartContext.pageContext](https://dev.office.com/sharepoint/reference/spfx/sp-webpart-base/iwebpartcontext)** object instead, which contains the context information for the particular solution.</span></span>

### <a name="no-access-to-sharepoint-javascript-object-model-by-default"></a><span data-ttu-id="a20bc-226">Отсутствие доступа к объектной модели JavaScript SharePoint по умолчанию</span><span class="sxs-lookup"><span data-stu-id="a20bc-226">No access to SharePoint JavaScript Object Model by default</span></span>

<span data-ttu-id="a20bc-227">При создании клиентских модификаций для классического пользовательского интерфейса SharePoint многие разработчики применяли объектную модель JavaScript (JSOM) для взаимодействия с SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-227">When building client-side customizations for the classic SharePoint user experience, many developers used the JavaScript Object Model (JSOM) to communicate with SharePoint.</span></span> <span data-ttu-id="a20bc-228">Модель JSOM предоставляла функцию IntelliSense и удобный доступ к API SharePoint подобно клиентской объектной модели (CSOM).</span><span class="sxs-lookup"><span data-stu-id="a20bc-228">JSOM offered them intellisense and easy access to the SharePoint API in a way similar to the Client-Side Object Model (CSOM).</span></span> <span data-ttu-id="a20bc-229">На классических страницах SharePoint основной компонент модели JSOM по умолчанию присутствовал на странице, а разработчики могли загружать дополнительные компоненты, например для взаимодействия со службой поиска SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-229">In classic SharePoint pages, the core piece of JSOM was by default present on the page, and developers could load additional pieces to for example communicate with SharePoint Search.</span></span>

<span data-ttu-id="a20bc-230">Современный пользовательский интерфейс SharePoint по умолчанию не включает модель SharePoint JSOM.</span><span class="sxs-lookup"><span data-stu-id="a20bc-230">The modern SharePoint user experience doesn't include SharePoint JSOM by default.</span></span> <span data-ttu-id="a20bc-231">Разработчики могут загружать ее самостоятельно, но рекомендуем использовать вместо нее REST API.</span><span class="sxs-lookup"><span data-stu-id="a20bc-231">While developers can load it themselves, the recommendation is to use the REST API instead, or the SharePoint Patterns and Practices JavaScript Core Library (PnP JS Library), which internally uses the SharePoint REST API.</span></span> <span data-ttu-id="a20bc-232">Модель REST более универсальна и поддерживается в различных клиентских библиотеках, таких как jQuery, Angular и React.</span><span class="sxs-lookup"><span data-stu-id="a20bc-232">Using REST is more universal and interchangeable between the different client-side libraries such as jQuery, Angular or React.</span></span>

<span data-ttu-id="a20bc-233">Корпорация Майкрософт больше не занимается разработкой модели JSOM.</span><span class="sxs-lookup"><span data-stu-id="a20bc-233">Microsoft is not actively investing in JSOM anymore.</span></span> <span data-ttu-id="a20bc-234">Если вы предпочитаете работать с API, вы также можете использовать [корневую библиотеку JavaScript для SharePoint Patterns and Practices](https://github.com/SharePoint/PnP-JS-Core), предоставляющую удобный API и определения типов TypeScript.</span><span class="sxs-lookup"><span data-stu-id="a20bc-234">If you prefer working with an API, you could alternatively use the [SharePoint Patterns and Practices JavaScript Core Library](https://github.com/SharePoint/PnP-JS-Core) which offers you a fluent API and TypeScript typings.</span></span>

## <a name="migrate-existing-customization-to-the-sharepoint-framework"></a><span data-ttu-id="a20bc-235">Перенос настроек в SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="a20bc-235">Migrate existing customization to the SharePoint Framework</span></span>

<span data-ttu-id="a20bc-236">Перенос настроек на основе веб-части редактора скриптов в SharePoint Framework предоставляет ряд преимуществ как для пользователей, так и для разработчиков.</span><span class="sxs-lookup"><span data-stu-id="a20bc-236">Migrating existing customizations to the SharePoint Framework Extensions offers both end-users and developers a number of benefits.</span></span> <span data-ttu-id="a20bc-237">Вы можете либо повторно использовать как можно больше существующих сценариев, либо полностью переписать настройку.</span><span class="sxs-lookup"><span data-stu-id="a20bc-237">When considering migrating existing customizations to the SharePoint Framework you can either choose to reuse as much of the existing JavaScript scripts as possible, or to completely rewrite the customization usign TypeScript.</span></span>

### <a name="reuse-existing-scripts"></a><span data-ttu-id="a20bc-238">Повторное использование существующих сценариев</span><span class="sxs-lookup"><span data-stu-id="a20bc-238">Reuse existing scripts</span></span>

<span data-ttu-id="a20bc-239">При переносе существующих настроек на основе веб-части редактора скриптов в SharePoint Framework вы можете использовать существующие сценарии.</span><span class="sxs-lookup"><span data-stu-id="a20bc-239">When migrating existing customizations to the SharePoint Framework Extensions you can choose to reuse your existing scripts.</span></span> <span data-ttu-id="a20bc-240">Несмотря на то что платформа SharePoint Framework ориентирована на TypeScript, вы можете использовать обычный код JavaScript и постепенно преобразовывать его в TypeScript.</span><span class="sxs-lookup"><span data-stu-id="a20bc-240">Even though the SharePoint Framework encourages using TypeScript, you can perfectly well use plain JavaScript and gradually transform it to TypeScript.</span></span> <span data-ttu-id="a20bc-241">Для краткосрочной поддержки определенного решения или в условиях ограниченного бюджета этого может быть достаточно.</span><span class="sxs-lookup"><span data-stu-id="a20bc-241">If you need to support a particular solution for a limited period of time or have a limited budget, this approach might be good enough for you.</span></span>

<span data-ttu-id="a20bc-242">В решении SharePoint Framework не всегда можно повторно использовать существующие скрипты.</span><span class="sxs-lookup"><span data-stu-id="a20bc-242">Reusing existing scripts in a SharePoint Framework solution is not always possible.</span></span> <span data-ttu-id="a20bc-243">Например, решения SharePoint Framework упаковываются в виде модулей JavaScript и асинхронно загружаются на странице.</span><span class="sxs-lookup"><span data-stu-id="a20bc-243">SharePoint Framework solutions for example are packaged as JavaScript modules and load asynchronously on a page.</span></span> <span data-ttu-id="a20bc-244">Некоторые библиотеки JavaScript некорректно работают, если ссылаться на них из модуля, а на некоторые необходимо ссылаться определенным способом.</span><span class="sxs-lookup"><span data-stu-id="a20bc-244">Some JavaScript libraries don't work correctly when referenced in a module or have to be referenced in a specific way.</span></span> <span data-ttu-id="a20bc-245">Кроме того, использование событий страниц (например, `onload`) или функции jQuery `ready` может привести к нежелательным результатам.</span><span class="sxs-lookup"><span data-stu-id="a20bc-245">Additionally, relying on page events such as `onload` or using the jQuery `ready` function, might lead to undesirable results.</span></span>

<span data-ttu-id="a20bc-246">Учитывая разнообразие библиотек JavaScript, сложно сказать заранее, можно ли будет использовать существующие сценарии в решении SharePoint Framework или все-таки придется переписывать их.</span><span class="sxs-lookup"><span data-stu-id="a20bc-246">For example, given the variety of JavaScript libraries, there is no easy way to tell upfront if your existing scripts can be reused in a SharePoint Framework solution or if you will need to rewrite it after all.</span></span> <span data-ttu-id="a20bc-247">Единственный способ узнать это — пробовать перемещать разные компоненты в решение SharePoint Framework и проверять их работу.</span><span class="sxs-lookup"><span data-stu-id="a20bc-247">The only way to determine this, is by trying to move the different pieces to a SharePoint Framework solution and see if they work as expected.</span></span>

### <a name="rewrite-the-customization"></a><span data-ttu-id="a20bc-248">Повторное создание настройки</span><span class="sxs-lookup"><span data-stu-id="a20bc-248">Rewrite the customization</span></span>

<span data-ttu-id="a20bc-249">Если вам потребуются дополнительные возможности SharePoint Framework или долгосрочная поддержка решения либо окажется, что существующие скрипты невозможно использовать в SharePoint Framework, то необходимо полностью переписать настройку.</span><span class="sxs-lookup"><span data-stu-id="a20bc-249">If you need to support your solution for a longer period of time, would like to make better use of the SharePoint Framework or if it turns out that your existing scripts cannot be reused with the SharePoint Framework, you might need to completely rewrite your customization. While it's more costly than reusing existing scripts, it offers you better results over a longer period of time: a solution that is better performing, easier to maintain and to use.</span></span> <span data-ttu-id="a20bc-250">Хотя это дороже, чем использовать существующие скрипты, в долгосрочной перспективе это более эффективно. Такое решение будет лучше работать, и его будет проще обслуживать и использовать.</span><span class="sxs-lookup"><span data-stu-id="a20bc-250">While it's more costly than reusing existing scripts, it offers you better results over a longer period of time: a solution that is better performing, and easier to maintain and use.</span></span>

<span data-ttu-id="a20bc-251">Переписывая существующую настройку на основе веб-части редактора скриптов для SharePoint Framework, для начала следует задуматься о необходимых функциях.</span><span class="sxs-lookup"><span data-stu-id="a20bc-251">When rewriting an existing customization to a SharePoint Framework solution, you should start with the desired functionality in mind.</span></span> <span data-ttu-id="a20bc-252">Для реализации пользовательского интерфейса советуем использовать Office UI Fabric, чтобы решение выглядело как неотъемлемая часть SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a20bc-252">For implementing the user experience you should consider using the Office UI Fabric so that your solution looks like an integral part of SharePoint.</span></span> <span data-ttu-id="a20bc-253">Для определенных компонентов, таких как диаграммы и ползунки, следует искать современные библиотеки, которые распространяются в виде модулей и включают определения типов TypeScript.</span><span class="sxs-lookup"><span data-stu-id="a20bc-253">For specific components such as charts or sliders, you should try looking for modern libraries that are distributed as modules and have TypeScript typings.</span></span> <span data-ttu-id="a20bc-254">Так вам будет легче внедрить компонент в решение.</span><span class="sxs-lookup"><span data-stu-id="a20bc-254">This makes it easier for you to integrate the component in your solution.</span></span>

<span data-ttu-id="a20bc-255">Невозможно однозначно сказать, какой компонент лучше всего подходит для того или иного сценария, но SharePoint Framework поддерживает все наиболее популярные сценарии, и вы сможете преобразовать существующие клиентские настройки в полноценные решения SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="a20bc-255">While there is no single answer which component is the best to use for which scenario, the SharePoint Framework is flexible enough to accommodate most popular scenarios and you should be able to transform your existing client-side customizations into fully-featured SharePoint Framework solutions.</span></span>

### <a name="migration-tips"></a><span data-ttu-id="a20bc-256">Советы по миграции</span><span class="sxs-lookup"><span data-stu-id="a20bc-256">Migration tips</span></span>

<span data-ttu-id="a20bc-257">Существует несколько общих шаблонов преобразования настроек на основе веб-части редактора скриптов в решения SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="a20bc-257">When transforming existing Script Editor Web Part customizations to the SharePoint Framework there are a few common patterns.</span></span>

#### <a name="move-existing-code-to-sharepoint-framework"></a><span data-ttu-id="a20bc-258">Перемещение существующего кода в SharePoint Framework</span><span class="sxs-lookup"><span data-stu-id="a20bc-258">Move existing code to SharePoint Framework</span></span>

<span data-ttu-id="a20bc-259">Модификации SharePoint, созданные с помощью веб-части редактора скриптов, обычно состоят из разметки HTML, включенной в веб-часть, и одной или нескольких ссылок на файлы JavaScript.</span><span class="sxs-lookup"><span data-stu-id="a20bc-259">SharePoint customizations built using the Script Editor Web Part often consist of some HTML markup, included in the web part, and one or more references to JavaScript files.</span></span> <span data-ttu-id="a20bc-260">При преобразовании существующих модификаций в решение SharePoint Framework, скорее всего, потребуется переместить разметку HTML из веб-части "Редактор скриптов" в метод **render** клиентской веб-части SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="a20bc-260">When transforming your existing customization to a SharePoint Framework solution, the HTML markup from the Script Editor Web Part would most likely have to be moved to the **render** method of the SharePoint Framework client-side web part.</span></span> <span data-ttu-id="a20bc-261">Ссылки на внешние скрипты будут заменены ссылками в свойстве **externals** из файла **config.json**.</span><span class="sxs-lookup"><span data-stu-id="a20bc-261">References to external scripts would be changed to references in the **externals** property in the **config.json** file.</span></span> <span data-ttu-id="a20bc-262">Необходимо скопировать внутренние скрипты в исходную папку веб-части, а затем сослаться на них из класса веб-части с помощью операторов **require()**.</span><span class="sxs-lookup"><span data-stu-id="a20bc-262">Internal scripts would be copied to the web part source folder and referenced from the web part class using **require()** statements.</span></span>

#### <a name="reference-functions-from-script-files"></a><span data-ttu-id="a20bc-263">Ссылки на функции в файлах скриптов</span><span class="sxs-lookup"><span data-stu-id="a20bc-263">Reference functions from script files</span></span>

<span data-ttu-id="a20bc-264">Чтобы ссылаться на функции из файлов скриптов, необходимо определить эти функции как экспортированные.</span><span class="sxs-lookup"><span data-stu-id="a20bc-264">To reference functions from script files, these functions need to be defined as an export.</span></span> <span data-ttu-id="a20bc-265">Допустим, у вас есть файл JavaScript, который вы хотите использовать в клиентской веб-части SharePoint Framework:</span><span class="sxs-lookup"><span data-stu-id="a20bc-265">In order to reference functions from script files, these functions need to be defined as an export. Consider an existing JavaScript file, that you would like to use in a SharePoint Framework client-side web part:</span></span>

```js
var greeting = function() {
  alert('How are you doing?');
  return false;
}
```

<span data-ttu-id="a20bc-266">Чтобы иметь возможность вызвать функцию **greeting** из класса веб-части, необходимо изменить содержимое файла JavaScript на следующее:</span><span class="sxs-lookup"><span data-stu-id="a20bc-266">In order to be able to call the **greeting** function from the web part class, you would need to change the JavaScript file to:</span></span>

```js
var greeting = function() {  
  alert('How are you doing?');
  return false;
}

module.exports = {  
  greeting: greeting
};
```

<span data-ttu-id="a20bc-267">Затем вы сможете сослаться на скрипт в классе веб-части и вызвать функцию **greeting**:</span><span class="sxs-lookup"><span data-stu-id="a20bc-267">Then, in the web part class you can refer to the script and call the **greeting** function:</span></span>

```ts
public render(): void {  
  this.domElement.innerHTML = `
    <input type="button" value="Click me"/>`;

  const myScript = require('./my-script.js');
  this.domElement.querySelector('input').addEventListener('click', myScript.greeting);
}
```

#### <a name="execute-ajax-calls"></a><span data-ttu-id="a20bc-268">Выполнение вызовов AJAX</span><span class="sxs-lookup"><span data-stu-id="a20bc-268">Execute AJAX calls</span></span>

<span data-ttu-id="a20bc-269">Многие клиентские настройки используют библиотеку jQuery для выполнения запросов AJAX из-за ее простоты и совместимости с разными браузерами.</span><span class="sxs-lookup"><span data-stu-id="a20bc-269">Many client-side customizations use jQuery for executing AJAX requests for its simplicity and cross-browser compatibility.</span></span> <span data-ttu-id="a20bc-270">Если вы используете jQuery только из-за этого, то вы можете совершать вызовы AJAX с помощью стандартного клиента HTTP, входящего в состав SharePoint Framework.</span><span class="sxs-lookup"><span data-stu-id="a20bc-270">If this is all that you're using jQuery for, you can execute the AJAX calls using the standard HTTP client provided with the SharePoint Framework.</span></span> 

<span data-ttu-id="a20bc-271">В SharePoint Framework есть два клиента HTTP: [SPHttpClient](https://docs.microsoft.com/ru-RU/javascript/api/sp-application-base), предназначенный для отправки запросов REST API SharePoint, и [HttpClient](https://docs.microsoft.com/ru-RU/javascript/api/sp-application-base), предназначенный для отправки веб-запросов других REST API.</span><span class="sxs-lookup"><span data-stu-id="a20bc-271">SharePoint Framework offers you two types of HTTP client: the [SPHttpClient](https://docs.microsoft.com/ru-RU/javascript/api/sp-application-base), meant for executing requests to the SharePoint REST API, and the [HttpClient](https://docs.microsoft.com/ru-RU/javascript/api/sp-application-base) designed for issuing web requests to other REST APIs.</span></span> <span data-ttu-id="a20bc-272">Вот как выполнить вызов, используя SPHttpClient для получения заголовка текущего сайта SharePoint:</span><span class="sxs-lookup"><span data-stu-id="a20bc-272">Here is how you would execute a call using the SPHttpClient to get the title of the current SharePoint site:</span></span>

```ts
this.context.spHttpClient.get(`${this.context.pageContext.web.absoluteUrl}/_api/web?$select=Title`,
SPHttpClient.configurations.v1,
{
  headers: {
    'Accept': 'application/json;odata=nometadata',
    'odata-version': ''
  }
})
.then((response: SPHttpClientResponse): Promise<{Title: string}> => {
  return response.json();
})
.then((web: {Title: string}): void => {
  // web.Title
}, (error: any): void => {
  // error
});
```

## <a name="see-also"></a><span data-ttu-id="a20bc-273">См. также</span><span class="sxs-lookup"><span data-stu-id="a20bc-273">See also</span></span>

- [<span data-ttu-id="a20bc-274">Перенос настроек SharePoint с использованием JavaScript в SharePoint Framework: ссылки на функции в файлах скриптов</span><span class="sxs-lookup"><span data-stu-id="a20bc-274">Migrate SharePoint JavaScript customizations to SharePoint Framework - reference functions from script files</span></span>](https://blog.mastykarz.nl/migrate-sharepoint-javascript-customizations-sharepoint-framework-reference-functions/)
- [<span data-ttu-id="a20bc-275">Перенос настроек SharePoint на JavaScript в SharePoint Framework: вызовы AJAX и отображение данных с помощью jQuery</span><span class="sxs-lookup"><span data-stu-id="a20bc-275">Migrate SharePoint JavaScript customizations to SharePoint Framework – jQuery AJAX calls and showing data</span></span>](https://rencore.com/blog/migrate-sharepoint-javascript-customizations-to-sharepoint-framework-jquery-ajax-calls-and-showing-data/)
