---
title: "Интеграция свойств веб-части в SharePoint"
description: "Используйте возможности, упрощающие управление значениями свойств веб-части, и интегрируйте их со службой поиска SharePoint при создании клиентских веб-частей SharePoint Framework."
ms.date: 01/10/2018
ms.prod: sharepoint
ms.openlocfilehash: 381ccc6862088e9388df61283175c12835781ccb
ms.sourcegitcommit: 1f1044e59d987d878bb8bc403413e3090234ad44
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2018
---
# <a name="integrate-web-part-properties-with-sharepoint"></a>Интеграция свойств веб-части с SharePoint

При создании классических веб-частей их свойства изолировались от SharePoint, а их значениями управляли пользователи. SharePoint Framework включает новые возможности, упрощающие управление значениями свойств веб-части и их интеграцию со службой поиска SharePoint. В этой статье описано, как использовать эти возможности при создании клиентских веб-частей SharePoint Framework.

> [!IMPORTANT] 
> Приведенное ниже руководство относится только к клиентским веб-частям SharePoint Framework, размещенным на современных страницах SharePoint. Возможности, описанные в этой статье, не поддерживаются в классических веб-частях и клиентских веб-частях SharePoint Framework, размещенных на классических страницах.

## <a name="client-side-web-part-properties"></a>Свойства клиентских веб-частей

При создании клиентских веб-частей SharePoint Framework можно определять свойства, настраиваемые пользователями. Благодаря тому, что вместо фиксированных значений используются свойства, веб-части более универсальны.

Обработка свойств веб-частей в SharePoint Framework реализована несколько иначе, чем в классических веб-частях. На приведенной ниже схеме показано, как значения свойств веб-части проходят через разные уровни SharePoint.

![Схема, иллюстрирующая обработку свойств веб-части SharePoint Framework](../../../images/integrate-webpart-properties-schema.png)

<br/>

Прежде чем принимать от пользователей значения свойств веб-части, всегда следует [проверять их](./validate-web-part-property-values.md). Это не только позволяет обеспечить удобство работы с веб-частями, но и помогает избежать хранения недопустимых данных в конфигурации веб-части. 

Кроме того, следует учитывать, что SharePoint Framework не поддерживает персонализацию, поэтому все пользователи видят одну и ту же конфигурацию определенной веб-части.

## <a name="specify-web-part-property-value-type"></a>Указание типа значения свойства веб-части

В классических веб-частях SharePoint значения свойств были изолированы от SharePoint. Если свойство веб-части содержало URL-адрес файла, хранящегося в SharePoint, при его перемещении или переименовании этот URL-адрес приходилось обновлять вручную. Кроме того, служба поиска SharePoint не индексировала вводимый пользователями текст, который отображался в веб-части.

При создании веб-частей на платформе SharePoint Framework можно указать тип значения, хранящегося в том или ином свойстве веб-части. Эта конфигурация определяет, как SharePoint будет обрабатывать значение. В зависимости от заданной конфигурации, SharePoint может включать значение определенного свойства в индекс поиска, удалять небезопасный код HTML и даже обновлять ссылки на хранящиеся в SharePoint документы в случае их перемещения или переименования.

Чтобы указать конфигурацию для свойств веб-части, в классе веб-части переопределите метод получения **propertiesMetadata**:

```ts
import {
  BaseClientSideWebPart,
  IPropertyPaneConfiguration,
  PropertyPaneTextField,
  IWebPartPropertiesMetadata
} from '@microsoft/sp-webpart-base';

// ...

export default class ArticleLinkWebPart extends BaseClientSideWebPart<IArticleLinkWebPartProps> {
  // ...
  protected get propertiesMetadata(): IWebPartPropertiesMetadata {
    return {
      'title': { isSearchablePlainText: true },
      'intro': { isHtmlString: true },
      'image': { isImageSource: true },
      'url': { isLink: true }
    };
  }
  // ...
}
```

Метод **propertiesMetadata** возвращает объект, свойство которого (строка) указывает имя свойства веб-части, а значение (объект) указывает способ обработки этого свойства. 

При переопределении метода **propertiesMetadata** не нужно указывать все свойства веб-части. По умолчанию SharePoint не обрабатывает значения свойств веб-части. Следует включать только те свойства, которые требуется обработать.

Ниже приведен список возможных значений, которые можно задать в метаданных свойств, и их влияние на то, как значение свойства веб-части обрабатывается SharePoint.

<br/>

Значение метаданных|Возможность поиска|Привязка ссылок|Удаление небезопасного HTML-кода
--------------|:--------:|:--------:|:----------------:
нет (по умолчанию)|нет|нет|нет
`isSearchablePlainText`|да|нет|нет
`isHtmlString`|да|да|да
`isImageSource`|да|да|нет
`isLink`|да|да|нет

<br/>

> [!IMPORTANT] 
> Определяя конфигурацию для свойств веб-части, для каждого свойства веб-части следует использовать только одно из указанных в таблице свойств. Указание нескольких свойств зачастую приводит к нежелательным результатом, и этого следует избегать.

По умолчанию значение свойства веб-части не индексируется службой поиска SharePoint и не обрабатывается SharePoint. Оно передается в веб-часть в том же виде, в котором его ввел пользователь, настраивающий веб-часть.

Если для свойства веб-части задан параметр `isSearchablePlainText`, оно будет включено в полнотекстовый индекс. Когда пользователи ищут ключевые слова, включенные в значение этого свойства, служба поиска SharePoint возвращает страницу с веб-частью в результатах поиска. Если значение содержит ссылку на хранящийся в SharePoint документ, то эта ссылка не будет обновлена при его перемещении или переименовании. Кроме того, весь введенный пользователями HTML-код остается без изменений. Работая со значением такого свойства, следует рассматривать его как обычный текст и экранировать вводимый пользователями HTML-код во избежание внедрения сценариев.

Если для свойства веб-части задан параметр `isHtmlString`, SharePoint сначала удаляет весь небезопасный HTML-код (например, теги `script`) из значения свойства. Оставшийся HTML-код можно считать пригодным для отображения на странице. Если значение содержит URL-адреса, указывающие на файлы, которые хранятся в SharePoint, то после переименования или перемещения одного из этих файлов SharePoint автоматически обновляет URL-адрес, хранящийся в свойстве веб-части. Это значительно упрощает управление URL-адресами во всех веб-частях и страницах в клиенте. Свойства веб-части в формате HTML также доступны для поиска, поэтому пользователи могут искать любые ключевые слова, включенные в значение свойства.

Типы `isImageSource` и `isLink` предназначены для свойств веб-частей, содержащих только ссылку на изображение или файл, хранящийся в SharePoint. В обоих случаях служба поиска SharePoint включает содержимое в полнотекстовый индекс и обновляет указанный URL-адрес в случае переименования или перемещения файла. Кроме того, может выполняться дополнительная обработка для ускорения загрузки изображений. Если на странице есть изображение заголовка, являющееся одним из первых пяти изображений на странице или находящееся в первых двух ее строках, то оно загружается заранее.
