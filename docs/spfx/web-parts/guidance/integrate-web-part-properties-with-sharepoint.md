---
title: "Интеграция свойств веб-части в SharePoint"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: b21a56e28143e798459bb319a31f9690716d5465
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="integrate-web-part-properties-with-sharepoint"></a>Интеграция свойств веб-части в SharePoint

В классических веб-частях свойства были изолированы от SharePoint, а их значениями управляли конечные пользователи. В SharePoint Framework есть ряд возможностей, которые упрощают управление этими значениями и интегрируют их со службой поиска SharePoint. В этой статье описано, как использовать эти возможности при создании клиентских веб-частей SharePoint Framework.

> **Внимание!** Следующее руководство относится только к клиентским веб-частям SharePoint Framework, размещенным на современных страницах SharePoint. Возможности, описанные в этой статье, не относятся к классическим веб-частям и клиентским веб-частям SharePoint Framework, размещенным на классических страницах.

## <a name="client-side-web-part-properties"></a>Свойства клиентских веб-частей

При создании клиентских веб-частей SharePoint Framework можно определять свойства, настраиваемые пользователями. Благодаря тому, что вместо фиксированных значений используются свойства, веб-части более универсальны.

Обработка свойств веб-частей SharePoint Framework и классических веб-частей отличается. На следующей схеме показаны значения свойств веб-части на различных уровнях SharePoint.

![Схема, иллюстрирующая обработку свойств веб-части SharePoint Framework](../../../images/integrate-webpart-properties-schema.png)

Всегда [проверяйте](./validate-web-part-property-values.md) значения свойств веб-части от конечных пользователей. Это не только позволит обеспечить ее удобство для пользователей, но и поможет предотвратить хранение недопустимых данных в ее конфигурации. Кроме того, следует учитывать, что SharePoint Framework не поддерживает персонализацию и все пользователи видят одну и ту же конфигурацию веб-части.

## <a name="specify-web-part-property-value-type"></a>Указание типа значения свойства веб-части

В классических веб-частях SharePoint значения свойств были изолированы от SharePoint. Если свойство веб-части содержало URL-адрес файла, хранящегося в SharePoint, при его перемещении или переименовании этот URL-адрес приходилось обновлять вручную. Кроме того, служба поиска SharePoint не индексировала вводимый пользователями текст, который отображался в веб-части.

При создании веб-частей SharePoint Framework позволяет указывать тип значения для конкретного свойства веб-части. Эта конфигурация определяет то, как SharePoint обрабатывает значение. В зависимости от указанной конфигурации SharePoint может включать значение конкретного свойства в индекс поиска, удалять небезопасный HTML-код и даже обновлять ссылки на хранящиеся в SharePoint документы при их перемещении или переименовании.

Чтобы указать конфигурацию для свойств веб-части, в классе веб-части переопределите метод получения **propertiesMetadata**:

```ts
import {
  BaseClientSideWebPart,
  IPropertyPaneConfiguration,
  PropertyPaneTextField,
  IWebPartPropertiesMetadata
} from '@microsoft/sp-webpart-base';

// ...

export default class ArticleLinkWebPart extends BaseClientSideWebPart<IArticleLinkWebPartProps> {
  // ...
  protected get propertiesMetadata(): IWebPartPropertiesMetadata {
    return {
      'title': { isSearchablePlainText: true },
      'intro': { isHtmlString: true },
      'image': { isImageSource: true },
      'url': { isLink: true }
    };
  }
  // ...
}
```

Метод **propertiesMetadata** возвращает объект, в котором свойство — строка, определяющая имя свойства веб-части, а значение — объект, определяющий способ обработки этого свойства SharePoint. При переопределении метода **propertiesMetadata** не нужно перечислять все свойства веб-части. По умолчанию значения свойств веб-части не обрабатываются SharePoint, поэтому включайте только нужные свойства.

Ниже приведен список возможных значений, которые можно задать в метаданных свойств, и их влияние на то, как значение свойства веб-части обрабатывается SharePoint.

Значение метаданных|Возможность поиска|Привязка ссылок|Удаление небезопасного HTML-кода
--------------|:--------:|:--------:|:----------------:
нет (по умолчанию)|нет|нет|нет
`isSearchablePlainText`|да|нет|нет
`isHtmlString`|да|да|да
`isImageSource`|да|да|нет
`isLink`|да|да|нет

> **Внимание!** При определении конфигурации для свойств веб-части следует использовать только одно из упомянутых выше свойств для каждого свойства веб-части. Не задавайте несколько свойств, так как это, скорее всего, приведет к нежелательным результатам.

По умолчанию значение свойства веб-части не индексируется службой поиска SharePoint и не обрабатывается SharePoint. Оно передается в веб-часть в том же виде, в котором его ввел пользователь, настраивающий веб-часть.

Если свойство веб-части указано как `isSearchablePlainText`, оно включается в полнотекстовый индекс. При поиске ключевых слов, включенных в значение этого свойства, служба поиска SharePoint возвращает страницу с веб-частью. Если значение содержит ссылку на документ, хранящийся в SharePoint, эта ссылка не обновляется при его перемещении или переименовании. Кроме того, введенный пользователями HTML-код не удаляется. При работе со значением такого свойства рассматривайте его как обычный текст и экранируйте вводимый пользователями HTML-код, прежде чем отображать его на странице, чтобы избежать внедрения сценария.

Если свойство веб-части определено как `isHtmlString`, SharePoint прежде всего удаляет небезопасный HTML-код, такой как теги `script`, из значения свойства. Оставшийся HTML-код можно считать безопасным для отображения на странице. Если значение содержит URL-адреса, указывающие на файлы, хранящиеся в SharePoint, при их переименовании или перемещении SharePoint автоматически обновляет URL-адрес, хранящийся в свойстве веб-части. Это значительно упрощает управление URL-адресами во всех веб-частях и страницах в клиенте. Свойства веб-части HTML также доступны для поиска, поэтому пользователи могут искать любые ключевые слова, включенные в значение свойства.

Используйте типы значений свойств `isImageSource` и `isLink` для свойств веб-частей, которые включают только ссылку на изображение или файл, хранящийся в SharePoint. В обоих случаях служба поиска SharePoint включает контент в полнотекстовый индекс и обновляет указанный URL-адрес при переименовании или перемещении файла. Кроме того, источники изображений могут обрабатываться дополнительно, чтобы ускорить скачивание изображений. Заглавное изображение, первые 5 изображений и изображения в первых двух строках на странице загружаются заранее.
