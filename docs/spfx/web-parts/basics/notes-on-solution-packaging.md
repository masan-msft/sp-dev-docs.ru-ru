# <a name="notes-on-solution-packaging"></a>Примечания по упаковке решений

Задача gulp **package-solution** проверяет файл **/config/package-solution.json** на наличие различных сведений конфигурации, включая некоторые универсальные пути к файлам и определения связей между компонентами (_WebParts_ & _Applications_) в пакете.

## <a name="configuration-file"></a>Файл конфигурации

Схема файла конфигурации выглядит следующим образом:

```javascript
interface IPackageSolutionOptions {
  paths?: IPackageSolutionPathOptions;
  solution: ISolution;
}
```

Каждый файл конфигурации пакета содержит необязательные параметры, с помощью которых можно переопределить места, в которых задача будет искать различные исходные файлы и манифесты, а также определить расположение для записи пакета. Кроме того, такие файлы содержат обязательное определение решения, которое сообщает упаковщику о связях между различными компонентами.

### <a name="solution-definition-isolution"></a>Определение решения (_ISolution_)

```javascript
interface ISolution {
  name: string;
  id: string;
  version?: string;
  features?: IFeature[];
}
```

Каждый файл решения должен содержать свойство **name**, идентифицирующее пакет в пользовательском интерфейсе SharePoint. Кроме того, каждый пакет должен содержать глобальный уникальный идентификатор (**id**), который используется в SharePoint. При необходимости вы также можете указать номер версии (**version**) в формате X.X.X.X, который используется для идентификации различных версий пакета при обновлении.

Кроме того, определение решения может включать список определений компонентов SharePoint. **Примечание.** Если он не указан или пуст, задача создает по одному компоненту для каждого элемента (сопоставление 1:1).

### <a name="feature-definition-ifeature"></a>Определение компонента (_IFeature_)

```javascript
interface IFeature {
  title: string;
  description: string;
  id: string;
  version?: string;
  componentIds?: string[];
}
```

Важно помнить, что это определение для создания компонента SharePoint, и некоторые из этих параметров будут отображаться в пользовательском интерфейсе. Как и у решений, у каждого компонента есть обязательные свойства **title**, **description**, **id** и **version** (в формате X.X.X.X). Обратите внимание, что свойство **id** компонента должно быть глобальным уникальным идентификатором.

Каждый компонент также может содержать любое количество элементов, которые будут активироваться вместе с этим компонентом. Они определяются в списке **componentIds** — глобальных уникальных идентификаторов, которые **ДОЛЖНЫ** совпадать со свойством **ID** в файле манифеста элемента. Если этот список не определен или пуст, упаковщик включит в компонент **все** элементы.

### <a name="file-paths-ipackagesolutionpathoptions"></a>Пути к файлам (_IPackageSolutionPathOptions_)

```javascript
interface IPackageSolutionPathOptions {
  rawPackageDir: string;
  zippedPackage: string;
  featureXmlDir: string;
}
```

* **rawPackageDir** — это каталог, в который будут записаны распакованные файлы пакетов.
* **zippedPackage** — это имя сжатого пакета с расширением (SPAPP).
* **featureXmlDir** — это каталог, в котором находится XML-файл пользовательского компонента.

### <a name="examples"></a>Примеры

#### <a name="default-configuration"></a>Конфигурация по умолчанию

```json
{
  "paths": {
    "rawPackageDir": "./sharepoint/solution/debug",
    "zippedPackage": "ClientSolution.spapp",
    "featureXmlDir": "./sharepoint/feature_xml"
  },
  "solution": {
    "name": "A Sample Solution",
    "id": "00000000-0000-0000-0000-000000000000",
    "version": "1.0.0.0"
  }
}
```

### <a name="custom-featurexml"></a>Пользовательский файл Feature.xml

Чтобы обеспечить поддержку подготовки различных ресурсов SharePoint (например, шаблонов списков, страниц или типов контента), в пакет можно внедрить пользовательский XML-файл компонента. Он используется для подготовки ресурсов, необходимых приложениям, но его также можно использовать для веб-частей. Документация по XML-файлам компонентов представлена [в этой статье](https://msdn.microsoft.com/en-us/library/office/ms475601.aspx?f=255&MSPPError=-2147217396).

По умолчанию задача упаковки ищет пользовательский XML-файл компонента в папке **./sharepoint/feature_xml**. Каждый файл из этой папки будет включен в окончательный пакет приложения. Однако задача использует содержимое папки _rels/, чтобы выяснить, какие пользовательские компоненты определены. В сущности, она предполагает, что каждый файл **XML.RELS** связан с одноименным файлом feature.xml на верхнем уровне папки **feature_xml/**, и добавляет связь с файлом **AppManifest.xml.rels**, включая этот компонент в пакет.