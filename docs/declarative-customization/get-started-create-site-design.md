---
title: "Приступая к созданию макетов и скриптов сайтов SharePoint"
description: "Узнайте, как приступить к созданию макетов и скриптов сайтов SharePoint, с помощью которых пользователи смогут создавать собственные сайты."
ms.date: 12/14/2017
ms.openlocfilehash: eddc4455695e014899b268456ee501e956639b98
ms.sourcegitcommit: db303a21b5f83c8c2f9c2028a271c9aae0ac0515
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2018
---
# <a name="get-started-creating-site-designs-and-site-scripts"></a>Приступая к созданию макетов и скриптов сайтов

> [!NOTE]
> Макеты и скрипты сайтов в настоящий момент пересматриваются и могут быть изменены. Сейчас они не поддерживаются для использования в рабочих средах.

Создавая макеты сайтов, вы можете предоставлять пользователям пригодные для повторного использования списки, темы, макеты, страницы или дополнительные действия, чтобы они могли быстро создавать сайты SharePoint с нужными им функциями. В этой статье описывается создание примера макета сайта, добавляющего список SharePoint для отслеживания заказов от клиентов. Затем мы создадим при помощи этого макета новый сайт SharePoint с настраиваемым списком.

В этой статье показано, как создавать скрипты и макеты сайтов с помощью командлетов PowerShell для SharePoint. Эти действия также можно выполнять с помощью интерфейсов REST API. На каждом этапе для справки представлены соответствующие вызовы REST.

## <a name="create-the-site-script-in-json"></a>Создание скрипта сайта в JSON

Макет сайта — это набор действий, которые SharePoint выполняет при создании сайта. Эти действия описывают изменения, применяемые к новому сайту, такие как создание списка или применение темы. Действия указываются в скрипте JSON. Скрипт JSON — это список всех выполняемых действий. При запуске скрипта SharePoint выполняет все действия в указанном порядке.

Каждое действие указывается значением verb в скрипте JSON. Кроме того, в действия могут быть вложены другие действия, также представляющие собой значения verb. В приведенном ниже коде JSON скрипт создает список с именем Customer Tracking, а затем вложенные действия задают описание и добавляют несколько полей, чтобы определить список.

1. Скачайте и установите [командную консоль SharePoint Online](https://www.microsoft.com/en-us/download/details.aspx?id=35588). Если у вас уже установлена консоль предыдущей версии, сначала удалите ее, а затем установите последнюю версию.
1. Подключитесь к клиенту SharePoint, следуя инструкциям в статье [Подключение к PowerShell в SharePoint Online]((https://technet.microsoft.com/ru-RU/library/fp161372.aspx)).
1. Создайте код JSON с описанием нового скрипта и назначьте его переменной, как показано в приведенном ниже фрагменте кода PowerShell.

 ```powershell
$site_script = @'
{
    "$schema": "schema.json",
        "actions": [
            {
                "verb": "createSPList",
                "listName": "Customer Tracking",
                "templateType": 100,
                "subactions": [
                    {
                        "verb": "SetDescription",
                        "description": "List of Customers and Orders"
                    },
                    {
                        "verb": "addSPField",
                        "fieldType": "Text",
                        "displayName": "Customer Name",
                        "isRequired": false,
                        "addToDefaultView": true
                    },
                    {
                        "verb": "addSPField",
                        "fieldType": "Number",
                        "displayName": "Requisition Total",
                        "addToDefaultView": true,
                        "isRequired": true
                    },
                    {
                        "verb": "addSPField",
                        "fieldType": "User",
                        "displayName": "Contact",
                        "addToDefaultView": true,
                        "isRequired": true
                    },
                    {
                        "verb": "addSPField",
                        "fieldType": "Note",
                        "displayName": "Meeting Notes",
                        "isRequired": false
                    }
                ]
            }
        ],
            "bindata": { },
    "version": 1
}
'@
```

Приведенный выше скрипт создаст список SharePoint с именем Customer Tracking. Он задаст описание, а также добавит в список четыре поля. Обратите внимание на то, что все они считаются действиями. Скрипты сайта ограничены 30 кумулятивными действиями (для одного или нескольких скриптов, которые могут быть вызваны в макете сайта).

## <a name="add-the-site-script"></a>Добавление скрипта сайта

Каждый скрипт сайта должен быть зарегистрирован в SharePoint, чтобы он был доступен. Добавьте новый макет сайта с помощью командлета **Add-SPOSiteScript**. В приведенном ниже примере показано, как добавить вышеописанный скрипт JSON.

```powershell
C:\> Add-SPOSiteScript -Title "Create customer tracking list" -Content $site_script -Description "Creates list for tracking customer contact information"
```

Результат выполнения командлета будет включать свойство **ID** добавленного скрипта. Запишите этот ИД, так как он потребуется позже, при создании макета сайта.

Для добавления скрипта сайта используется REST API **CreateSiteScript**.

## <a name="create-the-site-design"></a>Создание макета сайта

Теперь необходимо создать макет сайта. Он будет отображаться в раскрывающемся списке, когда пользователь создает сайт на основе одного из шаблонов. На нем может выполняться один или несколько уже добавленных скриптов.

- Выполните приведенный ниже командлет, чтобы добавить макет сайта. Замените \<ID\> на ИД добавленного вами скрипта сайта.

```powershell
C:\> Add-SPOSiteDesign -Title "Contoso customer tracking" -WebTemplate "64" -SiteScripts "<ID>" -Description "Tracks key customer data in a list"
```

Приведенный выше командлет создает макет сайта с именем Contoso customer tracking. Значение -WebTemplate указывает, с каким базовым шаблоном он будет связан. Значение 64 обозначает шаблон сайта группы, а значение 68 — шаблон сайта для общения.

В отклике JSON будет отображаться свойство **ID** нового макета сайта. Вы можете обновить или изменить макет сайта в последующих командлетах.

Для добавления макета сайта используется REST API **CreateSiteDesign**.

## <a name="use-the-new-site-design"></a>Использование нового макета сайта

Теперь, когда мы добавили скрипт и макет сайта, с их помощью можно создавать сайты.

1. Перейдите на домашнюю страницу сайта SharePoint, который используется для разработки.
1. Нажмите **Создать сайт**.
1. Выберите **Сайт группы**.
1. В раскрывающемся списке **Выберите оформление** щелкните свой макет сайта **Customer orders**.
1. В поле "Имя сайта" введите имя нового сайта — **Учет заказов от клиентов**.
1. Нажмите кнопку **Далее**.
1. Нажмите кнопку **Готово**.
1. В области будет показано, что применяется скрипт. По завершении нажмите **Просмотреть обновленный сайт**.
1. На странице появится настраиваемый список.
