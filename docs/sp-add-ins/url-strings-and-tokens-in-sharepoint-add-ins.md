---
title: Токены и строки URL-адресов в надстройках SharePoint
description: Узнайте, какие маркеры можно использовать в URL-адресах в надстройке SharePoint.
ms.date: 12/13/2017
ms.prod: sharepoint
ms.openlocfilehash: 90a389136ea775f3380529f8159a98e64cf5822a
ms.sourcegitcommit: 28690b54f1ef7c811d64393d2eaaff0a8635cc72
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2017
---
# <a name="url-strings-and-tokens-in-sharepoint-add-ins"></a>Токены и строки URL-адресов в надстройках SharePoint

> [!IMPORTANT]
> Общие сведения о составлении URL-адресов в SharePoint и использовании маркеров в этих URL-адресах см. в статье [URL-адреса и маркеры в SharePoint](../general-development/urls-and-tokens-in-sharepoint.md). В этой статье описываются маркеры, доступные в надстройках SharePoint.
 
В таблицах ниже перечислены маркеры, которые можно использовать в надстройках SharePoint.

Маркеры, перечисленные в таблицах в этом разделе, можно использовать в URL-адресах во множестве ситуаций при разработке надстроек SharePoint, например в дополнительных действиях и ссылках на пользовательские страницы. 

Некоторые из этих маркеров невозможно использовать в определенных контекстах. Для начальных страниц надстроек, дополнительных действий на хост-сайтах и свойства **Src** веб-частей надстроек можно использовать только некоторые из доступных маркеров. Эти случаи вынесены в отдельные столбцы, *но они не представляют собой исчерпывающий список областей применения маркеров.*

В каждой таблице:
- в столбце **StartPage** указывается, можно ли использовать маркер в элементе **StartPage** манифеста надстройки; 
- в столбце **Дополнительное действие** указывается, можно ли использовать маркер в URL-адресе дополнительного действия на хост-сайте; 
- в столбце **Веб-часть надстройки** указывается, можно ли использовать маркер в свойстве **Src** веб-части надстройки.

## <a name="tokens-that-you-can-use-at-the-beginning-of-a-url"></a>Маркеры, которые можно использовать в начале URL-адреса

|**Маркер**|**Во что разрешается**|**StartPage**|**Дополнительное действие**|**Веб-часть надстройки**|**Замечания**|
|:-----|:-----|:-----|:-----|:-----|:-----|
|~appWebUrl|URL-адрес сайта надстройки для Надстройка SharePoint.|Да|Да|Да|Этот маркер должен использоваться только вне сайта надстройки. Внутри самого сайта надстройки используйте для его URL-адреса маркер **~site**.|
|~controlTemplates|URL-адрес виртуальной папки ControlTemplates для текущего веб-сайта.|Нет|Нет|Нет||
|~hostUrl|URL-адрес хост-сайта.|Нет|Нет|Да||
|~hostLogoUrl|URL-адрес логотипа хост-сайта.|Нет|Нет|Нет||
|~layouts|URL-адрес виртуальной папки Layouts для текущего веб-сайта.|Нет|Нет|Нет||
|~remoteAppUrl|URL-адрес удаленного веб-приложения в Надстройка SharePoint.|Да|Да для хост-сайтов. Нет для сайтов надстроек.|Да|Если при разработке надстройки SharePoint используется Инструменты разработчика Microsoft Office для Visual Studio, то **~remoteAppUrl** невозможно использовать в URL-адресах **StartPage**. Тем не менее, если используются Visual Studio и средства, то этот маркер можно использовать для всех размещаемых у поставщика надстроек, и он разрешается при упаковке надстройки средой Visual Studio. В этом случае он скорее является маркером Visual Studio, чем маркером SharePoint. Вне манифеста надстройки этот маркер можно использовать, даже если не используется Инструменты разработчика Microsoft Office для Visual Studio.  |
|~site|URL-адрес текущего веб-сайта.|Нет|Нет|Да||
|~sitecollection|URL-адрес родительского семейства сайтов для текущего веб-сайта.|Нет|Нет|Да||
Если не указано обратное, перечисленные в следующей таблице маркеры можно использовать в части  *path*  свойства веб-части надстройки **Src** . Столбец **Веб-часть надстройки** относится к их использованию в части значения *query string*  .
 

<br/> 

## <a name="tokens-that-you-can-use-inside-a-url"></a>Маркеры, которые можно использовать в URL-адресе

|**Маркер**|**Во что разрешается**|**StartPage**|**Дополнительное действие**|**Веб-часть надстройки**|**Замечания**|
|:-----|:-----|:-----|:-----|:-----|:-----|
|{AppContextToken}|Маркер контекста OAuth для надстройки.|Нет|Нет|Нет||
|{AppWebUrl}|URL-адрес сайта надстройки в Надстройка SharePoint.|Да|Да|Да|Этот маркер следует использовать только за пределами сайта надстройки.<br/>На самом сайте надстройки используйте для его URL-адреса маркер **{Site}**.|
|{ClientTag}|Контрольный номер кэша клиента (метка клиента) для текущего веб-сайта.|Да|Да|Да||
|{HostLogoUrl}|Эмблема для хост-сайта Надстройка SharePoint.|Да|Да|Да||
|{HostTitle}|Название хост-сайта Надстройка SharePoint.|Да|Да|Да||
|{HostUrl}|URL-адрес хост-сайта Надстройка SharePoint.|Да|Да|Да||
|{ItemId}|Идентификатор элемента в списке или библиотеке (целое значение).|Нет|Да|Нет||
|{ItemUrl}|URL-адрес элемента, с которым выполняется действие. |Нет|Да|Нет||
|{Language}|Текущий язык и региональные параметры хост-сайта Надстройка SharePoint.|Да|Да|Да||
|{ListId}|Идентификатор текущего списка (GUID).|Нет|Да|Нет||
|{ProductNumber}|Полный номер версии фермы SharePoint.|Да|Да|Да|Пример значения: "15.0.4433.1011".|
|{RecurrenceId}|Индекс повторения повторяющегося события.|Нет|Да|Нет|Этот маркер не поддерживается для контекстных меню элементов списков.|
|{RemoteAppUrl}|URL-адрес удаленного веб-приложения в Надстройка SharePoint.|Да|Да|Да||
|{Site}|URL-адрес текущего веб-сайта.|Нет|Да|Да||
|{SiteCollection}|URL-адрес родительского сайта для текущего веб-сайта.|Нет|Да|Да||
|{SiteUrl}|URL-адрес текущего веб-сайта.|Нет|Да|Нет||
|{Source}|URL-адрес HTTP-запроса.|Нет|Да|Нет||
|{StandardTokens}|См. раздел "Замечания".|Да|Да|Да|Этот маркер состоит из пяти других маркеров. Сначала он разрешается в... `SPHostUrl={HostUrl}&amp;SPAppWebUrl={AppWebUrl}&amp;SPLanguage={Language}&amp;SPClientTag={ClientTag}&amp;SPProductNumber={ProductNumber}` <br/><br/>..., а затем разрешается каждый из этих маркеров. Если сайт надстройки отсутствует, то нет и части `&amp;SPAppWebUrl={AppWebUrl}`.|

## <a name="see-also"></a>См. также
<a name="SP15URLstrings_bk_addlresources"> </a>

-  [Разработка надстроек SharePoint](develop-sharepoint-add-ins.md)
-  [Расширенная поддержка экстрасети](http://msdn.microsoft.com/library/21d67796-23c5-4339-8f0e-124208d21ab2%28Office.15%29.aspx)
-  [Получение ссылок на сайты, веб-приложения и другие ключевые объекты](http://msdn.microsoft.com/library/8623ef1d-e3cc-426c-84a3-6379e0ae284f%28Office.15%29.aspx)
-  [Работа с объектами List и коллекциями](http://msdn.microsoft.com/library/d4167b10-6f1e-49f1-8b22-16ce20012a27%28Office.15%29.aspx)
-  [Базовые задачи объектной модели](http://msdn.microsoft.com/library/94d6898d-6a0f-43a7-ad06-1b27ec6916ea%28Office.15%29.aspx)
    
 

