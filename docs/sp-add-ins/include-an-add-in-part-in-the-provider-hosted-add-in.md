---
title: "Добавление веб-части надстройки в надстройку, размещаемую у поставщика"
description: "Настройте внешний вид удаленной веб-формы на странице SharePoint в надстройке SharePoint, размещаемой у поставщика."
ms.date: 12/04/2017
ms.prod: sharepoint
ms.openlocfilehash: 7e2d4dcb69aa59a8909f36118579f6e7e55d6953
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="include-an-add-in-part-in-the-provider-hosted-add-in"></a><span data-ttu-id="93077-103">Добавление веб-части надстройки в надстройку с размещением у поставщика</span><span class="sxs-lookup"><span data-stu-id="93077-103">Include an add-in part in the provider-hosted add-in</span></span>

<span data-ttu-id="93077-104">Это шестая часть серии статей, посвященной основам разработки надстроек SharePoint, размещаемых у поставщика. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями этой серии, представленными в разделе [Знакомство с созданием надстроек SharePoint, размещаемых у поставщика](get-started-creating-provider-hosted-sharepoint-add-ins.md#SP15createprovider_nextsteps).</span><span class="sxs-lookup"><span data-stu-id="93077-104">This is the sixth in a series of articles about the basics of developing provider-hosted SharePoint Add-ins. You should first be familiar with [SharePoint Add-ins](sharepoint-add-ins.md) and the previous articles in this series:</span></span> 
    
> [!NOTE]
> <span data-ttu-id="93077-105">Если вы изучали предыдущие статьи этой серии о размещаемых у поставщика надстройках, то у вас уже есть решение Visual Studio, которое можно использовать для работы с данной статьей.</span><span class="sxs-lookup"><span data-stu-id="93077-105">If you have been working through this series about provider-hosted add-ins, you have a Visual Studio solution that you can use to continue with this topic.</span></span> <span data-ttu-id="93077-106">Кроме того, вы можете скачать репозиторий на веб-странице [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) и открыть файл BeforeAdd-inPart.sln.</span><span class="sxs-lookup"><span data-stu-id="93077-106">You can also download the repository at [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) and open the BeforeAdd-inPart.sln file.</span></span>

<span data-ttu-id="93077-107">В этой статье показано добавление веб-части особого типа, называемой веб-частью надстройки, в надстройку SharePoint.</span><span class="sxs-lookup"><span data-stu-id="93077-107">In this article, you add a special kind of Web Part called an add-in part to the SharePoint Add-in.</span></span> <span data-ttu-id="93077-108">Веб-часть надстройки предоставляет доступ к форме заказа надстройки на странице SharePoint.</span><span class="sxs-lookup"><span data-stu-id="93077-108">The add-in part exposes the add-in's order form on a SharePoint page.</span></span>

## <a name="create-the-add-in-part"></a><span data-ttu-id="93077-109">Создание веб-части надстройки</span><span class="sxs-lookup"><span data-stu-id="93077-109">Create the add-in part</span></span>

> [!NOTE]
> <span data-ttu-id="93077-110">Когда решение открывается повторно, для параметров раздела "Запускаемые проекты" в Visual Studio обычно возвращаются значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="93077-110">The settings for Startup Projects in Visual Studio tend to revert to defaults whenever the solution is reopened.</span></span> <span data-ttu-id="93077-111">После повторного открытия примера решения, который рассматривается в этой серии статей, всегда выполняйте указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="93077-111">Always take these steps immediately after reopening the sample solution in this series of articles:</span></span> 
> 1. <span data-ttu-id="93077-112">В верхней части **обозревателя решений** щелкните узел решения правой кнопкой мыши и выберите пункт **Назначить запускаемые проекты**.</span><span class="sxs-lookup"><span data-stu-id="93077-112">Right-click the solution node at the top of **Solution Explorer**, and then select **Set startup projects**.</span></span>  
> 2. <span data-ttu-id="93077-113">Убедитесь, что в столбце **Действие** для всех трех проектов указано значение **Запуск**.</span><span class="sxs-lookup"><span data-stu-id="93077-113">Ensure that all three projects are set to **Start** in the **Action** column.</span></span>

1. <span data-ttu-id="93077-114">В **обозревателе решений** щелкните правой кнопкой мыши проект **ChainStore** и выберите пункты **Добавить** > **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="93077-114">In **Solution Explorer**, right-click the **ChainStore** project, and then select **Add** > **New Item**.</span></span>
    
2. <span data-ttu-id="93077-115">Выберите **веб-часть клиента (хост-сайт)**, присвойте ей имя **Place Order** (Размещение заказа), а затем нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="93077-115">Select **Client Web Part (Host Web)**, give it the name **Place Order**, and then select **Add**.</span></span> <span data-ttu-id="93077-116">("Клиентская веб-часть" — это еще одно название веб-части надстройки.)</span><span class="sxs-lookup"><span data-stu-id="93077-116">("Client Web Part" is another name for "add-in part".)</span></span>
 
3. <span data-ttu-id="93077-117">На следующей странице мастера выберите второй вариант (**Выберите или введите URL-адрес существующей веб-страницы для контента клиентской веб-части**).</span><span class="sxs-lookup"><span data-stu-id="93077-117">On the next page of the wizard, select the second option: **Select or enter the URL of an existing web page for the client web part content**.</span></span>

4. <span data-ttu-id="93077-118">В раскрывающемся списке выберите URL-адрес для страницы **OrderForm.aspx**, а затем нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="93077-118">In the drop-down list, select the URL for the **OrderForm.aspx** page, and then select **Finish**.</span></span>
    
   <span data-ttu-id="93077-119">В проект будет добавлен файл elements.xml, в котором определяется веб-часть надстройки. Затем этот файл будет открыт.</span><span class="sxs-lookup"><span data-stu-id="93077-119">An elements.xml file that defines the add-in part is added to the project and opened.</span></span>
    
5. <span data-ttu-id="93077-120">В элементе **ClientWebPart** измените указанные ниже атрибуты на следующие значения:</span><span class="sxs-lookup"><span data-stu-id="93077-120">In the **ClientWebPart** element, change the following attributes to these values:</span></span>
   
    |<span data-ttu-id="93077-121">**Атрибут**</span><span class="sxs-lookup"><span data-stu-id="93077-121">**Attribute**</span></span>|<span data-ttu-id="93077-122">**Значение**</span><span class="sxs-lookup"><span data-stu-id="93077-122">**Value**</span></span>|
    |:-----|:-----|
    |<span data-ttu-id="93077-123">Название</span><span class="sxs-lookup"><span data-stu-id="93077-123">Title</span></span>|<span data-ttu-id="93077-124">Разместить заказ</span><span class="sxs-lookup"><span data-stu-id="93077-124">Place Order</span></span>|
    |<span data-ttu-id="93077-125">Описание</span><span class="sxs-lookup"><span data-stu-id="93077-125">Description</span></span>|<span data-ttu-id="93077-126">Форма размещения заказа</span><span class="sxs-lookup"><span data-stu-id="93077-126">Form to place an order</span></span>|
    |<span data-ttu-id="93077-127">DefaultHeight (Высота, используемая по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="93077-127">DefaultHeight</span></span>|<span data-ttu-id="93077-128">320</span><span class="sxs-lookup"><span data-stu-id="93077-128">320 px</span></span>|

    <span data-ttu-id="93077-129">Для других атрибутов оставьте значения, используемые по умолчанию, и закройте файл.</span><span class="sxs-lookup"><span data-stu-id="93077-129">Leave all the other attributes with their defaults and save the file.</span></span>
    
## <a name="run-the-add-in-and-test-the-add-in-part"></a><span data-ttu-id="93077-130">Запуск надстройки и тестирование веб-части надстройки</span><span class="sxs-lookup"><span data-stu-id="93077-130">Run the add-in and test the add-in part</span></span>

1. <span data-ttu-id="93077-131">Нажмите клавишу F5, чтобы развернуть и запустить надстройку.</span><span class="sxs-lookup"><span data-stu-id="93077-131">Use the F5 key to deploy and run your add-in.</span></span> <span data-ttu-id="93077-132">Редактор Visual Studio размещает удаленное веб-приложение в IIS Express, а базу данных SQL — в SQL Express.</span><span class="sxs-lookup"><span data-stu-id="93077-132">Visual Studio hosts the remote web application in IIS Express and hosts the SQL database in SQL Express.</span></span> <span data-ttu-id="93077-133">Кроме того, он выполняет временную установку надстройки на вашем тестовом сайте SharePoint и сразу же запускает ее.</span><span class="sxs-lookup"><span data-stu-id="93077-133">It also makes a temporary installation of the add-in on your test SharePoint site and immediately runs the add-in.</span></span> <span data-ttu-id="93077-134">Прежде чем откроется начальная страница надстройки, вам будет предложено предоставить надстройке необходимые разрешения.</span><span class="sxs-lookup"><span data-stu-id="93077-134">You are prompted to grant permissions to the add-in before its start page opens.</span></span>

2. <span data-ttu-id="93077-135">Когда откроется начальная страница надстройки, сама надстройка будет уже развернута, и пользователи смогут добавлять веб-часть надстройки **Place Order** (Размещение заказа) в любую область веб-частей на любой странице SharePoint веб-сайта магазина в Гонконге.</span><span class="sxs-lookup"><span data-stu-id="93077-135">When the add-in's start page opens, the add-in has been deployed, and the **Place Order** add-in part is available for users to add to any Web Part area on any SharePoint page on the Hong Kong store's website.</span></span> <span data-ttu-id="93077-136">Чтобы добавить ее на начальную страницу, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="93077-136">Follow these steps to add it to the home page:</span></span>
    
   1. <span data-ttu-id="93077-137">На расположенном в верхней части начальной страницы элементе управления хрома нажмите кнопку **Back to Site** (Вернуться на сайт). Откроется домашняя страница магазина в Гонконге.</span><span class="sxs-lookup"><span data-stu-id="93077-137">Select **Back to Site** on the chrome control at the top of the start page to open the home page of the Hong Kong store.</span></span>
   2. <span data-ttu-id="93077-138">На ленте откройте вкладку **Страница** и нажмите кнопку **Изменить**.</span><span class="sxs-lookup"><span data-stu-id="93077-138">On the ribbon, open the **Page** tab and select **Edit**.</span></span>
   3. <span data-ttu-id="93077-139">После перевода страницы в режим правки откройте вкладку **Вставка** на ленте и нажмите кнопку **Веб-часть надстройки** (она может по-прежнему называться **Веб-часть приложения**).</span><span class="sxs-lookup"><span data-stu-id="93077-139">After the page is in edit mode, open the **Insert** tab on the ribbon, and then select **Add-in Part** (the button may still be called **App Part**).</span></span>
   4. <span data-ttu-id="93077-140">В открывшемся элементе управления вставки веб-части выберите веб-часть надстройки **Размещение заказа**.</span><span class="sxs-lookup"><span data-stu-id="93077-140">On the Web Part insertion control that opens, select the **Place Order** add-in part.</span></span> <span data-ttu-id="93077-141">Элемент управления будет выглядеть примерно так, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="93077-141">The control looks similar to the following.</span></span>

      <span data-ttu-id="93077-142">*Рис. 1. Элемент управления вставки веб-части в SharePoint*</span><span class="sxs-lookup"><span data-stu-id="93077-142">*Figure 1. SharePoint's Web Part insertion control*</span></span>

      ![Элемент управления вставки веб-части SharePoint. Выделена веб-часть под названием "Place Order" (Размещение заказа). Ее имя и описание отображаются в поле справа.](../images/aae61f89-2e9e-4808-8b0c-2439dad7c701.PNG)

   5. <span data-ttu-id="93077-146">Щелкните какую-нибудь из зон веб-частей на форме. Это необходимо, чтобы задать расположение для веб-части надстройки.</span><span class="sxs-lookup"><span data-stu-id="93077-146">Select somewhere in one of the Web Part zones of the form to set the location where the add-in part will go.</span></span> 
   6. <span data-ttu-id="93077-147">На элементе управления вставки веб-части щелкните **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="93077-147">Select **Add** on the Web Part insertion control.</span></span> <span data-ttu-id="93077-148">Веб-часть надстройки **Place Order** (Размещение заказа) будет добавлена в зону веб-частей.</span><span class="sxs-lookup"><span data-stu-id="93077-148">The **Place Order** add-in part is added to the Web Part zone.</span></span>
   7. <span data-ttu-id="93077-149">На ленте нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="93077-149">On the ribbon, select **Save**.</span></span>
    
3. <span data-ttu-id="93077-150">Теперь форма заказа отображается на странице. У нее такие же внешний вид и удобство использования, как и у остальной части страницы.</span><span class="sxs-lookup"><span data-stu-id="93077-150">The order form now appears on the page, and it has the look-and-feel of the rest of the page.</span></span> <span data-ttu-id="93077-151">Форма должна выглядеть указанным ниже образом.</span><span class="sxs-lookup"><span data-stu-id="93077-151">It should look like the following.</span></span> 
    
   <span data-ttu-id="93077-152">*Рис. 2. Веб-часть надстройки Place Order (Размещение заказа)*</span><span class="sxs-lookup"><span data-stu-id="93077-152">*Figure 2. Place Order add-in part*</span></span>

   ![Веб-часть надстройки Place Order (Размещение заказа) на странице с текстовыми полями "Product" (Продукт), "Supplier" (Поставщик) и "Quantity" (Количество). Кроме того, на странице есть кнопка "Place Order" (Заказать).](../images/beae2e3c-c1f4-4334-8ab8-0c42252cb2a2.PNG)

4. <span data-ttu-id="93077-155">Введите значения для полей **Supplier** (Поставщик), **Product** (Продукт) и **Quantity** (Количество), а затем нажмите кнопку **Place Order** (Заказать).</span><span class="sxs-lookup"><span data-stu-id="93077-155">Enter values for **Supplier**, **Product**, and **Quantity**, and then select **Place Order**.</span></span> <span data-ttu-id="93077-156">На экране ничего не произойдет, но заказ будет введен в корпоративную базу данных.</span><span class="sxs-lookup"><span data-stu-id="93077-156">Nothing appears to happen, but an order is entered in the corporate database.</span></span> <span data-ttu-id="93077-157">При необходимости вы можете очистить поля веб-части надстройки, обновив страницу.</span><span class="sxs-lookup"><span data-stu-id="93077-157">Optionally, you can empty the fields of the add-in part by refreshing the page.</span></span>

5. <span data-ttu-id="93077-158">Нажимайте кнопку "Назад" в браузере, пока не вернетесь на начальную страницу надстройки Chain Store (Сетевой магазин), а затем нажмите кнопку **Show Orders** (Показать заказы).</span><span class="sxs-lookup"><span data-stu-id="93077-158">Use the browser's back button until you are back at the Chain Store add-in's start page, and then select **Show Orders**.</span></span> <span data-ttu-id="93077-159">В списке будет отображаться ваш новый заказ.</span><span class="sxs-lookup"><span data-stu-id="93077-159">Your new order is listed.</span></span>

6. <span data-ttu-id="93077-160">Чтобы завершить сеанс отладки, закройте окно браузера или остановите отладку в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="93077-160">To end the debugging session, close the browser window or stop debugging in Visual Studio.</span></span> <span data-ttu-id="93077-161">При каждом нажатии клавиши F5 Visual Studio отзывает предыдущую версию надстройки и устанавливает ее последнюю версию.</span><span class="sxs-lookup"><span data-stu-id="93077-161">Each time you select F5, Visual Studio retracts the previous version of the add-in and installs the latest one.</span></span>

7. <span data-ttu-id="93077-162">Вы будете работать с этой надстройкой и решением Visual Studio при изучении других статей, поэтому при перерывах в работе рекомендуем отзывать надстройку.</span><span class="sxs-lookup"><span data-stu-id="93077-162">You will work with this add-in and Visual Studio solution in other articles, and it's a good practice to retract the add-in one last time when you are done working with it for a while.</span></span> <span data-ttu-id="93077-163">В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Отозвать**.</span><span class="sxs-lookup"><span data-stu-id="93077-163">Right-click the project in **Solution Explorer** and select **Retract**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="93077-164">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="93077-164">Next steps</span></span>
<span data-ttu-id="93077-165"><a name="Nextsteps"> </a></span><span class="sxs-lookup"><span data-stu-id="93077-165"></span></span>

<span data-ttu-id="93077-166">Надстройка зависит от двух списков, которые вы создали вручную. Но вы наверняка не хотите, чтобы пользователи тоже делали это вручную.</span><span class="sxs-lookup"><span data-stu-id="93077-166">The add-in depends on two lists that you created manually; you don't want your users to have to do that.</span></span> <span data-ttu-id="93077-167">В следующей статье показано автоматическое создание этих списков.</span><span class="sxs-lookup"><span data-stu-id="93077-167">In the next article, you begin the process of automatically creating these lists.</span></span> <span data-ttu-id="93077-168">Первое основное действие — создать пользовательские обработчики для событий установки надстройки: [Обработка событий надстроек в надстройках, размещаемых у поставщика](handle-add-in-events-in-the-provider-hosted-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="93077-168">The first major step is to create custom handlers for the event of installing an add-in: [Handle add-in events in the provider-hosted add-in](handle-add-in-events-in-the-provider-hosted-add-in.md).</span></span>
 

 

