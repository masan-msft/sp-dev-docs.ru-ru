---
title: Изучение структуры манифеста приложения и пакета надстройки SharePoint
description: В этой статье рассказывается о структуре пакета надстройки и файле манифеста для надстройки SharePoint.
ms.date: 12/13/2017
ms.prod: sharepoint
ms.openlocfilehash: 2c0b55a052f642302dc27de301f83268938d692d
ms.sourcegitcommit: 28690b54f1ef7c811d64393d2eaaff0a8635cc72
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2017
---
# <a name="explore-the-app-manifest-structure-and-the-package-of-a-sharepoint-add-in"></a>Изучение структуры манифеста приложения и пакета надстройки SharePoint

<a name="Package"> </a>

## <a name="add-in-for-sharepoint-package-structure"></a>Структура пакета надстройки SharePoint

Пакет надстройки SharePoint — это файл с расширением APP, который соответствует стандарту [Open Packaging Conventions (OPC)](https://msdn.microsoft.com/ru-RU/library/windows/desktop/dd742818(v=vs.85).aspx). Панель инструментов поиска содержит перечисленные ниже элементы.

- **Манифест надстройки.** Это обязательный файл с именем appmanifest.xml. Он сообщает SharePoint некоторые важные свойства надстройки, такие как название и необходимые для запуска разрешения. Дополнительные сведения о содержимом этого файла см. в разделе [Файл манифеста надстройки SharePoint](#AppManifest).
    
 
- **Пакеты решений SharePoint.** Надстройка может дополнительно включать пакет решений SharePoint (WSP-файл), содержащий компоненты сайта надстройки. К последним могут относиться страницы, экземпляры списков, представления, документы, компоненты на уровне веб-сайта и другие компоненты SharePoint. (Дополнительные сведения о том, какие компоненты SharePoint можно включить в надстройку SharePoint, см. в разделе [Типы компонентов SharePoint, встречающиеся в надстройке SharePoint](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint.md#TypesOfSPComponentsInApps).) WSP-файл может также содержать надстройки Office. Компоненты WSP-файла разворачиваются на сайте надстройки. Пример пакета надстройки, включающего пакет решений SharePoint, приведен в статье [Создание надстройки с размещением у поставщика, которая включает пользовательский список SharePoint и тип контента](create-a-provider-hosted-add-in-that-includes-a-custom-sharepoint-list-and-conte.md).
    
 
- **Компоненты хост-сайта с дополнительными действиями или веб-частями надстройки.** Кроме компонентов SharePoint, которые разворачиваются на сайте надстройки, надстройка SharePoint может также разворачивать одно или несколько дополнительных действий (элементов контекстного меню или расширений ленты) на хост-сайте. Для этого в пакет надстройки включается компонент, не входящий в WSP-файл пакета и разворачивающий компоненты, которые попадут на хост-сайт. Этот "свободный" компонент называется компонентом хост-сайта. 

  Веб-части надстройки разворачиваются на хост-сайте таким же образом. Компонент хост-сайта состоит из стандартного файла SharePoint feature.xml и одного или нескольких связанных файлов elements.xml. Например, файл elements.xml для дополнительного действия содержит разметку **CustomAction** для этого действия. Он также может включать разметку для веб-частей надстройки. В компонент хост-сайта могут входить только компоненты этих двух видов. Такие компоненты хост-сайта не перечисляются в манифесте надстройки. Однако они являются "частями" в контексте OPC, и существует явное отношение OPC между манифестом надстройки и каждым из этих файлов. Пример пакета надстройки, в котором имеется компонент хост-сайта, можно найти в статье [Создание дополнительных действий для развертывания с надстройками SharePoint](create-custom-actions-to-deploy-with-sharepoint-add-ins.md).
    
    > [!NOTE] 
    > Администраторы клиента могут выполнять пакетную установку надстройки SharePoint на несколько веб-сайтов. Надстройка, установленная таким образом, называется надстройкой на уровне **клиента**. Если надстройка устанавливается не в пакетном режиме, а отдельно на каждый веб-сайт, то это надстройка на уровне **Web** (Интернет). Если компонент хост-сайта включает расширения ленты или веб-части надстройки, то при пакетной установке надстройки они не развертываются на хост-сайтах, так что только элементы контекстного меню развертываются с надстройками на уровне Tenant (Клиент). 
    
    > Уровень надстройки не следует путать с уровнем компонента. Уровень компонента определяет, где будут развернуты элементы компонента. Возможные уровни: **Farm** (Ферма), **WebApplication** (Веб-приложение), **Site** (Сайт, т. е. семейство веб-сайтов) и **Web** (Интернет). Для компонентов в надстройках SharePoint (и для компонентов хост-сайтов, и для компонентов в WSP-файле в пакете надстройки) разрешен только вариант **Web** (Интернет). 
    
    > Уровень надстройки относится к уровню, на котором установлена надстройка. Возможные уровни: **Web** (Интернет), когда надстройка установлена на одном или нескольких веб-сайтах по очереди, и **Tenant** (Клиент), когда надстройка установлена в пакетном режиме на несколько веб-сайтов в области клиента пользователя. 
    
    > Дополнительные сведения об уровнях **Tenant** (Клиент) и **Web** (Интернет) см. в статье [Области клиентов и области развертывания для надстроек SharePoint](tenancies-and-deployment-scopes-for-sharepoint-add-ins.md).

- **Файлы ресурсов (RESX-файлы) для локализации.** Это составляющие манифеста надстройки для локализации, которые включают название надстройки и составляющие компонентов хост-сайта в пакете надстройки. (Отдельные части пакета надстройки, находящиеся внутри собственных пакетов, такие как WSP-файлы, пакеты веб-сайтов Azure и манифесты надстроек, отличаются собственными процессами локализации, которые применяются точно так же, как если бы элементы, о которых идет речь, не входили в надстройку SharePoint.) Пример пакета надстройки, содержащего RESX-файлы для компонента хост-сайта, можно найти в статье [Локализация надстроек SharePoint](localize-sharepoint-add-ins.md).
    
 
- **Манифесты надстроек Office.** При необходимости пакет надстройки Office может включать один или несколько манифестов надстроек Office. Эту часть можно включить в пакет надстройки, только если надстройку планируется отправить в корпоративный каталог надстроек SharePoint, а не в общедоступный магазин. Дополнительные сведения см. в статье [Публикация надстроек SharePoint](publish-sharepoint-add-ins.md).
    
 
<a name="AppManifest"> </a>

## <a name="add-in-for-sharepoint-manifest-file"></a>Файл манифеста надстройки SharePoint


Каждая надстройка SharePoint включает файл appmanifest.xml. Файл appmanifest.xml сообщает SharePoint, что он должен знать о надстройке и задает наиболее важные свойства надстройки. Далее приводятся некоторые элементы, которые задаются в манифесте.

- Внутреннее имя, идентификатор продукта и версия надстройки.

- URL-адрес начальной страницы, которая открывается при запуске надстройки. Это может быть страница на сайте надстройки, страница в облаке или страница на веб-сервере независимого поставщика ПО.
    
    > [!NOTE] 
    > При определенных обстоятельствах могут накладываться ограничения, из-за которых в элементе **StartPage** можно указывать не все типы файлов.  Подробнее см. в статье [Элемент StartPage (complexType PropertiesDefinition, манифест надстройки SharePoint)](http://msdn.microsoft.com/library/3092674c-a6c3-9021-3d7e-e716562a4a4f%28Office.15%29.aspx). При объединении нескольких параметров запроса в значении **StartPage** необходимо использовать код амперсанда `&amp;amp;` вместо `&amp;` или точки с запятой, чтобы указать их вместе.

- Другие свойства надстройки. Сюда входит название и поддерживаемые надстройкой языки (оба параметра обязательные), URL-адреса служб, которые обрабатывают события после установки, после обновления и до удаления, и шаблон сайта, который должен использоваться при создании сайта надстройки.
    
- Запросы разрешений, необходимых надстройке для доступа к ресурсам SharePoint вне сайта надстройки.
    
- Идентификация субъекта надстройки в целях проверки подлинности и авторизации. Это субъект, который предоставляет разрешения. Для надстроек с размещением в SharePoint этот элемент не нужен.
 
- Список необходимых компонентов (при наличии), которые должны быть доступны для установки надстройки. Например, вам может потребоваться установить, лицензировать и активировать определенные компоненты или службы.

> [!NOTE] 
> Файл манифеста надстройки — единственный обязательный элемент в пакете надстройки, но не все элементы в списке выше должны обязательно входить в этот файл. 
 
Подробнее о разметке манифеста надстройки см. в статье [Справочник по схеме для манифестов надстроек SharePoint](http://msdn.microsoft.com/library/1f8c5d44-3b60-0bfe-9069-1df821220691%28Office.15%29.aspx). Эта статья не заменяет сведения из указанного статьи, в том числе информацию об обязательных элементах и атрибутах. Кроме того, обратите внимание, что схема манифестов надстроек SharePoint отличается от схемы манифестов надстроек Office. Дополнительные сведения можно найти в статье [Справка по схеме для манифестов надстроек Office (версия 1.1)](https://docs.microsoft.com/ru-RU/office/dev/add-ins/develop/add-in-manifests).
 
Далее приводится пример файла appmanifest.xml. Обратите внимание, что в этом примере начальной страницей надстройки является страница ASP.NET, находящаяся на удаленном сервере, а не страница сайта SharePoint. URL-адрес этой страницы включает строку запроса, которая передает в удаленное веб-приложение URL-адрес хост-сайта. Часть `{HostUrl}` строки является маркером, который разрешается при запуске надстройки. Надстройка запрашивает разрешение на запись во все списки на хост-сайте. Субъектом надстройки, которому необходимо предоставить это разрешение, является удаленное веб-приложение.

В манифесте надстройки вам необходимо использовать элемент **SupportedLocales** или **SupportedLanguages**. Элемент **SupportedLanguages** устарел и теперь заменяется элементом **SupportedLocales**. Элемент **SupportedLanguages** будет работать даже после выпуска, однако следует воздерживаться от его использования. Дополнительные сведения об этих элементах см. в статьях [Элемент SupportedLocales (complexType PropertiesDefinition, манифест надстройки SharePoint)](http://msdn.microsoft.com/library/49bde91a-8d7a-be17-4c91-82c9c19f0f61%28Office.15%29.aspx) и [Элемент SupportedLanguages (complexType PropertiesDefinition, манифест надстройки SharePoint)](http://msdn.microsoft.com/library/7a8da886-5731-9abd-2911-5cd268bba4cf%28Office.15%29.aspx).

> [!NOTE] 
> Значения атрибута **Scope** элемента **AppPermissionRequest** структурированы как универсальный код ресурса (URI), но фактически это строковые литералы. Ни одна часть значения **Scope** в примере ниже не является заполнителем. Дополнительные сведения о разрешениях см. в статье [Разрешения для надстроек SharePoint](add-in-permissions-in-sharepoint.md).

```XML
<?xml version="1.0" encoding="utf-8" ?>
<App xmlns="http://schemas.microsoft.com/sharepoint/2012/app/manifest"
     ProductID="{4a07f3bd-803d-45f2-a710-b9e944c3396e}"
     Version="1.0.0.0"
     SharePointMinVersion="15.0.0.0"
     Name="MySampleApp"
>
  <Properties>
    <Title>My Sample App</Title>
    <StartPage>http://MyRemoteWebApplicationServer/default.aspx/?SPHostUrl={HostUrl}</StartPage>
    <SupportedLocales>
      <SupportedLocale CultureName="en-US" />
    </SupportedLocales>        
  </Properties>

  <AppPermissionRequests>
    <AppPermissionRequest Scope="http://sharepoint/content/sitecollection/web/list" Right="Write"/>
  </AppPermissionRequests>

  <AppPrincipal>
    <RemoteWebApplication ClientId="1ee82b34-7c1b-471b-b27e-ff272accd564" />
  </AppPrincipal>
</App>

```

<br/>


### <a name="url-tokens-in-the-add-in-manifest"></a>Маркеры URL-адресов в манифесте надстройки

В SharePoint есть несколько маркеров, которые можно использовать в элементе **StartPage** и в других местах надстроек и их компонентов, чтобы представлять информацию, неизвестную до запуска надстройки. Инфраструктура SharePoint разрешает эти маркеры. Одни маркеры используются в начале URL-адреса, а другие можно использовать в URL-адресе в качестве значения параметра запроса. Эти маркеры и ряд других маркеров также можно использовать в различных контекстах разработки SharePoint. 

Подробные сведения обо всех этих маркерах и о том, где их можно использовать, см. в статье [Токены и строки URL-адресов в надстройках SharePoint](url-strings-and-tokens-in-sharepoint-add-ins.md). Общие сведения об остальных маркерах и URL-адресах в SharePoint см. в статье [URL-адреса и маркеры в SharePoint](http://msdn.microsoft.com/library/161418d7-8123-4c4e-91a1-97e43c17f0e6%28Office.15%29.aspx).
 
> [!NOTE] 
> Эти маркеры не используются в атрибуте **Scope** элемента **AppPermissionRequest**.
 


## <a name="see-also"></a>См. также
<a name="SP15Exploreappmanifest_bk_addlresources"> </a>

-  [Разработка надстроек SharePoint](develop-sharepoint-add-ins.md)
-  [Важные аспекты разработки и архитектуры надстроек SharePoint](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscap.md)
-  [Приложения уровня данных](http://msdn.microsoft.com/ru-RU/library/ee210546)
-  [Web Deploy 2.0](http://www.iis.net/download/WebDeploy)
    
 

