
# <a name="incident-manager-a-cloud-business-add-in-tutorial"></a>Диспетчер инцидентов: руководство по созданию облачной бизнес-надстройки
С помощью шаблона **Облачная бизнес-надстройка** в Visual Studio можно создать надстройку, размещаемую в SharePoint, в которой пользователи могут просматривать, добавлять и изменять данные из удаленных источников с помощью современных мобильных сенсорных устройств, например телефонов и планшетов. В этом учебнике показано, как создать надстройку для вымышленной противопожарной службы Contoso, предназначенную для управления текущими инцидентами. В пошаговом руководстве охвачены базовые концепции создания облачной бизнес-надстройки, а также более сложные концепции, например интеграция библиотек документов и списков SharePoint.
 
Вы можете скачать пример надстройки диспетчера инцидентов и связанные с ним файлы в коллекции примеров MSDN: [Диспетчер инцидентов: руководство по созданию облачной бизнес-надстройки](http://code.msdn.microsoft.com/Incident-Manager-A-Cloud-c32d9b04).
 

 **Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint#bk_newname).
 


## <a name="prerequisites"></a>Необходимые компоненты

Для работы с этим пошаговым руководством необходим Visual Studio 2013 с обновлением 1 и Инструменты разработчика Microsoft для Visual Studio 2013 с обновлением от марта 2014 г.
 

 
Для размещения надстройки вам также понадобится сайт разработчика SharePoint в Office 365, который вы можете получить на странице  [Регистрация на сайте разработчиков для Office 365](http://go.microsoft.com/fwlink/?LinkId=263490).
 

 

 **Примечание.** Вы также можете разместить облачную бизнес-надстройку на сайте SharePoint.
 


## <a name="create-the-incident-management-application"></a>Создание надстройки для управления инцидентами
<a name="add-in"> </a>

В сферу работы противопожарной службы Contoso входит ликвидация пожаров, неотложная медицинская помощь, дорожно-транспортные происшествия и другие аварийные случаи. Каждый такой случай требует значительной работы по документированию происшествия. Сейчас компания регистрирует информацию, заполняя бумажные бланки на месте происшествия, а по возвращении в часть вводит информацию в свою компьютерную систему. Недавно компания ввела систему SharePoint для Office 365 для управления записями и приобрела планшеты, чтобы позволить руководителю аварийно-спасательных работ вводить данные на месте происшествия.
 

 
Вы создадите мобильную надстройку, которая будет использоваться для ввода основных сведений о происшествии. Так как при многих происшествиях требуется медицинская помощь, в надстройке также необходимо предусмотреть возможность ввода данных для многих пострадавших при одном происшествии. Этот раздел покажет вам, как создать базовое приложение, попутно объясняя основы облачных бизнес-надстроек.
 

 

### <a name="to-create-a-project"></a>Создание проекта


1. В строке меню последовательно выберите пункты **Файл**, **Создать** и **Проект**.
    
    Откроется диалоговое окно **Создание проекта**.
    
 
2. В списке шаблонов разверните узел **Visual Basic** или **Visual C#**, затем узел **Office/SharePoint**, выберите узел **Надстройки**, а затем шаблон **Облачная бизнес-надстройка**, как показано на рис. 1.
    
    **Рис. 1. Шаблон облачной бизнес-надстройки**

 

  ![Шаблон облачной бизнес-надстройки](../../images/CBA_IM1.PNG)
 

 

 
3. В текстовом поле **Имя** введите IncidentManager (Диспетчер инцидентов) и нажмите кнопку **OK**.
    
    Откроется мастер **создания облачной бизнес-надстройки**.
    
 
4. В мастере **создания облачной бизнес-надстройки** введите URL-адрес вашего сайта разработчика Office 365 и нажмите кнопку **Готово**.
    
    URL-адрес должен принять следующий вид: https://_MySite_.sharepoint.com/sites/Developer/.
    
    Решение **IncidentManager** будет добавлено в обозреватель решений с четырьмя проектами: проект верхнего уровня **IncidentManager**, проект **IncidentManager.HTMLClient**, проект **IncidentManager.Server** и проект **IncidentManager.SharePoint**.
    
    
 

    
    На следующем этапе вы добавите сущность, представляющую набор происшествий. Сущность создает таблицу базы данных SQL Server, встроенную в надстройку. В ней будет храниться информация о каждом происшествии.
    
 

### <a name="to-add-the-incident-entity"></a>Добавление объекта Incident


1. На **начальном** экране выберите гиперссылку **Создать таблицу**.
    
    Откроется Entity Designer.
    
 
2. В окне **Свойства** в текстовом поле свойства **Имя** введите Incident (Инцидент).
    
 
3. В Entity Designer перейдите по ссылке **<Add Property>** и введите IncidentNumber (Номер инцидента).
    
 
4. Нажмите клавишу ВВОД. Пр этом будет выбран **тип**, используемый по умолчанию (**String**), и флажок **Обязательный** останется установленным.
    
 
5. В окне **Свойства** установите флажок **Включить в уникальный индекс**.
    
    У каждого инцидента должен быть уникальный номер.
    
 
6. Перейдите по ссылке **<Add Property>** и введите IncidentDate (Дата инцидента), а затем нажмите клавишу **TAB**.
    
 
7. В столбце **Тип** выберите **Дата**, а затем дважды нажмите клавишу TAB.
    
 
8. В столбце **Имя** введите DispatchTime (Время отправки), а в столбце **Тип** — тип данных **DateTime**.
    
 
9. В следующей строке введите IncidentType (Тип инцидента) и выберите тип данных **Integer**.
    
 
10. В следующей строке введите IncidentAddress (Адрес инцидента) и выберите тип данных **String**.
    
 
11. В следующей строке введите ReportingPartyName (Имя, лица сообщившего об инциденте) и выберите тип данных **String**, а затем снимите флажок **Обязательный**.
    
    Иногда сведения об инцидентах сообщаются анонимно, и вам не нужно требовать указывать значение в этом поле.
    
 
12. В следующей строке введите ReportingPhone (Телефон, с которого сообщили об инциденте) и выберите тип данных **PhoneNumber**.
    
     **Phone Number** — это пользовательский бизнес-тип, который автоматически форматирует и проверяет номера телефонов.
    
 
13. В окне **Свойства** щелкните гиперссылку **Форматы телефонных номеров**.
    
    Откроется диалоговое окно **Форматы телефонных номеров**.
    
 
14. В диалоговом окне **Форматы телефонных номеров** выберите соответствующий формат для своей локали, а затем нажмите кнопку **Вверх**, чтобы переместить его в верх списка.
    
 
15. В текстовом поле **Проверка тестового номера телефона** введите номер телефона и убедитесь, что он правильно отформатирован, а затем нажмите кнопку **Сохранить**.
    
    Бизнес-тип **Phone Number** выполняет форматирование и проверку на любом экране, на котором он появляется.
    
 
16. В следующей строке укажите IncidentCommander (Управляющий инцидентом) и выберите тип данных **Person**.
    
    Бизнес-тип **Person** осуществляет связь со службой профилей пользователей SharePoint, которая запрашивает информацию о пользователях из Active Directory.
    
    На рис. 2 показан завершенный объект.
    

    **Рис. 2. Объект Incidents**

 

  ![Объект Incident](../../images/CBA_IM_2.PNG)
 

    
 

    
    На следующем этапе вы добавите список вариантов выбора, позволяющий пользователям выбирать значения из фиксированного набора. В таком случае у противопожарной службы будет набор общих типов происшествий.
    
 

### <a name="to-add-a-list-of-choices"></a>Добавление списка значений


1. В Entity Designer выберите поле **IncidentType** (Тип инцидента), а затем в окне **Свойства** щелкните гиперссылку **Список значений**.
    
    Откроется диалоговое окно **Список значений**.
    
 
2. В диалоговом окне **Список значений** щелкните ссылку **Добавить значение** и введите 1.
    
 
3. В столбце **Отображаемое имя** введите **Fire - Commercial** (Коммерческая противопожарная служба).
    
 
4. Введите указанные ниже значения и отображаемые имена, а затем нажмите кнопку **ОК**.
    

|**Значение**|**Отображаемое имя**|
|:-----|:-----|
|2|Пожар помещения|
|3|Пожар один личный состав тушения|
|4| Медицинская помощь специализированная реаниматологическая помощь|
|5| Медицинская помощь первичные реанимационные мероприятия|
|6|Дорожно-транспортное происшествие|
|7|Вызов службы|
|||

При работе надстройки пользователю будет доступен список отображаемых имен. Когда пользователь выберет необходимый вариант, в базе данных сохранится соответствующее значение **Integer**.
    
На следующем этапе вы добавите сущность "Пострадавший". Многие из происшествий, которыми занимается противопожарная служба, требуют оказания медицинской помощи, и часто в одном происшествии есть несколько пострадавших.
    
 

### <a name="to-add-the-patient-entity"></a>Добавление объекта Patient


1. В **обозревателе решений** откройте контекстное меню для узла **Источники данных** и выберите пункт **Добавить таблицу**.
    
 
2. В окне **Свойства** в текстовом поле для свойства **Имя** введите Patient (Пострадавший).
    
 
3. В Entity Designer добавьте указанные ниже поля, как показано на рис. 3.
    
    **Рис. 3. Завершенный объект Patient**

 

  ![Объект Patient](../../images/CBA_IM_2a.PNG)
 

    
 

    
    На следующем этапе вы определите отношение между сущностями "Происшествие" и "Пострадавший". С происшествием может быть связано много пациентов.
    
 

### <a name="to-define-a-relationship"></a>Создание отношения


1. В **обозревателе решений** откройте контекстное меню для узла **Incidents.lsml** и нажмите кнопку **Открыть**.
    
 
2. На панели инструментов нажмите кнопку **Отношение**.
    
    Откроется диалоговое окно **Добавление нового отношения**.
    
 
3. В диалоговом окне **Добавление нового отношения** в столбце **К:** строки **Имя** выберите **Patient** (Пострадавший).
    
 
4. В строке **Кратность** в столбце **От:** выберите **Ноль или один**.
    
 
5. В столбце **К:** выберите **Много** и нажмите кнопку **ОК**.
    
    На рис. 4 показано отношение.
    

    **Рис. 4. Отношение между объектами Incidents и Patients**

 

  ![Отношение между объектами Incident и Patient](../../images/CBA_IM_3.PNG)
 

    Таким образом создается отношение "ноль или один ко многим" между происшествиями и пострадавшими. У записи происшествия не обязательно должен быть пострадавший, но у каждого пострадавшего должно быть отношение с записью происшествия.
    
    
 

    
    На следующем этапе вы добавите экраны для просмотра, добавления и редактирования записей "Пострадавший" и "Происшествие".
    
 

### <a name="to-add-screens"></a>Добавление экранов


1. В **обозревателе решений** откройте контекстное меню для узла **Incidents.lsml** и нажмите кнопку **Открыть**.
    
 
2. В конструкторе экрана в строке **Перспектива** откройте вкладку **HTML-клиент**, а затем на панели инструментов нажмите кнопку **Экран**.
    
    Откроется диалоговое окно **Добавление нового экрана**.
    
 
3. В диалоговом окне **Добавление нового экрана** в списке **Выберите шаблон экрана** выберите **Общий набор экранов**.
    
 
4. В текстовом поле **Имя набора экранов** введите Incidents (Инциденты).
    
 
5. В списке **Данные экрана** выберите **Incidents** (Инциденты).
    
 
6. Установите флажки **Incident Details** (Сведения об инциденте) и **Incident Patients** (Пострадавшие в инциденте), а затем нажмите кнопку **ОК**.
    
    На рис. 5 показано диалоговое окно "Добавление нового экрана".
    

    **Рис. 5. Диалоговое окно "Добавление нового экрана"**

 

  ![Набор экранов Incidents (Инциденты)](../../images/CBA_IM_4.PNG)
 

    В проект "HTML-клиент" добавлены экраны для обзора, просмотра сведений, а также добавления и редактирования. Экран обзора автоматически устанавливается в качестве начального экрана приложения, и автоматически предоставляются необходимые команды для запуска экранов просмотра и добавления и редактирования.
    
 
7. Чтобы запустить надстройку, в строке меню последовательно выберите пункты **Отладка** и **Начать отладку**. Если откроется диалоговое окно **Подключение к SharePoint**, введите свои имя пользователя и пароль.
    
 
8. Если отобразится соответствующий запрос, нажмите кнопку **Доверять**. Откроется надстройка с пустым экраном. Обратите внимание, что экран имеет название **IncidentsSet** (Набор инцидентов).
    
 
9. Нажмите кнопку **Добавить**.
    
    Откроется диалоговое окно **Incidents** (Инциденты). Обратите внимание, что несмотря на то что вы можете ввести данные об инциденте, нет возможности добавить пострадавших. Чтобы исправить этот и другие недочеты, вам потребуется настроить экраны.
    
    
 

    
    В следующем действии вы настроите экран Browse (Обзор).
    
 
10. Закройте диалоговое окно **Incident** (Инцидент). Затем закройте окно браузера, чтобы вернуться в режим конструктора.
    
 

### <a name="to-customize-the-browse-screen"></a>Настройка экрана Browse (Обзор)


1. На экране **обозревателя решений** откройте контекстное меню для узла **BrowseIncidentsSet.lsml** и нажмите кнопку **Открыть**.
    
 
2. В окне **Свойства** выберите свойство **Отображаемое имя** и введите Incidents (Инциденты).
    
 
3. На экране конструктора выберите узел **Макет строк | строки**, а затем разверните список **Добавить** и выберите пункт **Incident Address** (Адрес инцидента).
    
 
4. Выберите узел **Dispatch Time** (Время отправки), а затем на панели инструментов нажмите кнопку **Удалить**.
    
    На рис. 6 показан завершенный макет экрана.
    

    **Рис. 6. Макет экрана Browse (Обзор)**

 

  ![Макет экрана Browse (Обзор)](../../images/CBA_IM4a.PNG)
 

    При выполнении приложения на экране будут отображаться плитки для всех происшествий, и на каждой из них будет показан номер, дата и адрес.
    
    
 

    
    На следующем экране вы настроите экран добавления и редактирования.
    
 

### <a name="to-customize-the-addedit-screen"></a>Настройка экрана добавления и редактирования


1. На экране **обозревателя решений** откройте контекстное меню для узла **AddEditIncidents.lsml** и нажмите кнопку **Открыть**.
    
 
2. Выберите узлы **Incident Address** (Адрес инцидента), **Reporting Party Name** (Имя, лица сообщившего об инциденте) и **Reporting Phone** (Телефон, с которого сообщили об инциденте) и перетащите их в раздел **Макет строк | слева** под узлом **Incident Type** (Тип инцидента).
    
 
3. Выберите узел **Dispatch Time** (Время отправки) и в окне **Свойства** снимите флажок **Средство выбора даты включено**.
    
    Дата не нужна, так как она всегда будет совпадать с датой инцидента.
    
 
4. В конструкторе экрана в области слева щелкните ссылку **Add Patients** (Добавить пострадавших), как показано на рис. 7.
    
    **Рис. 7. Ссылка Add Patients (Добавить пострадавших)**

 

  ![Ссылка Add Patients (Добавить пострадавших)](../../images/CBA_IM_5.PNG)
 

 

 
5. В области слева выберите узел **Patients** (Пострадавшие) и перетащите его в узел **Incident Commander** (Управляющий инцидентом) в области в центре окна.
    
    На рис. 8 показан завершенный макет экрана.
    

    **Рис. 8. Макет экрана добавления и редактирования**

 

  ![Макет экрана добавления и редактирования](../../images/CBA_IM_5a.PNG)
 

    
 

    
    На следующем этапе вы создадите экран для добавления записей о пострадавших.
    
 

### <a name="to-add-a-patients-screen"></a>Добавление экрана Patients (Пострадавшие).


1. На экране **обозревателя решений** откройте контекстное меню для узла **AddEditIncidents.lsml** и нажмите кнопку **Открыть**.
    
 
2. В конструкторе экрана в узле **Макет строк | Сведения (вкладка)** откройте контекстное меню для узла **Панель команд** и щелкните **Добавить кнопку**.
    
 
3. В диалоговом окне **Добавление кнопки** разверните список **showTab** и в группе **Patients** (Пострадавшие) выберите **addAndEditNew**, а затем нажмите кнопку **ОК**.
    
    Откроется диалоговое окно **Добавление нового экрана**.
    
 
4. В диалоговом окне **Добавление нового экрана** примите значения, используемые по умолчанию, и нажмите кнопку **ОК**.
    
    В конструкторе экрана откроется экран **AddEditPatient**.
    
 
5. В окне "Свойства" выберите свойство **Отображаемое имя** и введите Add Patient (Добавление пострадавшего).
    
 
6. В конструкторе экрана выберите узел **Incident** (Инцидент) и удалите его.
    
    Поле **Incidents** (Инцидент) не требуется, так как пострадавший уже связан с инцидентом.
    
    На рис. 9 показан завершенный макет экрана.
    

    **Рис. 9. Макет экрана добавления и редактирования**

 

  ![Макет экрана добавления и редактирования](../../images/CBA_IM_6.PNG)
 

    
 

    
    На следующем этапе вы запустите надстройку и добавите некоторые данные.
    
 

### <a name="to-test-the-add-in"></a>Тестирование надстройки


1. В строке меню последовательно выберите пункты **Отладка** и **Начать отладку**.
    
 
2. В запущенной надстройке нажмите кнопку **Добавить**.
    
    Откроется всплывающее окно **Incidents** (Инциденты), как показано на рис. 10.
    

    **Рис. 10. Всплывающее окно Incidents (Инциденты)**

 

  ![Всплывающее окно Add Incident (Добавление инцидента)](../../images/CBA_IM_7.PNG)
 

 

 
3. В текстовом поле **Incident Number** (Номер инцидента) введите 2014-1.
    
 
4. В полях **Incident Date** (Дата инцидента) и **Dispatch Time** (Время отправки) с помощью элементов управления **Средство выбора даты** и **Средство выбора времени** выберите дату и время.
    
 
5. В списке **Incident Type** (Тип инцидента) выберите **Aid - Basic Life Support** (Медицинская помощь: первичные реанимационные мероприятия).
    
 
6. В текстовом поле **Incident Address** (Адрес инцидента) введите адрес в своем городе.
    
     Не вводите город, область или край и почтовый индекс. Предполагается, что пожарная служба работает только в одном городе.
    
 
7. В элементе управления **средства выбора людей** **Incident Commander** (Управляющий инцидентом) введите имя пользователя на вашем сайте SharePoint.
    
    Обратите внимание, что по мере ввода текста отображается список всех подходящих имен.
    
 
8. Нажмите кнопку **Add Patient** (Добавить пострадавшего).
    
    Откроется всплывающее окно **Add Patient** (Добавление пострадавшего), как показано на рис. 11.
    

    **Рис. 11. Всплывающее окно Add Patient (Добавление пострадавшего)**

 

  ![Всплывающее окно Add Patient (Добавление пострадавшего)](../../images/CBA_IM_8.PNG)
 

 

 
9. Введите информацию о пострадавшем и нажмите кнопку **Сохранить**.
    
    Имя добавленного вами пострадавшего отобразится во всплывающем окне **Incidents** (Инциденты). Если хотите, можете добавить других пострадавших.
    
 
10. Во всплывающем окне **Incidents** (Инциденты) нажмите кнопку **Сохранить**.
    
    Если вы следовали инструкциям, отобразится сообщение об ошибке проверки. Поле **Reporting Phone** (Телефон, с которого сообщили об инциденте) — обязательное. В облачных бизнес-надстройках есть встроенная проверка для обязательных полей.
    
 
11. Введите номер телефона и снова нажмите кнопку **Сохранить**.
    
    На начальном экране **Incidents** (Инциденты) отобразится плитка с номером, датой и адресом инцидента.
    
 
12. Чтобы открыть экран "Просмотр" для инцидента, щелкните соответствующую плитку.
    
    Обратите внимание, что поле **Reporting Phone** (Телефон, с которого сообщили об инциденте) отображается как гиперссылка, и с его помощью можно получить прямой доступ к приложению телефона, используемому по умолчанию.
    
 
13. Нажмите кнопку **Правка**, чтобы открыть экран **AddEditIncidents**, а затем нажмите кнопку **Отменить**, чтобы вернуться на экран **Просмотр**.
    
 
14. Откройте вкладку **Patients** (Пострадавшие), чтобы отобразить список пострадавших, а затем щелкните плитку необходимого пострадавшего.
    
    Обратите внимание, что эта плитка не откроет экран просмотра для пострадавшего. Это потому, что вы еще не создали ни одного пострадавшего.
    
 
15. Чтобы вернуться в режим конструктора, нажмите кнопку **Закрыть** в браузере.
    
    
 

    
    В следующем действии мы добавим экран для отображения пострадавших.
    
 

### <a name="to-add-a-view-screen"></a>Добавление экрана просмотра


1. На экране **обозревателя решений** откройте контекстное меню для узла **Patients.lsml** и нажмите кнопку **Открыть**.
    
 
2. В Entity Designer в строке **Перспектива** щелкните **HTML-клиент**, а затем на панели инструментов нажмите кнопку **Экран**.
    
    Откроется диалоговое окно **Добавление нового экрана**.
    
 
3. В диалоговом окне **Добавление нового экрана** в списке **Выберите шаблон экрана** выберите **Экран просмотра сведений**.
    
 
4. В текстовом поле **Имя экрана** введите **ViewPatient** (Просмотр сведений о пострадавшем), в списке **Данные экрана** выберите **Patient** (Пострадавший) и нажмите кнопку **ОК**.
    
    В конструкторе экрана откроется экран **ViewPatient** (Просмотр сведений о пострадавшем).
    
 
5. В конструкторе экрана в узле **Макет строк | Сведения (вкладка)** откройте контекстное меню для узла **Панель команд** и щелкните **Добавить кнопку**.
    
 
6. В диалоговом окне **Добавление кнопки** разверните список **showTab** и в группе **Patient** щелкните **Изменить**, а затем нажмите кнопку **ОК**.
    
 
7. Запустите надстройку и убедитесь, что теперь можно отображать пострадавших и изменять сведения о них.
    
    
 

    
    Теперь вы создали полнофункциональную надстройку по управлению происшествиями, но облачные бизнес-надстройки способны делать намного больше. В следующем разделе вы узнаете, как использовать ресурсы на сайте SharePoint из надстройки по управлению происшествиями.
    
 

## <a name="integrate-sharepoint-resources"></a>Интеграция ресурсов SharePoint
<a name="integrate"> </a>

Противопожарная служба Contoso начала использовать надстройку по управлению происшествиями, и, как часто происходит с проектами разработки программного обеспечения, теперь она хочет добавить новую возможность. Кроме информации о происшествиях и пострадавших, компании необходимо управлять ресурсами, например огнетушительными аппаратами и персоналом. У компании уже есть списки аппаратов и персонала на сайте SharePoint, поэтому вы будете использовать эти списки как еще один источник данных для надстройки.
 

 
На первом этапе необходимо добавить несколько заранее заполненных шаблонов списков на свой сайт разработчика.
 

 

### <a name="to-add-list-templates"></a>Добавление шаблонов списков


1. Чтобы запустить надстройку, в строке меню последовательно выберите команды **Отладка** и **Начать отладку**.
    
 
2. В запущенной надстройке на панели хрома щелкните **Вернуться на сайт**, чтобы перейти на свой сайт разработчика SharePoint, как показано на рис. 12.
    
    **Рис. 12. Ссылка "Вернуться на сайт"**

 

  ![Переход на сайт разработчика SharePoint](../../images/CBA_IM_8a.PNG)
 

 

 
3. На странице **Разработчик** щелкните ссылку **Содержимое сайта**.
    
 
4. На странице **Содержимое сайта** щелкните ссылку **Параметры**, как показано на рис. 13.
    
    **Рис. 13. Ссылка "Параметры"**

 

  ![Ссылка "Параметры сайта"](../../images/CBA_IM_8b.PNG)
 

 

 
5. На странице **Параметры сайта** в списке **Коллекции веб-дизайнера** щелкните ссылку **Шаблоны списков**, как показано на рис. 14.
    
    **Рис. 14. Ссылка "Шаблоны списков"**

 

  ![Список "Шаблоны списков"](../../images/CBA_IM_8c.PNG)
 

 

 
6. На странице **Коллекция шаблонов списков** откройте вкладку **ФАЙЛЫ**, а затем на ленте нажмите кнопку **Отправить документ**.
    
 
7. В диалоговом окне **Добавление шаблона** нажмите кнопку **Обзор**, а затем перейдите к папке **Ресурсы** для скачанного примера "Управление инцидентами".
    
 
8. Выберите файл **ContosoApparatus.stp** и нажмите кнопку **Открыть**, а затем кнопку **ОК**.
    
 
9. В диалоговом окне **Коллекция шаблонов списков** нажмите кнопку **Сохранить**.
    
 
10. Повторите процесс и отправьте файл **ContosoPersonnel.stp**.
    
    **Рис. 15. Отправленные файлы**

 

  ![Шаблоны Contoso](../../images/CBA_IM_8d.PNG)
 

 

 
11. Щелкните ссылку **Содержимое сайта** и на странице **Содержимое сайта** щелкните плитку **добавить надстройку**.
    
 
12. На странице **Содержимое сайта > Ваши надстройки** щелкните плитку **Contoso Apparatus** (Оборудование Contoso).
    
     **Примечание.** Чтобы найти плитку **Contoso Apparatus** (Оборудование Contoso), вам может потребоваться перейти на вторую страницу надстроек.
13. В диалоговом окне **Добавление настраиваемого списка** выберите текстовое поле **Имя** и введите Contoso Apparatus (Оборудование Contoso), а затем нажмите кнопку **Создать**.
    
 
14. Повторите процесс и добавьте список **Contoso Personnel** (Сотрудники Contoso), введя для него имя Contoso Personnel (Сотрудники Contoso).
    
 
15. На странице **Содержимое сайта** проверьте, появились ли списки **Contoso Apparatus** (Оборудование Contoso) и **Contoso Personnel** (Сотрудники Contoso).
    
    
 

    
    В следующем действии вы добавите свой сайт SharePoint в качестве источника данных.
    
 

### <a name="to-add-a-sharepoint-data-source"></a>Добавление источника данных SharePoint


1. В **обозревателе решений** откройте контекстное меню узла **Источники данных** и выберите пункт **Добавить источник данных**.
    
    Откроется **мастер подключения к источнику данных**.
    
 
2. В **мастере подключения к источнику данных** щелкните значок **SharePoint**, как показано на рис. 16, а затем нажмите кнопку **Далее**.
    
    **Рис. 16. Источник данных SharePoint**

 

  ![Источник данных SharePoint](../../images/CBA_IM_9.PNG)
 

 

 
3. На странице **Ввод сведений для подключения** убедитесь, что указан правильный URL-адрес вашего сайта разработчика SharePoint, а затем нажмите кнопку **Далее**.
    
 
4. На странице **Выбор элементов SharePoint** установите флажки для списков **ContosoApparatus** (Оборудование Сontoso) и **ContosoPersonnel** (Сотрудники Contoso), как показано на рис. 17, а затем нажмите кнопку **Готово**.
    
    **Рис. 17. Выбранные списки**

 

  ![Списки SharePoint](../../images/CBA_IM_9a.PNG)
 

    Объекты будут добавлены в новый узел **Данные разработчика** в узле **Источники данных** в **обозревателе решений**, и в Entity Designer откроется объект **ContosoApparatus**.
    
    
     **Примечание.** Возможно, вы заметили, что также добавлен объект **UserInformationLists**. SharePoint использует этот список для управления полями **CreatedBy** и**ModifiedBy** для списков.
5. В окне **Свойства** выберите свойство **Отображаемое имя** и измените его значение на Apparatus (Оборудование).
    
    
 

    
    В следующем действии вы определите запрос, который будет ограничивать перечень данных, возвращаемых из объекта **ApparatusSet**. В данном случае вам необходимо отображать только действующее оборудование.
    
 

### <a name="to-define-the-availableapparatus-query"></a>Определение запроса AvailableApparatus


1. В **обозревателе решений** откройте контекстное меню узла **ApparatusSet.lsml** и выберите пункт **Добавить запрос**.
    
    Откроется конструктор запросов.
    
 
2. В окне **Свойства** выберите свойство **Имя** и введите для него значение AvailableApparatus.
    
 
3. В конструкторе запросов щелкните ссылку **Добавить фильтр** и во втором раскрывающемся списке выберите **Доступные**.
    
 
4. В последнем текстовом поле измените значение **Ложь** на **Истина**.
    
    На рис. 18 показан запрос.
    

    **Рис. 18. Запрос AvailableApparatus (Доступное оборудование)**

 

  ![Запрос AvailableApparatus (Доступное оборудование)](../../images/CBA_IM_10.PNG)
 

    
 

    
    В следующем действии вы определите другой запрос для объекта **ContosoPersonnel**. В данном случае вам необходимо отображать только тех сотрудников, которые относятся к смене A.
    
 

### <a name="to-define-the-availablepersonnel-query"></a>Определение запроса AvailablePersonnel (Доступные сотрудники)


1. В **обозревателе решений** откройте контекстное меню узла **ContosoPersonnels.lsml** и выберите пункт **Добавить запрос**.
    
    Откроется конструктор запросов.
    
 
2. В окне **Свойства** выберите свойство **Имя** и введите для него значение AvailablePersonnel (Доступные сотрудники).
    
 
3. В конструкторе запросов щелкните ссылку **Добавить фильтр** и во втором раскрывающемся списке выберите **Shift** (Смена).
    
 
4. В последнем текстовом поле введите **A**.
    
    На рис. 19 показан запрос.
    

    **Рис. 19. Запрос AvailablePersonnel (Доступные сотрудники)**

 

  ![Диалоговое окно "Отношение"](../../images/CBA_IM_10a.PNG)
 

    
 

    
    В следующем действии вы добавите списки доступного оборудования и сотрудников на экран **ViewIncidents** (Просмотр инцидентов).
    
 

### <a name="to-add-queries-to-the-screen"></a>Добавление запросов на экран


1. В **обозревателе решений** откройте контекстное меню узла **ViewIncidents.lsml** и нажмите кнопку **Открыть**.
    
 
2. В конструкторе экрана откройте контекстное меню узла **Вкладка** и щелкните **Добавить вкладку**.
    
 
3. В окне **Свойства** измените значение свойства **Имя** на Resources (Ресурсы).
    
 
4. В конструкторе экрана на панели инструментов щелкните **Добавить элемент данных**.
    
    Откроется диалоговое окно **Добавление элемента данных**.
    
 
5. В диалоговом окне **Добавление элемента данных** установите переключатель **Запрос**.
    
 
6. В списке выберите пункт **DeveloperData.AvailableApparatus**, как показано на рис. 20, и нажмите кнопку **ОК**.
    
    **Рис. 20. Запрос AvailableApparatus (Доступное оборудование)**

 

  ![Добавление запроса](../../images/CBA_IM_11.PNG)
 

    Коллекция **AvailableApparatus** (Доступное оборудование) будет добавлена в левую область конструктора экрана.
    
 
7. Повторите этот процесс, чтобы добавить запрос **AvailablePersonnel** (Доступные сотрудники) на экран.
    
 
8. В узле **Макет строк | Ресурсы** откройте список **Добавить** и выберите пункт **Available Apparatus** (Доступное оборудование).
    
 
9. Выберите узел **Список | Available Apparatus (Доступное оборудование)**, откройте список **Список** и выберите пункт **Список плиток**.
    
 
10. Удалите все элементы в узле **Макет строк | Contoso Apparatus (Оборудование Contoso)**, кроме **Apparatus Number** (Номер оборудования) и **Apparatus Type** (Тип оборудования).
    
 
11. В узле **Макет строк | Ресурсы** откройте список **Добавить** и выберите пункт **Available Personnel** (Доступные сотрудники).
    
 
12. Выберите узел **Список | Available Personnel (Доступные сотрудники)**, откройте список **Список** и выберите пункт **Таблица**.
    
 
13. Удалите все элементы в узле **Строка таблицы | Contoso Personnel (Сотрудники Contoso)**, кроме **Name** (Имя), **Rank** (Ранг) и **Assignment** (Назначение).
    
    На рис. 21 показан макет экрана.
    

    **Рис. 21. Макет экрана**

 

  ![Макет вкладки Resources (Ресурсы)](../../images/CBA_IM_11a.PNG)
 

 

 
14. Запустите надстройку и просмотрите изменения. Выберите инцидент, а затем откройте вкладку **Resources** (Ресурсы), чтобы просмотреть список доступных ресурсов.
    
    
 

    
    Мы закончили вносить изменения. В следующем разделе вы узнаете, как добавить библиотеку документов SharePoint и сопоставить ее с надстройкой.
    
 

## <a name="associate-a-document-library"></a>Сопоставление библиотеки документов
<a name="associate"> </a>

На месте происшествия руководитель аварийно-спасательных работ должен документировать многие данные. Для некоторых из них предварительно созданы формы, а некоторые не предусмотрены заранее и зависят от конкретного случая. Документы, создаваемые на месте происшествия, должны быть доступны позже; они должны быть упорядочены по происшествиям для легкого извлечения. Для надстройки по управлению происшествиями можно использовать компонент настраиваемой библиотеки документов в SharePoint, чтобы сопоставлять документы с каждым происшествием.
 

 

### <a name="to-add-a-document-library-to-the-sharepoint-site"></a>Добавление библиотеки документов на сайт SharePoint


1. Чтобы запустить надстройку, в строке меню последовательно выберите команды **Отладка** и **Начать отладку**.
    
 
2. В запущенной надстройке на панели хрома щелкните **Вернуться на сайт**, как показано на рис. 22, и перейдите на свой сайт разработчика SharePoint.
    
    **Рис. 22. Ссылка "Вернуться на сайт"**

 

  ![Переход на сайт разработчика SharePoint](../../images/CBA_IM_8a.PNG)
 

 

 
3. На странице **Разработчик** щелкните ссылку **Содержимое сайта**.
    
 
4. На странице **Содержимое сайта** щелкните плитку **добавить надстройку**.
    
 
5. На странице **Содержимое сайта > Ваши надстройки** щелкните плитку **Библиотека документов**.
    
 
6. В диалоговом окне **Добавление библиотеки документов** в текстовом поле **Имя** введите Incident Documents (Документы, связанные с инцидентом), а затем нажмите кнопку **Создать**.
    
 
7. На странице **Содержимое сайта** щелкните плитку **Incident Documents** (Документы, связанные с инцидентом), чтобы открыть библиотеку, а затем откройте вкладку **БИБЛИОТЕКА**.
    
 
8. На **ленте** нажмите кнопку **Создать столбец**.
    
 
9. В диалоговом окне **Создание столбца** в текстовом поле **Имя столбца** введите IncidentNumber (Номер инцидента), а затем нажмите кнопку **ОК**.
    
    На рис. 23 показан добавленный столбец.
    

    **Рис. 23. Библиотека документов Incident Documents (Документы, связанные с инцидентом)**

 

  ![Библиотека документов со столбцом IncidentNumber (Номер инцидента)](../../images/CBA_IM_12.PNG)
 

    Чтобы сопоставить библиотеку документов с вашей надстройкой, библиотека документов должна содержать настраиваемый столбец, сопоставленный с уникальным полем в вашем объекте. В этом случае столбец **IncidentNumber** (Номер инцидента) будет сопоставлен с полем **IncidentNumber** (Номер инцидента) в объекте **Incidents** (Инциденты).
    
    
 

    
    В следующем действии вы добавите библиотеку документов в свою надстройку.
    
 

### <a name="to-add-a-document-library-to-a-project"></a>Добавление библиотеки документов в проект


1. В **обозревателе решений** откройте контекстное меню узла **Данные разработчика** и выберите пункт **Обновить источник данных**.
    
 
2. На странице **Выбор элементов SharePoint** в левой панели выберите элемент списка **Библиотеки документов**, а в правой панели установите флажок **IncidentDocuments** (Документы, связанные с инцидентом), как показано на рис. 24, и нажмите кнопку **Готово**.
    
    **Рис. 24. Объект IncidentDocuments (Документы, связанные с инцидентом)**

 

  ![Выбор библиотеки документов](../../images/CBA_IM_13.PNG)
 

    В обозреватель решений будет добавлен узел **IncidentDocuments.lsml**.
    
    
 

    
    В следующем действии вы создадите отношение между библиотекой документов и объектом Incidents (Инциденты).
    
 

### <a name="to-create-a-relationship-across-data-sources"></a>Создание отношения между источниками данных


1. В **обозревателе решений** откройте контекстное меню узла **IncidentDocuments.lsml** и нажмите кнопку **Открыть**.
    
 
2. В Entity Designer в строке **Перспектива** выберите пункт **Сервер**, а затем на панели инструментов нажмите кнопку **Отношение**.
    
 
3. В диалоговом окне **Добавление нового отношения** в раскрывающемся списке **К:** выберите пункт **Incident** (Инцидент), как показано на рис. 25.
    
    **Рис. 25. Диалоговое окно "Добавление нового отношения"**

 

  ![Отношение между объектами](../../images/CBA_IM_11b.PNG)
 

 

 
4. В раскрывающемся списке **Внешний ключ** выберите поле **IncidentNumber (String)** (Номер инцидента [String]) из объекта **IncidentDocuments** (Документы, связанные с инцидентом).
    
 
5. В раскрывающемся списке **Первичный ключ** выберите поле **IncidentNumber (String)** (Номер инцидента [String]) из объекта **Incidents** (Инциденты) и нажмите кнопку **ОК**.
    
    На рис. 26 показаны внешний и первичный ключи.
    

    **Рис. 26. Внешний и первичный ключи**

 

  ![Сопоставленные поля](../../images/CBA_IM_11c.PNG)
 

    
 

    
    В следующем действии вы добавите библиотеку документов на экран **ViewIncidents** (Просмотр инцидентов).
    
 

### <a name="to-add-a-document-library-to-a-screen"></a>Добавление библиотеки документов на экран


1. В **обозревателе решений** откройте контекстное меню узла **ViewIncidents.lsml** и нажмите кнопку **Открыть**.
    
 
2. В конструкторе экрана откройте контекстное меню узла **Вкладка** и щелкните **Добавить вкладку**.
    
 
3. В окне **Свойства** измените значение свойства **Имя** на Documents (Документы).
    
 
4. В конструкторе экрана в левой области щелкните ссылку **Add IncidentDocuments** (Добавить документы, связанные с инцидентом).
    
 
5. В центральной области в узле **Макет строк | Документы** откройте список **Добавить** и выберите пункт **Incident Documents** (Документы, связанные с инцидентом).
    
 
6. В узле **Макет строк | Документы** откройте контекстное меню узла **Панель команд** и выберите пункт **Добавить кнопку**.
    
 
7. В диалоговом окне **Добавление кнопки** разверните список **showTab** и в группе **IncidentDocuments** (Документы, связанные с инцидентом) выберите пункт **createOrUploadDocument**, как показано на рис. 27, и нажмите кнопку **ОК**.
    
    **Рис. 27. Диалоговое окно "Добавление кнопки"**

 

  ![Кнопка для создания или отправки документов](../../images/CBA_IM_14.PNG)
 

 

 
8. В окне **Свойства** выберите свойство **Отображаемое имя** и введите Add Document (Добавить документ).
    
 
9. Разверните список свойств **Значок** и выберите пункт **Вложение**.
    
 
10. Чтобы запустить надстройку, в строке меню последовательно выберите команды **Отладка** и **Начать отладку**.
    
 
11. Выберите инцидент, откройте вкладку **Documents** (Документы) и нажмите кнопку **Add Document** (Добавить документ).
    
    Откроется диалоговое окно SharePoint **Создание файла**, как показано на рис. 28.
    

    **Рис. 28. Диалоговое окно "Создание файла"**

 

  ![Диалоговое окно "Создание файла" в SharePoint](../../images/CBA_IM_15.PNG)
 

 

 
12. Щелкните ссылку **ОТПРАВИТЬ СУЩЕСТВУЮЩИЙ ФАЙЛ**, выберите файл, который необходимо отправить, а затем нажмите кнопку **Открыть**.
    
    Файл будет добавлен на вкладку **Documents** (Документы).
    
     **Совет.** Если вы выбрали документ Office, то можете просмотреть его в надстройке.
13. Нажмите кнопку Add Document (Добавить документ) и в диалоговом окне **Создание файла** щелкните **Документ Word**.
    
    Новый документ Word откроется в **Word Online**.
    
 
14. В заголовке окна выберите поле **Имя документа**, как показано на рис. 29, и введите Incident Report (Отчет об инциденте).
    
    **Рис. 29. Поле имени документа**

 

  ![Имя файла](../../images/CBA_IM_16.PNG)
 

    Введенное здесь имя будет использоваться в качестве имени файла документа.
    
    
     **Примечание.** Если вы не введете имя файла, файл будет сохранен с именем **Документ.docx**, используемым по умолчанию. После сохранения файла его имя можно изменить только в библиотеке документов в SharePoint.
15. Вернитесь к надстройке, нажав кнопку "Назад"в браузере. Документ **Incident Report** (Отчет об инциденте) должен отобразиться на вкладке **Documents** (Документы).
    
 
16. Чтобы вернуться в режим конструктора, нажмите кнопку **Закрыть** в браузере.
    
    
 

    
    В следующем разделе вы настроите надстройку и добавите код JavaScript.
    
 

## <a name="customize-the-add-in"></a>Настройка надстройки
<a name="custom"> </a>

Противопожарная служба Contoso довольна возможностями, добавленными в надстройку по управлению происшествиями, но хочет добавить еще несколько "завершающих штрихов". Представители службы хотят, чтобы на экране отображался логотип службы вместо значка, используемого по умолчанию. Им не нравится элемент управления **FlipSwitch** для поля **Insured** (Есть страховка) на экране **AddEditPatient**, и они хотят заменить его на флажок. Наконец, так как не при всех происшествиях есть пострадавшие, необходимо, чтобы вкладка **Patients** (Пострадавшие) не отображалась на экране **ViewIncidents** (Просмотр инцидентов), если пострадавших нет.
 

 

### <a name="to-display-a-custom-logo"></a>Отображение настраиваемого логотипа


1. В **обозревателе решений** в проекте **IncidentManager.HtmlClient** разверните узлы **Контент** и **Изображения**.
    
 
2. Выберите файлы **user-logo.png** и **user-splash-screen.png**, как показано на рис. 30, и удалите их.
    
    **Рис. 30. Файлы, которые необходимо удалить**

 

  ![Файлы логотипа и экрана-заставки](../../images/CBA_IM_17.PNG)
 

 

 
3. Откройте контекстное меню узла **Изображения**, последовательно выберите пункты **Добавить** и **Существующий элемент**.
    
 
4. В диалоговом окне **Добавление существующего элемента** нажмите кнопку **Обзор**, а затем перейдите к папке **Ресурсы** для скачанного примера Incident Management (Управление инцидентами).
    
 
5. Выберите файлы **user-logo.png** и **user-splash-screen.png**, а затем нажмите кнопку **Добавить**.
    
    В заголовке окна надстройки отобразятся новые изображения, а при ее загрузке будет появляться экран-заставка.
    
    
 

    
    В следующем действии вы замените элемент управления **FlipSwitch** на флажок.
    
 

### <a name="to-replace-the-flipswitch-control"></a>Замена элемента управления FlipSwitch


1. В **обозревателе решений** откройте контекстное меню узла **AddEditPatient.lsml** и нажмите кнопку **Открыть**.
    
 
2. В конструкторе экрана разверните список для узла **Insured** (Есть страховка) и выберите **Пользовательский элемент управления**.
    
 
3. В окне **Свойства** щелкните ссылку **Изменить код метода Render**.
    
 
4. В редакторе кода добавьте указанный ниже код в метод **Insured_render**.
    
```
  // Create the checkbox and add it to the DOM.
    var checkbox = $("<input type='checkbox'/>")
            .css({
                height: 20,
                width: 20,
                margin: "10px"
            })
            .appendTo($(element));

    // Determine if the change was initiated by the user.
    var changingValue = false;

    checkbox.change(function () {
        changingValue = true;
        contentItem.value = checkbox[0].checked;
        changingValue = false;
    });
    contentItem.dataBind("value", function (newValue) {
        if (!changingValue) {
            checkbox[0].checked = newValue;
        }
    });
```


    This code creates a  **CheckBox** control when the screen is rendered. You'll also need to add code to set an initial value.
    
 
5. В **обозревателе решений** откройте контекстное меню объекта **Patients.lsml** и нажмите кнопку **Открыть**.
    
 
6. В Entity Designer на панели **Перспектива** откройте вкладку **HTMLClient**.
    
 
7. На панели инструментов разверните список **Запись кода** и выберите пункт **created**.
    
 
8. В редакторе кода добавьте указанный ниже код в метод **created**.
    
```
  entity.Insured = new Boolean();
    entity.Insured = 'true';
```


    This code sets the initial value of the control to checked (true) when the screen is created.
    
    
 

    
    In the next step, you'll add code to hide the  **Patients** tab if no patients exist.
    
 

### <a name="to-conditionally-hide-a-tab"></a>Условное скрытие вкладки


1. В **обозревателе решений** откройте контекстное меню узла экрана **ViewIncidents.lsml** и нажмите кнопку **Открыть**.
    
 
2. На панели инструментов откройте список **Запись кода** и выберите пункт **created**.
    
 
3. В редакторе кода добавьте указанный ниже код в метод **ViewIncidents_created**.
    
```
  screen.getPatients().then(function (results) {
        var queryCount = results.count;
        if (queryCount == 0 ) {
            screen.findContentItem("Patients").isVisible = false;
        }
    });
```


    This code runs the  **GetPatients** query to get a count of **Patients**. If the result is zero, the  **findContentItem** method sets the **isVisible** property of the **Patients** tab to false, hiding it.
    
 
4. В строке меню последовательно выберите пункты **Отладка** и **Начать отладку**, чтобы запустить надстройку. Обратите внимание, что на экранах будет отображаться новый логотип. Откройте первый инцидент, который вы создали ранее, и измените сведения о пострадавшем. Убедитесь, что вместо поля Insured (Есть страховка) сейчас используется одноименный флажок. Добавьте новый инцидент без пострадавших и убедитесь, что вкладка **Patients** (Пострадавшие) скрыта на экране просмотра.
    
    
 

    
    В последнем разделе вы опубликуете готовую надстройку в SharePoint.
    
 

## <a name="publish-to-sharepoint"></a>Публикация в SharePoint
<a name="pub"> </a>

Пока вы запускали надстройку только в режиме отладки, который выполняет проверку подлинности с помощью SharePoint и перенаправляет вас к экземпляру IIS Express локального компьютера. Далее вы опубликуете надстройку как автоматически размещаемую надстройку SharePoint, которая будет автоматически подготавливать пространство в Office 365 для надстройки и внутренней базы данных. В частности, надстройка будет размещена в Microsoft Azure, а база данных в SQL Azure. После того как вы опубликуете надстройку, другие люди смогут запускать ее из SharePoint на своих компьютерах и мобильных устройствах.
 

 

### <a name="to-publish-the-add-in"></a>Публикация надстройки


1. На панели инструментов Visual Studio откройте список **Отладка** и выберите пункт **Выпуск**.
    
 
2. В **обозревателе решений** откройте контекстное меню узла **IncidentManager** (Диспетчер инцидентов), как показано на рис. 31, и выберите пункт **Опубликовать**.
    
    **Рис. 31. Узел IncidentManager (Диспетчер инцидентов)**

 

  ![Узел IncidentManager](../../images/CBA_IM_18.PNG)
 

    Откроется **мастер публикации приложений LightSwitch**.
    
 
3. На странице параметров **SharePoint** установите переключатель **Автоматическое размещение**, как показано на рис. 32, а затем нажмите кнопку **Опубликовать**.
    
    **Рис. 32. Вариант "Автоматическое размещение"**

 

  ![Мастер публикации](../../images/CBA_IM_19.PNG)
 

    Когда надстройка будет опубликована, откроется **проводник**, в котором будет отображаться папка **Publish** (Публикация) для вашего проекта.
    
 
4. В браузере перейдите на свой сайт разработчика SharePoint
    
 
5. В списке **Тестируемые надстройки** щелкните ссылку с многоточием (…) рядом с пунктом **IncidentManager** (Диспетчер инцидентов), а затем щелкните ссылку **Удалить**, как показано на рис. 33.
    
    **Рис. 33. Ссылка "Удалить"**

 

  ![Список "Тестируемые приложения"](../../images/CBA_IM_20.PNG)
 

 

 
6. Щелкните ссылку **создания надстройки для развертывания**.
    
 
7. В диалоговом окне **Развертывание надстройки** щелкните ссылку **отправки**, как показано на рис. 34.
    
    **Рис. 34. Ссылка отправки**

 

  ![Диалоговое окно "Развертывание приложения"](../../images/CBA_IM_20a.PNG)
 

    Откроется диалоговое окно **Отправка надстройки**.
    
 
8. В диалоговом окне **Отправка надстройки** нажмите кнопку **Обзор** и найдите папку **Publish** (Публикация) для своей надстройки. Выберите файл **IncidentManager.SharePoint.app**, нажмите кнопку **Открыть**, а затем кнопку **ОК**.
    
    Когда файл будет отправлен, откроется диалоговое окно **Развертывание надстройки**.
    
 
9. В диалоговом окне **Развертывание надстройки** нажмите кнопку **Развернуть**.
    
 
10. В диалоговом окне **Отправка надстройки** нажмите кнопку **Доверять**.
    
    Надстройка будет установлена на вашем сайте SharePoint. Этот процесс может занять несколько минут.
    
    На рис. 35 показан список "Тестируемые надстройки" в процессе установки надстройки.
    

    **Рис. 35. Список "Тестируемые надстройки"**

 

  ![Выполняется установка надстройки](../../images/CBA_IM_21.PNG)
 

 

 
11. Щелкните ссылку **Содержимое сайта**.
    
    На рис. 37 показан список "Содержимое сайта" в процессе установки надстройки.
    

    **Рис. 37. Установка надстройки**

 

  ![Выполняется установка надстройки](../../images/CBA_IM_22.PNG)
 

 

 
12. По завершении установки надстройки щелкните плитку **Incident Manager** (Диспетчер инцидентов), чтобы запустить надстройку.
    
    На рис. 38 показан список "Содержимое сайта" после установки надстройки.
    

    **Рис. 38. Установка надстройки**

 

  ![Надстройка готова к запуску](../../images/CBA_IM_23.PNG)
 

    Надстройка открывается в браузере и выглядит точно так же, как при запуске в режиме отладки. Обратите внимание, что исчезли данные, которые вы ввели при разработке. При развертывании надстройки развертывается база данных, но не сами данные.
    
 
13. Введите какие-либо данные и убедитесь, что все работает, как ожидалось.
    
    На рис. 39 показана надстройка, отображаемая в браузере на компьютере.
    

    **Рис. 39. Мозаика**

 

  ![Макет в браузере на компьютере](../../images/CBA_IM_24.PNG)
 

    Вы также можете проверить свою надстройку на мобильном устройстве. Войдите на сайт SharePoint из веб-браузера на устройстве, а затем запустите надстройку.
    
    На рис. 40 показана надстройка, отображаемая в браузере мобильного устройства.
    

    **Рис. 40. Представление списка**

 

  ![Макет на мобильном устройстве](../../images/CBA_IM_25.PNG)
 

 

 
Поздравляем! Вы завершили изучение этого руководства и теперь знакомы с основами создания облачной бизнес-надстройки. Теперь создайте собственную надстройку, а представленные ниже дополнительные ресурсы помогут вам углубить свои знания.
 

## <a name="additional-resources"></a>Дополнительные ресурсы
<a name="bk_addresources"> </a>


-  [Приступая к разработке облачной бизнес-надстройки](get-started-developing-cloud-business-add-ins)
    
 
-  [Разработка облачных бизнес-надстроек](develop-cloud-business-add-ins)
    
 
-  [Публикация облачных бизнес-надстроек](publish-cloud-business-add-ins)
    
 

