---
title: "Создание собственной кнопки ленты на хост-сайте надстройки SharePoint"
description: "Подготовьте хост-сайт, добавьте дополнительное действие на ленте, проверьте компонент сайта надстройки, а затем запустите и протестируйте надстройку."
ms.date: 12/04/2017
ms.prod: sharepoint
ms.openlocfilehash: 7af64ad9f207c8fd43b7fa10039c61e76d06f083
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="create-a-custom-ribbon-button-in-the-host-web-of-a-sharepoint-add-in"></a><span data-ttu-id="3498c-103">Создание собственной кнопки ленты на хост-сайте надстройки SharePoint</span><span class="sxs-lookup"><span data-stu-id="3498c-103">Create a custom ribbon button in the host web of a SharePoint Add-in</span></span>

<span data-ttu-id="3498c-104">Это девятая часть серии статей, посвященной основам разработки надстроек SharePoint, размещаемых в SharePoint. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями этой серии, представленными в разделе [Знакомство с созданием надстроек SharePoint, размещаемых в SharePoint](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md#Nextsteps).</span><span class="sxs-lookup"><span data-stu-id="3498c-104">This is the ninth in a series of articles about the basics of developing SharePoint-hosted SharePoint Add-ins. You should first be familiar with [SharePoint Add-ins](sharepoint-add-ins.md) and the previous articles in this series:</span></span> 
    
> [!NOTE]
> <span data-ttu-id="3498c-105">Если вы изучали предыдущие статьи этой серии о надстройках, размещаемых в SharePoint, то у вас уже есть решение для Visual Studio, которое можно использовать для работы с этой статьей.</span><span class="sxs-lookup"><span data-stu-id="3498c-105">If you have been working through this series about SharePoint-hosted add-ins, you have a Visual Studio solution that you can use to continue with this topic.</span></span> <span data-ttu-id="3498c-106">Кроме того, вы можете скачать репозиторий на веб-странице [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) и открыть файл BeforeRibbon.sln.</span><span class="sxs-lookup"><span data-stu-id="3498c-106">You can also download the repository at [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) and open the BeforeRibbon.sln file.</span></span>

<span data-ttu-id="3498c-107">Все надстройки SharePoint можно запускать со страницы **Содержимое сайта** на хост-сайте, выбрав плитку надстройки.</span><span class="sxs-lookup"><span data-stu-id="3498c-107">All SharePoint Add-ins can be run from the **Site Contents** page of the host web by selecting the add-in's tile.</span></span> <span data-ttu-id="3498c-108">Функциональность надстройки SharePoint также может быть представлена на хост-сайте посредством дополнительных действий, а именно настраиваемых кнопок ленты или элементов меню.</span><span class="sxs-lookup"><span data-stu-id="3498c-108">The functionality of a SharePoint Add-in can also be exposed on the host web through custom actions, which are custom ribbon buttons or custom menu items.</span></span> <span data-ttu-id="3498c-109">В этой статье описано добавление кнопки на ленту хост-сайта.</span><span class="sxs-lookup"><span data-stu-id="3498c-109">In this article you add a button to the ribbon on a host web.</span></span>

## <a name="prepare-the-host-web"></a><span data-ttu-id="3498c-110">Подготовка хост-сайта</span><span class="sxs-lookup"><span data-stu-id="3498c-110">Prepare the host web</span></span>

<span data-ttu-id="3498c-111">Ниже показано, как добавить кнопку на ленту календаря на хост-сайте. В пользовательском интерфейсе сайта разработчика SharePoint выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="3498c-111">To add the button to the ribbon of a calendar on the host web, take the following steps in the UI of your SharePoint developer site.</span></span>

1. <span data-ttu-id="3498c-112">На домашней странице сайта выберите пункты **Содержимое сайта** > **Добавить надстройку** > **Календарь**.</span><span class="sxs-lookup"><span data-stu-id="3498c-112">From the home page of the site, select **Site Contents** > **add and add-in** > **Calendar**.</span></span>

2. <span data-ttu-id="3498c-113">В диалоговом окне **Добавление календаря** введите **Employee Orientation Schedule** (Расписание адаптации сотрудников) в поле **Имя**, а затем нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="3498c-113">In the **Adding Calendar** dialog, for the **Name**, enter **Employee Orientation Schedule**, and then select **Create**.</span></span>

3. <span data-ttu-id="3498c-114">Когда откроется календарь, наведите курсор на любую дату, чтобы на ней появилась ссылка **Добавить**, и перейдите по ссылке **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="3498c-114">When the calendar opens, put the cursor on any date until the **Add** link appears on the date, and then select **Add**.</span></span> 

4. <span data-ttu-id="3498c-115">В диалоговом окне **Расписание обучения сотрудников: новый элемент** в поле **Название** введите **Orient Cassi Hicks** (Адаптация пользователя Cassie Hicks).</span><span class="sxs-lookup"><span data-stu-id="3498c-115">In the **Employee Orientation Schedule - New Item** dialog, for the **Title**, enter **Orient Cassi Hicks**.</span></span> <span data-ttu-id="3498c-116">В остальных полях оставьте значения, используемые по умолчанию, и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="3498c-116">Leave the other fields at their defaults, and then select **Save**.</span></span>
    
   <span data-ttu-id="3498c-117">Календарь должен выглядеть примерно так:</span><span class="sxs-lookup"><span data-stu-id="3498c-117">The calendar should look similar to the following:</span></span>

   <span data-ttu-id="3498c-118">*Рис. 1. Настраиваемый календарь*</span><span class="sxs-lookup"><span data-stu-id="3498c-118">*Figure 1. Custom calendar*</span></span>

   ![Календарь под названием "Employee Orientation Schedule" (Расписание адаптации сотрудников), где в пункте "June 1" (1 июня) указано "Orient Cassie Hicks" (Адаптация пользователя Cassie Hicks)](../images/d2066862-41c1-424d-9bfb-b6c5342bcf2c.PNG)

> [!IMPORTANT]
> <span data-ttu-id="3498c-120">Для выполнения приведенной ниже процедуры необходимо, чтобы в пользовательском интерфейсе Visual Studio был виден календарь. Однако если при создании календаря Visual Studio была открыта, календарь не будет отображаться.</span><span class="sxs-lookup"><span data-stu-id="3498c-120">The next procedure requires that the calendar be visible in the UI of Visual Studio, but it won't be if Visual Studio was open when you created the calendar.</span></span> <span data-ttu-id="3498c-121">Прежде чем продолжить, выйдите из Visual Studio и закройте все окна браузера и консоли PowerShell, с которых вы вошли на сайт разработчика.</span><span class="sxs-lookup"><span data-stu-id="3498c-121">Before you continue, close Visual Studio, and sign out of any browser windows and PowerShell consoles where you are signed in to your developer site.</span></span>

## <a name="add-a-ribbon-custom-action"></a><span data-ttu-id="3498c-122">Добавление дополнительного действия на ленте</span><span class="sxs-lookup"><span data-stu-id="3498c-122">Add a ribbon custom action</span></span>

1. <span data-ttu-id="3498c-123">В **обозревателе решений** щелкните правой кнопкой мыши проект **EmployeeOrientation** и выберите **Добавить** > **Новый элемент** > **Office/SharePoint** > **Дополнительное действие ленты**.</span><span class="sxs-lookup"><span data-stu-id="3498c-123">In **Solution Explorer**, right-click the **EmployeeOrientation** project, and select **Add** > **New Item** > **Office/SharePoint** > **Ribbon Custom Action**.</span></span> <span data-ttu-id="3498c-124">Присвойте новому элементу имя **RunOrientationAdd-in** и нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="3498c-124">Name it **RunOrientationAdd-in**, and then select **Add**.</span></span>

2. <span data-ttu-id="3498c-125">Мастер создания дополнительного действия для ленты задаст вам несколько вопросов.</span><span class="sxs-lookup"><span data-stu-id="3498c-125">The Create Custom Action for Ribbon Wizard asks you a series of questions.</span></span> <span data-ttu-id="3498c-126">Ответьте на них, используя таблицу ниже, и нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="3498c-126">Give the answers from the following table, and then select **Finish**.</span></span> 

    |<span data-ttu-id="3498c-127">**Вопрос для свойства**</span><span class="sxs-lookup"><span data-stu-id="3498c-127">**Property question**</span></span>|<span data-ttu-id="3498c-128">**Ответ**</span><span class="sxs-lookup"><span data-stu-id="3498c-128">**Answer**</span></span>|
    |:-----|:-----|
    |<span data-ttu-id="3498c-129">Где вы хотите разместить дополнительное действие?</span><span class="sxs-lookup"><span data-stu-id="3498c-129">Where do you want to expose the custom action?</span></span>|<span data-ttu-id="3498c-130">Выберите вариант **хост-сайт**.</span><span class="sxs-lookup"><span data-stu-id="3498c-130">Select **Host Web**.</span></span>|
    |<span data-ttu-id="3498c-131">К какой области относится дополнительное действие?</span><span class="sxs-lookup"><span data-stu-id="3498c-131">Where is the custom action scoped to?</span></span>|<span data-ttu-id="3498c-132">Выберите вариант **Экземпляр списка** (*не* "Шаблон списка").</span><span class="sxs-lookup"><span data-stu-id="3498c-132">Select **List Instance** (*not* List Template).</span></span>|
    |<span data-ttu-id="3498c-133">К какому элементу относится дополнительное действие?</span><span class="sxs-lookup"><span data-stu-id="3498c-133">Which particular item is the custom action scoped to?</span></span>|<span data-ttu-id="3498c-134">Выберите вариант **Employee Orientation Schedule** (Расписание адаптации сотрудников).</span><span class="sxs-lookup"><span data-stu-id="3498c-134">Select **Employee Orientation Schedule**.</span></span>|
    |<span data-ttu-id="3498c-135">Где находится элемент управления?</span><span class="sxs-lookup"><span data-stu-id="3498c-135">Where is the control located?</span></span>|<span data-ttu-id="3498c-136">Не используйте варианты из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="3498c-136">Do not use the drop-down selections.</span></span> <span data-ttu-id="3498c-137">Вместо этого введите `Ribbon.Calendar.Events.Actions.Controls._children`.</span><span class="sxs-lookup"><span data-stu-id="3498c-137">Instead, enter `Ribbon.Calendar.Events.Actions.Controls._children`.</span></span> <span data-ttu-id="3498c-138">(Третий компонент, **Events**, идентифицирует вкладку ленты, а четвертая часть, **Actions**, — группу кнопок.)</span><span class="sxs-lookup"><span data-stu-id="3498c-138">(The third part, **Events**, identifies the tab of the ribbon, and the fourth part, **Actions**, identifies the button group.)</span></span>|
    |<span data-ttu-id="3498c-139">Какой текст указан в элементе меню?</span><span class="sxs-lookup"><span data-stu-id="3498c-139">What is the text on the menu item?</span></span>|<span data-ttu-id="3498c-140">Введите **Employee Orientation** (Адаптация сотрудников).</span><span class="sxs-lookup"><span data-stu-id="3498c-140">Enter **Employee Orientation**.</span></span>|
    |<span data-ttu-id="3498c-141">Куда ведет дополнительное действие?</span><span class="sxs-lookup"><span data-stu-id="3498c-141">Where does the custom action navigate to?</span></span>|<span data-ttu-id="3498c-142">Не используйте варианты из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="3498c-142">Do not use the drop-down selections.</span></span> <span data-ttu-id="3498c-143">Вместо этого введите `~appWebUrl/Lists/NewEmployeesInSeattle`.</span><span class="sxs-lookup"><span data-stu-id="3498c-143">Instead, enter  `~appWebUrl/Lists/NewEmployeesInSeattle`.</span></span> <span data-ttu-id="3498c-144">Это страница представления списка, который находится на сайте надстройки, поэтому кнопка на ленте хост-сайта открывает страницу на сайте надстройки.</span><span class="sxs-lookup"><span data-stu-id="3498c-144">This is the list view page for the list, which is on the add-in web, so the ribbon button on the host web opens a page on the add-in web.</span></span>|


## <a name="inspect-the-add-in-web-feature"></a><span data-ttu-id="3498c-145">Проверка компонента сайта надстройки</span><span class="sxs-lookup"><span data-stu-id="3498c-145">Inspect the add-in web feature</span></span>

<span data-ttu-id="3498c-146">В **обозревателе решений** разверните узел **Компоненты** и выберите компонент **NewEmployeeOrientationComponents**.</span><span class="sxs-lookup"><span data-stu-id="3498c-146">In **Solution Explorer**, expand the **Features** folder, and select the **NewEmployeeOrientationComponents** feature.</span></span> <span data-ttu-id="3498c-147">Откроется конструктор компонентов.</span><span class="sxs-lookup"><span data-stu-id="3498c-147">The Feature designer opens.</span></span>

<span data-ttu-id="3498c-148">Обратите внимание, что созданное вами дополнительное действие **RunOrientationAdd-in** находится в списке **Элементы в решении**, а не в списке **Элементы в компоненте**.</span><span class="sxs-lookup"><span data-stu-id="3498c-148">Notice that the custom action that you created, **RunOrientationAdd-in**, is listed in **Items in the solution**, but not in **Items in the feature**.</span></span> <span data-ttu-id="3498c-149">Это связано с тем, что этот компонент развернут на сайте надстройки, а ваше дополнительное действие — на хост-сайте.</span><span class="sxs-lookup"><span data-stu-id="3498c-149">This is because the feature is deployed to the add-in web, but your custom action is deployed to the host web.</span></span> 

<span data-ttu-id="3498c-150">Когда создаете пакет надстройки в Visual Studio для развертывания в рабочей среде или нажимаете клавишу F5 в Visual Studio, пакет Инструменты разработчика Microsoft Office для Visual Studio создает особый компонент хост-сайта, добавляет в него дополнительное действие и развертывает его на хост-сайте.</span><span class="sxs-lookup"><span data-stu-id="3498c-150">When you package the add-in in Visual Studio for deployment to production, or when you select F5 in Visual Studio, the Office Developer Tools for Visual Studio creates a special host web feature, adds the custom action to it, and deploys it to the host web.</span></span> <span data-ttu-id="3498c-151">Ни в коем случае не следует изменять компонент хост-сайта. Именно поэтому он не будет создан до момента формирования пакета.</span><span class="sxs-lookup"><span data-stu-id="3498c-151">You should never edit the host web feature; that is why it is not created until packaging time.</span></span>

<span data-ttu-id="3498c-152">*Рис. 2. Конструктор компонентов*</span><span class="sxs-lookup"><span data-stu-id="3498c-152">*Figure 2. Feature designer*</span></span>

![Конструктор компонентов со столбцами "Элементы в решении" и "Элементы в компоненте".](../images/49ea0bf0-2cfa-4070-aa65-24b4a9c5e874.PNG)

## <a name="run-and-test-the-add-in"></a><span data-ttu-id="3498c-155">Запуск и тестирование надстройки</span><span class="sxs-lookup"><span data-stu-id="3498c-155">Run and test the add-in</span></span>

1. <span data-ttu-id="3498c-p113">Нажмите клавишу F5, чтобы развернуть и запустить надстройку. Visual Studio выполнит временную установку надстройки на тестовом сайте SharePoint и сразу же запустит ее.</span><span class="sxs-lookup"><span data-stu-id="3498c-p113">Use the F5 key to deploy and run your add-in. Visual Studio makes a temporary installation of the add-in on your test SharePoint site and immediately runs the add-in.</span></span> 

2. <span data-ttu-id="3498c-158">Откроется страница надстройки SharePoint по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="3498c-158">The default page of the SharePoint Add-in opens.</span></span> <span data-ttu-id="3498c-159">Перейдите на начальную страницу сайта разработчика (т. е. хост-сайта).</span><span class="sxs-lookup"><span data-stu-id="3498c-159">Go to the home page of your developer site (which is the host web).</span></span> <span data-ttu-id="3498c-160">Ссылка на него расположена в левом верхнем углу страницы.</span><span class="sxs-lookup"><span data-stu-id="3498c-160">There is a breadcrumb link to it in the upper-left corner of the page.</span></span>

3. <span data-ttu-id="3498c-161">На домашней странице хост-сайта щелкните **Содержимое сайта**, а затем на странице **Содержимое сайта** выберите календарь **Employee Orientation Schedule** (Расписание адаптации сотрудников). Обратите внимание, что надстройку **Employee Orientation** (Адаптация сотрудников) выбирать не надо.</span><span class="sxs-lookup"><span data-stu-id="3498c-161">On the host web's home page, select **Site Contents**, and on the **Site Contents** page, select the **Employee Orientation Schedule** calendar (not the **Employee Orientation** add-in).</span></span>

4. <span data-ttu-id="3498c-162">Когда календарь откроется, выберите событие **Orient Cassie Hicks** (Адаптация пользователя Cassie Hicks).</span><span class="sxs-lookup"><span data-stu-id="3498c-162">When the calendar opens, select the event **Orient Cassie Hicks**.</span></span> <span data-ttu-id="3498c-163">Если вкладка **События** на ленте не открылась автоматически, откройте ее.</span><span class="sxs-lookup"><span data-stu-id="3498c-163">If the **Events** tab on the ribbon doesn't open automatically, open it.</span></span> <span data-ttu-id="3498c-164">Она должна выглядеть примерно так, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="3498c-164">It should look similar to the following:</span></span>
    
   <span data-ttu-id="3498c-165">*Рис. 3. Вкладка ленты "События" с настраиваемой кнопкой*</span><span class="sxs-lookup"><span data-stu-id="3498c-165">*Figure 3. Events ribbon tab with custom button*</span></span>

   ![Лента "События" с настраиваемой кнопкой Employee Orientation (Адаптация сотрудников).](../images/916ecbba-11ff-45b6-a8e9-ba717ae6fe0b.png)

5. <span data-ttu-id="3498c-167">В группе **Действия** на ленте выберите элемент **Employee Orientation** (Адаптация сотрудников).</span><span class="sxs-lookup"><span data-stu-id="3498c-167">In the **Actions** group on the ribbon, select **Employee Orientation**.</span></span> <span data-ttu-id="3498c-168">Откроется представление списка **New Employees in Seattle** (Новые сотрудники в Сиэтле).</span><span class="sxs-lookup"><span data-stu-id="3498c-168">The list view page for **New Employees in Seattle** opens.</span></span>

6. <span data-ttu-id="3498c-169">Чтобы завершить сеанс отладки, закройте окно браузера или остановите отладку в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3498c-169">To end the debugging session, close the browser window or stop debugging in Visual Studio.</span></span> <span data-ttu-id="3498c-170">При каждом нажатии клавиши F5 Visual Studio будет отзывать предыдущую версию надстройки и устанавливать последнюю.</span><span class="sxs-lookup"><span data-stu-id="3498c-170">Each time that you select F5, Visual Studio will retract the previous version of the add-in and install the latest one.</span></span>

7. <span data-ttu-id="3498c-171">Вы будете работать с этой надстройкой и решением Visual Studio при изучении других статей, поэтому при перерывах в работе рекомендуется отзывать надстройку.</span><span class="sxs-lookup"><span data-stu-id="3498c-171">You will work with this add-in and Visual Studio solution in other articles, and it's a good practice to retract the add-in one last time when you are done working with it for a while.</span></span> <span data-ttu-id="3498c-172">В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Отозвать**.</span><span class="sxs-lookup"><span data-stu-id="3498c-172">Right-click the project in **Solution Explorer** and select **Retract**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3498c-173">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="3498c-173">Next steps</span></span>
<span data-ttu-id="3498c-174"><a name="Nextsteps"> </a></span><span class="sxs-lookup"><span data-stu-id="3498c-174"></span></span>

<span data-ttu-id="3498c-175">Из следующей статьи этой серии вы узнаете, как добавить JavaScript в надстройку SharePoint и получить доступ к данным SharePoint с помощью объектной модели JavaScript для SharePoint. Название этой статьи: [Использование API JavaScript для SharePoint для работы с данными SharePoint](use-the-sharepoint-javascript-apis-to-work-with-sharepoint-data.md).</span><span class="sxs-lookup"><span data-stu-id="3498c-175">In the next article in this series, you'll add JavaScript to the SharePoint Add-in and access SharePoint data with SharePoint's JavaScript object model: [Use the SharePoint JavaScript APIs to work with SharePoint data](use-the-sharepoint-javascript-apis-to-work-with-sharepoint-data.md).</span></span>
 

 

