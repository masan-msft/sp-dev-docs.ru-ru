---
title: "Создание собственной кнопки ленты на хост-сайте надстройки SharePoint"
description: "Подготовьте хост-сайт, добавьте дополнительное действие на ленте, проверьте компонент сайта надстройки, а затем запустите и протестируйте надстройку."
ms.date: 12/04/2017
ms.prod: sharepoint
ms.openlocfilehash: 7af64ad9f207c8fd43b7fa10039c61e76d06f083
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="create-a-custom-ribbon-button-in-the-host-web-of-a-sharepoint-add-in"></a>Создание собственной кнопки ленты на хост-сайте надстройки SharePoint

Это девятая часть серии статей, посвященной основам разработки надстроек SharePoint, размещаемых в SharePoint. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями этой серии, представленными в разделе [Знакомство с созданием надстроек SharePoint, размещаемых в SharePoint](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md#Nextsteps). 
    
> [!NOTE]
> Если вы изучали предыдущие статьи этой серии о надстройках, размещаемых в SharePoint, то у вас уже есть решение для Visual Studio, которое можно использовать для работы с этой статьей. Кроме того, вы можете скачать репозиторий на веб-странице [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) и открыть файл BeforeRibbon.sln.

Все надстройки SharePoint можно запускать со страницы **Содержимое сайта** на хост-сайте, выбрав плитку надстройки. Функциональность надстройки SharePoint также может быть представлена на хост-сайте посредством дополнительных действий, а именно настраиваемых кнопок ленты или элементов меню. В этой статье описано добавление кнопки на ленту хост-сайта.

## <a name="prepare-the-host-web"></a>Подготовка хост-сайта

Ниже показано, как добавить кнопку на ленту календаря на хост-сайте. В пользовательском интерфейсе сайта разработчика SharePoint выполните указанные ниже действия.

1. На домашней странице сайта выберите пункты **Содержимое сайта** > **Добавить надстройку** > **Календарь**.

2. В диалоговом окне **Добавление календаря** введите **Employee Orientation Schedule** (Расписание адаптации сотрудников) в поле **Имя**, а затем нажмите кнопку **Создать**.

3. Когда откроется календарь, наведите курсор на любую дату, чтобы на ней появилась ссылка **Добавить**, и перейдите по ссылке **Добавить**. 

4. В диалоговом окне **Расписание обучения сотрудников: новый элемент** в поле **Название** введите **Orient Cassi Hicks** (Адаптация пользователя Cassie Hicks). В остальных полях оставьте значения, используемые по умолчанию, и нажмите кнопку **Сохранить**.
    
   Календарь должен выглядеть примерно так:

   *Рис. 1. Настраиваемый календарь*

   ![Календарь под названием "Employee Orientation Schedule" (Расписание адаптации сотрудников), где в пункте "June 1" (1 июня) указано "Orient Cassie Hicks" (Адаптация пользователя Cassie Hicks)](../images/d2066862-41c1-424d-9bfb-b6c5342bcf2c.PNG)

> [!IMPORTANT]
> Для выполнения приведенной ниже процедуры необходимо, чтобы в пользовательском интерфейсе Visual Studio был виден календарь. Однако если при создании календаря Visual Studio была открыта, календарь не будет отображаться. Прежде чем продолжить, выйдите из Visual Studio и закройте все окна браузера и консоли PowerShell, с которых вы вошли на сайт разработчика.

## <a name="add-a-ribbon-custom-action"></a>Добавление дополнительного действия на ленте

1. В **обозревателе решений** щелкните правой кнопкой мыши проект **EmployeeOrientation** и выберите **Добавить** > **Новый элемент** > **Office/SharePoint** > **Дополнительное действие ленты**. Присвойте новому элементу имя **RunOrientationAdd-in** и нажмите кнопку **Добавить**.

2. Мастер создания дополнительного действия для ленты задаст вам несколько вопросов. Ответьте на них, используя таблицу ниже, и нажмите кнопку **Готово**. 

    |**Вопрос для свойства**|**Ответ**|
    |:-----|:-----|
    |Где вы хотите разместить дополнительное действие?|Выберите вариант **хост-сайт**.|
    |К какой области относится дополнительное действие?|Выберите вариант **Экземпляр списка** (*не* "Шаблон списка").|
    |К какому элементу относится дополнительное действие?|Выберите вариант **Employee Orientation Schedule** (Расписание адаптации сотрудников).|
    |Где находится элемент управления?|Не используйте варианты из раскрывающегося списка. Вместо этого введите `Ribbon.Calendar.Events.Actions.Controls._children`. (Третий компонент, **Events**, идентифицирует вкладку ленты, а четвертая часть, **Actions**, — группу кнопок.)|
    |Какой текст указан в элементе меню?|Введите **Employee Orientation** (Адаптация сотрудников).|
    |Куда ведет дополнительное действие?|Не используйте варианты из раскрывающегося списка. Вместо этого введите `~appWebUrl/Lists/NewEmployeesInSeattle`. Это страница представления списка, который находится на сайте надстройки, поэтому кнопка на ленте хост-сайта открывает страницу на сайте надстройки.|


## <a name="inspect-the-add-in-web-feature"></a>Проверка компонента сайта надстройки

В **обозревателе решений** разверните узел **Компоненты** и выберите компонент **NewEmployeeOrientationComponents**. Откроется конструктор компонентов.

Обратите внимание, что созданное вами дополнительное действие **RunOrientationAdd-in** находится в списке **Элементы в решении**, а не в списке **Элементы в компоненте**. Это связано с тем, что этот компонент развернут на сайте надстройки, а ваше дополнительное действие — на хост-сайте. 

Когда создаете пакет надстройки в Visual Studio для развертывания в рабочей среде или нажимаете клавишу F5 в Visual Studio, пакет Инструменты разработчика Microsoft Office для Visual Studio создает особый компонент хост-сайта, добавляет в него дополнительное действие и развертывает его на хост-сайте. Ни в коем случае не следует изменять компонент хост-сайта. Именно поэтому он не будет создан до момента формирования пакета.

*Рис. 2. Конструктор компонентов*

![Конструктор компонентов со столбцами "Элементы в решении" и "Элементы в компоненте". Надстройка запуска адаптации находится в первом, а не во втором столбце.](../images/49ea0bf0-2cfa-4070-aa65-24b4a9c5e874.PNG)

## <a name="run-and-test-the-add-in"></a>Запуск и тестирование надстройки

1. Нажмите клавишу F5, чтобы развернуть и запустить надстройку. Visual Studio выполнит временную установку надстройки на тестовом сайте SharePoint и сразу же запустит ее. 

2. Откроется страница надстройки SharePoint по умолчанию. Перейдите на начальную страницу сайта разработчика (т. е. хост-сайта). Ссылка на него расположена в левом верхнем углу страницы.

3. На домашней странице хост-сайта щелкните **Содержимое сайта**, а затем на странице **Содержимое сайта** выберите календарь **Employee Orientation Schedule** (Расписание адаптации сотрудников). Обратите внимание, что надстройку **Employee Orientation** (Адаптация сотрудников) выбирать не надо.

4. Когда календарь откроется, выберите событие **Orient Cassie Hicks** (Адаптация пользователя Cassie Hicks). Если вкладка **События** на ленте не открылась автоматически, откройте ее. Она должна выглядеть примерно так, как показано ниже.
    
   *Рис. 3. Вкладка ленты "События" с настраиваемой кнопкой*

   ![Лента "События" с настраиваемой кнопкой Employee Orientation (Адаптация сотрудников).](../images/916ecbba-11ff-45b6-a8e9-ba717ae6fe0b.png)

5. В группе **Действия** на ленте выберите элемент **Employee Orientation** (Адаптация сотрудников). Откроется представление списка **New Employees in Seattle** (Новые сотрудники в Сиэтле).

6. Чтобы завершить сеанс отладки, закройте окно браузера или остановите отладку в Visual Studio. При каждом нажатии клавиши F5 Visual Studio будет отзывать предыдущую версию надстройки и устанавливать последнюю.

7. Вы будете работать с этой надстройкой и решением Visual Studio при изучении других статей, поэтому при перерывах в работе рекомендуется отзывать надстройку. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Отозвать**.

## <a name="next-steps"></a>Дальнейшие действия
<a name="Nextsteps"> </a>

Из следующей статьи этой серии вы узнаете, как добавить JavaScript в надстройку SharePoint и получить доступ к данным SharePoint с помощью объектной модели JavaScript для SharePoint. Название этой статьи: [Использование API JavaScript для SharePoint для работы с данными SharePoint](use-the-sharepoint-javascript-apis-to-work-with-sharepoint-data.md).
 

 

