---
title: "Создание настраиваемой кнопки ленты на хост-сайте надстройки SharePoint"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: aa5e03efbb6af2e86f29aa10fbca0f883c0c3427
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="create-a-custom-ribbon-button-in-the-host-web-of-a-sharepoint-add-in"></a>Создание настраиваемой кнопки ленты на хост-сайте надстройки SharePoint
В этой статье рассказывается, как добавить команды для настраиваемых кнопок ленты на хост-сайте надстройки SharePoint.
 

 **Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint.md#bk_newname).
 

Это девятая часть серии статей, посвященной основам разработки надстроек, размещаемых в SharePoint. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями из этой серии.
 

-  [Знакомство с созданием надстроек SharePoint с размещением в SharePoint](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md)
    
 
-  [Развертывание и установка надстроек SharePoint, размещаемых в SharePoint](deploy-and-install-a-sharepoint-hosted-sharepoint-add-in.md)
    
 
-  [Добавление настраиваемых столбцов в надстройки, размещаемые в SharePoint](add-custom-columns-to-a-sharepoint-hostedsharepoint-add-in.md)
    
 
-  [Добавление настраиваемого типа контента в надстройки, размещаемые в SharePoint](add-a-custom-content-type-to-a-sharepoint-hostedsharepoint-add-in.md)
    
 
-  [Добавление веб-части на страницу в надстройку для SharePoint с размещением в SharePoint](add-a-web-part-to-a-page-in-a-sharepoint-hosted-sharepoint-add-in.md)
    
 
-  [Добавление рабочего процесса в надстройку для SharePoint с размещением в SharePoint](add-a-workflow-to-a-sharepoint-hosted-sharepoint-add-in.md)
    
 
-  [Добавление настраиваемой страницы и стиля для надстройки с размещением в SharePoint](add-a-custom-page-and-style-to-a-sharepoint-hosted-sharepoint-add-in.md)
    
 
-  [Добавление настраиваемой клиентской обработки в надстройку SharePoint, размещаемую в SharePoint](add-custom-client-side-rendering-to-a-sharepoint-hosted-sharepoint-add-in.md)
    
 

 **Примечание.** Если вы изучали предыдущие статьи этой серии о надстройках, размещаемых в SharePoint, то у вас уже есть решение Visual Studio, которое можно использовать для работы с данной статьей. Кроме того, вы можете скачать репозиторий [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) и открыть файл BeforeRibbon.sln.
 

Любую надстройку SharePoint можно запустить на странице **Содержимое сайта** хост-сайта. Для этого достаточно щелкнуть плитку необходимой надстройки. Кроме того, функциональность надстройки SharePoint можно сделать доступной на хост-сайте с помощью дополнительных действий, которые представляют собой настраиваемые кнопки ленты или настраиваемые элементы меню. В процессе изучения этой статьи вы добавите кнопку на ленту хост-сайта.
 

## <a name="prepare-the-host-web"></a>Подготовка хост-сайта

Ниже показано, как добавить кнопку на ленту календаря на хост-сайте. В пользовательском интерфейсе сайта разработчика SharePoint выполните указанные ниже действия.
 

 

1. На домашней странице сайта выберите пункты **Содержимое сайта** > **добавить надстройку** > **Календарь**.
    
 
2. В диалоговом окне **Добавление календаря** в поле **Имя** введите Employee Orientation Schedule (Расписание вводного обучения для сотрудников), а затем нажмите кнопку **Создать**.
    
 
3. Когда откроется календарь, наведите указатель на любую дату, чтобы на ней появилась ссылка **Add** (Добавить), и перейдите по этой ссылке. 
    
 
4. В диалоговом окне **Employee Orientation Schedule - New Item** (Расписание вводного обучения для сотрудников: новый элемент) введите "Orient Cassi Hicks" (Вводное обучение Cassi Hicks) в поле **Title** (Название). В остальных полях оставьте значения, заданные по умолчанию, а затем нажмите кнопку **Save** (Сохранить).
    
    Календарь должен выглядеть примерно так:
    

    **Настраиваемый календарь**

 

  ![Календарь Employee Orientation Schedule (Расписание вводного обучения для сотрудников), где в элементе "1 июня" указано Orient Cassie Hicks (Вводное обучение для пользователя Cassi Hicks)](../images/d2066862-41c1-424d-9bfb-b6c5342bcf2c.PNG)
 

 

 

 

 

 **Важно!** Для выполнения следующей процедуры необходимо, чтобы календарь отображался в пользовательском интерфейсе Visual Studio. Но его не будет видно, если в момент создания календаря Visual Studio будет открыт. Прежде чем продолжить, закройте Visual Studio, окна браузера и консоли PowerShell, с помощью которых вы входили на сайт разработчика.
 


## <a name="add-a-ribbon-custom-action"></a>Добавление дополнительного действия на ленте


1. В **обозревателе решений** щелкните правой кнопкой мыши проект **EmployeeOrientation** (Вводное обучение для сотрудников) и выберите **Добавить** > **Новый элемент** > **Office/SharePoint** > **Настраиваемое действие ленты**. Присвойте новому элементу имя RunOrientationAdd-in и нажмите кнопку **Добавить**.
    
 
2. **Мастер настраиваемого действия для ленты** задаст вам несколько вопросов. Ответьте на них, используя таблицу ниже.
    

|**Вопрос для свойства**|**Ответ**|
|:-----|:-----|
|Где вы хотите разместить дополнительное действие?|Выберите вариант **хост-сайт**.|
|Какова область для дополнительного действия?|Выберите вариант **Экземпляр списка** (*не* "Шаблон списка").|
|К какому элементу относится дополнительное действие?|Выберите вариант **Employee Orientation Schedule** (Расписание вводного обучения для сотрудников).|
|Где находится элемент управления?|Не используйте варианты из раскрывающегося списка. Вместо этого введите **Ribbon.Calendar.Events.Actions.Controls._children**. (Третья часть, **Events**, идентифицирует вкладку на ленте, а четвертая часть, **Actions**, — группу кнопок.)|
|Какой текст будет указан в элементе меню?|Введите **Employee Orientation** (Вводное обучение для сотрудников).|
|Куда будет вести дополнительное действие?|Не используйте варианты из раскрывающегося списка. Вместо этого введите **~appWebUrl/Lists/NewEmployeesInSeattle**. Это страница представления списка, который находится на сайте надстройки, поэтому кнопка на ленте на хост-сайте открывает страницу на сайте надстройки.|
3. Нажмите кнопку **Готово**. 
    
 

## <a name="inspect-the-add-in-web-feature"></a>Проверка компонента сайта надстройки

В **обозревателе решений** разверните узел **Компоненты** и выберите компонент **NewEmployeeOrientationComponents**. Откроется конструктор компонентов.
 

 
Обратите внимание, что созданное вами дополнительное действие **RunOrientationAdd-in** находится в списке **Элементы в решении**, а не в списке **Элементы в компоненте**. Это связано с тем, что компонент развернут на сайте надстройки, а ваше дополнительное действие — на хост-сайте. Когда вы создаете пакет надстройки в Visual Studio для развертывания в рабочей среде или нажимаете клавишу F5 в Visual Studio, пакет Инструменты разработчика Office для Visual Studio создает особый компонент хост-сайта, добавляет в него дополнительное действие и развертывает его на хост-сайте. Ни в коем случае не следует изменять компонент хост-сайта. Именно поэтому он не будет создан до момента формирования пакета.
 

 

**Конструктор компонентов**

 

 
![Конструктор компонентов со столбцами "Элементы в решении" и "Элементы в компоненте". "Надстройка запуска адаптации" находится в первом, а не во втором столбце.](../images/49ea0bf0-2cfa-4070-aa65-24b4a9c5e874.PNG)
 

 

 

## <a name="run-and-test-the-add-in"></a>Запуск и тестирование надстройки


 

 

1. Нажмите клавишу F5, чтобы развернуть и запустить надстройку. Visual Studio выполнит временную установку надстройки на тестовом сайте SharePoint и сразу же запустит ее. 
    
 
2. Откроется страница надстройки SharePoint, указанная по умолчанию. Перейдите на начальную страницу сайта разработчика (то есть хост-сайта). Ссылка на него расположена в левом верхнем углу страницы.
    
 
3. На домашней странице хост-сайта щелкните **Содержимое сайта**, а затем на странице **Содержимое сайта** щелкните календарь **Employee Orientation Schedule** (Расписание вводного обучения для сотрудников). Обратите внимание, что надстройку **Employee Orientation** (Вводное обучение для сотрудников) выбирать не надо.
    
 
4. Когда откроется календарь, щелкните событие **Orient Cassie Hicks** (Вводное обучение для пользователя Cassi Hicks). Если вкладка **События** на ленте не открылась автоматически, откройте ее. Она должна выглядеть примерно так, как показано ниже.
    
    **Вкладка ленты "События" с настраиваемой кнопкой**

 

  ![Лента "События" с настраиваемой кнопкой Employee Orientation (Вводное обучение для сотрудников).](../images/916ecbba-11ff-45b6-a8e9-ba717ae6fe0b.png)
 

 

 
5. В группе **Действия** на ленте выберите элемент **Employee Orientation** (Вводное обучение для сотрудников). Откроется представление списка **New Employees in Seattle** (Новые сотрудники в Сиэтле).
    
 
6. Чтобы завершить сеанс отладки, закройте окно браузера или остановите отладку в Visual Studio. При каждом нажатии клавиши F5 Visual Studio будет отзывать предыдущую версию надстройки и устанавливать ее последнюю версию.
    
 
7. Эти надстройка и решение Visual Studio будут рассматриваться и в других статьях, поэтому при перерывах в работе рекомендуется отзывать надстройку. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Отозвать**.
    
 

## 
<a name="Nextsteps"> </a>

Из следующей статьи этой серии вы узнаете, как добавить JavaScript в надстройку SharePoint и получить доступ к данным SharePoint с помощью объектной модели JavaScript для SharePoint. Название этой статьи:  [Использование API JavaScript для SharePoint для работы с данными SharePoint](use-the-sharepoint-javascript-apis-to-work-with-sharepoint-data.md).
 

 

