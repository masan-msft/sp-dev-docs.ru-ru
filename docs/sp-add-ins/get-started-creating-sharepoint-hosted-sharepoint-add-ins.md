---
title: Знакомство с созданием надстроек SharePoint с размещением в SharePoint
description: Узнайте, как настроить среду разработки и создать свою первую надстройку SharePoint с размещением в SharePoint.
ms.date: 03/14/2018
ms.prod: sharepoint
ms.openlocfilehash: 24cdfe50698d97021c406bdf0a27110ec4dce904
ms.sourcegitcommit: ad9b18a3fc81d9561383413644120e7255d31d61
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/17/2018
---
# <a name="get-started-creating-sharepoint-hosted-sharepoint-add-ins"></a>Знакомство с созданием надстроек SharePoint, размещаемых в SharePoint

Надстройки с размещением в SharePoint — это один из двух основных типов надстроек SharePoint. Обзор надстроек SharePoint и этих основных типов см. в статье [Надстройки SharePoint](sharepoint-add-ins.md). Ниже представлен обзор надстроек с размещением в SharePoint.

- Они содержат списки SharePoint, веб-части, рабочие процессы, пользовательские страницы и другие компоненты, каждый из которых установлен на дочернем сайте (сайте надстройки) того веб-сайта SharePoint, на котором установлена надстройка.
- Единственный код, который они содержат, — JavaScript пользовательских страниц SharePoint.

В этой статье описываются перечисленные ниже действия.

- Настройка среды разработки
- Создание проекта надстройки
- Написание кода надстройки
- Запуск надстройки и тестирование списка

<a name="Setup"> </a>

## <a name="set-up-your-dev-environment"></a>Настройка среды разработки

Существует множество способов настройки среды разработки для надстроек SharePoint. Здесь приведен самый простой из них.

### <a name="get-the-tools"></a>Получение инструментов

- Если вы еще не установили **Visual Studio** 2013 или более поздней версии, сделайте это, следуя инструкциям из статьи [Установка Visual Studio](https://docs.microsoft.com/ru-RU/visualstudio/install/install-visual-studio). Рекомендуем использовать [последнюю версию из Центра загрузки Майкрософт](https://www.visualstudio.com/downloads/download-visual-studio-vs).
 
- Visual Studio включает **Инструменты разработчика Microsoft Office для Visual Studio**. Иногда выпуск новой версии этих инструментов не совпадает с выходом обновлений Visual Studio. Чтобы убедиться, что у вас установлена последняя версия этих инструментов, запустите [установщик набора "Инструменты разработчика Office для Visual Studio 2013"](http://aka.ms/OfficeDevToolsForVS2013) или [установщик набора "Инструменты разработчика Office для Visual Studio 2015"](http://aka.ms/OfficeDevToolsForVS2015). 

Сверяйтесь с [более ранними версиями Visual Studio](http://msdn.microsoft.com/library/da049020-cfda-40d7-8ff4-7492772b620f.aspx) или другой [документацией по Visual Studio](https://docs.microsoft.com/ru-RU/visualstudio/).

<a name="o365_signup"> </a>

### <a name="sign-up-for-an-office-365-developer-subscription"></a>Получение подписки разработчика Office 365

> [!NOTE]
> Возможно, у вас уже есть доступ к подписке разработчика Office 365: 
> - **Вы подписчик Visual Studio (MSDN)?** Подписчики Visual Studio Ultimate и Visual Studio Premium с MSDN получают подписку разработчика Office 365 бесплатно. [Воспользуйтесь этим преимуществом сегодня](https://msdn.microsoft.com/subscriptions/manage/default.aspx). 
> - **У вас есть один из указанных ниже планов подписки на Office 365?** [Создайте сайт разработчика, используя имеющуюся подписку на Office 365](create-a-developer-site-on-an-existing-office-365-subscription.md). 

Чтобы получить план Office 365: 

- [Зарегистрируйтесь в программе для разработчиков Office 365](https://developer.microsoft.com/ru-RU/office/dev-program).

- Пошаговые инструкции для принятия участия в этой программе, регистрации и настройки подписки см. в [документации по программе для разработчиков приложений для Office 365](https://docs.microsoft.com/ru-RU/office/developer-program/office-365-developer-program).

### <a name="open-your-developer-site"></a>Открытие сайта разработчика 
 
Перейдите по ссылке **Создание надстроек** в левом верхнем углу страницы, чтобы открыть сайт разработчика. Открывшийся сайт должен выглядеть так, как показано на следующем рисунке. Наличие на странице списка **Тестируемые надстройки** подтверждает, что веб-сайт был создан с помощью шаблона "Сайт разработчика" SharePoint. Если вместо этого отображается обычный сайт группы, подождите несколько минут и перезагрузите сайт.
    
> [!NOTE]
> Запишите URL-адрес сайта. Он используется при создании проектов надстроек SharePoint в Visual Studio.

**Домашняя страница сайта разработчика со списком "Тестируемые надстройки"**

![Снимок экрана: домашняя страница сайта разработчика.](../images/SP15_DeveloperSiteHome_border.png)


<a name="Create"> </a>

## <a name="create-the-add-in-project"></a>Создание проекта надстройки

1. Запустите Visual Studio, выбрав команду **Запуск от имени администратора**.

2. В Visual Studio выберите пункты **Файл** > **Создать** > **Новый проект**.
 
3. В диалоговом окне **Новый проект** последовательно разверните узлы **Visual C#** и **Office/SharePoint**, а затем выберите элементы **Надстройки** > **Надстройка для SharePoint**.

4. Присвойте проекту имя **EmployeeOrientation**, а затем нажмите кнопку **ОК**.

5. В диалоговом окне **Настройка параметров надстроек SharePoint** укажите полный URL-адрес сайта SharePoint, который требуется использовать для отладки надстройки. Это URL-адрес сайта разработчика. В URL-адресе используйте протокол HTTPS, а не HTTP. В разделе **Как требуется разместить надстройку SharePoint?**, выберите **Размещено в SharePoint**, а затем нажмите кнопку **Готово**.

6. Вам может быть предложено войти на сайт разработчика. В таком случае используйте учетные данные администратора подписки.

7. После создания проекта откройте файл **/Pages/Default.aspx** из корневой папки проекта. Помимо прочего, этот созданный файл загружает один или оба сценария, размещенные в SharePoint: sp.runtime.js и sp.js. Разметку для загрузки этих файлов можно найти в элементе управления **Content** в верхней части файла с идентификатором **PlaceHolderAdditionalPageHead**. Разметка зависит от используемой версии **Инструментов разработчика Microsoft Office для Visual Studio**. В руководствах из этой серии необходимо загружать оба файла с обычными HTML-тегами **\<script\>**, а не с тегами **\<SharePoint:ScriptLink\>**. 

    Убедитесь, что указанные ниже строки присутствуют в элементе управления **PlaceHolderAdditionalPageHead** *над* строкой `<meta name="WebPartPageExpansion" content="full" />`.
    
    ```
      <script type="text/javascript" src="/_layouts/15/sp.runtime.js"></script> 
      <script type="text/javascript" src="/_layouts/15/sp.js"></script> 
    ```

8. Проверьте файл на наличие другой разметки, загружающей один или оба файла сценариев, и удалите ее. Сохраните и закройте файл.

<a name="Code"> </a>
## <a name="code-your-add-in"></a>Написание кода надстройки

Для вашей первой надстройки SharePoint с размещением в SharePoint мы включим классическое расширение SharePoint: настраиваемый список и его экземпляр.

1. В **обозревателе решений** откройте файл AppManifest.xml.

2. Когда откроется конструктор манифеста, измените значение в поле **Title**, на **Адаптация сотрудников**. *Не* меняйте значение в поле **Name**.

3. Сохраните и закройте файл.

4. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункты **Добавить** > **Новая папка**. Назовите папку Lists.

5. Щелкните новую папку правой кнопкой мыши и выберите пункты **Добавить** > **Новый элемент**. В узле **Office/SharePoint** откроется диалоговое окно **Добавление нового элемента**.

6. Выберите **Список**. Задайте для него имя **NewEmployeeOrientation** и нажмите кнопку **Добавить**. 
 
7. На странице **Выберите параметры списка** в мастере настройки SharePoint оставьте заданное по умолчанию отображаемое имя списка **NewEmployeeOrientation**, нажмите кнопку **Создать настраиваемый шаблон списка и экземпляр списка на его основе** и в раскрывающемся списке выберите **По умолчанию (настраиваемый список)**. Затем нажмите кнопку **Готово**.

8. Мастер создаст шаблон списка **NewEmployeeOrientation** с экземпляром дочернего списка под названием **NewEmployeeOrientationInstance**. При этом может открыться конструктор списков, который понадобится на следующем этапе.

9. Разверните узел **NewEmployeeOrientationInstance** в **обозревателе решений**, если вы еще не сделали этого, чтобы четко отличать файл elements.xml, который представляет собой дочерний элемент *экземпляра* списка, от файла elements.xml, который представляет собой дочерний элемент *шаблона* списка.

    ![Содержимое папки с дочерним шаблоном NewEmployeeOrientation, у которого есть три дочерних элемента (NewEmployeeOrientationInstance, файл elements.xml и файл schema.xml). У экземпляра есть дочерний элемент elements.xml.](../images/10e5d116-d24b-4a44-bfff-cfbf2f971b1e.PNG)

10. Откройте дочерний элемент elements.xml в шаблоне списка **NewEmployeeOrientation**.

11. Измените значение атрибута **DisplayName** (не атрибута **Name**), чтобы имя стало более понятным: "Обучение новых сотрудников".

12. Задайте для атрибута **Description** значение "Сведения об адаптации новых сотрудников".

13. Оставьте для других атрибутов значения по умолчанию, а затем сохраните и закройте файл.

14. Если конструктор списков не открыт, выберите узел **NewEmployeeOrientation** в **обозревателе решений**.

15. Откройте вкладку **Список** в конструкторе. Эта вкладка используется для установки определенных значений *экземпляра* (не *шаблона*) списка, но она содержит некоторые значения по умолчанию, унаследованные от шаблона.

16. Замените значения на вкладке **Список** на следующие:
    
    -  **Заголовок**: "Новые сотрудники в Сиэтле".
    -  **URL-адрес списка**: Lists/NewEmployeesInSeattle.
    -  **Описание**: "Новые сотрудники в Сиэтле".

17. Оставьте установленные по умолчанию флажки и закройте конструктор.

18. В **обозревателе решений** может отображаться старое имя экземпляра списка. В таком случае откройте контекстное меню узла **NewEmployeeOrientationInstance**, выберите пункт **Переименовать** и измените имя на **NewEmployeesInSeattle**.

19. Откройте файл schema.xml.

20. В элементе **View**, значение **BaseViewID** которого равно 0, замените имеющийся элемент **ViewFields** на приведенную ниже часть кода. Используйте именно этот GUID для параметра **FieldRef** с именем `Title`. В этом автоматически созданном файле schema.xml могут встречаться разрывы строк в странных местах. Убедитесь, что вы нашли соответствующие начальный и конечный теги элемента **ViewFields**. Добавьте разрывы строк для удобочитаемости. 

    ```
      <ViewFields>
         <FieldRef Name="Title" ID="{fa564e0f-0c70-4ab9-b863-0177e6ddd247}" DisplayName="Employee" />
      </ViewFields>
    ```

21. Не закрывая файл schema.xml, в элементе **View**, значение **BaseViewID** которого равно 1, замените элемент **ViewFields** на приведенную ниже разметку. Используйте именно этот GUID для параметра **FieldRef** с именем `LinkTitle`.
    
    ```
      <ViewFields>
         <FieldRef Name="LinkTitle" ID="{82642ec8-ef9b-478f-acf9-31f7d45fbc31}" DisplayName="Employee" />
      </ViewFields>
    ```

22. Сохраните и закройте файл schema.xml.

23. Откройте файл elements.xml, который представляет собой дочерний элемент *экземпляра* списка **NewEmployeesInSeattle** (а не *шаблона* списка **NewEmployeeOrientation**).

24. В этом файле заполните список начальными данными. Для этого добавьте следующую разметку элемента **Data** в качестве дочернего элемента **ListInstance**.
    
    ```
      <Data>
      <Rows>
        <Row>
          <Field Name="Title">Tom Higginbotham</Field>
        </Row>
        <Row>
          <Field Name="Title">Satomi Hayakawa</Field>
        </Row>
        <Row>
          <Field Name="Title">Cassi Hicks</Field>
        </Row>
        <Row>
          <Field Name="Title">Lertchai Treetawatchaiwong</Field>
        </Row>
      </Rows>
    </Data>
    ```

25. Сохраните и закройте файл.

26. В **обозревателе решений** дважды щелкните элемент **Компонент1**, чтобы открыть конструктор компонентов. В конструкторе задайте для параметра **Название** значение **Компоненты для адаптации новый сотрудников**, а для параметра **Описание** — значение **Списки и другие компоненты для адаптации сотрудников в компании**. Сохраните файл и закройте конструктор.

27. Если элемент **Компонент1** в **обозревателе решений** не был переименован автоматически, откройте его контекстное меню, выберите пункт **Переименовать** и укажите имя **NewEmployeeOrientationComponents**.

28. Откройте файл Default.aspx.

29. Найдите элемент **Content** для ASP.NET с идентификатором **PlaceHolderPageTitleInTitleArea**. Замените стандартную строку **Заголовок страницы** на **Новые сотрудники по местонахождению**.

30. Найдите элемент **Content** для ASP.NET с идентификатором **PlaceHolderMain**. *Замените* его содержимое на приведенную ниже разметку. `_spPageContextInfo` — это объект JavaScript, который SharePoint автоматически включает на страницу. Его свойство `webAbsoluteUrl` возвращает URL-адрес сайта надстройки.
    
    ```XML
        <p><asp:HyperLink runat="server" 
        NavigateUrl="JavaScript:window.location = _spPageContextInfo.webAbsoluteUrl + '/Lists/NewEmployeesInSeattle/AllItems.aspx';" 
        Text="New Employees in Seattle" /></p>
    ```

<a name="Code"> </a>
## <a name="run-the-add-in-and-test-the-list"></a>Запуск надстройки и тестирование списка

1. Нажмите клавишу F5, чтобы развернуть и запустить надстройку. Visual Studio временно устанавливает надстройку на тестовом сайте SharePoint и сразу же запускает ее. Сведения о том, как пользователи запускают установленную надстройку SharePoint, см. в разделе [Дальнейшие действия](#Nextsteps).

2. Когда откроется страница надстройки по умолчанию, перейдите по ссылке **Новые сотрудники в Сиэтле**, чтобы открыть экземпляр настраиваемого списка.

    ![Отображается страница по умолчанию надстройки, озаглавленная "Новые сотрудники по расположению". Ссылка "Новые сотрудники в Сиэтле". Стрелка от этой ссылки указывает на страницу списка. Она называется "Новые сотрудники в Сиэтле", список приведен ниже.](../images/9dc5cefe-083a-4807-bee6-473001f23db9.png)

3. Добавьте и удалите элементы в списке.

4. Чтобы завершить сеанс отладки, закройте окно браузера или остановите отладку в Visual Studio. При каждом нажатии клавиши F5 Visual Studio будет отзывать предыдущую версию надстройки и устанавливать ее последнюю версию.

5. Вы будете работать с этой надстройкой и решением Visual Studio при изучении других статей, поэтому при перерывах в работе рекомендуем отзывать надстройку. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Отозвать**.

<a name="Nextsteps"> </a>
## <a name="next-steps"></a>Дальнейшие действия

Чтобы создавать надстройки, выполняйте перечисленные ниже действия в указанном порядке.

1.  [Развертывание и установка надстроек SharePoint, размещаемых в SharePoint](deploy-and-install-a-sharepoint-hosted-sharepoint-add-in.md)
2.  [Добавление настраиваемых столбцов в надстройку SharePoint, размещаемую в SharePoint](add-custom-columns-to-a-sharepoint-hosted-sharepoint-add-in.md)
3.  [Добавление настраиваемого типа контента в надстройку с размещением в SharePoint](add-a-custom-content-type-to-a-sharepoint-hosted-sharepoint-add-in.md)
4.  [Добавление веб-части на страницу в надстройке SharePoint, размещаемой в SharePoint](add-a-web-part-to-a-page-in-a-sharepoint-hosted-sharepoint-add-in.md)
5.  [Добавление рабочего процесса в надстройку для SharePoint с размещением в SharePoint](add-a-workflow-to-a-sharepoint-hosted-sharepoint-add-in.md)
6.  [Добавление настраиваемой страницы и стиля для надстройки с размещением в SharePoint](add-a-custom-page-and-style-to-a-sharepoint-hosted-sharepoint-add-in.md)
7.  [Добавление настраиваемой функции отрисовки в клиенте в надстройку SharePoint, размещаемую в SharePoint](add-custom-client-side-rendering-to-a-sharepoint-hosted-sharepoint-add-in.md)
8.  [Создание настраиваемой кнопки ленты на хост-сайте надстройки SharePoint](create-a-custom-ribbon-button-in-the-host-web-of-a-sharepoint-add-in.md)
9.  [Использование API JavaScript для SharePoint для работы с данными SharePoint](use-the-sharepoint-javascript-apis-to-work-with-sharepoint-data.md)
10. [Работа с данными хост-сайта из JavaScript на сайте надстройки](work-with-host-web-data-from-javascript-in-the-add-in-web.md)


