# <a name="three-authorization-systems-for-sharepoint-add-ins"></a>Три системы авторизации для надстроек SharePoint
В этой статье рассказывается о трех системах, которые надстройки SharePoint могут использовать, чтобы получить авторизацию для доступа к ресурсам SharePoint.
 

 **Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint#bk_newname).
 

В SharePoint надстройка SharePoint представляет собой субъект удостоверения, такой же как, например, пользователь. Чтобы использовать ресурсы SharePoint, надстройка должна пройти проверку подлинности и авторизацию. Надстройка может использовать три системы авторизации. Эти системы не являются взаимоисключающими.
 

## <a name="understand-the-three-authorization-systems-and-when-to-use-them"></a>Общие сведения о трех системах авторизации и о том, в каких случаях следует использовать их
<a name="UnderstandThreeSystems"> </a>


 

 

-  **Низкий уровень доверия**: Надстройка SharePoint с размещением у поставщика может зарегистрироваться в службе Служба контроля доступа Microsoft Azure (ACS), которая выдает маркер доступа, позволяющий надстройке обращаться к ресурсам в клиенте SharePoint или ферме, где установлена надстройка. Azure ACS это доверенный поставщик маркеров в "потоке" платформы OAuth 2.0, который включает в себя SharePoint и удаленные компоненты надстройки. Для продажи надстроек, использующих эту систему, можно использовать Магазин Office. Система с низким уровнем доверия в основном предназначена для надстроек, удаленные компоненты которых размещаются в облаке.
    
    Дополнительные сведения о том, как создавать надстройку для SharePoint, использующую систему с низким уровнем доверия, можно найти в узле SDK  [Создание надстроек для SharePoint, которые используют авторизацию с низким уровнем доверия](creating-sharepoint-add-ins-that-use-low-trust-authorization).
    
     **Примечание.** У клиента, устанавливающего надстройку, должна быть учетная запись Office 365. Это необходимо для предоставления надстройке доступа к Azure ACS. Тем не менее клиенту не нужно использовать эту учетную запись для каких-либо других целей, а надстройку можно установить в локальную ферму SharePoint, выполнив ряд простых задач по настройке фермы.
-  **Система с высоким уровнем доверия**: надстройка с размещением у поставщика может установить отношение доверия с SharePoint, используя цифровые сертификаты. Система с высоким уровнем доверия в первую очередь предназначена для надстроек, удаленные компоненты которых размещены в локальной среде. Надстройку можно установить в ферме SharePoint, не подключенной к Интернету. Его невозможно установить в SharePoint Online или отправить для продажи в Магазин Office.
    
    Дополнительные сведения о том, как создать надстройку для SharePoint, использующую систему с высоким уровнем доверия, можно найти в узле SDK  [Создание надстроек для SharePoint, которые используют авторизацию с высоким уровнем доверия](creating-sharepoint-add-ins-that-use-high-trust-authorization).
    
 
-  **Междоменная библиотека**: если бизнес-логика надстройки находится в JavaScript, вы можете использовать междоменную библиотеку SharePoint вместо систем с низким или высоким уровнем доверия или в дополнение к ним. Библиотека также предназначена для сценариев, в которых некоторые компоненты надстройки размещены в облаке, но корпоративный брандмауэр клиента не позволяет использовать систему с низким уровнем доверия. Браузер пользователя блокирует скрипты из других доменов, но библиотека инкапсулирует безопасную систему для обхода этого ограничения. Надстройки, использующие библиотеку, можно отправлять для продажи в Магазин Office и устанавливать в SharePoint Online или в локальной среде SharePoint.
    
    Дополнительные сведения о том, как создать надстройку для SharePoint, использующую междоменную библиотеку, можно найти в узле SDK  [Создание надстроек для SharePoint, которые используют междоменную библиотеку](creating-sharepoint-add-ins-that-use-the-cross-domain-library), в записи блога  [Устранение проблем с междоменным взаимодействием в надстройках SharePoint](http://blogs.msdn.com/b/officeapps/archive/2012/11/29/solving-cross-domain-problems-in-apps-for-sharepoint.aspx).
    
 

## <a name="background-information-about-the-oauth-20-framework-and-the-sharepoint-implementation-of-it"></a>Общие сведения о платформе OAuth 2.0 и ее реализации в SharePoint
<a name="UnderstandThreeSystems"> </a>

В двух из трех систем авторизации используется платформа OAuth 2.0. OAuth 2.0 — это **открытая платформа для авторизации**. Она позволяет выполнять безопасную авторизацию стандартным способом из классических, мобильных и веб-приложений. OAuth предоставляет пользователям возможность утверждать действия приложений от имени этих пользователей без предоставления имен пользователей и паролей. Например, с помощью OAuth **пользователи могут открывать доступ** к своим личным ресурсам или данным (к списку контактов, документам, фотографиям, видео и т. д.), хранящимся на одном сайте, с другого сайта, **при этом пользователю не нужно будет сообщать свои учетные данные** (обычно это имя пользователя и пароль) другому сайту.
 

 
OAuth позволяет пользователям предоставлять маркеры доступа к их данным, размещенным у определенного поставщика услуг (например, SharePoint). Каждый маркер предоставляет доступ к конкретному поставщику ресурсов (например, к веб-сайту SharePoint) для определенных ресурсов (например, документов в библиотеке документов SharePoint) и на определенное время (например, на 12 часов). Это позволяет пользователю предоставить стороннему классическому или веб-приложению доступ к сведениям, которые хранятся у другого поставщика ресурсов или услуг (например, SharePoint), и делать это без разглашения своего имени пользователя и пароля и без раскрытия  *всех*  своих данных, размещенных у поставщика.
 

 
SharePoint использует платформу **OAuth 2.0** и **применяет "потоки" передачи маркеров** для указанных ниже целей.
 

 

- Авторизация запросов надстройкой SharePoint для доступа к ресурсам SharePoint.
    
 
- Проверка подлинности надстроек в Магазине Office, в каталоге надстроек или в клиенте разработчика.
    
 
Дополнительные и справочные сведения, а также терминологию OAuth можно найти на сайте  [OAuth.net](http://oauth.net/) и в разделе [Протокол веб-авторизации (oauth)](http://datatracker.ietf.org/doc/active/). Коротко говоря, есть сервер ресурсов, на котором размещен защищенный ресурс; владелец ресурса; клиентское приложение, которому необходим доступ к ресурсу; и сервер авторизации, который выдает ресурсу маркеры доступа по запросу владельца ресурса. В официальной документации OAuth предполагается, что существует один владелец ресурса, предоставляющий доступ к ресурсу из клиентского приложения при каждом его запуске. Предполагается также, что человек, использующий клиентское приложение, является владельцем ресурса. В реализации SharePoint учитывается, что ресурс SharePoint, например список, совместно используется несколькими пользователями. Кроме того, в реализации SharePointНадстройка SharePoint получает доступ во время установки, а не при каждом запуске; и ее могут запускать другие пользователи, а не только человек, который ее установил и предоставил ей доступ. (Если надстройки не установлены в SharePoint, но получают доступ к ресурсам SharePoint (это "Надстройки SharePoint" только в определенном смысле), запускающему надстройку пользователю требуется предоставлять разрешения при каждом запуске надстройки.)
 

 
Таким образом, в реализации SharePoint роли OAuth выполняют указанные ниже компоненты.
 

 

- удаленный компонент, входящий в надстройку для SharePoint, играет роль клиентского приложения;
    
 
- пользователи SharePoint являются владельцами ресурса;
    
 
- SharePoint играет роль сервера ресурсов.
    
 
- Azure ACS играет роль сервера авторизации, когда используется  [система авторизации с низким уровнем доверия](creating-sharepoint-add-ins-that-use-low-trust-authorization). Когда используется  [система с высоким уровнем доверия](creating-sharepoint-add-ins-that-use-high-trust-authorization), сама надстройка (наряду с цифровым сертификатом) становится сервером авторизации.
    
 

### <a name="access-tokens-are-not-sign-in-tokens"></a>Маркеры доступа — это не маркеры входа
<a name="FileName_uniquekeyword3"> </a>

Как описано выше, для доступа к ресурсам надстройка должна запросить маркер доступа у сервера авторизации OAuth, который владелец ресурса ранее назначил доверенным издателем маркеров безопасности (STS). В противоположность этому служба маркеров безопасности WS-Federation и служба маркеров безопасности пассивного входа SAML в основном предназначены для выдачи маркеров входа. В SharePoint STS OAuth не используется для выдачи маркеров входа, то есть они не используются в качестве поставщиков удостоверений. Поэтому служба маркеров безопасности OAuth не отображается в списке на странице входа пользователя в разделе **Поставщик проверки подлинности** центра администрирования и в средстве выбора людей в SharePoint.
 

 
Администраторы SharePoint могут использовать команды Windows PowerShell, чтобы включать и отключать OAuth STS подобно тому, как они включают и выключают доверенных поставщиков входа в SharePoint 2010. 
 

 

