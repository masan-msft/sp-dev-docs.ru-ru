---
title: "Три системы авторизации для надстроек SharePoint"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: 0ada356729f13c91d60fc98cc22fb3d1a958542b
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="three-authorization-systems-for-sharepoint-add-ins"></a><span data-ttu-id="b6bea-102">Три системы авторизации для надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="b6bea-102">Three authorization systems for SharePoint Add-ins</span></span>
<span data-ttu-id="b6bea-103">В этой статье рассказывается о трех системах, которые надстройки SharePoint могут использовать, чтобы получить авторизацию для доступа к ресурсам SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6bea-103">Learn the three systems that SharePoint Add-ins can use to get authorization to SharePoint resources.</span></span>
 

 <span data-ttu-id="b6bea-p101">**Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint.md#bk_newname).</span><span class="sxs-lookup"><span data-stu-id="b6bea-p101">**Note**  The name "apps for SharePoint" is changing to "SharePoint Add-ins". During the transition, the documentation and the UI of some SharePoint products and Visual Studio tools might still use the term "apps for SharePoint". For details, see  [New name for apps for Office and SharePoint](new-name-for-apps-for-sharepoint.md#bk_newname).</span></span>
 

<span data-ttu-id="b6bea-p102">В SharePoint надстройка SharePoint представляет собой субъект удостоверения, такой же как, например, пользователь. Чтобы использовать ресурсы SharePoint, надстройка должна пройти проверку подлинности и авторизацию. Надстройка может использовать три системы авторизации. Эти системы не являются взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p102">In SharePoint, a SharePoint Add-in is an identity principal just like a user and it must be authenticated and authorized to use SharePoint resources. There are three authorization systems that an add-in can use. They are not mutually exclusive.</span></span>
 

## <a name="understand-the-three-authorization-systems-and-when-to-use-them"></a><span data-ttu-id="b6bea-110">Общие сведения о трех системах авторизации и о том, в каких случаях следует использовать их</span><span class="sxs-lookup"><span data-stu-id="b6bea-110">Understand the three authorization systems and when to use them</span></span>
<span data-ttu-id="b6bea-111"><a name="UnderstandThreeSystems"> </a></span><span class="sxs-lookup"><span data-stu-id="b6bea-111"></span></span>


 

 

-  <span data-ttu-id="b6bea-p103">**Низкий уровень доверия**: Надстройка SharePoint с размещением у поставщика может зарегистрироваться в службе Служба контроля доступа Microsoft Azure (ACS), которая выдает маркер доступа, позволяющий надстройке обращаться к ресурсам в клиенте SharePoint или ферме, где установлена надстройка. Azure ACS это доверенный поставщик маркеров в "потоке" платформы OAuth 2.0, который включает в себя SharePoint и удаленные компоненты надстройки. Для продажи надстроек, использующих эту систему, можно использовать Магазин Office. Система с низким уровнем доверия в основном предназначена для надстроек, удаленные компоненты которых размещаются в облаке.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p103">**Low-Trust**: A provider-hosted SharePoint Add-in can register with Microsoft Azure Access Control Service (ACS) which issues an access token to the add-in that allows the add-in access to the resources in the SharePoint tenancy or farm on which the add-in is installed. Azure ACS is the trusted token issuer in an OAuth 2.0 Framework "flow" that includes SharePoint and the remote components of the add-in. Add-ins that use this system can be sold in the Office Store. The low-trust system is primarily intended for add-ins whose remote components are hosted in the cloud.</span></span>
    
    <span data-ttu-id="b6bea-116">Дополнительные сведения о том, как создавать надстройку для SharePoint, использующую систему с низким уровнем доверия, можно найти в узле SDK  [Создание надстроек для SharePoint, которые используют авторизацию с низким уровнем доверия](creating-sharepoint-add-ins-that-use-low-trust-authorization.md).</span><span class="sxs-lookup"><span data-stu-id="b6bea-116">For more information about creating a SharePoint Add-in that uses the low-trust system, see the SDK node  [Creating SharePoint Add-ins that use low-trust authorization](creating-sharepoint-add-ins-that-use-low-trust-authorization.md).</span></span>
    
     <span data-ttu-id="b6bea-p104">**Примечание.** У клиента, устанавливающего надстройку, должна быть учетная запись Office 365. Это необходимо для предоставления надстройке доступа к Azure ACS. Тем не менее клиенту не нужно использовать эту учетную запись для каких-либо других целей, а надстройку можно установить в локальную ферму SharePoint, выполнив ряд простых задач по настройке фермы.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p104">**Note**  The customer who installs the add-in must have an Office 365 account. This is needed to give the add-in access to the Azure ACS. However, the customer need not use the account for any other purpose, and the add-in can be installed to an on-premise SharePoint farm after some simple configuration tasks on the farm.</span></span>
-  <span data-ttu-id="b6bea-p105">**Система с высоким уровнем доверия**: надстройка с размещением у поставщика может установить отношение доверия с SharePoint, используя цифровые сертификаты. Система с высоким уровнем доверия в первую очередь предназначена для надстроек, удаленные компоненты которых размещены в локальной среде. Надстройку можно установить в ферме SharePoint, не подключенной к Интернету. Его невозможно установить в SharePoint Online или отправить для продажи в Магазин Office.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p105">**High-Trust**: A provider-hosted add-in can establish trust with SharePoint by using digital certificates. The high-trust system is primarily intended for add-ins whose remote components are hosted on-premise. The add-in can be installed to a SharePoint farm that is not connected to the Internet. The add-in cannot be installed on SharePoint Online or sold in the Office Store.</span></span>
    
    <span data-ttu-id="b6bea-124">Дополнительные сведения о том, как создать надстройку для SharePoint, использующую систему с высоким уровнем доверия, можно найти в узле SDK  [Создание надстроек для SharePoint, которые используют авторизацию с высоким уровнем доверия](creating-sharepoint-add-ins-that-use-high-trust-authorization.md).</span><span class="sxs-lookup"><span data-stu-id="b6bea-124">For more information about creating a SharePoint Add-in that uses the high-trust system, see the SDK node  [Creating SharePoint Add-ins that use high-trust authorization](creating-sharepoint-add-ins-that-use-high-trust-authorization.md).</span></span>
    
 
-  <span data-ttu-id="b6bea-p106">**Междоменная библиотека**: если бизнес-логика надстройки находится в JavaScript, вы можете использовать междоменную библиотеку SharePoint вместо систем с низким или высоким уровнем доверия или в дополнение к ним. Библиотека также предназначена для сценариев, в которых некоторые компоненты надстройки размещены в облаке, но корпоративный брандмауэр клиента не позволяет использовать систему с низким уровнем доверия. Браузер пользователя блокирует скрипты из других доменов, но библиотека инкапсулирует безопасную систему для обхода этого ограничения. Надстройки, использующие библиотеку, можно отправлять для продажи в Магазин Office и устанавливать в SharePoint Online или в локальной среде SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p106">**Cross-Domain Library**: When the add-in's business logic is in JavaScript, you have the option of using the SharePoint cross-domain library either in place of, or as a supplement to, the low-trust and high-trust systems. The library is also intended for scenarios where the add-in has cloud-hosted components, but the customer's corporate firewall makes it difficult to use the low-trust system. The user's browser blocks scripts from other domains, but the library encapsulates a secure system for working around this restriction. Add-ins that use the library can be sold in the Office Store and can be installed to either SharePoint Online or on-premise SharePoint.</span></span>
    
    <span data-ttu-id="b6bea-129">Дополнительные сведения о том, как создать надстройку для SharePoint, использующую междоменную библиотеку, можно найти в узле SDK  [Создание надстроек для SharePoint, которые используют междоменную библиотеку](creating-sharepoint-add-ins-that-use-the-cross-domain-library.md), в записи блога  [Устранение проблем с междоменным взаимодействием в надстройках SharePoint](http://blogs.msdn.com/b/officeapps/archive/2012/11/29/solving-cross-domain-problems-in-apps-for-sharepoint.aspx).</span><span class="sxs-lookup"><span data-stu-id="b6bea-129">For more information about creating a SharePoint Add-in that uses the cross-domain library, see the SDK node  [Creating SharePoint Add-ins that use the cross-domain library](creating-sharepoint-add-ins-that-use-the-cross-domain-library.md), the blog post  [Solving cross-domain problems in SharePoint Add-ins](http://blogs.msdn.com/b/officeapps/archive/2012/11/29/solving-cross-domain-problems-in-apps-for-sharepoint.aspx).</span></span>
    
 

## <a name="background-information-about-the-oauth-20-framework-and-the-sharepoint-implementation-of-it"></a><span data-ttu-id="b6bea-130">Общие сведения о платформе OAuth 2.0 и ее реализации в SharePoint</span><span class="sxs-lookup"><span data-stu-id="b6bea-130">Background information about the OAuth 2.0 Framework and the SharePoint implementation of it</span></span>
<span data-ttu-id="b6bea-131"><a name="UnderstandThreeSystems"> </a></span><span class="sxs-lookup"><span data-stu-id="b6bea-131"></span></span>

<span data-ttu-id="b6bea-p107">В двух из трех систем авторизации используется платформа OAuth 2.0. OAuth 2.0 — это **открытая платформа для авторизации**. Она позволяет выполнять безопасную авторизацию стандартным способом из классических, мобильных и веб-приложений. OAuth предоставляет пользователям возможность утверждать действия приложений от имени этих пользователей без предоставления имен пользователей и паролей. Например, с помощью OAuth **пользователи могут открывать доступ** к своим личным ресурсам или данным (к списку контактов, документам, фотографиям, видео и т. д.), хранящимся на одном сайте, с другого сайта, **при этом пользователю не нужно будет сообщать свои учетные данные** (обычно это имя пользователя и пароль) другому сайту.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p107">Two of the three authorization systems, use the OAuth 2.0 Framework. OAuth 2.0 is an  **open framework for authorization**. OAuth enables secure authorization from desktop, device, and web applications in a standard way. OAuth enables a user to approve an application to act on his or her behalf without sharing his or her user name and password. For example, it **enables a user to share** his or her private resources or data (contact list, documents, photos, videos and so on) on one site with another site, **without requiring the user to provide his or her credentials** (typically user name and password) to the other site.</span></span>
 

 
<span data-ttu-id="b6bea-p108">OAuth позволяет пользователям предоставлять маркеры доступа к их данным, размещенным у определенного поставщика услуг (например, SharePoint). Каждый маркер предоставляет доступ к конкретному поставщику ресурсов (например, к веб-сайту SharePoint) для определенных ресурсов (например, документов в библиотеке документов SharePoint) и на определенное время (например, на 12 часов). Это позволяет пользователю предоставить стороннему классическому или веб-приложению доступ к сведениям, которые хранятся у другого поставщика ресурсов или услуг (например, SharePoint), и делать это без разглашения своего имени пользователя и пароля и без раскрытия  *всех*  своих данных, размещенных у поставщика.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p108">OAuth enables users to provide access tokens to data that is hosted by a given service provider (such as SharePoint). Each token grants access to a specific resource provider (such as a SharePoint website), for specific resources (for example, documents in a SharePoint document library), and for a defined duration (for example, 12 hours). This enables a user to grant a third-party web or desktop application access to information that is stored with another resource or service provider (such as SharePoint), and to do so without sharing his or her user name and password and without sharing  *all*  the data that he or she has with the provider.</span></span>
 

 
<span data-ttu-id="b6bea-140">SharePoint использует платформу **OAuth 2.0** и **применяет "потоки" передачи маркеров** для указанных ниже целей.</span><span class="sxs-lookup"><span data-stu-id="b6bea-140">SharePoint uses the  **OAuth 2.0** framework **uses token passing "flows"** to:</span></span>
 

 

- <span data-ttu-id="b6bea-141">Авторизация запросов надстройкой SharePoint для доступа к ресурсам SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6bea-141">Authorize requests by a SharePoint Add-in to access SharePoint resources.</span></span>
    
 
- <span data-ttu-id="b6bea-142">Проверка подлинности надстроек в Магазине Office, в каталоге надстроек или в клиенте разработчика.</span><span class="sxs-lookup"><span data-stu-id="b6bea-142">Authenticate add-ins in the Office Store, an add-in catalog, or a developer tenant.</span></span>
    
 
<span data-ttu-id="b6bea-p109">Дополнительные и справочные сведения, а также терминологию OAuth можно найти на сайте  [OAuth.net](http://oauth.net/) и в разделе [Протокол веб-авторизации (oauth)](http://datatracker.ietf.org/doc/active/). Коротко говоря, есть сервер ресурсов, на котором размещен защищенный ресурс; владелец ресурса; клиентское приложение, которому необходим доступ к ресурсу; и сервер авторизации, который выдает ресурсу маркеры доступа по запросу владельца ресурса. В официальной документации OAuth предполагается, что существует один владелец ресурса, предоставляющий доступ к ресурсу из клиентского приложения при каждом его запуске. Предполагается также, что человек, использующий клиентское приложение, является владельцем ресурса. В реализации SharePoint учитывается, что ресурс SharePoint, например список, совместно используется несколькими пользователями. Кроме того, в реализации SharePointНадстройка SharePoint получает доступ во время установки, а не при каждом запуске; и ее могут запускать другие пользователи, а не только человек, который ее установил и предоставил ей доступ. (Если надстройки не установлены в SharePoint, но получают доступ к ресурсам SharePoint (это "Надстройки SharePoint" только в определенном смысле), запускающему надстройку пользователю требуется предоставлять разрешения при каждом запуске надстройки.)</span><span class="sxs-lookup"><span data-stu-id="b6bea-p109">For more information and background about OAuth and OAuth terminology, see  [OAuth.net](http://oauth.net/) and [Web Authorization Protocol (oauth)](http://datatracker.ietf.org/doc/active/). In sum, there is a resource server that hosts a protected resource, an owner of the resource, a client application which seeks access to the resource, and an authorization server that issues access tokens to the resource when instructed to by the resource owner. The official OAuth documentation tends to assume a scenario in which there is a single resource owner who grants access to the resource from the client application each time the client application is run. It also assumes that the person using the client application is the resource owner. The SharePoint implementation takes account of the fact that a SharePoint resource, such as a list, is shared among multiple users. Also, in the SharePoint implementation the SharePoint Add-in is granted access when it is installed, not each time it is run; and it can be run by users other than the person who installed it and granted it access. (In the case of add-ins that are not installed on SharePoint, but access SharePoint resources (so they are "SharePoint Add-ins" only in an extended sense), the user running the add-in does have to grant permissions each time the add-in is run.)</span></span>
 

 
<span data-ttu-id="b6bea-150">Таким образом, в реализации SharePoint роли OAuth выполняют указанные ниже компоненты.</span><span class="sxs-lookup"><span data-stu-id="b6bea-150">So, in the SharePoint implementation, the OAuth roles are played by the following components:</span></span>
 

 

- <span data-ttu-id="b6bea-151">удаленный компонент, входящий в надстройку для SharePoint, выполняет роль клиентского приложения;</span><span class="sxs-lookup"><span data-stu-id="b6bea-151">The remote component of a SharePoint Add-in plays the role of the client application.</span></span>
    
 
- <span data-ttu-id="b6bea-152">пользователи SharePoint являются владельцами ресурса;</span><span class="sxs-lookup"><span data-stu-id="b6bea-152">SharePoint users play the role of resource owner.</span></span>
    
 
- <span data-ttu-id="b6bea-153">SharePoint выполняет роль сервера ресурсов.</span><span class="sxs-lookup"><span data-stu-id="b6bea-153">SharePoint plays the role of the resource server.</span></span>
    
 
- <span data-ttu-id="b6bea-154">ACS Azure выполняет роль сервера авторизации при использовании [системы с низким уровнем доверия](creating-sharepoint-add-ins-that-use-low-trust-authorization.md).</span><span class="sxs-lookup"><span data-stu-id="b6bea-154">Azure ACS plays the role of the authorization server when  [the low-trust authorization system](creating-sharepoint-add-ins-that-use-low-trust-authorization.md) is used. When the the high-trust system is used, the add-in itself (along with a digitial certificate) becomes the authorization server.</span></span> <span data-ttu-id="b6bea-155">При использовании [системы с высоким уровнем доверия](creating-sharepoint-add-ins-that-use-high-trust-authorization.md) сервером авторизации становится сама надстройка (вместе с цифровым сертификатом).</span><span class="sxs-lookup"><span data-stu-id="b6bea-155">Azure ACS plays the role of the authorization server when  the low-trust authorization system is used. When the [the high-trust system](creating-sharepoint-add-ins-that-use-high-trust-authorization.md) is used, the add-in itself (along with a digitial certificate) becomes the authorization server.</span></span>
    
 

### <a name="access-tokens-are-not-sign-in-tokens"></a><span data-ttu-id="b6bea-156">Маркеры доступа — не то же, что маркеры входа</span><span class="sxs-lookup"><span data-stu-id="b6bea-156">Access tokens are not sign-in tokens</span></span>
<span data-ttu-id="b6bea-157"><a name="FileName_uniquekeyword3"> </a></span><span class="sxs-lookup"><span data-stu-id="b6bea-157"></span></span>

<span data-ttu-id="b6bea-p111">Как описано выше, для доступа к ресурсам надстройка должна запросить маркер доступа у сервера авторизации OAuth, который владелец ресурса ранее назначил доверенным издателем маркеров безопасности (STS). В противоположность этому служба маркеров безопасности WS-Federation и служба маркеров безопасности пассивного входа SAML в основном предназначены для выдачи маркеров входа. В SharePoint STS OAuth не используется для выдачи маркеров входа, то есть они не используются в качестве поставщиков удостоверений. Поэтому служба маркеров безопасности OAuth не отображается в списке на странице входа пользователя в разделе **Поставщик проверки подлинности** центра администрирования и в средстве выбора людей в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="b6bea-p111">As described above, to access resources, an add-in has to request an access token from an OAuth authorization server that has previously been designated as a trusted security token issuer (STS) by the resource owner. In contrast, the WS-Federation STS and the Security Assertion Markup Language (SAML) passive sign-in STS are primarily intended to issue sign-in tokens. In SharePoint, an OAuth STS is not used for issuing sign-in tokens, that is, they are not used as identity providers. So, you will not see an OAuth STS listed in the user sign-in page, the  **Authentication Provider** section in Central Administration, or the people picker in SharePoint.</span></span>
 

 
<span data-ttu-id="b6bea-162">Администраторы SharePoint могут использовать команды Windows PowerShell, чтобы включать и отключать OAuth STS подобно тому, как они включают и выключают доверенных поставщиков входа в SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="b6bea-162">SharePoint administrators can use Windows PowerShell commands to enable or disable an OAuth STS, similar to how they can enable or disable trusted login providers in SharePoint 2010.</span></span> 
 

 

