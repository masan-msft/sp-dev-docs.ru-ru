---
title: "Краткий обзор объектной модели SharePoint"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: c703d0edf04b77313d6a7276df4e444dee2250cf
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="get-a-quick-overview-of-the-sharepoint-object-model"></a>Краткий обзор объектной модели SharePoint
Краткое описание некоторых основных классов в объектной модели SharePoint.
 

 **Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint.md#bk_newname).
 

Это четвертая часть серии статей, посвященной основам разработки надстроек, размещаемых у поставщика. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями из этой серии.
 

-  [Знакомство с созданием надстроек SharePoint с размещением у поставщика](get-started-creating-provider-hosted-sharepoint-add-ins.md)
    
 
-  [Настройка внешнего вида надстройки SharePoint, размещенной у поставщика](give-your-provider-hosted-add-in-the-sharepoint-look-and-feel.md)
    
 
-  [Добавление настраиваемой кнопки в надстройку, размещенную у поставщика](include-a-custom-button-in-the-provider-hosted-add-in.md)
    
 

 **Примечание.** Если вы изучали предыдущие статьи этой серии о надстройках, размещаемых в SharePoint, то у вас уже есть решение для Visual Studio, которое можно использовать для работы с данной статьей. Кроме того, вы можете скачать репозиторий [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) и открыть файл BeforeSharePointWriteOps.sln.
 

В данной статье мы немного отвлечемся от программирования и кратко рассмотрим клиентскую объектную модель (CSOM) SharePoint. Это большая модель. Она хорошо задокументирована на MSDN в виде справочных статей, инструкций и примеров кода. В этой статье мы предоставим вам только самые поверхностные сведения. Тем не менее благодаря даже такому краткому рассказу большая часть кода, с которым вы столкнетесь в этой серии статей, станет намного понятнее. 
 

## <a name="content-hierarchy"></a>Иерархия содержимого

В таблице ниже показана иерархия содержимого в SharePoint, а также представляющие его классы CSOM. У каждого из этих объектов имеется дочерний объект указанного непосредственно под ним типа.
 

|**Объект**|**Класс**|**Замечания**|
|:-----|:-----|:-----|
|Локальная ферма SharePoint или подписка на SharePoint Online (также называемая клиентом)||К этому уровню CSOM можно получить только ограниченный программный доступ. Например, нет классов Farm, Subscription или Tenant. (в серверной объектной модели SharePoint, которую невозможно использовать в надстройках, имеется программный доступ к этим объектам.)|
|семейство веб-сайтов|**Site**|Семейство веб-сайтов, сгруппированных вместе большей частью по причинам, связанным с администрированием, а также для того чтобы в нем содержались компоненты SharePoint, например эталонные страницы с фирменным оформлением или настраиваемые группы безопасности, которые можно применить ко всем дочерним веб-сайтам. Все веб-сайты принадлежат каким-либо семействам веб-сайтов.|
|веб-сайт|**Web**|Набор страниц и компонентов SharePoint. Может включать дочерние веб-сайты.|
|список|**List**|На этом уровне также находятся библиотеки документов и другие библиотеки файлов. Библиотека документов — это особый тип списка, в котором каждая строка содержит вложенный документ, а в других столбцах содержатся данные об этом документе, например сведения об авторе, дате и времени последнего изменения документа и о том, кто последним извлекал его. |
|элемент списка|**ListItem**|Строка в списке (то есть элемент списка), в полях которой записаны определенные значения. Тоже имеет тип. См. следующую строку. |
|элемент списка|**Тип контента**|Тип элемента списка. Представлен классом **ContentType**. По сути каждый тип элемента списка представляет собой набор столбцов и метаданных. Самый простой их них — встроенный тип контента **Item**. Все другие типы контента являются производными от типа **Item**. В SharePoint имеется много встроенных типов контента, например Event и Announcement. |
|столбец|**Поле**|Объект **Field** включает не только данные о базовом типе данных, но и сведения о том, каким образом форматировать и отображать данные в формах, например в формах создания, отображения и изменения элементов списка.|

 

 
Вы можете программным способом создавать настраиваемые списки, типы контента, типы столбцов и элементы списков. 
 

 
Помимо доступа к содержимому CSOM предоставляет доступ к пользователям, группам, ролям и разрешениям, таксономии, поиску и многому другому.
 

 

## <a name="client-side-runtime-and-batching"></a>Клиентская среда выполнения и пакетная обработка
<a name="CSOMBatching"> </a>

В CSOM используется система пакетной обработки. Система преобразовывает блоки управляемого кода в XML и отправляет их на сервер в одном HTTP-запросе. Для каждой команды система совершает вызов соответствующей серверной объектной модели, а сервер возвращает клиенту отклик в формате нотации объектов JavaScript (JSON). 
 

 
Код SharePoint на клиенте начинается с получения клиентом объекта контекста, представляющего текущий контекст запроса, который включает идентификатор веб-сайта SharePoint (и его родительского семейства веб-сайтов). С помощью этого контекста вы можете получить доступ к объектам CSOM. Обратите внимание на указанные ниже особенности этого кода.
 

 

- Объект  `spContext` имеет тип **SharePointContext** и определен в файле SharePointContext.cs (или в файле SharePointContext.vb), который создается Инструменты разработчика Office для Visual Studio. Вы можете изменять этот файл, но не так часто, как хотелось бы. Для многих проектов надстройки SharePoint этот файл и файл TokenHelper.cs (или файл TokenHelper.vb), который также создается с помощью средств, эффективно работает в качестве расширений CSOM.
    
 
- Объект `clientContext` относится к типу **ClientContext** модели CSOM.
    
 
- Метод **ExecuteQuery** объединяет код операции CRUD в XML-сообщение, которое затем отправляет на сервер SharePoint. Там оно преобразуется в эквивалентный код серверной объектной модели, а затем выполняется.
    
 



```C#
using (var clientContext = spContext.CreateUserClientContextForSPHost())
{
    // CRUD operation or query code goes here.

    clientContext.ExecuteQuery();
}
```

В одной из предыдущих статей этой серии был пример этого шаблона (в показанном ниже методе  `GetLocalEmployeeName`). Обратите внимание на указанные ниже особенности этого метода.
 

 

- Первые две строки в блоке **using** получают ссылки на список и объект элемента списка. Но на самом деле, когда эти строки выполняются в клиентской среде выполнения SharePoint, они просто преобразовываются в формат XML. Метод **ExecuteQuery** отправляет полученный код XML на сервер.
    
 
-  Метод **Load** добавляет дополнительную информацию в сообщение: он сообщает серверу, что необходимо отправить указанный объект на клиент. Метод **ExecuteQuery** получает этот объект (в виде JSON) и использует его для инициализации переменной `selectedLocalEmployee` в клиенте. Последующий код клиентской части затем ссылается на этот объект **ListItem** и его члены. Как вы видите, следующая строка ссылается на значение поля Title (Название) элемента. Если не был вызван метод **Load**, то эта срока приведет к исключению, так как чтобы этот объект появился в клиентской части, необходимо загрузить его.
    
 



```C#
private string GetLocalEmployeeName()
{
    ListItem localEmployee;

    using (var clientContext = spContext.CreateUserClientContextForSPHost())
    {
        List localEmployeesList = clientContext.Web.Lists.GetByTitle("Local Employees");
        selectedLocalEmployee = localEmployeesList.GetItemById(listItemID);
        clientContext.Load(selectedLocalEmployee);
        clientContext.ExecuteQuery();
    }
    return localEmployee["Title"].ToString();
}
```


## 
<a name="Nextsteps"> </a>

 В следующей статье [Добавление операций записи SharePoint в надстройку, размещаемую у поставщика](add-sharepoint-write-operations-to-the-provider-hosted-add-in.md) мы вернемся к программированию и узнаем, как записывать данные в SharePoint.
 

 

