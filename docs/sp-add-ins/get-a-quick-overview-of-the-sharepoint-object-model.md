---
title: "Краткий обзор объектной модели SharePoint"
description: "Узнайте об иерархии контента, клиентской среде выполнения и пакетной обработке."
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: eedec2c5116d1844ff0d2e052aa83a64b14a411e
ms.sourcegitcommit: 655e325aec73c8b7c6b5e3aaf71fbb4d2d223b5d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2017
---
# <a name="get-a-quick-overview-of-the-sharepoint-object-model"></a><span data-ttu-id="e034a-103">Краткий обзор объектной модели SharePoint</span><span class="sxs-lookup"><span data-stu-id="e034a-103">Get a quick overview of the SharePoint object model</span></span>

<span data-ttu-id="e034a-104">Это четвертая часть серии статей, посвященной основам разработки надстроек SharePoint, размещаемых у поставщика. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями из этой серии.</span><span class="sxs-lookup"><span data-stu-id="e034a-104">This is the fourth in a series of articles about the basics of developing provider-hosted SharePoint Add-ins. You should first be familiar with  [SharePoint Add-ins](sharepoint-add-ins.md) and the previous articles in this series:</span></span>

-  [<span data-ttu-id="e034a-105">Знакомство с созданием надстроек SharePoint с размещением у поставщика</span><span class="sxs-lookup"><span data-stu-id="e034a-105">Get started creating provider-hosted SharePoint Add-ins</span></span>](get-started-creating-provider-hosted-sharepoint-add-ins.md)
-  [<span data-ttu-id="e034a-106">Настройка внешнего вида надстройки SharePoint, размещенной у поставщика</span><span class="sxs-lookup"><span data-stu-id="e034a-106">Give your provider-hosted add-in the SharePoint look-and-feel</span></span>](give-your-provider-hosted-add-in-the-sharepoint-look-and-feel.md)
-  [<span data-ttu-id="e034a-107">Добавление настраиваемой кнопки в надстройку, размещенную у поставщика</span><span class="sxs-lookup"><span data-stu-id="e034a-107">Include a custom button in the provider-hosted add-in</span></span>](include-a-custom-button-in-the-provider-hosted-add-in.md)
 
> [!NOTE]
> <span data-ttu-id="e034a-108">Если вы изучали предыдущие статьи из этой серии о надстройках, размещаемых у поставщика, то у вас уже есть решение для Visual Studio, которое можно использовать для работы с этой статьей.</span><span class="sxs-lookup"><span data-stu-id="e034a-108">Note If you have been working through this series about provider-hosted add-ins, then you have a Visual Studio solution that you can use to continue with this topic. You can also download the repository at  SharePoint_Provider-hosted_Add-Ins_Tutorials and open the BeforeSharePointWriteOps.sln file.</span></span> <span data-ttu-id="e034a-109">Кроме того, вы можете скачать репозиторий [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) и открыть файл BeforeSharePointWriteOps.sln.</span><span class="sxs-lookup"><span data-stu-id="e034a-109">You can also download the repository at [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) and open the BeforeSharePointWriteOps.sln file.</span></span>

<span data-ttu-id="e034a-110">В этой статье мы немного отвлечемся от программирования и кратко рассмотрим клиентскую объектную модель (CSOM) SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e034a-110">In this article you'll take a brief break from coding to get a quick overview of the SharePoint Client-side Object Model (CSOM).</span></span> <span data-ttu-id="e034a-111">Это большая модель. Она хорошо задокументирована на сайте MSDN в виде справочных статей, инструкций и примеров кода.</span><span class="sxs-lookup"><span data-stu-id="e034a-111">This model is large and well-documented in MSDN with reference topics, "how-to's", and code samples.</span></span> <span data-ttu-id="e034a-112">В этой статье мы предоставим вам только самые поверхностные сведения.</span><span class="sxs-lookup"><span data-stu-id="e034a-112">In this article, we can only provide the tip of the tip of the tip of the iceberg.</span></span> <span data-ttu-id="e034a-113">Тем не менее благодаря даже такому краткому описанию большая часть кода, с которым вы столкнетесь в этой серии статей, станет намного понятнее.</span><span class="sxs-lookup"><span data-stu-id="e034a-113">But even a very short introduction will make much of the code you see in this series a lot less mysterious.</span></span> 

## <a name="content-hierarchy"></a><span data-ttu-id="e034a-114">Иерархия контента</span><span class="sxs-lookup"><span data-stu-id="e034a-114">Content Hierarchy</span></span>

<span data-ttu-id="e034a-115">В таблице ниже показана иерархия контента в SharePoint, а также представляющие его классы CSOM.</span><span class="sxs-lookup"><span data-stu-id="e034a-115">The table below shows the hierarchy of content in SharePoint and the CSOM classes that represent them. Each of these entities has children of the type just below it.</span></span> <span data-ttu-id="e034a-116">У каждого из этих объектов имеется дочерний элемент указанного непосредственно под ним типа.</span><span class="sxs-lookup"><span data-stu-id="e034a-116">Each of these entities has children of the type just under it.</span></span>
 

|<span data-ttu-id="e034a-117">**Объект**</span><span class="sxs-lookup"><span data-stu-id="e034a-117">**Entity**</span></span>|<span data-ttu-id="e034a-118">**Класс**</span><span class="sxs-lookup"><span data-stu-id="e034a-118">**Class**</span></span>|<span data-ttu-id="e034a-119">**Замечания**</span><span class="sxs-lookup"><span data-stu-id="e034a-119">**Remarks**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="e034a-120">Локальная ферма SharePoint или подписка на SharePoint Online (также называемая клиентом)</span><span class="sxs-lookup"><span data-stu-id="e034a-120">SharePoint on-premises farm or SharePoint Online subscription (also called a tenant)</span></span>||<span data-ttu-id="e034a-p104">К этому уровню CSOM можно получить только ограниченный программный доступ. Например, нет классов Farm, Subscription или Tenant. (в серверной объектной модели SharePoint, которую невозможно использовать в надстройках, имеется программный доступ к этим объектам.)</span><span class="sxs-lookup"><span data-stu-id="e034a-p104">There is only limited programmatic access to this level in CSOM. There is no Farm or Subscription or Tenant class, for example. (SharePoint's server-side object model, which cannot be used in add-ins, enables programmatic access to these entities.)</span></span>|
|<span data-ttu-id="e034a-124">семейство веб-сайтов</span><span class="sxs-lookup"><span data-stu-id="e034a-124">site collection</span></span>|<span data-ttu-id="e034a-125">**Site**</span><span class="sxs-lookup"><span data-stu-id="e034a-125">**Site**</span></span>|<span data-ttu-id="e034a-126">Семейство веб-сайтов, сгруппированных вместе большей частью по причинам, связанным с администрированием, а также для размещения компонентов SharePoint, например эталонных страниц с фирменным оформлением или пользовательских групп безопасности, которые можно применить ко всем дочерним веб-сайтам.</span><span class="sxs-lookup"><span data-stu-id="e034a-126">A collection of websites that are grouped together for mainly administrative reasons and to house SharePoint components, such as branded master pages, or custom security groups, that can be applied to all the child websites. All websites belong to some site collection.</span></span> <span data-ttu-id="e034a-127">Все веб-сайты принадлежат каким-либо семействам веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="e034a-127">All websites belong to some site collection.</span></span>|
|<span data-ttu-id="e034a-128">веб-сайт</span><span class="sxs-lookup"><span data-stu-id="e034a-128">website</span></span>|<span data-ttu-id="e034a-129">**Web**</span><span class="sxs-lookup"><span data-stu-id="e034a-129">**Web**</span></span>|<span data-ttu-id="e034a-p106">Набор страниц и компонентов SharePoint. Может включать дочерние веб-сайты.</span><span class="sxs-lookup"><span data-stu-id="e034a-p106">A set of pages and SharePoint components. Can have subwebsites.</span></span>|
|<span data-ttu-id="e034a-132">список</span><span class="sxs-lookup"><span data-stu-id="e034a-132">list</span></span>|<span data-ttu-id="e034a-133">**List**</span><span class="sxs-lookup"><span data-stu-id="e034a-133">**List**</span></span>|<span data-ttu-id="e034a-p107">На этом уровне также находятся библиотеки документов и другие библиотеки файлов. Библиотека документов — это особый тип списка, в котором каждая строка содержит вложенный документ, а в других столбцах содержатся данные об этом документе, например сведения об авторе, дате и времени последнего изменения документа и о том, кто последним извлекал его.</span><span class="sxs-lookup"><span data-stu-id="e034a-p107">Document libraries and other kinds of file libraries are also at this level. A document library is a special kind of list in which each row includes an attached document, and the other columns are data about the document, such as its author, when it was last edited, and who has it checked out.</span></span> |
|<span data-ttu-id="e034a-136">элемент списка</span><span class="sxs-lookup"><span data-stu-id="e034a-136">list item</span></span>|<span data-ttu-id="e034a-137">**ListItem**</span><span class="sxs-lookup"><span data-stu-id="e034a-137">**ListItem**</span></span>|<span data-ttu-id="e034a-p108">Строка в списке (то есть элемент списка), в полях которой записаны определенные значения. Тоже имеет тип. См. следующую строку.</span><span class="sxs-lookup"><span data-stu-id="e034a-p108">A row in a list—that is, a list item—with particular values in the fields of the row. Also has a type. See next row.</span></span> |
|<span data-ttu-id="e034a-141">элемент списка</span><span class="sxs-lookup"><span data-stu-id="e034a-141">list item</span></span>|<span data-ttu-id="e034a-142">**Тип контента**</span><span class="sxs-lookup"><span data-stu-id="e034a-142">**Content Type**</span></span>|<span data-ttu-id="e034a-p109">Тип элемента списка. Представлен классом **ContentType**. По сути каждый тип элемента списка представляет собой набор столбцов и метаданных. Самый простой их них — встроенный тип контента **Item**. Все другие типы контента являются производными от типа **Item**. В SharePoint имеется много встроенных типов контента, например Event и Announcement.</span><span class="sxs-lookup"><span data-stu-id="e034a-p109">The type of a list item. These are represented by the  **ContentType** class. Each is basically a set of columns and metadata. The simplest is the built-in **Item** content type. All other content types are derived from **Item**. SharePoint includes many built-in content types, such as Event and Announcement.</span></span> |
|<span data-ttu-id="e034a-149">столбец</span><span class="sxs-lookup"><span data-stu-id="e034a-149">column</span></span>|<span data-ttu-id="e034a-150">**Поле**</span><span class="sxs-lookup"><span data-stu-id="e034a-150">**Field**</span></span>|<span data-ttu-id="e034a-151">Объект **Field** включает не только данные о базовом типе данных, но и сведения о том, каким образом форматировать и отображать данные в формах, например в формах создания, отображения и изменения элементов списка.</span><span class="sxs-lookup"><span data-stu-id="e034a-151">A  **Field** object includes not only information about the underlying data type, but also information about how the data is formatted and rendered on forms, such as the forms for creating, displaying, and editing specific list items.</span></span>|

<span data-ttu-id="e034a-152">Вы можете программным способом создавать собственные списки, типы контента, типы столбцов и элементы списков.</span><span class="sxs-lookup"><span data-stu-id="e034a-152">You can programmatically create custom lists, content types, column types, and list items.</span></span> 

<span data-ttu-id="e034a-153">Помимо доступа к контенту CSOM предоставляет доступ к пользователям, группам, ролям и разрешениям, таксономии, поиску и многому другому.</span><span class="sxs-lookup"><span data-stu-id="e034a-153">In addition to content, the CSOM gives you access to users, groups, roles  permissions, taxonomy, search, and more.</span></span>

<span data-ttu-id="e034a-154"><a name="CSOMBatching"> </a></span><span class="sxs-lookup"><span data-stu-id="e034a-154"></span></span>
## <a name="client-side-runtime-and-batching"></a><span data-ttu-id="e034a-155">Клиентская среда выполнения и пакетная обработка</span><span class="sxs-lookup"><span data-stu-id="e034a-155">Client-side runtime and batching</span></span>

<span data-ttu-id="e034a-156">В CSOM используется система пакетной обработки.</span><span class="sxs-lookup"><span data-stu-id="e034a-156">CSOM uses a batching system.</span></span> <span data-ttu-id="e034a-157">Она преобразовывает блоки управляемого кода в XML и отправляет их на сервер в одном HTTP-запросе.</span><span class="sxs-lookup"><span data-stu-id="e034a-157">Chunks of managed code are converted into XML and sent to the server in a single HTTP request.</span></span> <span data-ttu-id="e034a-158">Для каждой команды система совершает вызов соответствующей серверной объектной модели, а сервер возвращает клиенту отклик в формате нотации объектов JavaScript (JSON).</span><span class="sxs-lookup"><span data-stu-id="e034a-158">CSOM uses a batching system. Chunks of managed code is converted into XML and sent to the server in a single HTTP request. For every command, a corresponding server object model call is made, and the server returns a response to the client in JavaScript Object Notation (JSON) format.</span></span> 

<span data-ttu-id="e034a-159">Код SharePoint на клиенте начинается с получения клиентом объекта контекста, представляющего текущий контекст запроса, который включает идентификатор веб-сайта SharePoint (и его родительского семейства веб-сайтов). С помощью этого контекста вы можете получить доступ к объектам CSOM.</span><span class="sxs-lookup"><span data-stu-id="e034a-159">SharePoint code on a client begins by retrieving a client context object that represents the current request context, including the identity of the SharePoint website (and its parent site collection) and through this context you can obtain access to CSOM objects. The following is the basic structure that you will see again and again. Note the following about this code:</span></span> <span data-ttu-id="e034a-160">Обратите внимание на</span><span class="sxs-lookup"><span data-stu-id="e034a-160">The following is the basic structure that you will see again and again.</span></span> 

```C#
  using (var clientContext = spContext.CreateUserClientContextForSPHost())
  {
      // CRUD operation or query code goes here.

      clientContext.ExecuteQuery();
  }
```

<span data-ttu-id="e034a-161">указанные ниже особенности этого кода.</span><span class="sxs-lookup"><span data-stu-id="e034a-161">Note the following about this code:</span></span>

- <span data-ttu-id="e034a-162">Объект `spContext` имеет тип **SharePointContext** и определен в файле SharePointContext.cs (или в файле SharePointContext.vb), который создается пакетом "Инструменты разработчика Office для Visual Studio".</span><span class="sxs-lookup"><span data-stu-id="e034a-162">The `spContext` object is of the type **SharePointContext** and is defined in the SharePointContext.cs (or .vb) file that is generated by the Office Developer Tools for Visual Studio.</span></span> <span data-ttu-id="e034a-163">Вы можете изменять этот файл, но это требуется не так и часто.</span><span class="sxs-lookup"><span data-stu-id="e034a-163">This file can be modified, but it is not often that you need to do so.</span></span> <span data-ttu-id="e034a-164">Для многих проектов надстройки SharePoint этот файл и файл TokenHelper.cs (или файл TokenHelper.vb), который также создается с помощью этих инструментов, эффективно работает в качестве расширений CSOM.</span><span class="sxs-lookup"><span data-stu-id="e034a-164">For most SharePoint Add-in projects, this file and the TokenHelper.cs (or .vb) file, which is also generated by the tools, effectively function as extensions of CSOM itself.</span></span>

- <span data-ttu-id="e034a-165">Объект `clientContext` относится к типу **ClientContext** модели CSOM.</span><span class="sxs-lookup"><span data-stu-id="e034a-165">The  `clientContext` object is the CSOM type **ClientContext**.</span></span>

- <span data-ttu-id="e034a-166">Метод **ExecuteQuery** объединяет код операции CRUD в XML-сообщение, которое затем отправляет на сервер SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e034a-166">The  **ExecuteQuery** method bundles up the CRUD operation code in and XML message that it sends to the SharePoint server. There it is translated into equivalent server-side object model code and executed.</span></span> <span data-ttu-id="e034a-167">Там оно преобразуется в эквивалентный код серверной объектной модели, а затем выполняется.</span><span class="sxs-lookup"><span data-stu-id="e034a-167">There it is translated into equivalent server-side object model code and executed.</span></span>

<span data-ttu-id="e034a-168">В одной из предыдущих статей этой серии был пример этого шаблона (в приведенном ниже методе `GetLocalEmployeeName`).</span><span class="sxs-lookup"><span data-stu-id="e034a-168">There was an example of this pattern in the previous article of this series, in the  `GetLocalEmployeeName` method shown below. Note the following about this method:</span></span> 

```C#
private string GetLocalEmployeeName()
{
    ListItem localEmployee;

    using (var clientContext = spContext.CreateUserClientContextForSPHost())
    {
        List localEmployeesList = clientContext.Web.Lists.GetByTitle("Local Employees");
        selectedLocalEmployee = localEmployeesList.GetItemById(listItemID);
        clientContext.Load(selectedLocalEmployee);
        clientContext.ExecuteQuery();
    }
    return localEmployee["Title"].ToString();
}
```

<span data-ttu-id="e034a-169">Обратите внимание на указанные ниже особенности этого метода.</span><span class="sxs-lookup"><span data-stu-id="e034a-169">Note the following about this method:</span></span>

- <span data-ttu-id="e034a-p114">Первые две строки в блоке **using** получают ссылки на список и объект элемента списка. Но на самом деле, когда эти строки выполняются в клиентской среде выполнения SharePoint, они просто преобразовываются в формат XML. Метод **ExecuteQuery** отправляет полученный XML на сервер.</span><span class="sxs-lookup"><span data-stu-id="e034a-p114">The first two lines in the **using** block appear to get references to the list and the list item object. But actually when these lines execute in the SharePoint client-side runtime, they are simply translated into an XML format. The **ExecuteQuery** method sends that XML to the server.</span></span>

-  <span data-ttu-id="e034a-173">Метод **Load** добавляет дополнительную информацию в сообщение: он сообщает серверу, что указанный объект необходимо отправить на клиент.</span><span class="sxs-lookup"><span data-stu-id="e034a-173">The **Load** method adds something extra to the message: it tells the server to send the specified object down to the client.</span></span> <span data-ttu-id="e034a-174">Метод **ExecuteQuery** получает этот объект (в виде JSON) и использует его для инициализации переменной `selectedLocalEmployee` в клиенте.</span><span class="sxs-lookup"><span data-stu-id="e034a-174">The **ExecuteQuery** method receives this object (as JSON) and uses it to initialize the client-side `selectedLocalEmployee` variable.</span></span> <span data-ttu-id="e034a-175">Последующий клиентский код затем ссылается на этот объект **ListItem** и его члены.</span><span class="sxs-lookup"><span data-stu-id="e034a-175">Subsequent client-side code then references that **ListItem** object and its members.</span></span> <span data-ttu-id="e034a-176">Как вы видите, следующая строка ссылается на значение поля `"Title"` элемента.</span><span class="sxs-lookup"><span data-stu-id="e034a-176">As you can see, the next line references the value of the item's `"Title"` field.</span></span> <span data-ttu-id="e034a-177">Если не вызван метод **Load**, то эта срока приведет к исключению, так как чтобы этот объект появился на стороне клиента, его необходимо загрузить.</span><span class="sxs-lookup"><span data-stu-id="e034a-177">This line would have thrown an exception if the **Load** method had not been called because the object doesn't really exist on the client-side until it is loaded.</span></span>
 
## <a name="next-steps"></a><span data-ttu-id="e034a-178">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="e034a-178">Next steps</span></span>
<span data-ttu-id="e034a-179"><a name="Nextsteps"> </a></span><span class="sxs-lookup"><span data-stu-id="e034a-179"></span></span>

<span data-ttu-id="e034a-180">В следующей статье мы вернемся к программированию и узнаем, как [добавить операции записи SharePoint в надстройку, размещаемую у поставщика](add-sharepoint-write-operations-to-the-provider-hosted-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="e034a-180">In the next article, we get back to coding and learn how to write data to SharePoint: [Add SharePoint write operations to the provider-hosted add-in](add-sharepoint-write-operations-to-the-provider-hosted-add-in.md)</span></span>
 

 

