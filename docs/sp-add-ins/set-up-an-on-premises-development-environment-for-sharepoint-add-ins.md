---
title: "Настройка локальной среды разработки надстроек SharePoint"
description: "Установка операционной системы и необходимых компонентов, а также настройка служб и изолированного домена надстройки."
ms.date: 11/03/2017
ms.prod: sharepoint
ms.openlocfilehash: fb44b2809e6af3b66f7069d2dd1d7a875214ab71
ms.sourcegitcommit: 074f3a7983a7b253f56f8c670a0290c27bb7734b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2017
---
# <a name="set-up-an-on-premises-development-environment-for-sharepoint-add-ins"></a>Настройка локальной среды разработки надстроек SharePoint

По сравнению с требованиями к рабочей среде, требования к среде разработки менее строгие, а их выполнение менее затратно. Поэтому в инструкциях, приведенных в этом разделе, нет сведений об установке в рабочей среде. 

Инструкции по настройке установки SharePoint в рабочей среде см. в следующих статьях:

- [Обзор установки и настройки SharePoint](http://technet.microsoft.com/ru-RU/library/ee667264%28v=office.15%29)
- [Требования к оборудованию и программному обеспечению для SharePoint](http://technet.microsoft.com/ru-RU/library/cc262485%28v=office.15%29)
- [Настройка среды для надстроек SharePoint](http://technet.microsoft.com/ru-RU/library/fp161236%28office.15%29.aspx) 

<a name="bk_installOS"> </a>
## <a name="install-the-operating-system-for-your-development-environment-for-sharepoint-add-ins"></a>Установка операционной системы для среды разработки надстроек SharePoint

Во всех средах разработки для установки и запуска SharePoint необходимо использовать компьютер с ЦП, поддерживающим архитектуру x64, и с ОЗУ не менее, чем на 16 ГБ. Рекомендуется ОЗУ на 24 ГБ.

В зависимости от конкретных требований и бюджета можно выбрать какой-либо из следующих вариантов.

- Установка SharePoint на сервере с Windows Server 2008 R2 с пакетом обновления 1 (64-разрядной версии) или Windows Server 2012.
 
- Использование Microsoft Hyper-V и установка SharePoint на виртуальной машине под управлением гостевой ОС Windows Server 2012 или Windows Server 2008 R2 64-разрядной версии с пакетом обновления 1. Руководство по настройке виртуальной машины Microsoft Hyper-V для SharePoint см. в статье [Использование рекомендованных конфигураций для виртуальных машин SharePoint и среды Hyper-V](http://technet.microsoft.com/ru-RU/library/ff621103%28v=office.15%29.aspx). 
    
> [!NOTE]
> Установка SharePoint поддерживается только в Windows Server 2008 R2 64-разрядной версии с пакетом обновления 1 или в Windows Server 2012. Если вы хотите разрабатывать надстройки SharePoint для SharePoint в Windows 7 или Windows 8, можно получить доступ к Сайту разработчика Office 365 и разрабатывать надстройки удаленно. 

<a name="bk_prereqsOS"> </a>
## <a name="install-the-prerequisites-for-the-operating-system-and-sharepoint"></a>Установка необходимых компонентов для операционной системы и SharePoint

1. Запустите средство PrerequisiteInstaller.exe, включенное в установочные файлы.

2. Запустите средство Setup.exe, включенное в ваши установочные файлы.

3. Примите условия лицензионного соглашения на использование программного обеспечения корпорации Майкрософт.

4. На странице **Выберите нужный тип установки** выберите вариант **Изолированная**.
    
   *Рис. 1. Выбор варианта установки*

   ![Тип сервера установки SharePoint](../images/SP15_app_ServerType.gif)

5. Если во время установки возникают какие-либо ошибки, просмотрите файл журнала. Чтобы найти его, откройте окно командной строки и введите следующие команды. Ссылка на файл журнала появляется также после завершения установки.
    
   ```
     cd %temp%
   dir /od *.log
   ```

6. После завершения установки вам будет предложено запустить мастер настройки продуктов и технологий SharePoint.
    
   > [!NOTE]
   > Если установка выполняется на компьютере, который подсоединен к домену, но не подключен к контроллеру домена, работа мастера настройки продуктов и технологий SharePoint может завершиться с ошибкой. В этом случае подключитесь к контроллеру домена напрямую или через виртуальную частную сеть (VPN) либо выполните вход, используя локальную учетную запись с правами администратора на компьютере.

7. После завершения работы мастера откроется страница **Выбор шаблона** нового сайта SharePoint. На этой странице выберите шаблон **Сайт разработчика**. Надстройки SharePoint можно развертывать на Сайте разработчика только с помощью Visual Studio.
    
   *Рис. 2. Страница выбора шаблона сайта*

   ![Страница шаблонов сайта](../images/SP15_appChooseSiteTemplate.gif)

<a name="Servertoserver"> </a>
## <a name="configure-services-in-sharepoint-for-server-to-server-add-in-use"></a>Настройка служб в SharePoint для межсерверного использования надстроек

На этом этапе службы в SharePoint настраиваются для межсерверного использования надстроек. Это позволяет создавать размещаемые у поставщиков надстройки с высоким уровнем доверия в вашей среде. Дополнительные сведения о создании таких надстроек см. в статье [Создание надстроек с высоким уровнем доверия для SharePoint](create-high-trust-sharepoint-add-ins.md).

Настройте службу управления приложениями и приложение профилей пользователей (такое название службы связано с тем, что изначально надстройки SharePoint назывались "приложениями для SharePoint"). Для этого выполните следующие действия:
    
1. В **центре администрирования** выберите пункт **Управление приложениями-службами** в разделе **Управление приложениями**.
   
2. На странице **Приложения-службы** убедитесь в том, что запущены следующие службы:
   
   - Приложение-служба профилей пользователей
   - Служба управления приложениями
    
3. В разделе **Управление приложениями** выберите пункт **Управление службами на сервере**. 
   
4. На странице **Службы на сервере** убедитесь в том, что запущены следующие службы:
    
   - Служба профилей пользователей 

Убедитесь в том, что в **приложении-службе профилей пользователей** создан по крайней мере один профиль. Для этого сделайте следующее.
    
1. В **центре администрирования** в разделе **Управление приложениями** выберите пункт **Управление приложениями-службами**.
    
2. Затем выберите пункт **Приложение-служба профилей пользователей**.
    
3. На странице **Служба управления профилями: приложение-служба профилей пользователей** в разделе **Люди** выберите пункт **Управление профилями пользователей**.
    
4. На странице **Управление профилями пользователей** нажмите кнопку **Создать профили**.
    
5. На странице **Добавление профиля пользователя** введите имя своей учетной записи и адрес электронной почты.
    
6. Нажмите кнопку **Сохранить и закрыть**.
    
   > [!NOTE]
   > Если появится сообщение о том, что профиль, который вы пытаетесь создать, уже существует, нажмите **Отменить и вернуться**.

7. Когда вы вернетесь на страницу **Управление профилями пользователей**, должно отобразиться сообщение **Общее число профилей: 1**.
    

<a name="SP15Appdevonprem_bk_installVS"> </a> 
## <a name="install-visual-studio-and-office-developer-tools-for-visual-studio"></a>Установка Visual Studio и Инструментов разработчика Office для Visual Studio

- Если вы еще не установили **Visual Studio** 2013 или более поздней версии, сделайте это согласно инструкциям на странице [Установка Visual Studio](https://docs.microsoft.com/ru-RU/visualstudio/install/install-visual-studio). Рекомендуем использовать [последнюю версию из Центра загрузки Майкрософт](https://www.visualstudio.com/downloads/download-visual-studio-vs).

- В состав Visual Studio входят **Инструменты разработчика Microsoft Office для Visual Studio**, но иногда выход новой версии инструментов не совпадает с выходом обновлений Visual Studio. Чтобы убедиться, что вы используете последнюю версию инструментов, запустите [установщик Инструментов разработчика Office для Visual Studio 2013](http://aka.ms/OfficeDevToolsForVS2013) или [установщик Инструментов разработчика Office для Visual Studio 2015](http://aka.ms/OfficeDevToolsForVS2015).

### <a name="verbose-logging-in-visual-studio"></a>Подробное ведение журнала в Visual Studio

Выполните указанные ниже действия, чтобы включить подробное ведение журнала.

1. Откройте реестр и перейдите к разделу **HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\ _nn.n_\SharePointTools**, где _nn.n_ — это номер версии Visual Studio, например 12.0 или 14.0.

2. Добавьте ключ DWORD под названием **EnableDiagnostics**.

3. Присвойте ключу значение **1**.

Путь реестра в будущих версиях Visual Studio изменится.

<a name="SP15appdevonprem_bk_configure"> </a>
## <a name="configure-an-isolated-add-in-domain-in-sharepoint"></a>Настройка изолированного домена надстройки в SharePoint

Прежде чем выполнять процедуры, описанные в этом разделе, ознакомьтесь с информацией в статье [Хост-сайты, сайты надстроек и изолированный домен](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint.md#IsolatedDomain).

Требуется создать изолированный домен в вашей тестовой ферме SharePoint. Кроме того, для установки SharePoint требуется общий домен с заголовком узла с подстановочными знаками, где можно выполнять подготовку надстроек, размещаемых в SharePoint.

В целях разработки можно изменить свой файл Hosts при необходимости, чтобы сделать возможной маршрутизацию с компьютера разработки к тестовому экземпляру Надстройка SharePoint. Visual Studio изменяет файл Hosts автоматически при создании и развертывании надстройки. 
 
> [!NOTE]
> Для рабочих ферм необходимо создать стратегию маршрутизации DNS в интрасети и, возможно, настроить брандмауэр. Дополнительные сведения о создании и настройке рабочей среды для надстроек SharePoint см. в статье [Установка надстроек SharePoint и управление ими](http://technet.microsoft.com/ru-RU/library/fp161232%28v=office.15%29).

Выполните действия, описанные в следующем разделе, чтобы создать изолированный домен надстройки.
 
> [!NOTE]
> Все эти действия необходимо выполнять от имени администратора фермы, а командную строку и командную консоль SharePoint необходимо запускать от имени администратора.

### <a name="create-an-isolated-add-in-domain-on-your-development-computer"></a>Создание изолированного домена надстройки на компьютере для разработки

1. Убедитесь, что запущены службы spadmin и sptimer. Для этого откройте командную строку и введите приведенные ниже команды.
    
    ```
      net start spadminv4
      net start sptimerv4
    ```

2. Создайте изолированный домен надстройки, запустив командную консоль SharePoint от имени администратора и выполнив следующую команду.

   Замените _contosoaddins.com_ доменом вашей надстройки. Это *не* должен быть поддомен несущего домена SharePoint. В противном случае будет утрачено большинство преимуществ безопасности изолированных доменов надстроек. Например, если имя несущего домена — contoso.com, не используйте addins.contoso.com в качестве домена надстроек.
    
    ```
      Set-SPAppDomain "contosoaddins.com"
    ```

3. Убедитесь, что запущены службы SPSubscriptionSettingsService и AppManagementServiceInstance. Для этого введите в командной консоли SharePoint приведенную ниже команду.
    
    ```
      Get-SPServiceInstance | where{$_.GetType().Name -eq "AppManagementServiceInstance" -or $_.GetType().Name -eq "SPSubscriptionSettingsServiceInstance"} | Start-SPServiceInstance
    ```

4. Убедитесь, что запущены службы SPSubscriptionSettingsService и AppManagementServiceInstance. Для этого введите в командной консоли SharePoint приведенную ниже команду. Результат выполнения команды покажет, подключена ли каждая служба.
    
    ```
      Get-SPServiceInstance | where{$_.GetType().Name -eq "AppManagementServiceInstance" -or $_.GetType().Name -eq "SPSubscriptionSettingsServiceInstance"}
    ```

5. Необходимо указать учетную запись, в которой будут выполняться экземпляры служб SPSubscriptionService и AppManagementServiceInstance. Это должна быть учетная запись SPManagedAccount. Чтобы создать учетную запись SPManagedAccount, введите в командной консоли SharePoint приведенную ниже команду (вам будет предложено указать имя пользователя или домен учетной записи, а также пароль).
    
    ```
      $account = New-SPManagedAccount
    ```

6. Укажите параметры учетной записи, пула приложений и базы данных для служб SPSubscriptionService и AppManagementServiceInstance, введя следующий код в командной консоли SharePoint. Если в предыдущем действии была создана учетная запись SPManagedAccount, используйте здесь ее имя.
    
    ```
     $account = Get-SPManagedAccount "domain\user" 
     $appPoolSubSvc = New-SPServiceApplicationPool -Name SettingsServiceAppPool -Account $account
     $appPoolAppSvc = New-SPServiceApplicationPool -Name AppServiceAppPool -Account $account
     $appSubSvc = New-SPSubscriptionSettingsServiceApplication -ApplicationPool $appPoolSubSvc -Name SettingsServiceApp -DatabaseName SettingsServiceDB 
     $proxySubSvc = New-SPSubscriptionSettingsServiceApplicationProxy -ServiceApplication $appSubSvc
     $appAppSvc = New-SPAppManagementServiceApplication -ApplicationPool $appPoolAppSvc -Name AppServiceApp -DatabaseName AppServiceDB
     $proxyAppSvc = New-SPAppManagementServiceApplicationProxy -ServiceApplication $appAppSvc

    ```

7. Укажите префикс надстройки (см. статью [Хост-сайты, сайты надстроек и изолированный домен](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint.md#IsolatedDomain)). Для этого введите приведенный ниже код в командной консоли SharePoint.
    
    ```
      Set-SPAppSiteSubscriptionName -Name "add-in" -Confirm:$false
    ```

**Выполните следующую процедуру, только если в вашей среде используется прокси-сервер.** После создания изолированного домена надстроек выполните действия, приведенные в следующей процедуре, чтобы добавить этот домен в список обхода в Internet Explorer. Это гарантирует, что вы сможете переходить к этому домену после развертывания надстройки, размещенной в SharePoint, или надстройки, размещенной у поставщика, которая содержит сайт надстройки.

### <a name="add-your-isolated-add-in-domain-to-your-bypass-list-in-internet-explorer"></a>Добавление изолированного домена надстройки в список обхода в Internet Explorer

1. В Internet Explorer откройте меню **Сервис**.

2. Выберите пункт **Свойства браузера**.

3. На вкладке **Подключения** нажмите кнопку **Настройка сети**.

4. Снимите флажок **Автоматическое определение параметров**.

5. Установите флажок **Использовать прокси-сервер для локальных подключений**.

6. Нажмите кнопку **Дополнительно** и добавьте адрес \*.Ваш_домен_надстроек.com в список **Исключения**.

7. Нажмите кнопку **ОК**.

8. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Настройка параметров локальной сети**.

9. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Свойства браузера**.
    
Сведения о доступных вариантах развертывания надстроек см. в статье [Развертывание и установка надстроек SharePoint: методы и параметры](deploying-and-installing-sharepoint-add-ins-methods-and-options.md).
 
> [!TIP]
> Когда вы развернете размещаемую в SharePoint надстройку в среде установки и попробуете запустить эту надстройку, вам может быть предложено войти со своими учетными данными. Чтобы такие предложения больше не появлялись, отключите проверки замыкания на себя. Инструкции по отключению таких проверок см. в статье [При просмотре веб-сайта, использующего встроенную проверку подлинности и размещенного на сервере IIS 5.1 или более поздней версии, появляется сообщение об ошибке 401.1](http://support.microsoft.com/kb/896861).
 

## <a name="additional-resources"></a>Дополнительные ресурсы
<a name="SP15SetupSPO365_bk_addlresources"> </a>

- [Надстройки SharePoint](sharepoint-add-ins.md)
- [Знакомство с созданием надстроек SharePoint с размещением у поставщика](get-started-creating-provider-hosted-sharepoint-add-ins.md)
- [Знакомство с созданием надстроек SharePoint, размещаемых в SharePoint](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md)
- [Установка более ранних версий Visual Studio](http://msdn.microsoft.com/library/da049020-cfda-40d7-8ff4-7492772b620f.aspx)
- [Документация по Visual Studio](https://docs.microsoft.com/ru-RU/visualstudio/)    
 
