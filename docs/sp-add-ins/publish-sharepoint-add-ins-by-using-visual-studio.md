---
title: "Публикация надстроек SharePoint с помощью Visual Studio"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: 7215ae000b40436c64b2a4b566948a88f20b9533
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="publish-sharepoint-add-ins-by-using-visual-studio"></a>Публикация надстроек SharePoint с помощью Visual Studio
Узнайте, как опубликовать Надстройка SharePoint с помощью Microsoft Visual Studio 2013 или Visual Studio 2012. Если с надстройкой связано веб-приложение, то сначала необходимо развернуть его. Затем, как и для всех Надстройки SharePoint, необходимо упаковать Надстройка SharePoint и опубликовать его. Кроме того, можно отправить надстройку для ее включения в Магазин Office.
 

 **Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint.md#bk_newname).
 


## <a name="prerequisites"></a>Необходимые компоненты
<a name="Prereq"> </a>


 

 

-  [Microsoft Visual Studio 2013](http://go.microsoft.com/fwlink/?LinkId=517284  )
    
    -или-
    
     [Visual Studio 2012](https://www.microsoft.com/en-us/download/details.aspx?id=30682) и Инструменты разработчика Office для Visual Studio. Чтобы скачать эти инструменты, см. раздел "Инструменты" на [странице загрузки](http://go.microsoft.com/fwlink/?LinkId=234393). (Новый диспетчер публикации недоступен в Visual Studio 2012 и более ранних версиях.)
    
 
- Microsoft SharePoint
    
 

## <a name="publish-by-using-visual-studio-2013"></a>Публикация с помощью Visual Studio 2013
<a name="VS2013"> </a>

Если с размещаемым у поставщика Надстройка SharePoint связано веб-приложение, для начала разверните файлы для него. Затем, как и для всех Надстройки SharePoint, запакуйте Надстройка SharePoint и опубликуйте его.
 

 

 **Важно!** Чтобы обеспечить публикацию значений идентификатора и секрета клиента SharePoint с веб-проектом, что позволит веб-содержимому получать доступ к данным SharePoint, опубликуйте проект надстройки SharePoint с помощью страницы **Публикация надстройки**. Чтобы открыть эту страницу, вызовите контекстное меню надстройки SharePoint (не веб-приложения) и выберите команду **Опубликовать**.
 


### <a name="step-1-deploy-the-web-application"></a>Этап 1. Развертывание веб-приложения

Обычно с Надстройка SharePoint связано ведущее веб-приложение, которое необходимо развернуть на веб-сервере. Подробнее об использовании мастера веб-публикации см. в статье  [Инструкции. Развертывание проекта веб-приложения с помощью публикации одним щелчком в Visual Studio](http://msdn.microsoft.com/library/dd465337.aspx).
 

 

### <a name="to-open-the-publish-your-add-in-page"></a>Открытие страницы публикации надстроек


- В **обозревателе решений** откройте контекстное меню для проекта надстройки SharePoint и выберите пункт **Опубликовать**.
    
    Откроется страница **Публикация надстройки**.
    
 

### <a name="to-select-or-create-a-profile"></a>Выбор или создание профиля


- В списке **Текущий профиль** выберите профиль для импорта или нажмите **<Создать…>**, чтобы создать профиль.
    
    В профиле публикации указан сервер, на котором развертывается веб-приложение, учетные данные, необходимые для входа на сервер, развертываемые базы данных (если применимо) и другие параметры развертывания. Вы можете создавать различные профили публикации в соответствии с вашими потребностями. Например, можно создать один профиль для тестирования, а другой — для публикации.
    
    Если выбрать команду **<Создать…>**, откроется **мастер создания профиля публикации**. С помощью этого мастера можно импортировать профиль публикации от поставщика услуг размещения сайтов, например Azure, или создать новый профиль, а затем вручную добавить имя сервера, учетные данные и другие параметры. Если создать новый профиль, а не импортировать существующий, потребуется указать значения идентификатора и секрета клиента, как описано в статьях [Регистрация надстроек для SharePoint 2013](http://msdn.microsoft.com/library/jj687469.aspx) и [Создание или обновление идентификаторов и секретов клиентов на Панели мониторинга продаж](http://msdn.microsoft.com/library/office/jj220036.aspx).
    
    Если планируется отправить надстройку SharePoint в Магазин Office, то необходимо использовать значения идентификатора и секрета клиента, созданные на Панели мониторинга продаж. Во время разработки вы можете использовать идентификатор и секрет клиента, созданные с помощью страницы appregnew.aspx, но для надстроек, отправляемых в Магазин Office, необходимо использовать идентификаторы и секреты клиентов, полученные из Панели мониторинга продаж. Кроме того, необходимо создать профиль публикации на сайте Azure и импортировать его в Visual Studio, а не создавать профиль в мастере **создания профиля публикации**. При создании профиля в Azure все параметры на вкладке **Подключение** автоматически указываются в Visual Studio. Дополнительные сведения об импорте и создании профилей публикации см. в разделе [Создание профиля публикации](http://msdn.microsoft.com/library/dd465337.aspx#creating_a_profile).
    
     **Совет.** Если не удается опубликовать веб-содержимое напрямую, вы можете создать пакет веб-развертывания, который администратор может развернуть на сайте. Чтобы создать пакет веб-развертывания, создайте новый профиль, откройте вкладку **Подключение** и выберите пункт **Пакет веб-развертывания** в списке **Метод публикации**.

### <a name="to-deploy-your-web-app-project"></a>Развертывание проекта веб-приложения


1. На вкладке **Публикация надстройки** нажмите кнопку **Развернуть веб-проект**.
    
    Откроется диалоговое окно **Публикация веб-сайта**.
    
 
2. Укажите недостающие значения на вкладках **Подключение** и **Параметры**.
    
    Если требуется изменить способ публикации файлов для надстройки SharePoint или надстройка использует внешнюю базу данных, откройте вкладку **Параметры**. См. раздел "Настройка вкладки «Параметры»" статьи [Развертывание проекта веб-приложения с помощью публикации одним щелчком в Visual Studio](http://msdn.microsoft.com/library/dd465337.aspx).
    
 
3. Чтобы узнать, какие элементы будут изменены при развертывании веб-приложения, нажмите кнопку **Начать просмотр** на вкладке **Предварительный просмотр**.
    
 
4. Нажмите кнопку **Опубликовать**, чтобы развернуть проект веб-приложения.
    
 

### <a name="step-2-package-the-add-in"></a>Этап 2. Упаковка надстройки


1. На вкладке **Публикация надстройки** нажмите кнопку **Упаковать надстройку**.
    
    Откроется **мастер публикации надстроек Office и SharePoint**.
    
 
2. В текстовом поле **Где размещен ваш веб-сайт?** введите URL-адрес сайта, на котором будут размещены файлы надстройки SharePoint.
    
    Этот адрес должен начинаться с префикса https. См. раздел [Почему приложения и надстройки должны быть защищены с использованием SSL?](http://msdn.microsoft.com/library/jj591603#bk_q7).
    
     **Примечание.** Веб-сайты Azure автоматически предоставляют конечную точку https. Если надстройка публикуется на сайте Магазина Office или в самом Магазине Office, то адрес должен начинаться с префикса https. Однако если надстройка публикуется на локальном сайте, необходимо использовать префикс http.

    В текстовом поле **Идентификатор клиента надстройки** уже должен появиться идентификатор клиента, указанный в профиле публикации.
    
    Если до этого момента использовалось замещающее значение идентификатора клиента, то теперь необходимо добавить фактический идентификатор клиента. Эти сведения встроены в APP-пакет и позволяют веб-содержимому связываться с SharePoint на динамическом сайте.
    
 
3. Нажмите кнопку **Готово**.
    
    Visual Studio создаст файлы, необходимые для публикации Надстройка SharePoint, а затем откроет конечную папку публикации. Сведения об установке надстроек см. в статье  [Установка надстроек SharePoint и управление ими](http://technet.microsoft.com/library/fp161232.aspx).
    
 

### <a name="step-3-publish-your-sharepoint-add-in-on-the-office-store"></a>Этап 3. Публикация надстройки SharePoint в Магазине Office

Чтобы отправить надстройку SharePoint в Магазин Office, выполните указанные ниже действия.
 

 

1. На странице **Публикация надстройки** нажмите кнопку **Посетить Панель мониторинга продаж** и войдите в свою учетную запись Панели мониторинга продаж Майкрософт.
    
    См. статью [Отправка надстроек Office и SharePoint, а также веб-приложений для Office 365 в Магазин Office](http://msdn.microsoft.com/library/submit-office-and-sharepoint-add-ins-and-office-365-web-apps-to-the-office-store%28Office.15%29.aspx).
    
 
2. Нажмите **Добавить новое приложение**, укажите необходимые данные и отправьте надстройку в Магазин Office. Дополнительные сведения см. в статье [Отправка надстроек Office и SharePoint и приложений для Office 365 в Магазин Office с помощью Панели мониторинга продаж](http://msdn.microsoft.com/library/use-the-seller-dashboard-to-submit-office-and-sharepoint-add-ins-and-office-365-apps-to-the-office-store%28Office.15%29.aspx).
    
 

## <a name="publish-by-using-visual-studio-2012"></a>Публикация с помощью Visual Studio 2012
<a name="VS2012"> </a>

Когда надстройка SharePoint будет готова к упаковке, откройте мастер **публикации надстроек Office**, который подготовит файлы надстройки SharePoint к публикации.
 

 

### <a name="step-1-package-the-sharepoint-add-in"></a>Этап 1. Упаковка надстройки SharePoint


1. В **обозревателе решений** откройте контекстное меню для проекта надстройки SharePoint и выберите пункт **Опубликовать**.
    
    Запустится мастер **публикации надстроек Office**. Страницы мастера зависят от типа упаковываемой надстройки SharePoint. Для надстройки с размещением в SharePoint появляется только страница **Сводка**. Для надстройки, размещаемой у поставщика, также отображаются страницы **Профиль** и **Размещение**.
    
 
2. Если надстройка SharePoint размещается у поставщика, укажите имя профиля публикации в списке **Выбор профиля для публикации** и нажмите кнопку **Далее**.
    
    В профиле публикации сохраняются сведения, указанные на странице **Размещение**.
    
 
3. В списке **Где размещен ваш веб-сайт?** укажите URL-адрес веб-приложения, в котором будет размещаться надстройка SharePoint.
    
 
4. В полях под заголовком **Удостоверение надстройки** укажите идентификатор и секрет клиента, а затем нажмите кнопку **Далее**.
    
    См. статью [Авторизация и проверка подлинности надстроек SharePoint](authorization-and-authentication-of-sharepoint-add-ins.md).
    
 
5. Для всех типов надстроек SharePoint установите флажок **Открыть папку выходных данных после успешной упаковки** (если он еще не установлен) и нажмите кнопку **Готово**.
    
    Visual Studio создает все файлы, необходимые для публикации Надстройка SharePoint. Эти файлы находятся в подпапке  `app.Publish` в папке выходных данных проекта (например, `%UserProfile%\Documents\Visual Studio 2012\Projects\MyApp\bin\Debug\app.publish`). В ней содержится APP-файл Надстройка SharePoint и несколько файлов веб-приложения (если Надстройка SharePoint размещается в облаке). Все Надстройки SharePoint включают APP-файл, представляющий собой манифест надстройки для публикации Надстройка SharePoint. Надстройки SharePoint с размещением у поставщика также включают файлы для публикации ведущего веб-приложения.
    
 

### <a name="step-2-publish-the-web-application"></a>Этап 2. Публикация веб-приложения

Если Надстройка SharePoint размещается у поставщика, то с ним связано веб-приложение, которое необходимо опубликовать на веб-сервере. Visual Studio создает пакет развертывания и сценарий для выполнения этой задачи.
 

 
Пакет развертывания для проекта веб-приложения содержится в сжатом файле (ZIP) в папке  `app.publish`. Помимо ZIP-файла, в папке  `app.publish` находятся следующие файлы.
 

 


|**Файл**|**Описание**|
|:-----|:-----|
| _Имя_проекта_.deploy.cmd|Это пакетный файл командной строки, который вызывает средство веб-развертывания, что позволяет упростить установку пакета с помощью командной строки.|
| _Имя_проекта_.SetParameters.xml|Этот файл содержит параметры, которые передаются в средство веб-развертывания при использовании файла deploy.cmd для установки пакета. Настройки пакета Visual Studio определяют значения по умолчанию для всех параметров. Вы можете изменить эти значения, например, если нужно установить веб-приложение на нескольких серверах и использовать разные параметры для каждого из них.|
| _Имя_проекта_.SourceManifest.xml|Этот файл содержит параметры, которые Visual Studio передает в средство веб-развертывания и которые это средство использует для создания веб-пакета. Этот файл требуется средству веб-развертывания только для создания пакета. Он не используется при установке пакета.|
Пошаговые инструкции см. в статье [Как установить пакет развертывания с помощью файла deploy.cmd, созданного в Visual Studio](http://go.microsoft.com/fwlink/?LinkID=254954).
 

 

### <a name="step-3-publish-your-sharepoint-add-in"></a>Этап 3. Публикация надстройки SharePoint
<a name="Publish"> </a>

Чтобы опубликовать Надстройка SharePoint, отправьте файл манифеста надстройки (APP-файл) в Магазин Office, каталог надстроек Office, SharePoint, файловый ресурс или каталог Exchange. Манифест надстройки находится в папке  `app.publish`, например  `%UserProfile%\Documents\Visual Studio 2012\Projects\MyApp\bin\Debug\app.publish`. Дополнительные сведения о публикации Надстройка SharePoint см. в статье  [Авторизация и проверка подлинности для надстроек в SharePoint](authorization-and-authentication-of-sharepoint-add-ins.md).
 

 

## <a name="additional-resources"></a>Дополнительные ресурсы
<a name="Additional"> </a>


-  [Публикация надстроек SharePoint](publish-sharepoint-add-ins.md)
    
 
-  [Публикация надстройки Office](http://msdn.microsoft.com/library/7f3ae6a0-06e9-438c-8899-bd9f605e6d9e%28Office.15%29.aspx)
    
 

