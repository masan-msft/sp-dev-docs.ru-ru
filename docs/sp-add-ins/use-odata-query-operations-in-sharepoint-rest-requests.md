---
title: "Использование операций запросов OData в запросах SharePoint REST"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: a0cd291475b492183a57de1db2a9272154fea3f4
ms.sourcegitcommit: 1cae27d85ee691d976e2c085986466de088f526c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2017
---
# <a name="use-odata-query-operations-in-sharepoint-rest-requests"></a>Использование операций запросов OData в запросах SharePoint REST
Узнайте, как использовать широкий спектр операторов строки запроса OData для выбора, фильтрации и упорядочивания данных, запрашиваемых у службы REST SharePoint. 
 

 **Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint.md#bk_newname).
 

 **Перед началом работы**
 

-  [Знакомство со службой REST в SharePoint](get-to-know-the-sharepoint-rest-service.md)
    
 
-  [Навигация по структуре данных SharePoint, представленной в службе REST](navigate-the-sharepoint-data-structure-represented-in-the-rest-service.md)
    
 
-  [Определение универсальных кодов ресурсов (URI) конечных точек службы SharePoint REST](determine-sharepoint-rest-service-endpoint-uris.md)
    
 
Служба REST SharePoint поддерживает широкий диапазон операторов строки запроса OData, который позволяет выбирать, фильтровать и упорядочивать запрашиваемые данные.
 

 **Совет.** Служба REST в SharePoint Online (а также в локальной среде SharePoint 2016 или более поздней версии) поддерживает объединение нескольких запросов в один вызов с помощью параметра запроса OData `$batch`. Подробные сведения и ссылки на примеры кода см. в статье [Создание пакетного запроса с помощью интерфейсов REST API](make-batch-requests-with-the-rest-apis.md).
 


## <a name="select-fields-to-return"></a>Выбор полей для возврата

С помощью параметра запроса [$select](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#SelectSystemQueryOption) укажите, какие поля необходимо возвращать для списка, элемента списка или другого объекта SharePoint, представленного набором сущностей. Для возврата всех доступных полей используйте запрос `$select=*`
 

 

 **Примечание.** Как правило, если вы не указываете параметр запроса `$select`, служба REST возвращает все доступные поля по умолчанию. Однако иногда некоторые объекты SharePoint включают свойства, для извлечения которых требуется очень много ресурсов. Чтобы оптимизировать работу службы REST, эти свойства не включаются в запрос по умолчанию. Например, свойство **SPWeb.EffectiveBasePermissions** по умолчанию не возвращается, его необходимо запросить с помощью параметра `$select`.
 

Кроме того, можно сделать так, чтобы возвращались планируемые поля из других списков и значения подстановки. Для этого укажите имя поля в параметрах запроса `$select` и `$expand`. Пример:
 

 
 `http://server/site/_api/web/lists('guid')/items?$select=Title,Products/Name&amp;$expand=Products/Name`
 

 
Массовое расширение и выбор связанных элементов не поддерживается.
 

 

## <a name="select-items-to-return"></a>Выбор элементов для возврата

С помощью параметра запроса [$filter](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#FilterSystemQueryOption) укажите, какие элементы необходимо возвращать. В разделе [Операторы запросов OData, поддерживаемые в службе SharePoint REST](#bk_supported) указаны параметры сравнения и функции для фильтрации запросов, которые можно использовать в службе SharePoint REST.
 

 

## <a name="query-for-single-value-lookup-fields"></a>Запрос полей подстановки с одним значением

Поля подстановки одиночного значения представлены двумя отдельными полями в службе REST SharePoint: одно поле представляет фактическое значение поля, а другое — имя поля. Вы можете выполнять запросы значения поля подстановки так же, как для любого другого поля этого типа данных. Например, если значением поля подстановки является строка, вы можете использовать в вашем запросе параметры сравнения строк.
 

 

## <a name="query-for-users"></a>Запрос пользователей

В службе REST SharePoint пользователи представлены понятным (отображаемым) именем пользователя, а не их псевдонимами или комбинацией домена и псевдонима. Следовательно, вам необходимо сформировать запросы к понятным именам пользователей.
 

 

 **Примечание.** Запросы пользователей на основе участия в группах не поддерживаются. Использование оператора **Current** для выполнения запросов по идентификатору текущего пользователя не поддерживается.
 


## <a name="query-for-multi-value-lookup-fields-and-users"></a>Запрос полей подстановки с несколькими значениями и пользователей

Так как поля подстановки с несколькими значениями возвращаются в виде строки из нескольких значений, то их нельзя запросить (например, эквивалент элемента **Includes** или элемента **NotIncludes** не поддерживается).
 

 

## <a name="sort-returned-items"></a>Сортировка результатов

Используйте параметр [$orderby](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#OrderBySystemQueryOption), чтобы указать, как сортировать результаты запроса. Чтобы сортировать результаты по нескольким полям, укажите список полей через запятую. Вы также можете указать, в каком порядке нужно сортировать элементы (по возрастанию или по убыванию), добавив к запросу ключевое слово **asc** или **desc**.
 

 

## <a name="page-through-returned-items"></a>Постраничное разбиение результатов

С помощью параметров [$top](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#TopSystemQueryOption) и [$skiptoken](http://msdn.microsoft.com/library/dd942121.aspx) выберите часть элементов, которую нужно исключить из результатов запроса.
 

 

 **Примечание.** Параметр $skip не работает с запросами, касающимися элементов списков SharePoint.
 

Параметр  `$top` позволяет выбрать первые *n*  элементов набора возврата для получения. Например, следующий URI запрашивает возврат только первых десяти элементов из потенциального набора результатов:
 

 
 `http://server/site/_api/web/lists('<guid>')/items$top=10`
 

 
Параметр $skiptoken позволяет пропустить указанное количество элементов и получить остальные.
 

 
 `$skiptoken=Paged=TRUE&amp;p_ID=5`
 

 

 **Примечание.** При использовании этих параметров запроса следует учитывать, что постраничное разбиение в OData выполняется по порядку. Предположим, что вы размещаете кнопку следующей страницы для отображения элементов списка SharePoint. Вы используете службу REST, чтобы кнопка возвращала элементы 1–20, затем элементы 21–40 и так далее. Однако предположим, что другой пользователь удаляет элемент 4 и 18 между нажатиями кнопки "Далее". В этом случае порядковое размещение остальных элементов сбрасывается, и при отображении элементов 21–40 пропускаются два элемента.
 


## <a name="odata-query-operators-supported-in-the-sharepoint-rest-service"></a>Операторы запросов OData, поддерживаемые в службе SharePoint REST
<a name="bk_supported"> </a>



|**Поддерживаются**|**Не поддерживаются**|
|:-----|:-----|
|**Числовые сравнения** Lt Le Gt Ge Eq Ne| Арифметические операторы (Add, Sub, Mul, Div, Mod) Базовые математические функции (округление, пол, потолок) |
|**Сравнение строк** startsWith substringof Eq Ne| endsWith replace substring tolower toupper trim concat|
|**Функции даты и времени** day() month() year() hour() minute() second()| Оператор DateTimeRangesOverlap Запросы относительно того, относится ли дата и время к временному шаблону|
На следующем рисунке показаны поддерживаемые параметры запроса OData.
 

 

**Поддерживаемые параметры запроса OData**

 

 
![Синтаксис параметров запроса службы SharePoint REST](../images/SPF15Con_REST_queryOptionSyntax.png)
 

 

 

## <a name="additional-resources"></a>Дополнительные ресурсы
<a name="bk_addresources"> </a>


-  [Знакомство со службой REST в SharePoint](get-to-know-the-sharepoint-rest-service.md)
    
 
-  [Выполнение базовых операций с использованием конечных точек SharePoint REST](complete-basic-operations-using-sharepoint-rest-endpoints.md)
    
 
-  [Работа со списками и элементами списков в интерфейсе REST](working-with-lists-and-list-items-with-rest.md)
    
 
-  [Работа с папками и файлами в службе REST](working-with-folders-and-files-with-rest.md)
    
 
-  [Навигация по структуре данных SharePoint, представленной в службе REST](navigate-the-sharepoint-data-structure-represented-in-the-rest-service.md)
    
 
-  [Определение универсальных кодов ресурсов (URI) конечных точек службы SharePoint REST](determine-sharepoint-rest-service-endpoint-uris.md)
    
 
-  [Справочные материалы по интерфейсу API службы REST и примеры](http://msdn.microsoft.com/library/rest-api-reference-and-samples%28Office.15%29.aspx)
    
 

 

 
