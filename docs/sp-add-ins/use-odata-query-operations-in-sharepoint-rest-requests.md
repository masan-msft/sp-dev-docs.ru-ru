---
title: "Использование операций запросов OData в запросах REST SharePoint"
description: "Узнайте, как использовать широкий спектр операторов строки запроса OData для выбора, фильтрации и упорядочивания данных, запрашиваемых у службы REST SharePoint."
ms.date: 12/14/2017
ms.prod: sharepoint
ms.openlocfilehash: 404559d6acfa97bdd9b779e625b4badebdcd6c6a
ms.sourcegitcommit: 202dd467c8e5b62c6469808226ad334061f70aa2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/15/2017
---
# <a name="use-odata-query-operations-in-sharepoint-rest-requests"></a>Использование операций запросов OData в запросах REST SharePoint

**Перед началом работы**

- [Знакомство со службой REST в SharePoint](get-to-know-the-sharepoint-rest-service.md)
- [Навигация по структуре данных SharePoint, представленной в службе REST](navigate-the-sharepoint-data-structure-represented-in-the-rest-service.md)
- [Определение универсальных кодов ресурсов (URI) конечных точек службы SharePoint REST](determine-sharepoint-rest-service-endpoint-uris.md)

Служба REST SharePoint поддерживает широкий диапазон операторов строки запроса OData, который позволяет выбирать, фильтровать и упорядочивать запрашиваемые данные.
 
> [!TIP] 
> Служба REST SharePoint Online (а также локальной среды SharePoint 2016 и более поздних версий) поддерживает объединение нескольких запросов в одном вызове службы с помощью параметра запроса OData `$batch`. Дополнительные сведения и ссылки на примеры кода см. в статье [Отправка пакетных запросов с помощью интерфейсов REST API](make-batch-requests-with-the-rest-apis.md).

## <a name="select-fields-to-return"></a>Выбор полей для возврата

С помощью параметра запроса [$select](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#SelectSystemQueryOption) укажите, какие поля необходимо возвращать для списка, элемента списка или другого объекта SharePoint, представленного набором сущностей. Для возврата всех доступных полей используйте запрос `$select=*`.
 
> [!NOTE] 
> Как правило, если вы не указываете параметр запроса `$select`, служба REST по умолчанию возвращает все доступные поля. Но иногда некоторые объекты SharePoint включают свойства, для получения которых требуется очень много ресурсов. Для оптимизации работы службы REST эти свойства не включаются в запрос по умолчанию. Их следует запрашивать специально. Например, свойство **SPWeb.EffectiveBasePermissions** по умолчанию не возвращается, его необходимо запросить с помощью параметра запроса `$select`.

Кроме того, можно сделать так, чтобы возвращались планируемые поля из других списков и значения подстановки. Для этого укажите имя поля в параметрах запроса `$select` и `$expand`. Пример:

`http://server/site/_api/web/lists('guid')/items?$select=Title,Products/Name&amp;$expand=Products/Name`

Массовое расширение и выбор связанных элементов не поддерживается.

## <a name="select-items-to-return"></a>Выбор элементов для возврата

С помощью параметра запроса [$filter](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#FilterSystemQueryOption) укажите, какие элементы необходимо возвращать. В разделе [Операторы запросов OData, поддерживаемые в службе SharePoint REST](#bk_supported) указаны параметры сравнения и функции для фильтрации запросов, которые можно использовать в службе SharePoint REST.

## <a name="query-for-single-value-lookup-fields"></a>Запрос полей подстановки с одним значением

Поля подстановки одиночного значения представлены двумя отдельными полями в службе REST SharePoint: одно поле представляет фактическое значение поля, а другое — имя поля. Вы можете выполнять запросы значения поля подстановки так же, как для любого другого поля этого типа данных. Например, если значением поля подстановки является строка, вы можете использовать в вашем запросе параметры сравнения строк.

## <a name="query-for-users"></a>Запрос пользователей

В службе REST SharePoint пользователи представлены понятным (отображаемым) именем пользователя, а не их псевдонимами или комбинацией домена и псевдонима. Следовательно, вам необходимо сформировать запросы к понятным именам пользователей.
 
> [!NOTE] 
> Запросы на получение пользователей с учетом членства в группах не поддерживаются. Использование оператора **Current** для выполнения запросов с использованием идентификатора текущего пользователя не поддерживается.

## <a name="query-for-multi-value-lookup-fields-and-users"></a>Запрос на получение полей подстановки с несколькими значениями и пользователей

Поскольку поля подстановки с несколькими значениями возвращаются как строка из нескольких значений, то их нельзя запросить (например, эквивалент элемента **Includes** или элемента **NotIncludes** не поддерживается).

## <a name="sort-returned-items"></a>Сортировка результатов

Используйте параметр [$orderby](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#OrderBySystemQueryOption), чтобы указать, как нужно сортировать результаты запроса. Чтобы сортировать результаты по нескольким полям, укажите список полей через запятую. Вы также можете указать, в каком порядке нужно сортировать элементы (по возрастанию или по убыванию), добавив к запросу ключевое слово **asc** или **desc**.

## <a name="page-through-returned-items"></a>Постраничное разбиение результатов

С помощью параметров запроса [$top](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#TopSystemQueryOption) и [$skiptoken](http://msdn.microsoft.com/library/dd942121.aspx) выберите часть элементов, которую нужно исключить из результатов запроса.
 
> [!NOTE] 
> Параметр запроса $skip не работает с запросами для элементов списков SharePoint.

Параметр `$top` позволяет выбрать первые *n* результатов для возврата. Например, с помощью следующего универсального кода ресурса (URI) можно запросить возврат только первых десяти результатов:

`http://server/site/_api/web/lists('<guid>')/items$top=10`

Параметр $skiptoken позволяет пропустить указанное количество элементов и получить остальные.

`$skiptoken=Paged=TRUE&amp;p_ID=5`
 
> [!NOTE] 
> При использовании этих параметров запроса следует учитывать, что постраничное разбиение в OData выполняется по порядку. Предположим, что вы размещаете кнопку следующей страницы для отображения элементов списка SharePoint. Вы используете службу REST, чтобы кнопка возвращала элементы 1–20, элементы 21–40 и так далее. Однако предположим, что другой пользователь удаляет элемент 4 и 18 между нажатиями кнопки "Далее". В этом случае порядковое размещение остальных элементов сбрасывается, и при отображении элементов 21–40 пропускаются два элемента.
 
<a name="bk_supported"> </a>

## <a name="odata-query-operators-supported-in-the-sharepoint-rest-service"></a>Операторы запросов OData, поддерживаемые в службе SharePoint REST

|**Поддерживаются**|**Не поддерживаются**|
|:-----|:-----|
|**Числовые сравнения** Lt Le Gt Ge Eq Ne| **Арифметические операторы** (Add, Sub, Mul, Div, Mod)<br/>**Базовые математические функции** (округление, пол, потолок) |
|**Сравнение строк** startsWith substringof Eq Ne| endsWith replace substring tolower toupper trim concat|
|**Функции даты и времени** day() month() year() hour() minute() second()| Оператор DateTimeRangesOverlap<br/>Выполнение запроса для выяснения того, входит ли дата или время в указанный повторяющийся временной интервал|

Ниже показаны поддерживаемые параметры запроса OData.

**Поддерживаемые параметры запроса OData**

![Синтаксис параметров запроса для службы REST SharePoint](../images/SPF15Con_REST_queryOptionSyntax.png)

<br/>

## <a name="see-also"></a>См. также
<a name="bk_addresources"> </a>

- [Знакомство со службой REST в SharePoint](get-to-know-the-sharepoint-rest-service.md)
- [Материалы по OData](get-to-know-the-sharepoint-rest-service.md#odata-resources)
- [Справочные материалы по REST API и примеры](https://msdn.microsoft.com/library)
- [Разработка надстроек SharePoint](develop-sharepoint-add-ins.md)
    
 

 

 
