---
title: "Обновление надстроек SharePoint"
description: "Создание и развертывание обновления надстройки SharePoint."
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: 31c1194450d8169cf61fe9cfab57c7203437546e
ms.sourcegitcommit: 655e325aec73c8b7c6b5e3aaf71fbb4d2d223b5d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2017
---
# <a name="update-sharepoint-add-ins"></a><span data-ttu-id="491b6-103">Обновление надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-103">Update SharePoint Add-ins</span></span>

<span data-ttu-id="491b6-104">Вы можете обновить свою надстройку SharePoint, используя встроенную в SharePoint систему обновления.</span><span class="sxs-lookup"><span data-stu-id="491b6-104">You can update your SharePoint Add-in by using the updating support built into SharePoint.</span></span> <span data-ttu-id="491b6-105">В течение 24 часов после отправки обновленной версии надстройки в каталог надстроек организации или приема надстройки в Магазин Office рядом с надстройкой на странице **Контент сайта** каждого веб-сайта, на котором она установлена, появится уведомление о доступном обновлении.</span><span class="sxs-lookup"><span data-stu-id="491b6-105">You can update your SharePoint Add-in by using the updating support built into SharePoint. Within 24 hours after you upload an updated version of the add-in to the organization's add-in catalog or the add-in is accepted at the Office Store, a notification that an update is available appears next to the add-in on  **Site Contents** page of every website where it is installed. As you can see in Figure 1, a link is provided for users to immediately install the update.</span></span> <span data-ttu-id="491b6-106">Как видно на рисунке 1, пользователи могут немедленно установить обновление по предоставленной ссылке.</span><span class="sxs-lookup"><span data-stu-id="491b6-106">As you can see in Figure 1, a link is provided for users to immediately install the update.</span></span>
 
<span data-ttu-id="491b6-107">*Рис. 1. Процесс обновления надстройки SharePoint*</span><span class="sxs-lookup"><span data-stu-id="491b6-107">*Figure 1. Add-in for SharePoint update process*</span></span>

![Руководство по обновлению приложения в пользовательском интерфейсе](../images/UpdatingApp_AppTileUpdateNotice.png)
 
<span data-ttu-id="491b6-p102">Пользователь может установить обновление, не удаляя предыдущую версию. Инфраструктура обновления проверяет установку обновления и выполняет ее откат в случае каких-либо ошибок.</span><span class="sxs-lookup"><span data-stu-id="491b6-p102">A user can install the update without first uninstalling the earlier version. The update infrastructure tests the update installation and rolls it back if there are any errors.</span></span>
 
> [!IMPORTANT]
> <span data-ttu-id="491b6-111">С помощью системы обновления нельзя изменить *тип надстройки*.</span><span class="sxs-lookup"><span data-stu-id="491b6-111">You cannot change the *add-in type* by using the update system.</span></span> <span data-ttu-id="491b6-112">Например, надстройку с размещением в SharePoint нельзя преобразовать в надстройку с размещением у поставщика.</span><span class="sxs-lookup"><span data-stu-id="491b6-112">For example, you cannot change an add-in from SharePoint-hosted to provider-hosted with an update.</span></span> <span data-ttu-id="491b6-113">Чтобы изменить тип, необходимо [перенести данные из старой надстройки в новую](sharepoint-add-ins-update-process.md#Major).</span><span class="sxs-lookup"><span data-stu-id="491b6-113">To make a change of type, you need to [migrate from an old add-in to a new one](sharepoint-add-ins-update-process.md#Major).</span></span> <span data-ttu-id="491b6-114">В частности, так как [программа тестирования надстроек с автоматически размещением закрыта](http://blogs.office.com/2014/05/16/update-on-autohosted-apps-preview-program/.md), надстройку с автоматически размещением нельзя обновить до надстройки с размещением у поставщика.</span><span class="sxs-lookup"><span data-stu-id="491b6-114">In particular, because [the preview program for autohosted add-ins has been closed](http://blogs.office.com/2014/05/16/update-on-autohosted-apps-preview-program/.md), you should be aware that you cannot update an autohosted add-in to a provider-hosted add-in.</span></span> <span data-ttu-id="491b6-115">Преобразуйте надстройку согласно инструкциям в [этой статье](convert-an-autohosted-sharepoint-add-in-to-a-provider-hosted-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="491b6-115">You have to convert the add-in as explained in [Convert an autohosted SharePoint Add-in to a provider-hosted add-in](convert-an-autohosted-sharepoint-add-in-to-a-provider-hosted-add-in.md).</span></span>

<span data-ttu-id="491b6-116"><a name="Prerequisites"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-116"></span></span>
## <a name="prerequisites-for-updating-a-sharepoint-add-in"></a><span data-ttu-id="491b6-117">Необходимые условия для обновления надстройки SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-117">Prerequisites for updating a SharePoint Add-in</span></span>

<span data-ttu-id="491b6-118">Для обновления надстройки SharePoint необходимы вот какие компоненты:</span><span class="sxs-lookup"><span data-stu-id="491b6-118">Before you update a SharePoint Add-in, you need:</span></span>

- <span data-ttu-id="491b6-119">Тестовая установка SharePoint, которая поддерживает изоляцию.</span><span class="sxs-lookup"><span data-stu-id="491b6-119">A test SharePoint installation that is configured for add-in isolation.</span></span> <span data-ttu-id="491b6-120">Инструкции по настройке Сайта разработчика Office 365 см. в статье [Настройка среды для разработки надстроек SharePoint в Office 365](set-up-a-development-environment-for-sharepoint-add-ins-on-office-365.md).</span><span class="sxs-lookup"><span data-stu-id="491b6-120">For instructions about how to set up an Office 365 Developer Site, see [Set up a development environment for SharePoint Add-ins on Office 365](set-up-a-development-environment-for-sharepoint-add-ins-on-office-365.md).</span></span>

- <span data-ttu-id="491b6-121">Инструменты, используемые для создания надстройки SharePoint, которые, как правило, также используются для ее обновления.</span><span class="sxs-lookup"><span data-stu-id="491b6-121">Tools that are used in creating a SharePoint Add-in are usually also used in updating it. For example, most developers use Visual Studio and Microsoft Office Developer Tools for Visual Studio to create SharePoint Add-ins.</span></span> <span data-ttu-id="491b6-122">Например, для создания надстроек SharePoint многие разработчики используют Visual Studio и Инструменты разработчика Microsoft Office для Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="491b6-122">Tools that are used in creating a SharePoint Add-in are usually also used in updating it. For example, most developers use Visual Studio and Microsoft Office Developer Tools for Visual Studio to create SharePoint Add-ins.</span></span>

### <a name="core-concepts-to-know-to-update-a-sharepoint-add-in"></a><span data-ttu-id="491b6-123">Основные понятия, касающиеся обновления надстройки SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-123">Core concepts to know to update a SharePoint Add-in</span></span>

<span data-ttu-id="491b6-124">Прежде чем обновлять надстройку, ознакомьтесь с понятиями в приведенной ниже таблице.</span><span class="sxs-lookup"><span data-stu-id="491b6-124">Review the concepts in the following table before updating your add-in.</span></span>

<span data-ttu-id="491b6-125">**Таблица 1. Основные понятия, касающиеся обновления надстроек SharePoint**</span><span class="sxs-lookup"><span data-stu-id="491b6-125">**Table 1. Core concepts for updating a SharePoint Add-in**</span></span>

|<span data-ttu-id="491b6-126">**Название статьи**</span><span class="sxs-lookup"><span data-stu-id="491b6-126">**Article title**</span></span>|<span data-ttu-id="491b6-127">**Описание**</span><span class="sxs-lookup"><span data-stu-id="491b6-127">**Description**</span></span>|
|:-----|:-----|
| [<span data-ttu-id="491b6-128">Выбор шаблонов для разработки и размещения надстройки SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-128">Choose patterns for developing and hosting your SharePoint Add-in</span></span>](choose-patterns-for-developing-and-hosting-your-sharepoint-add-in.md)|<span data-ttu-id="491b6-129">Сведения о различных типах надстроек SharePoint. Процесс обновления для разных типов отличается.</span><span class="sxs-lookup"><span data-stu-id="491b6-129">Learn about the different types of SharePoint Add-ins. The updating process varies depending on the type.</span></span>|
| [<span data-ttu-id="491b6-130">Процесс обновления надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-130">SharePoint Add-ins update process</span></span>](sharepoint-add-ins-update-process.md)|<span data-ttu-id="491b6-131">Описание процесса обновления надстроек SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-131">Learn about the process for updating SharePoint Add-ins.</span></span>|
| [<span data-ttu-id="491b6-132">Обновление компонентов</span><span class="sxs-lookup"><span data-stu-id="491b6-132">Upgrading Features</span></span>](http://msdn.microsoft.com/library/e917f709-6491-4d50-adbe-2ab8f35da990%28Office.15%29.aspx)|<span data-ttu-id="491b6-133">Узнайте, как обновлять компоненты (пакет SDK SharePoint 2010).</span><span class="sxs-lookup"><span data-stu-id="491b6-133">Learn how to update Features (SharePoint 2010 SDK).</span></span>|
| [<span data-ttu-id="491b6-134">Развертывание и установка надстроек SharePoint: методы и параметры</span><span class="sxs-lookup"><span data-stu-id="491b6-134">Deploying and installing SharePoint Add-ins: methods and options</span></span>](deploying-and-installing-sharepoint-add-ins-methods-and-options.md)|<span data-ttu-id="491b6-135">Сведения о методах публикации, установки и удаления надстроек SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-135">Learn about the methods for publishing, installing, and uninstalling a SharePoint Add-in.</span></span>|
| [<span data-ttu-id="491b6-136">Обработка событий в надстройках SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-136">Handle events in SharePoint Add-ins</span></span>](handle-events-in-sharepoint-add-ins.md)|<span data-ttu-id="491b6-137">Сведения о приемниках удаленных событий в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-137">Learn about remote event receivers in SharePoint.</span></span>|

<span data-ttu-id="491b6-138"><a name="MajorAppUpgradeSteps"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-138"></span></span>
## <a name="major-steps-for-updating-an-add-in"></a><span data-ttu-id="491b6-139">Основные шаги по обновлению надстройки</span><span class="sxs-lookup"><span data-stu-id="491b6-139">Major steps in updating an add-in</span></span>

<span data-ttu-id="491b6-140">Ниже описаны основные шаги по созданию обновления для надстройки SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-140">The following are the major steps that may be needed when you create an update for a SharePoint Add-in.</span></span> <span data-ttu-id="491b6-141">Каждый шаг подробно описан в разделах или статьях, на которые указывают ссылки.</span><span class="sxs-lookup"><span data-stu-id="491b6-141">Each step is discussed in detail in linked sections or articles.</span></span> <span data-ttu-id="491b6-142">Не все они являются обязательными в каждом проекте обновления.</span><span class="sxs-lookup"><span data-stu-id="491b6-142">Not all the steps are required in every update project.</span></span> <span data-ttu-id="491b6-143">Необходимые действия зависят от того, какие компоненты уже содержатся в надстройке, а какие нужно добавить.</span><span class="sxs-lookup"><span data-stu-id="491b6-143">What you must do depends on what components are already in your add-in and what components you are adding.</span></span> <span data-ttu-id="491b6-144">Обязательными являются только действия, отмеченные знаком `**`.</span><span class="sxs-lookup"><span data-stu-id="491b6-144">Only the items marked with `**` are always required.</span></span>

- <span data-ttu-id="491b6-145">Обновите манифест надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-145">Update the add-in manifest.</span></span>

   - <span data-ttu-id="491b6-146">`**` Увеличьте номер **Version** в элементе [App](http://msdn.microsoft.com/library/d5f30dfe-7500-5f85-0f08-f4f220c0c692%28Office.15%29.aspx) файла appmanifest.xml (в первом выпуске схемы надстройки назывались "приложениями").</span><span class="sxs-lookup"><span data-stu-id="491b6-146">***** Raise the **Version** number in the App element of the appmanifest.xml file. (Add-ins were called "apps" when the schema was first released.) Do [not](http://msdn.microsoft.com/library/d5f30dfe-7500-5f85-0f08-f4f220c0c692%28Office.15%29.aspx)  change the ProductID number.</span></span> <span data-ttu-id="491b6-147">*Не* изменяйте номер **ProductID**.</span><span class="sxs-lookup"><span data-stu-id="491b6-147">Do *not* change the **ProductID** number.</span></span>
   
   - <span data-ttu-id="491b6-148">Измените раздел [AppPermissionRequests](http://msdn.microsoft.com/library/4e617622-78d3-3d23-677d-9957eb1fb107%28Office.15%29.aspx) файла appmanifest.xml.</span><span class="sxs-lookup"><span data-stu-id="491b6-148">Change the  [AppPermissionRequests](http://msdn.microsoft.com/library/4e617622-78d3-3d23-677d-9957eb1fb107%28Office.15%29.aspx) section of the appmanifest.xml file.</span></span>
   
   - <span data-ttu-id="491b6-149">Измените раздел [AppPrerequisites](http://msdn.microsoft.com/library/7622b55f-01a1-2c39-9daa-7cfb1a3c890f%28Office.15%29.aspx) файла appmanifest.xml.</span><span class="sxs-lookup"><span data-stu-id="491b6-149">Change the  [AppPrerequisites](http://msdn.microsoft.com/library/7622b55f-01a1-2c39-9daa-7cfb1a3c890f%28Office.15%29.aspx) section of the appmanifest.xml file.</span></span>
    
   <span data-ttu-id="491b6-150">Дополнительные сведения см. в разделе [Обновление версии надстройки, запросов разрешений и необходимых условий](#UpdateManifest).</span><span class="sxs-lookup"><span data-stu-id="491b6-150">For more information, see  [Update the add-in version, permission requests, and prerequisites](#UpdateManifest).</span></span>

- <span data-ttu-id="491b6-151">Добавьте или обновите разметку для компонентов сайта надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-151">Add or update the markup for add-in web components. For more information, see  Update add-in web components in SharePoint.</span></span> <span data-ttu-id="491b6-152">Дополнительные сведения см. в статье [Обновление компонентов сайта с надстройкой в SharePoint](update-add-in-web-components-in-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="491b6-152">Add or update the markup for add-in web components. For more information, see  [Update add-in web components in SharePoint](update-add-in-web-components-in-sharepoint.md).</span></span>

- <span data-ttu-id="491b6-153">Добавьте или обновите разметку для компонентов хост-сайта.</span><span class="sxs-lookup"><span data-stu-id="491b6-153">Add or update the markup for host web components. For more information, see  Update host web components in SharePoint.</span></span> <span data-ttu-id="491b6-154">Дополнительные сведения см. в статье [Обновление компонентов хост-сайта с надстройкой в SharePoint](update-host-web-components-in-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="491b6-154">Add or update the markup for host web components. For more information, see  [Update host web components in SharePoint](update-host-web-components-in-sharepoint.md).</span></span>

- <span data-ttu-id="491b6-155">Добавьте пользовательскую логику в [UpgradedEventEndpoint](http://msdn.microsoft.com/library/09a93d44-d295-47bb-f91c-d243178b0f53%28Office.15%29.aspx) и зарегистрируйте ее в файле appmanifest.xml.</span><span class="sxs-lookup"><span data-stu-id="491b6-155">Add custom logic to an [UpgradedEventEndpoint](http://msdn.microsoft.com/library/09a93d44-d295-47bb-f91c-d243178b0f53%28Office.15%29.aspx) and register it in the appmanifest.xml file. For more information, see How to: Create an UpgradedEventEndpoint handler for SharePoint 2013.</span></span> <span data-ttu-id="491b6-156">Дополнительные сведения см. в статье [Создание обработчика для события обновления надстройки SharePoint](create-a-handler-for-the-update-event-in-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="491b6-156">Add custom logic to an  UpgradedEventEndpoint and register it in the appmanifest.xml file. For more information, see [Create a handler for the update event in SharePoint Add-ins](create-a-handler-for-the-update-event-in-sharepoint-add-ins.md).</span></span>
    
- <span data-ttu-id="491b6-157">Обновите удаленные компоненты.</span><span class="sxs-lookup"><span data-stu-id="491b6-157">Update the remote components:</span></span>
    
   - <span data-ttu-id="491b6-158">Для надстройки с размещением у поставщика обновите удаленные компоненты с помощью методов, соответствующих платформам, которые используются для размещения.</span><span class="sxs-lookup"><span data-stu-id="491b6-158">For a provider-hosted add-in, update the remote components using the techniques appropriate for the hosting platform stack.</span></span> 
   
   <span data-ttu-id="491b6-159">Дополнительные сведения см. в статье [Обновление удаленных компонентов в надстройках SharePoint](update-remote-components-in-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="491b6-159">For more information, see  [Update remote components in SharePoint Add-ins](update-remote-components-in-sharepoint-add-ins.md).</span></span>
    
- <span data-ttu-id="491b6-160">`**` Отправьте пакет надстройки в Магазин Office или каталог надстроек организации.</span><span class="sxs-lookup"><span data-stu-id="491b6-160">`**`***** Upload the add-in package to the Office Store or the organization's add-in catalog.</span></span>

<span data-ttu-id="491b6-161"><a name="BestUpdatePractices"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-161"></span></span>
## <a name="best-practices-for-add-in-updates"></a><span data-ttu-id="491b6-162">Рекомендации по обновлению надстроек</span><span class="sxs-lookup"><span data-stu-id="491b6-162">Best practices for add-in updates</span></span>

<span data-ttu-id="491b6-163">В следующих разделах рассматриваются процедуры, которым нужно следовать, и важные вопросы, на которые следует обратить внимание при планировании обновления.</span><span class="sxs-lookup"><span data-stu-id="491b6-163">The following sections discuss practices you should follow and important points to consider as you are planning an update.</span></span>

### <a name="decide-whether-you-really-have-to-update"></a><span data-ttu-id="491b6-164">Решите, действительно ли нужно обновление</span><span class="sxs-lookup"><span data-stu-id="491b6-164">Decide whether you really have to update</span></span>

<span data-ttu-id="491b6-165">Улучшить надстройку SharePoint с размещением у поставщика можно и без обновления.</span><span class="sxs-lookup"><span data-stu-id="491b6-165">For a provider-hosted SharePoint Add-in, improvements to the add-in do not necessarily require updating the add-in.</span></span> <span data-ttu-id="491b6-166">Если изменения касаются только удаленных компонентов и не должны отражаться в компонентах SharePoint, можно изменить удаленные компоненты, не обновляя надстройку.</span><span class="sxs-lookup"><span data-stu-id="491b6-166">If all the changes are to remote components, and those changes don't have to be reflected in SharePoint components, you can change the remote components without updating the add-in.</span></span> <span data-ttu-id="491b6-167">Если URL-адреса и строки, используемые компонентами SharePoint для доступа к удаленным компонентам, не изменяются, надстройка SharePoint продолжает работать.</span><span class="sxs-lookup"><span data-stu-id="491b6-167">As long as the URLs and connection strings that the SharePoint components use to access the remote components do not change, the SharePoint Add-in continues to work.</span></span> 

<span data-ttu-id="491b6-168">Допустим, вы добавили кнопку в удаленное веб-приложение, которая считывает столбец из нового списка SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-168">For example, suppose that you add a button to a remote web application that reads a column from a SharePoint list that the web application did not previously read.</span></span> <span data-ttu-id="491b6-169">Если столбец уже существует в списке, вам не нужно ничего менять в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-169">If the column already exists on the list, you do not have to change anything in SharePoint.</span></span> <span data-ttu-id="491b6-170">Вы можете отправить измененную веб-страницу, измененный код или данные JavaScript в удаленное веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="491b6-170">You can upload the revised webpage, and the revised code-behind or JavaScript, to the remote web application.</span></span> <span data-ttu-id="491b6-171">Новые функции мгновенно станут доступны пользователям при запуске надстройки SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-171">The new functionality is immediately available to users when they start the SharePoint Add-in.</span></span>

### <a name="remember-that-updating-is-optional-for-users"></a><span data-ttu-id="491b6-172">Помните, что обновление не является обязательным для пользователей</span><span class="sxs-lookup"><span data-stu-id="491b6-172">Remember that updating is optional for users</span></span>

<span data-ttu-id="491b6-173">Когда новая версия надстройки SharePoint становится доступна в Магазине Office или каталоге надстроек организации, на плитке надстройки на странице **Контент сайта** появляется сообщение о доступном обновлении.</span><span class="sxs-lookup"><span data-stu-id="491b6-173">When a new version of your SharePoint Add-in becomes available in the Office Store or the organization's add-in catalog, a message appears on the add-in's tile on the **Site Contents** page informing users that an update is available.</span></span> <span data-ttu-id="491b6-174">Оно появляется в течение 24 часов.</span><span class="sxs-lookup"><span data-stu-id="491b6-174">It takes no more than 24 hours for this message to appear.</span></span> <span data-ttu-id="491b6-175">Но обновление не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="491b6-175">But nothing in the SharePoint infrastructure forces users to update.</span></span> <span data-ttu-id="491b6-176">Поэтому изменения, которые вы вносите в удаленные компоненты, не должны нарушать работу предыдущих версий надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-176">So changes that you make to remote components must not break the older versions of the add-in.</span></span> <span data-ttu-id="491b6-177">Общее, но не универсальное, правило гласит: *добавляйте* новые элементы в удаленные компоненты, но не удаляйте, не переименовывайте, не перемещайте и не изменяйте схему, строку подключения или URL-адрес существующего компонента.</span><span class="sxs-lookup"><span data-stu-id="491b6-177">A general, but not quite universal, rule is that you should *add* things to remote components, but avoid deleting, renaming, moving, or changing the schema, connection string, or URL of any existing component.</span></span>

<span data-ttu-id="491b6-178">Если удаленному компоненту нужна версия экземпляра надстройки, который его вызывает, вы можете отправить эти сведения из SharePoint.</span><span class="sxs-lookup"><span data-stu-id="491b6-178">If a remote component needs to know the version of the add-in instance that is calling it, you can pass this information from SharePoint. For example, you can add the add-in version as a query parameter on the  StartPage URL of the add-in.</span></span> <span data-ttu-id="491b6-179">Например, можно добавить версию надстройки как параметр запроса в URL-адрес элемента [StartPage](http://msdn.microsoft.com/library/3092674c-a6c3-9021-3d7e-e716562a4a4f%28Office.15%29.aspx) надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-179">If a remote component needs to know the version of the add-in instance that is calling it, you can pass this information from SharePoint. For example, you can add the add-in version as a query parameter on the  [StartPage](http://msdn.microsoft.com/library/3092674c-a6c3-9021-3d7e-e716562a4a4f%28Office.15%29.aspx) URL of the add-in.</span></span>

<span data-ttu-id="491b6-180"><a name="DebugFirst"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-180"></span></span>
### <a name="create-and-debug-the-new-version-as-if-it-were-a-brand-new-add-in"></a><span data-ttu-id="491b6-181">Создайте и отладьте новую версию, как будто это новая надстройка</span><span class="sxs-lookup"><span data-stu-id="491b6-181">Create and debug the new version as if it were a brand new add-in</span></span>

<span data-ttu-id="491b6-p115">Следует отделять разработку и отладку новой версии надстройки от отладки разметки и логики обновления. Для этого удалите предыдущую версию надстройки из тестового сайта SharePoint для разработки. Сохраните резервную копию файла пакета надстройки для предыдущей версии. Необходимым образом добавьте и измените компоненты надстройки, а затем проверьте и отладьте их с использованием тестового сайта, как будто это новая надстройка, созданная с нуля.</span><span class="sxs-lookup"><span data-stu-id="491b6-p115">You should separate the development and debugging of the new version of the add-in from the debugging of the update markup and logic. To do this, uninstall the earlier version of the add-in from your development test SharePoint site. Save a backup copy of the add-in package file for the earlier version. Add and change components of the add-in as needed, and then test and debug them against the test site as if it is a brand new add-in you are creating from scratch.</span></span>

### <a name="test-the-update-with-each-earlier-version-of-the-add-in"></a><span data-ttu-id="491b6-186">Протестируйте обновление с каждой предыдущей версией надстройки</span><span class="sxs-lookup"><span data-stu-id="491b6-186">Test the update with each earlier version of the add-in</span></span>

<span data-ttu-id="491b6-187">Когда новая версия надстройки будет правильно работать как "новая" надстройка, измените код и разметку так, чтобы проект представлял собой обновление старой надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-187">When the new version of the add-in is functioning correctly as a "new" add-in, restructure the code and markup so that the project is an update of the old add-in. For example, increment the add-in version number as indicated in Major steps in updating an add-in. For more information about turning the project into an update, see the child topics of this topic.</span></span> <span data-ttu-id="491b6-188">Например, увеличьте номер версии надстройки, как указано в разделе [Основные шаги по обновлению надстройки](#MajorAppUpgradeSteps).</span><span class="sxs-lookup"><span data-stu-id="491b6-188">For example, increment the add-in version number as indicated in [Major steps in updating an add-in](#MajorAppUpgradeSteps).</span></span> <span data-ttu-id="491b6-189">Дополнительные сведения о преобразовании проекта в обновление см. в разделах этой статьи.</span><span class="sxs-lookup"><span data-stu-id="491b6-189">For more information about turning the project into an update, see the child topics of this topic.</span></span>

<span data-ttu-id="491b6-190">Когда вы будете готовы проверить свое обновление, уберите новую версию с тестового сайта и повторно разверните предыдущую версию, чтобы проверить логику обновления.</span><span class="sxs-lookup"><span data-stu-id="491b6-190">When you are ready to test your update, retract the new version from the test site and redeploy the earlier version so you can test update logic.</span></span> <span data-ttu-id="491b6-191">Если существует несколько предыдущих версий надстройки, установите каждую из них на отдельный дочерний веб-сайт тестового сайта.</span><span class="sxs-lookup"><span data-stu-id="491b6-191">If you have shipped multiple previous versions of the add-in, install each earlier version on a different subweb of your test site.</span></span> <span data-ttu-id="491b6-192">Затем отправьте последнюю версию надстройки в каталог надстроек тестового сайта и обновите каждый экземпляр надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-192">Then upload the latest version of the add-in to your test site's add-in catalog and update every instance of the add-in.</span></span> <span data-ttu-id="491b6-193">Убедитесь, что каждый из них имеет последний номер версии и новейшие версии всех компонентов.</span><span class="sxs-lookup"><span data-stu-id="491b6-193">Verify that each has the latest add-in version number and the latest version of all components.</span></span> <span data-ttu-id="491b6-194">Если в надстройке используется сайт надстройки, убедитесь, что его компоненты развернуты в соответствии с процедурой, описанной в разделе [Проверка развертывания веб-компонентов надстройки](update-add-in-web-components-in-sharepoint.md#VerifyDeployAppWebComp).</span><span class="sxs-lookup"><span data-stu-id="491b6-194">If there is an add-in web in the add-in, verify that the add-in web components have been deployed by using the procedure in [Verify deployment of add-in web components](update-add-in-web-components-in-sharepoint.md#VerifyDeployAppWebComp).</span></span>

<span data-ttu-id="491b6-195"><a name="ImmediateUpdateNotice"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-195"></span></span>
### <a name="update-an-add-in-without-waiting-24-hours"></a><span data-ttu-id="491b6-196">Обновите надстройку раньше чем через 24 часа</span><span class="sxs-lookup"><span data-stu-id="491b6-196">Update an add-in without waiting 24 hours</span></span>

<span data-ttu-id="491b6-197">Разрабатывая обновление для надстройки на тестовом сайте SharePoint, нет смысла ждать 24 часа между обновлениями.</span><span class="sxs-lookup"><span data-stu-id="491b6-197">When developing an update for an add-in on your SharePoint test site, it is impractical to wait 24 hours between updates. You (and users on a production SharePoint site) can update an add-in immediately after it is uploaded to the spstore or the organization's add-in catalog with these steps:</span></span> <span data-ttu-id="491b6-198">Вы (и пользователи производственного сайта SharePoint) можете обновить надстройку сразу после ее отправки в Магазин Office или каталог надстроек организации. Для этого выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="491b6-198">When developing an update for an add-in on your SharePoint test site, it is impractical to wait 24 hours between updates. You (and users on a production SharePoint site) can update an add-in immediately after it is uploaded to the Office Store or the organization's add-in catalog with these steps:</span></span>

#### <a name="to-immediately-update-an-add-in"></a><span data-ttu-id="491b6-199">Немедленное обновление надстройки</span><span class="sxs-lookup"><span data-stu-id="491b6-199">To immediately update an add-in</span></span>

1. <span data-ttu-id="491b6-200">Отправив последнее обновление в каталог надстроек, откройте страницу **Контент сайта** на веб-сайте, на котором установлена надстройка, и нажмите кнопку **...** на плитке надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-200">After the latest update is uploaded to the add-in catalog, open the  **Site Contents** page on the website where the add-in is installed and choose the **...** button on the add-in's tile.</span></span>

2. <span data-ttu-id="491b6-201">В появившейся выноске выберите вкладку **О программе**. На открывшейся странице **О программе** отобразится сообщение о доступности новой версии.</span><span class="sxs-lookup"><span data-stu-id="491b6-201">On the callout that opens, choose the  **About** tab. On the **About** page that opens, there is a notice that a new version is available.</span></span>

3. <span data-ttu-id="491b6-202">Нажмите кнопку **Получить**.</span><span class="sxs-lookup"><span data-stu-id="491b6-202">Select the **Get It** button.</span></span> <span data-ttu-id="491b6-203">Снова откроется страница **Контент сайта**, а на плитке надстройки появится сообщение о текущем обновлении надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-203">Choose the  Get It button. The **Site Contents** page reopens, and there is a notice on the add-in's tile that the add-in is being updated.</span></span>

<span data-ttu-id="491b6-204">Эти действия показаны на рисунке 2.</span><span class="sxs-lookup"><span data-stu-id="491b6-204">Figure 2 illustrates these steps.</span></span>

<span data-ttu-id="491b6-205">*Рис. 2. Процесс мгновенного обновления надстройки SharePoint*</span><span class="sxs-lookup"><span data-stu-id="491b6-205">*Figure 2. Process of immediately updating a SharePoint Add-in*</span></span>

![Процесс немедленного обновления надстройки](../images/UpdatingApp_ImmediateUpgradeProcess.png)

> [!NOTE]
> <span data-ttu-id="491b6-207">Чтобы сообщение о доступности обновления на плитке надстройки отображалось чаще, чем каждые 24 часа, вы можете использовать метод, описанный в статье [Процесс обновления надстройки SharePoint](sharepoint-add-ins-update-process.md#Minor), чтобы оно появлялось мгновенно.</span><span class="sxs-lookup"><span data-stu-id="491b6-207">If you need to see the "update available" notice on the add-in's tile more frequently than every 24 hours, you can use the method described in [Update process for a SharePoint Add-in](sharepoint-add-ins-update-process.md#Minor) to make the notice appear immediately.</span></span>

<span data-ttu-id="491b6-208"><a name="UpdateManifest"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-208"></span></span>
## <a name="update-the-add-in-version-permission-requests-and-prerequisites"></a><span data-ttu-id="491b6-209">Обновление версии надстройки, запросов разрешений и необходимых условий</span><span class="sxs-lookup"><span data-stu-id="491b6-209">Update the add-in version, permission requests, and prerequisites</span></span>

<span data-ttu-id="491b6-210">Создав резервную копию папки проекта Visual Studio, откройте проект надстройки.</span><span class="sxs-lookup"><span data-stu-id="491b6-210">After making a backup copy of the Visual Studio project folder, open the add-in project. Open add-in manifest and raise the version number on the  General tab of the manifest designer.</span></span> <span data-ttu-id="491b6-211">Откройте манифест надстройки и на вкладке **Общие** конструктора манифеста увеличьте номер версии.</span><span class="sxs-lookup"><span data-stu-id="491b6-211">After making a backup copy of the vsnv project folder, open the add-in project. Open add-in manifest and raise the version number on the **General** tab of the manifest designer.</span></span>

<span data-ttu-id="491b6-212">Если обновленной версии надстройки требуется больше (или меньше) разрешений для компонентов хост-сайта, внесите необходимые изменения в разделе надстройки [AppPermissionRequests](http://msdn.microsoft.com/library/4e617622-78d3-3d23-677d-9957eb1fb107%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="491b6-212">If the updated version of the app needs more (or fewer) permissions to components of the host web, make changes as needed to the [AppPermissionRequests](http://msdn.microsoft.com/library/4e617622-78d3-3d23-677d-9957eb1fb107%28Office.15%29.aspx) section of the app. In vsdev11short, use the Permissions tab of the manifest designer.</span></span> <span data-ttu-id="491b6-213">В Visual Studio откройте вкладку **Разрешения** конструктора манифеста.</span><span class="sxs-lookup"><span data-stu-id="491b6-213">In Visual Studio, use the **Permissions** tab of the manifest designer.</span></span> 

<span data-ttu-id="491b6-214">После обновления надстройки пользователю всегда предлагается предоставить разрешения, независимо от того, изменились ли они по сравнению с предыдущей версией.</span><span class="sxs-lookup"><span data-stu-id="491b6-214">When an add-in is updated, the user is always prompted to grant permissions, whether the permissions have changed or not since the previous version.</span></span> <span data-ttu-id="491b6-215">Если в новой версии требуется *меньше* разрешений по сравнению с предыдущей, дополнительные разрешения *не отзываются*.</span><span class="sxs-lookup"><span data-stu-id="491b6-215">If the new version requests *fewer* permissions than the preceding version, the additional permissions of the preceding version *are not revoked*.</span></span> <span data-ttu-id="491b6-216">Чтобы отозвать эти разрешения, после обновления надстройки пользователь должен перейти на страницу *{SharePointDomain}* `/_layouts/15/appinv.aspx` и вручную ввести разрешения, соответствующие схеме [AppPermissionRequests](http://msdn.microsoft.com/library/4e617622-78d3-3d23-677d-9957eb1fb107%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="491b6-216">The only way to restrict the add-in to the permissions that the latest version needs is for a user to open the page *{SharePointDomain}* `/_layouts/15/appinv.aspx` after the add-in has been updated, and then manually enter permission markup that conforms to the [AppPermissionRequests](http://msdn.microsoft.com/library/4e617622-78d3-3d23-677d-9957eb1fb107%28Office.15%29.aspx) schema.</span></span>

<span data-ttu-id="491b6-217">Если обновленной версии надстройки требуются определенные компоненты, которых не было в предыдущей версии (или отсутствуют компоненты, которые были в предыдущей версии), внесите необходимые изменения в разделе надстройки [AppPrerequisites](http://msdn.microsoft.com/library/7622b55f-01a1-2c39-9daa-7cfb1a3c890f%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="491b6-217">If the updated version of the add-in has prerequisites that the earlier versions did not have (or no longer has some prerequisites that earlier versions had), make changes as needed to the  [AppPrerequisites](http://msdn.microsoft.com/library/7622b55f-01a1-2c39-9daa-7cfb1a3c890f%28Office.15%29.aspx) section of the add-in. In Visual Studio, use the Prerequisites tab of the manifest designer.</span></span> <span data-ttu-id="491b6-218">В Visual Studio откройте вкладку **Необходимые компоненты** в конструкторе манифеста.</span><span class="sxs-lookup"><span data-stu-id="491b6-218">In Visual Studio, use the **Prerequisites** tab of the manifest designer.</span></span>

## <a name="next-steps"></a><span data-ttu-id="491b6-219">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="491b6-219">Next steps</span></span>
<span data-ttu-id="491b6-220"><a name="Next"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-220"></span></span>

<span data-ttu-id="491b6-221">Перейдите к следующему пункту в разделе [Основные шаги по обновлению надстройки](#MajorAppUpgradeSteps) или непосредственно к одной из следующих статей:</span><span class="sxs-lookup"><span data-stu-id="491b6-221">Continue with the next bullet in the section  [Major steps in updating an add-in](#MajorAppUpgradeSteps) or go directly to one of the following articles:</span></span>

-  [<span data-ttu-id="491b6-222">Обновление компонентов сайта надстройки в SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-222">Update add-in web components in SharePoint</span></span>](update-add-in-web-components-in-sharepoint.md)
-  [<span data-ttu-id="491b6-223">Обновление компонентов хост-сайта в SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-223">Update host web components in SharePoint</span></span>](update-host-web-components-in-sharepoint.md)
-  [<span data-ttu-id="491b6-224">Создание обработчика для события обновления надстройки SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-224">Create a handler for the update event in SharePoint Add-ins</span></span>](create-a-handler-for-the-update-event-in-sharepoint-add-ins.md)
-  <span data-ttu-id="491b6-225">[Обновление удаленных компонентов в надстройках SharePoint](update-remote-components-in-sharepoint-add-ins.md) </span><span class="sxs-lookup"><span data-stu-id="491b6-225">[Update remote components in SharePoint Add-ins](update-remote-components-in-sharepoint-add-ins.md)</span></span>
    
## <a name="additional-resources"></a><span data-ttu-id="491b6-226">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="491b6-226">Additional resources</span></span>
<span data-ttu-id="491b6-227"><a name="bk_addresources"> </a></span><span class="sxs-lookup"><span data-stu-id="491b6-227"></span></span>

-  [<span data-ttu-id="491b6-228">Разработка надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-228">Develop SharePoint Add-ins</span></span>](develop-sharepoint-add-ins.md)
-  [<span data-ttu-id="491b6-229">Процесс обновления надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="491b6-229">SharePoint Add-ins update process</span></span>](sharepoint-add-ins-update-process.md) 
    
 

