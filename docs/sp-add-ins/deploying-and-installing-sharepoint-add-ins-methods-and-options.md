---
title: "Развертывание и установка надстроек SharePoint: методы и параметры"
description: "Публикация, установка и удаление надстройки SharePoint."
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: fdf17615e9019947da82102ecae4dce9a16e589e
ms.sourcegitcommit: 655e325aec73c8b7c6b5e3aaf71fbb4d2d223b5d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2017
---
# <a name="deploying-and-installing-sharepoint-add-ins-methods-and-options"></a>Развертывание и установка надстроек SharePoint: методы и параметры

В этой статье вы узнаете больше о возможностях публикации, установки и удаления надстроек SharePoint.

<a name="MarketOrCatalog"> </a>
## <a name="publishing-to-the-office-store-or-an-organizations-add-in-catalog"></a>Публикация в Магазине Office или каталоге надстроек организации

Вы можете разместить свою надстройку Надстройка SharePoint в общедоступном Магазин Office или в частном каталоге надстроек организации. Частный каталог надстроек это специальная коллекция веб-сайтов в веб-приложении SharePoint (или клиенте SharePoint Online), в которой размещаются библиотеки документов для приложений для SharePoint и приложений для Office. Размещение каталога в собственной коллекции веб-сайтов позволяет администратору веб-приложений или клиентов более легко ограничивать разрешения на доступ в каталог. 

Если надстройку разместить в общедоступном Магазин Office, Microsoft выполняет в нем ряд операций по проверке. Например, проверку действительности и полноты разметки манифеста надстройки, а также того, не содержат ли какие-либо из пакетов решений SharePoint (файлы WSP) запрещенных элементов или функций, область действия которых шире, чем **Web**. Содержимое пакета также проверяется на предмет нежелательных элементов. Если надстройка проходит все проверки, пакет надстройки заносится в файл и подписывается Microsoft. 

> [!NOTE]
> Если вы разрабатываете надстройку и развертываете ее с помощью Инструментов разработчика Microsoft Office для Visual Studio, надстройка устанавливается непосредственно на целевой тестовый сайт SharePoint. А так как она не проходит через Магазин Office, описанная выше проверка не выполняется.

Надстройку SharePoint отправить в каталог надстроек организации можно так же просто, как любой файл — в библиотеку документов SharePoint Foundation. Заполните всплывающую форму, указав локальный URL-адрес пакета надстройки и другие сведения, например имя надстройки. Подобные проверки выполняются, когда надстройка добавляется в каталог надстроек организации. И надстройки, которые их не проходят, помечаются в каталоге как недопустимые или отключенные. 

Администраторы клиентов и веб-приложений SharePoint могут приобрести надстройки SharePoint в Магазине Office. Чтобы открыть Магазин Office, нажмите кнопку **Добавить надстройку** на странице **Содержимое сайта** и выберите пункт **Магазин SharePoint** на странице **Мои надстройки **. Откроется страница **Магазина SharePoint** с подробными сведениями о надстройках SharePoint от поставщиков (эти сведения можно также найти на сайте office.com). 

Надстройки, для которых требуются компоненты, не установленные в веб-приложении или клиенте администратора, отображаются в магазине надстроек тусклым шрифтом и недоступны. Например, если для надстройки требуются неустановленные службы поиска, она недоступна. Администраторы могут просматривать, сортировать и фильтровать список надстроек, читать о них сведения и отзывы, а также покупать для них лицензии.

Решив приобрести лицензию, администратор должен принять условия покупки и согласиться с разрешениями, которые должна иметь надстройка для нормальной работы, такими как доступ к чтению списков или полный доступ к коллекции веб-сайтов. 

При покупке одной или более лицензий для надстройки они загружаются в веб-приложение или клиент. Автоматическая загрузка и установка надстройки при покупке лицензии не предусмотрены, хотя администраторы имеют возможность совместить установку с покупкой лицензии.

Пользователи устанавливают надстройки со страницы **Ваши надстройки**. На странице располагаются такие объединенные списки:

- Надстройки SharePoint из каталога надстроек в организации веб-приложения (или клиента).
- Надстройки SharePoint из Магазина Office, на который организация или клиент уже имеют лицензию веб-сайта, или лицензию, которая была присвоена пользователю.

В списке отображаются все надстройки, которые можно установить сразу. Надстройки можно отфильтровать, чтобы отобразить на странице только те, которые включены в каталог надстроек организации. После установки на веб-сайте надстройка появляется в списке надстроек на странице **Содержимое сайта**.

<a name="Installing"> </a>
## <a name="installing-sharepoint-add-ins"></a>Установка надстроек SharePoint

Владельцы веб-сайтов устанавливают Надстройки SharePoint со страницы **Ваши надстройки**, как было описано ранее в этом разделе. При установке создается экземпляр надстройки. Подробнее об установке надстроек:  [Добавление надстроек для SharePoint на сайт SharePoint](https://technet.microsoft.com/ru-RU/library/fp161231.aspx). 
 
> [!NOTE]
> Иногда в результате временных сбоев в сетевом соединение установка может быть заблокирована. Если по какой-либо причине при установке происходит сбой, инфраструктура инсталляции повторяет попытку три раза. При неудаче в пользовательском интерфейсе появляется отметка об ошибке. Пользователи могут повторить попытку установки позднее. 

<a name="Uninstalling"> </a>
## <a name="uninstalling-sharepoint-add-ins"></a>Удаление надстроек SharePoint

Владельцы веб-сайта могут удалить экземпляр Надстройка SharePoint с помощью пользовательского интерфейса SharePoint. Удаление экземпляра Надстройки SharePoint чистое, т. е. удаляется все, установленное надстройкой. 

При этом компоненты, используемые надстройкой, но установленные отдельно от нее, не удаляются. Предположим, у надстройки есть удаленная веб-страница с кнопками, с помощью которых создаются списки на хост-сайте. При удалении надстройки удаляется ее плитка на странице **Содержимое сайта**, в результате чего удаленная страница становится недоступной для конечных пользователей. При этом созданные надстройкой списки остаются. Система SharePoint не фиксирует, какие списки на хост-сайте были созданы надстройкой, а какие — в пользовательском интерфейсе SharePoint, поэтому она не может удалять списки, созданные надстройкой. Обычно это желательное поведение, так как списки могут содержать данные, которые будут полезны пользователям даже после удаления надстройки, создавшей списки.

Если Надстройка SharePoint включает в себя веб-надстройку, то она удаляется. Благодаря этому достигается более полное удаление, чем при систематическом отключении функций и запуске WSP-файла надстройки в режиме отмены.
 
> [!NOTE]
> Когда пользователь удаляет надстройку, она перемещается в первую корзину. При удалении из первой корзины настройка перемещается во вторую. При удалении из второй корзины она удаляется полностью без возможности восстановления. 

Кроме того, при удалении надстройки отзываются разрешения для нее согласно следующим правилам:

- разрешения уровня веб-сайта всегда аннулируются;
- если в семействе веб-сайтов отсутствуют другие экземпляры надстройки, разрешения уровня семейства веб-сайтов также аннулируются;
- Если в подписке сайта (клиенте) нет других экземпляров надстройки, разрешения на уровне клиента также отзываются.

Веб-служба [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если она зарегистрирована в манифесте приложения, выполняется в начале процесса деинсталляции (это происходит, когда надстройка удаляется из второй корзины). Рекомендуется пользоваться веб-службой [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если вы также пользуетесь веб-службой [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx), и настраивать службу [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx) так, чтобы она отменяла все действия, выполняемые службой [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx). Дополнительные сведения см. в статье [Обработка событий в надстройках SharePoint](handle-events-in-sharepoint-add-ins.md).

## <a name="additional-resources"></a>Дополнительные ресурсы
<a name="SP15deployinstallapps_addlresources"> </a>

-  [Публикация надстроек SharePoint](publish-sharepoint-add-ins.md)
-  [Важные аспекты архитектуры и разработки надстроек SharePoint](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscap.md)
-  [Процесс обновления надстроек SharePoint](sharepoint-add-ins-update-process.md)
    
 

