# <a name="deploying-and-installing-sharepoint-add-ins-methods-and-options"></a>Развертывание и установка надстроек SharePoint: методы и параметры
Узнайте о методах публикации, установке и удалении надстроек SharePoint.
 

 **Примечание.** В настоящее время идет процесс замены названия "приложения для SharePoint" названием "надстройки SharePoint". Во время этого процесса в документации и пользовательском интерфейсе некоторых продуктов SharePoint и средств Visual Studio может по-прежнему использоваться термин "приложения для SharePoint". Дополнительные сведения см. в статье [Новое название приложений для Office и SharePoint](new-name-for-apps-for-sharepoint#bk_newname).
 


## <a name="publishing-to-the-office-store-or-an-organizations-add-in-catalog"></a>Публикация в Магазине Office или каталоге надстроек организации
<a name="MarketOrCatalog"> </a>

Вы можете разместить свою надстройку Надстройка SharePoint в общедоступном Магазин Office или в частном каталоге надстроек организации. Частный каталог надстроек это специальная коллекция веб-сайтов в веб-приложении SharePoint (или клиенте SharePoint Online), в которой размещаются библиотеки документов для приложений для SharePoint и приложений для Office. Размещение каталога в собственной коллекции веб-сайтов позволяет администратору веб-приложений или клиентов более легко ограничивать разрешения на доступ в каталог. 
 

 
При отправке надстройки в общедоступный Магазин Office, корпорация Майкрософт выполняет в нем ряд проверок. Например, проверяются действительность и полнота разметки манифеста надстройки, а также того, не содержат ли какие-либо из пакетов решений SharePoint (WSP-файлы) запрещенные элементы или функции, область действия которых шире, чем **Интернет**. Содержимое пакета также проверяется на наличие нежелательных элементов. Если надстройка проходит все проверки, пакет надстройки заносится в файл и получает подпись корпорации Майкрософт. 
 

 

 **Примечание.** При разработке надстройки и её развертывании с помощью Инструментов разработчика Microsoft Office для Visual Studio она устанавливается непосредственно на целевом тестовом сайте SharePoint. Так как надстройка не проходит через Магазин Office, описанная выше проверка не выполняется.
 

Размещение Надстройка SharePoint в каталоге надстроек организации не сложнее размещения любого файла в библиотеке документов SharePoint Foundation. Вы заполняете всплывающую форму, в которую вводите локальный URL пакета надстройки и другую информацию, такую как название надстройки. После размещения надстройки в каталоге надстроек организации проводятся те же самые проверочные действия, а надстройки, не прошедшие проверку, помечаются в каталоге как недействительные или недоступные. 
 

 
Администраторы клиентов и веб-приложений SharePoint могут приобретать надстройки SharePoint в общедоступном Магазине Office. Чтобы открыть Магазин Office, администратор должен выбрать команду **Добавить надстройку** на странице **Содержимое сайта**, а затем выбрать **Магазин SharePoint** на странице **Ваши надстройки**. После этого откроется страница **Магазин SharePoint**, на которой администраторы могут находить сведения о надстройках SharePoint, предлагаемых поставщиками. (Это также можно сделать на сайте office.com.) Надстройки, которым необходимы компоненты, не установленные в веб-приложении или клиенте администратора, помечены как недоступные. Например, если приложению необходимы службы поиска, но они не установлены, то надстройка затемняется. Администраторы могут сортировать, фильтровать или просматривать список надстроек, читать сведения и отзывы о надстройках, а также покупать лицензии на них.
 

 
Решив приобрести лицензию, администратор должен принять условия покупки и согласиться с разрешениями, которые должна иметь надстройка для нормальной работы, такими как доступ к чтению списков или полный доступ к коллекции веб-сайтов. 
 

 
При покупке одной или более лицензий для надстройки они загружаются в веб-приложение или клиент. Автоматическая загрузка и установка надстройки при покупке лицензии не предусмотрены, хотя администраторы имеют возможность совместить установку с покупкой лицензии.
 

 
Пользователи устанавливают надстройки со страницы **Ваши надстройки**. На этой странице представлен объединенный список перечисленных ниже элементов.
 

 

- Надстройки SharePoint из каталога надстроек в организации веб-приложения (или клиента).
    
 
- Надстройки SharePoint из Магазин Office, на который организация или клиент уже имеют лицензию веб-сайта, или лицензию, которая была присвоена пользователю.
    
 
Список содержит все надстройки, которые пользователь может установить сразу. За редкими исключениями, в списке нет других надстроек. Пользователи могут фильтровать список, чтобы на странице отображались только надстройки из каталога надстроек организации. После установки надстройки она отображается в списке на странице **Содержимое сайта** для соответствующего сайта.
 

 

## <a name="installing-sharepoint-add-ins"></a>Установка надстроек SharePoint
<a name="Installing"> </a>

Владельцы веб-сайтов устанавливают надстройки SharePoint со страницы **Ваши надстройки**, как описывается ранее в этой статье. При установке создается экземпляр надстройки. Дополнительные сведения об установке надстроек см. в статье [Добавление приложений для SharePoint на сайт SharePoint](https://technet.microsoft.com/en-us/library/fp161231.aspx). 
 

 

 **Примечание.** Иногда в результате перебоев сетевого подключения установка может быть заблокирована. Если по какой-либо причине при установке происходит сбой, инфраструктура установки повторяет попытку три раза. В случае неудачи в пользовательском интерфейсе появляется сообщение об ошибке. Пользователи могут повторить попытку установки позже. 
 


## <a name="uninstalling-sharepoint-add-ins"></a>Удаление надстроек SharePoint
<a name="Uninstalling"> </a>

Владельцы веб-сайта могут удалить экземпляр Надстройка SharePoint с помощью пользовательского интерфейса SharePoint. Удаление экземпляра Надстройки SharePoint чистое, т. е. удаляется все, установленное надстройкой. 
 

 
Однако компоненты, которые используются надстройкой, но установлены отдельно от нее, не удаляются. Предположим, что у надстройки есть удаленная веб-страница с кнопками, которые создают списки на хост-сайте. Удаление надстройки приведет к удалению плитки надстройки со страницы **Содержимое сайта**, в результате чего удаленная страница станет недоступной или непригодной для пользователей. Однако при этом не удаляются списки, созданные с надстройкой. В SharePoint не хранятся сведения о том, какие списки на хост-сайте были созданы надстройкой, а какие — пользователями в интерфейсе SharePoint, поэтому невозможно удалить списки, созданные надстройкой. В целом, это хорошо, так как списки могут содержать данные, которые будут полезны пользователям даже после удаления надстройки, создавшей их.
 

 
Если Надстройка SharePoint включает в себя веб-надстройку, то она удаляется. Благодаря этому достигается более полное удаление, чем при систематическом отключении функций и запуске WSP-файла надстройки в режиме отмены.
 

 

 **Примечание.** Когда пользователь удаляет надстройку, она перемещается в корзину первого уровня. Если удалить надстройку оттуда, она перемещается в корзину второго уровня. После удаления из корзины второго уровня надстройка полностью удаляется без возможности восстановления. 
 

Кроме того, при удалении надстройки отзываются разрешения для нее согласно следующим правилам:
 

 

- разрешения уровня веб-сайта всегда аннулируются;
    
 
- если в семействе веб-сайтов отсутствуют другие экземпляры надстройки, разрешения уровня семейства веб-сайтов также аннулируются;
    
 
- Если в подписке сайта (клиенте) нет других экземпляров надстройки, разрешения на уровне клиента также отзываются.
    
 
Веб-служба  [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если она зарегистрирована в манифесте надстройки, выполняется в начале процесса удаления. Это происходит, если надстройка удаляется из корзины второго уровня. Рекомендуется пользоваться веб-службой  [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если вы также пользуетесь веб-службой  [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx), и настраивать услугу  [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx) так, чтобы она отменяла все действия, выполняемые службой [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx). Дополнительные сведения см. в статье  [Обработка событий в надстройках SharePoint](handle-events-in-sharepoint-add-ins).
 

 

## <a name="additional-resources"></a>Дополнительные ресурсы
<a name="SP15deployinstallapps_addlresources"> </a>


-  [Публикация надстроек SharePoint](publish-sharepoint-add-ins)
    
 
-  [Важные аспекты разработки и архитектуры для надстроек SharePoint](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscape)
    
 
-  [Процесс обновления надстроек SharePoint](sharepoint-add-ins-update-process)
    
 

