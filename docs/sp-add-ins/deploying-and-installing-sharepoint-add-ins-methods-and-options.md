---
title: "Развертывание и установка надстроек SharePoint: методы и параметры"
description: "Публикация, установка и удаление надстройки SharePoint."
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: ad167642401e4bef300897b6d26b4f56bda6624d
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="deploying-and-installing-sharepoint-add-ins-methods-and-options"></a><span data-ttu-id="2fc89-103">Развертывание и установка надстроек SharePoint: методы и параметры</span><span class="sxs-lookup"><span data-stu-id="2fc89-103">Deploying and installing SharePoint Add-ins: methods and options</span></span>

<span data-ttu-id="2fc89-104">В этой статье вы узнаете больше о возможностях публикации, установки и удаления надстроек SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2fc89-104">In this article, you'll learn more about the options for publishing your SharePoint Add-in, as well as how to install and uninstall it.</span></span>

<span data-ttu-id="2fc89-105"><a name="MarketOrCatalog"> </a></span><span class="sxs-lookup"><span data-stu-id="2fc89-105"><a name="MarketOrCatalog"> </a></span></span>
## <a name="publishing-to-the-office-store-or-an-organizations-add-in-catalog"></a><span data-ttu-id="2fc89-106">Публикация в Магазине Office или каталоге надстроек организации</span><span class="sxs-lookup"><span data-stu-id="2fc89-106">Publishing to the Office Store or an organization's add-in catalog</span></span>

<span data-ttu-id="2fc89-p101">Вы можете разместить свою надстройку Надстройка SharePoint в общедоступном Магазин Office или в частном каталоге надстроек организации. Частный каталог надстроек это специальная коллекция веб-сайтов в веб-приложении SharePoint (или клиенте SharePoint Online), в которой размещаются библиотеки документов для приложений для SharePoint и приложений для Office. Размещение каталога в собственной коллекции веб-сайтов позволяет администратору веб-приложений или клиентов более легко ограничивать разрешения на доступ в каталог.</span><span class="sxs-lookup"><span data-stu-id="2fc89-p101">You can upload your SharePoint Add-in to either the public Office Store or to an organization's private add-in catalog. A private add-in catalog is a dedicated site collection in a SharePoint web application (or a SharePoint Online tenancy) that hosts document libraries for SharePoint Add-ins and Office Add-ins. Putting the catalog into its own site collection makes it easier for the web application administrator or tenant administrator to limit permissions to the catalog.</span></span> 

<span data-ttu-id="2fc89-p102">Если надстройку разместить в общедоступном Магазин Office, Microsoft выполняет в нем ряд операций по проверке. Например, проверку действительности и полноты разметки манифеста надстройки, а также того, не содержат ли какие-либо из пакетов решений SharePoint (файлы WSP) запрещенных элементов или функций, область действия которых шире, чем **Web**. Содержимое пакета также проверяется на предмет нежелательных элементов. Если надстройка проходит все проверки, пакет надстройки заносится в файл и подписывается Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2fc89-p102">If the add-in is uploaded to the Office Store, Microsoft runs some validation checks on it. For example, it checks whether the add-in manifest markup is valid and complete and verifies that any SharePoint solution packages (.wsp files) that are included do not include disallowed elements or Features with a scope broader than **Web**. The content of the package is also inspected for objectionable content. If the add-in passes all tests, the add-in package is wrapped into a file and signed by Microsoft.</span></span> 

> [!NOTE]
> <span data-ttu-id="2fc89-113">Если вы разрабатываете надстройку и развертываете ее с помощью Инструментов разработчика Microsoft Office для Visual Studio, надстройка устанавливается непосредственно на целевой тестовый сайт SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2fc89-113">When you are developing your add-in and deploying it with Microsoft Office Developer Tools for Visual Studio, the add-in is directly installed on the target test SharePoint site.</span></span> <span data-ttu-id="2fc89-114">А так как она не проходит через Магазин Office, описанная выше проверка не выполняется.</span><span class="sxs-lookup"><span data-stu-id="2fc89-114">Because it is not passing through the Office Store, the validation checking described earlier does not occur.</span></span>

<span data-ttu-id="2fc89-115">Надстройку SharePoint отправить в каталог надстроек организации можно так же просто, как любой файл — в библиотеку документов SharePoint Foundation.</span><span class="sxs-lookup"><span data-stu-id="2fc89-115">Uploading a SharePoint Add-in to an organization's add-in catalog is as easy as uploading any file to a SharePoint Foundation document library.</span></span> <span data-ttu-id="2fc89-116">Заполните всплывающую форму, указав локальный URL-адрес пакета надстройки и другие сведения, например имя надстройки.</span><span class="sxs-lookup"><span data-stu-id="2fc89-116">You fill out a pop-up form in which you supply the local URL of the add-in package and other information, such as the name of the add-in.</span></span> <span data-ttu-id="2fc89-117">Подобные проверки выполняются, когда надстройка добавляется в каталог надстроек организации. И надстройки, которые их не проходят, помечаются в каталоге как недопустимые или отключенные.</span><span class="sxs-lookup"><span data-stu-id="2fc89-117">When the add-in is uploaded to an organization's add-in catalog, similar checks take place, and add-ins that do not pass are marked as invalid or disabled in the catalog.</span></span> 

<span data-ttu-id="2fc89-118">Администраторы клиентов и веб-приложений SharePoint могут приобрести надстройки SharePoint в Магазине Office.</span><span class="sxs-lookup"><span data-stu-id="2fc89-118">Tenant administrators and SharePoint web application administrators can shop for SharePoint Add-ins in the Office Store.</span></span> <span data-ttu-id="2fc89-119">Чтобы открыть Магазин Office, нажмите кнопку **Добавить надстройку** на странице **Содержимое сайта** и выберите пункт **Магазин SharePoint** на странице **Мои надстройки **.</span><span class="sxs-lookup"><span data-stu-id="2fc89-119">To open the Office Store, the administrator selects **Add an Add-in** on the **Site Contents** page and then selects **SharePoint Store** in the **Your Add-ins** page.</span></span> <span data-ttu-id="2fc89-120">Откроется страница **Магазина SharePoint** с подробными сведениями о надстройках SharePoint от поставщиков (эти сведения можно также найти на сайте office.com).</span><span class="sxs-lookup"><span data-stu-id="2fc89-120">This opens a **SharePoint Store** page that the administrators can use to discover and learn about SharePoint Add-ins that vendors are offering (they can also do this on office.com).</span></span> 

<span data-ttu-id="2fc89-121">Надстройки, для которых требуются компоненты, не установленные в веб-приложении или клиенте администратора, отображаются в магазине надстроек тусклым шрифтом и недоступны.</span><span class="sxs-lookup"><span data-stu-id="2fc89-121">Add-ins that require a prerequisite that is not installed on the administrator's web application or tenancy appear dimmed and are unavailable in the add-in store.</span></span> <span data-ttu-id="2fc89-122">Например, если для надстройки требуются неустановленные службы поиска, она недоступна.</span><span class="sxs-lookup"><span data-stu-id="2fc89-122">For example, if an add-in requires Search Services and this is not installed, the add-in appears dimmed.</span></span> <span data-ttu-id="2fc89-123">Администраторы могут просматривать, сортировать и фильтровать список надстроек, читать о них сведения и отзывы, а также покупать для них лицензии.</span><span class="sxs-lookup"><span data-stu-id="2fc89-123">Administrators can sort, filter, and browse the list of add-ins, read about the add-ins, see add-in reviews, and purchase licenses for an add-in.</span></span>

<span data-ttu-id="2fc89-124">Решив приобрести лицензию, администратор должен принять условия покупки и согласиться с разрешениями, которые должна иметь надстройка для нормальной работы, такими как доступ к чтению списков или полный доступ к коллекции веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="2fc89-124">When an administrator decides to purchase a license, she must accept the terms and conditions of purchase and agree to the permissions that the add-in must have in order to execute, such as read access to lists or full control access to the site collection.</span></span> 

<span data-ttu-id="2fc89-p107">При покупке одной или более лицензий для надстройки они загружаются в веб-приложение или клиент. Автоматическая загрузка и установка надстройки при покупке лицензии не предусмотрены, хотя администраторы имеют возможность совместить установку с покупкой лицензии.</span><span class="sxs-lookup"><span data-stu-id="2fc89-p107">When one or more licenses for an add-in are purchased, the licenses are downloaded to the web application or tenancy. The add-in is not automatically downloaded and installed when the license is purchased, although administrators have the option to combine installation with license purchase.</span></span>

<span data-ttu-id="2fc89-p108">Пользователи устанавливают надстройки со страницы **Ваши надстройки**. На странице располагаются такие объединенные списки:</span><span class="sxs-lookup"><span data-stu-id="2fc89-p108">Users install add-ins from the **Your Add-ins** page. This page has a merged listing of the following:</span></span>

- <span data-ttu-id="2fc89-129">Надстройки SharePoint из каталога надстроек в организации веб-приложения (или клиента).</span><span class="sxs-lookup"><span data-stu-id="2fc89-129">SharePoint Add-ins from the web application's (or the tenant's) organization add-in catalog.</span></span>
- <span data-ttu-id="2fc89-130">Надстройки SharePoint из Магазина Office, на который организация или клиент уже имеют лицензию веб-сайта, или лицензию, которая была присвоена пользователю.</span><span class="sxs-lookup"><span data-stu-id="2fc89-130">SharePoint Add-ins from the Office Store for which the organization or tenant already owns a site license or a license that has been assigned to the user.</span></span>

<span data-ttu-id="2fc89-131">В списке отображаются все надстройки, которые можно установить сразу.</span><span class="sxs-lookup"><span data-stu-id="2fc89-131">All the add-ins that the user can install immediately are listed.</span></span> <span data-ttu-id="2fc89-132">Надстройки можно отфильтровать, чтобы отобразить на странице только те, которые включены в каталог надстроек организации.</span><span class="sxs-lookup"><span data-stu-id="2fc89-132">Users can filter the add-ins included on the page to include only add-ins in the organization's add-in catalog.</span></span> <span data-ttu-id="2fc89-133">После установки на веб-сайте надстройка появляется в списке надстроек на странице **Содержимое сайта**.</span><span class="sxs-lookup"><span data-stu-id="2fc89-133">When an add-in is installed, it appears in the list of add-ins on the **Site Contents** page of the website to which it is installed.</span></span>

<span data-ttu-id="2fc89-134"><a name="Installing"> </a></span><span class="sxs-lookup"><span data-stu-id="2fc89-134"><a name="Installing"> </a></span></span>
## <a name="installing-sharepoint-add-ins"></a><span data-ttu-id="2fc89-135">Установка надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fc89-135">Installing SharePoint Add-ins</span></span>

<span data-ttu-id="2fc89-p110">Владельцы веб-сайтов устанавливают Надстройки SharePoint со страницы **Ваши надстройки**, как было описано ранее в этом разделе. При установке создается экземпляр надстройки. Подробнее об установке надстроек:  [Добавление надстроек для SharePoint на сайт SharePoint](https://technet.microsoft.com/ru-RU/library/fp161231.aspx).</span><span class="sxs-lookup"><span data-stu-id="2fc89-p110">Website owners install SharePoint Add-ins from the **Your Add-ins** page as described earlier in this topic. Installation creates an instance of the add-in. For more information about installing add-ins, see [Add SharePoint Add-ins to a SharePoint site](https://technet.microsoft.com/ru-RU/library/fp161231.aspx).</span></span> 
 
> [!NOTE]
> <span data-ttu-id="2fc89-p111">Иногда в результате временных сбоев в сетевом соединение установка может быть заблокирована. Если по какой-либо причине при установке происходит сбой, инфраструктура инсталляции повторяет попытку три раза. При неудаче в пользовательском интерфейсе появляется отметка об ошибке. Пользователи могут повторить попытку установки позднее.</span><span class="sxs-lookup"><span data-stu-id="2fc89-p111">Sometimes a temporary loss of a network connection can block installation. If installation fails for any reason, the installation infrastructure will retry three times. If it does not succeed, an indication of the failure appears in the UI. Users can retry the installation later.</span></span> 

<span data-ttu-id="2fc89-143"><a name="Uninstalling"> </a></span><span class="sxs-lookup"><span data-stu-id="2fc89-143"><a name="Uninstalling"> </a></span></span>
## <a name="uninstalling-sharepoint-add-ins"></a><span data-ttu-id="2fc89-144">Удаление надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fc89-144">Uninstalling SharePoint Add-ins</span></span>

<span data-ttu-id="2fc89-p112">Владельцы веб-сайта могут удалить экземпляр Надстройка SharePoint с помощью пользовательского интерфейса SharePoint. Удаление экземпляра Надстройки SharePoint чистое, т. е. удаляется все, установленное надстройкой.</span><span class="sxs-lookup"><span data-stu-id="2fc89-p112">Website owners can uninstall an instance of a SharePoint Add-in through the SharePoint UI. Uninstallation of an instance of a SharePoint Add-ins is clean. This means that everything installed by the add-in is uninstalled.</span></span> 

<span data-ttu-id="2fc89-148">При этом компоненты, используемые надстройкой, но установленные отдельно от нее, не удаляются.</span><span class="sxs-lookup"><span data-stu-id="2fc89-148">However, components that an add-in uses, but that are installed separately from the installation of the add-in, are not removed.</span></span> <span data-ttu-id="2fc89-149">Предположим, у надстройки есть удаленная веб-страница с кнопками, с помощью которых создаются списки на хост-сайте.</span><span class="sxs-lookup"><span data-stu-id="2fc89-149">For example, suppose an add-in has a remote web page with buttons that create lists on the host web.</span></span> <span data-ttu-id="2fc89-150">При удалении надстройки удаляется ее плитка на странице **Содержимое сайта**, в результате чего удаленная страница становится недоступной для конечных пользователей. При этом созданные надстройкой списки остаются.</span><span class="sxs-lookup"><span data-stu-id="2fc89-150">Uninstallation of the add-in removes the add-in's tile from the **Site Contents** page, which in turn makes the remote page effectively inaccessible or unusable for end users, but it does not remove the lists that were created with the add-in.</span></span> <span data-ttu-id="2fc89-151">Система SharePoint не фиксирует, какие списки на хост-сайте были созданы надстройкой, а какие — в пользовательском интерфейсе SharePoint, поэтому она не может удалять списки, созданные надстройкой.</span><span class="sxs-lookup"><span data-stu-id="2fc89-151">SharePoint does not keep a record of which lists on the host web were created with the add-in and which ones were created by users in the SharePoint UI, so it can't delete lists that were created with the add-in.</span></span> <span data-ttu-id="2fc89-152">Обычно это желательное поведение, так как списки могут содержать данные, которые будут полезны пользователям даже после удаления надстройки, создавшей списки.</span><span class="sxs-lookup"><span data-stu-id="2fc89-152">This is generally desirable behavior because the lists may have data that remains useful to users even after the removal of the add-in that created the lists.</span></span>

<span data-ttu-id="2fc89-p114">Если Надстройка SharePoint включает в себя веб-надстройку, то она удаляется. Благодаря этому достигается более полное удаление, чем при систематическом отключении функций и запуске WSP-файла надстройки в режиме отмены.</span><span class="sxs-lookup"><span data-stu-id="2fc89-p114">If the SharePoint Add-in includes an add-in web, the add-in web is deleted. This provides a cleaner uninstall than systematically deactivating features and reversing the deployment of the add-in's internal .wsp file.</span></span>
 
> [!NOTE]
> <span data-ttu-id="2fc89-155">Когда пользователь удаляет надстройку, она перемещается в первую корзину.</span><span class="sxs-lookup"><span data-stu-id="2fc89-155">When a user removes an add-in, it is moved to the first stage Recycle Bin.</span></span> <span data-ttu-id="2fc89-156">При удалении из первой корзины настройка перемещается во вторую.</span><span class="sxs-lookup"><span data-stu-id="2fc89-156">Deleting it from there moves it to the second stage Recycle Bin.</span></span> <span data-ttu-id="2fc89-157">При удалении из второй корзины она удаляется полностью без возможности восстановления.</span><span class="sxs-lookup"><span data-stu-id="2fc89-157">If it is deleted from the second stage Recycle Bin, it is completely uninstalled and cannot be restored.</span></span> 

<span data-ttu-id="2fc89-158">Кроме того, при удалении надстройки отзываются разрешения для нее согласно следующим правилам:</span><span class="sxs-lookup"><span data-stu-id="2fc89-158">The add-in's permissions are also revoked when it is removed (recycled), according to these rules:</span></span>

- <span data-ttu-id="2fc89-159">разрешения уровня веб-сайта всегда аннулируются;</span><span class="sxs-lookup"><span data-stu-id="2fc89-159">Web-scoped permissions are always revoked.</span></span>
- <span data-ttu-id="2fc89-160">если в семействе веб-сайтов отсутствуют другие экземпляры надстройки, разрешения уровня семейства веб-сайтов также аннулируются;</span><span class="sxs-lookup"><span data-stu-id="2fc89-160">If there is no other instance of the add-in in the site collection, site collection-scoped permissions are also revoked.</span></span>
- <span data-ttu-id="2fc89-161">Если в подписке сайта (клиенте) нет других экземпляров надстройки, разрешения на уровне клиента также отзываются.</span><span class="sxs-lookup"><span data-stu-id="2fc89-161">If there is no other instance of the add-in in the site subscription (tenancy), tenant-scoped permissions are also revoked.</span></span>

<span data-ttu-id="2fc89-162">Веб-служба [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если она зарегистрирована в манифесте приложения, выполняется в начале процесса деинсталляции (это происходит, когда надстройка удаляется из второй корзины).</span><span class="sxs-lookup"><span data-stu-id="2fc89-162">The [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx) web service, if one is registered in the add-in manifest of the add-in, executes at the beginning of the uninstallation process (which occurs when the add-in is removed from the second stage Recycle Bin).</span></span> <span data-ttu-id="2fc89-163">Рекомендуется пользоваться веб-службой [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если вы также пользуетесь веб-службой [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx), и настраивать службу [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx) так, чтобы она отменяла все действия, выполняемые службой [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="2fc89-163">It is a best practice to have an [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx) web service if you have an [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx) web service and to design the [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx) service to reverse anything done in your [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx) service.</span></span> <span data-ttu-id="2fc89-164">Дополнительные сведения см. в статье [Обработка событий в надстройках SharePoint](handle-events-in-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="2fc89-164">For more information, see [Handle events in SharePoint Add-ins](handle-events-in-sharepoint-add-ins.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="2fc89-165">См. также</span><span class="sxs-lookup"><span data-stu-id="2fc89-165">See also</span></span>
<span data-ttu-id="2fc89-166"><a name="SP15deployinstallapps_addlresources"> </a></span><span class="sxs-lookup"><span data-stu-id="2fc89-166"><a name="SP15deployinstallapps_addlresources"> </a></span></span>

-  [<span data-ttu-id="2fc89-167">Публикация надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fc89-167">Publish SharePoint Add-ins</span></span>](publish-sharepoint-add-ins.md)
-  [<span data-ttu-id="2fc89-168">Важные аспекты архитектуры и разработки надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fc89-168">Important aspects of the SharePoint Add-in architecture and development landscape</span></span>](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscap.md)
-  [<span data-ttu-id="2fc89-169">Процесс обновления надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="2fc89-169">SharePoint Add-ins update process</span></span>](sharepoint-add-ins-update-process.md)
    
 

