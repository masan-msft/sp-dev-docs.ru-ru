---
title: Обработка событий в надстройках SharePoint
description: Обработка событий списков, событий элементов списков и событий надстройки в надстройках SharePoint с размещением у поставщика.
ms.date: 12/22/2017
ms.prod: sharepoint
ms.openlocfilehash: 820541b20f0faafd3872c148f9f205add7f76ecb
ms.sourcegitcommit: c57fc0e802661b0771f8b022964b6956ab4f6caf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/23/2017
---
# <a name="handle-events-in-sharepoint-add-ins"></a><span data-ttu-id="d3955-103">Обработка событий в надстройках SharePoint</span><span class="sxs-lookup"><span data-stu-id="d3955-103">Handle events in SharePoint Add-ins</span></span>

<span data-ttu-id="d3955-104">Пользовательский код в надстройках с размещением у поставщика может обрабатывать три категории событий:</span><span class="sxs-lookup"><span data-stu-id="d3955-104">Your custom code can handle three categories of events in provider-hosted add-ins:</span></span>

- <span data-ttu-id="d3955-105">**События списков**, например добавление или удаление списка на веб-сайте.</span><span class="sxs-lookup"><span data-stu-id="d3955-105">**List events**, such as the adding or deleting of a list on a website.</span></span>
- <span data-ttu-id="d3955-106">**События элементов списков**, например редактирование элемента в списке.</span><span class="sxs-lookup"><span data-stu-id="d3955-106">**List item events**, such as the editing of an item in a list.</span></span>
- <span data-ttu-id="d3955-107">**События надстройки**, например установка надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-107">**Add-in events**, such as the installation of an add-in.</span></span>

<span data-ttu-id="d3955-108">Надстройки SharePoint с размещением в SharePoint не поддерживают обработку событий, но вы можете превратить рабочий процесс в подобие обработчика событий списков или их элементов, сделав так, чтобы событие вызывало рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="d3955-108">SharePoint-hosted SharePoint Add-ins do not support event handling, but you can turn a workflow into a kind of list or list item event handler by setting an event to trigger the workflow. See  Workflows in SharePoint. Workflows cannot be triggered by add-in events, so add-in events cannot be handled with a SharePoint-hosted add-in.</span></span> <span data-ttu-id="d3955-109">Дополнительные сведения см. в статье [Рабочие процессы в SharePoint](../general-development/workflows-in-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="d3955-109">For more information, see [Workflows in SharePoint](../general-development/workflows-in-sharepoint.md).</span></span> <span data-ttu-id="d3955-110">События надстроек не могут вызывать рабочие процессы, поэтому они не могут обрабатываться надстройкой с размещением в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-110">Workflows cannot be triggered by add-in events, so add-in events cannot be handled with a SharePoint-hosted add-in.</span></span>
 
> [!NOTE] 
> <span data-ttu-id="d3955-111">События веб-сайтов и семейств веб-сайтов не поддерживаются в надстройках SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-111">Note  Website events and site collection events are not supported in SharePoint Add-ins.</span></span>
 
<span data-ttu-id="d3955-112">События делятся на два типа:</span><span class="sxs-lookup"><span data-stu-id="d3955-112">There are two kinds of events:</span></span> 

- <span data-ttu-id="d3955-113">**События _до операции_** вызываются до обработки события инфраструктурой SharePoint (в том числе сохранения изменений в базе данных контента).</span><span class="sxs-lookup"><span data-stu-id="d3955-113">**_Before_ events** are triggered before the SharePoint infrastructure does any of its own handling of the event (including committing changes to the content database).</span></span> <span data-ttu-id="d3955-114">В SharePoint **пользовательские обработчики событий до операции всегда выполняются синхронно**.</span><span class="sxs-lookup"><span data-stu-id="d3955-114">In SharePoint **custom before event handlers always execute synchronously**.</span></span> <span data-ttu-id="d3955-115">Помимо прочего, их можно использовать для отмены события.</span><span class="sxs-lookup"><span data-stu-id="d3955-115">Among other purposes, they can be used to cancel the event.</span></span> <span data-ttu-id="d3955-116">Например, если у надстройки есть функция удаления списка, обработчик соответствующего события может отменить удаление, если не соблюдаются определенные условия.</span><span class="sxs-lookup"><span data-stu-id="d3955-116">For example, if an add-in has a function for deleting a list, a handler for the list deleting event can cancel the deletion if certain conditions are not met.</span></span> <span data-ttu-id="d3955-117">Если событие является частью последовательности, его отмена предотвратит возникновение последующих событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-117">If the event is part of a sequence of events, cancelling it prevents any of the later events from occurring at all.</span></span> <span data-ttu-id="d3955-118">Например, если обработчик события ItemAdding отменяет его, то следующее событие ItemAdded не вызывается.</span><span class="sxs-lookup"><span data-stu-id="d3955-118">For example, if your handler for the ItemAdding event cancels the event, the ItemAdded event, which normally comes later, is not triggered.</span></span>

- <span data-ttu-id="d3955-119">**События _после операции_** вызываются после обработки события инфраструктурой SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-119">**_After_ events** are triggered after the SharePoint infrastructure does any of its own handling of the event.</span></span> <span data-ttu-id="d3955-120">В SharePoint **обработчики удаленных событий после операции всегда выполняются асинхронно**.</span><span class="sxs-lookup"><span data-stu-id="d3955-120">In SharePoint, **remote after event handlers, for list and list item events, always execute asynchronously**.</span></span> <span data-ttu-id="d3955-121">(Исключение составляют события приложений.). Помимо прочего, их можно использовать для регистрации событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-121">(App events are an exception.) Among other purposes, they can be used to log events.</span></span>
    
<span data-ttu-id="d3955-122"><a name="RER"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-122"></span></span> 

## <a name="handle-list-and-list-item-events"></a><span data-ttu-id="d3955-123">Обработка событий списков и событий элементов списков</span><span class="sxs-lookup"><span data-stu-id="d3955-123">Handle list and list item events</span></span>

<span data-ttu-id="d3955-p104">Для обработки событий списков и их элементов создаются удаленные приемники событий (RER) — веб-службы, которые выполняются за пределами фермы SharePoint или SharePoint Online. URL-адрес службы RER регистрируется для обрабатываемых ею событий. Зарегистрировать обработчик можно двумя способами:</span><span class="sxs-lookup"><span data-stu-id="d3955-p104">To handle list and list item events, you create remote event receivers (RERs), which are web services that run externally to the SharePoint farm or SharePoint Online. The URL of the RER service is registered for the events it handles. There are two ways to register a handler:</span></span>

- <span data-ttu-id="d3955-127">События на хост-сайте регистрируются программно с помощью CSOM (клиентской объектной модели) или REST API SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-127">Events in the host web are registered programmatically with the CSOM (client-side object model) or the SharePoint REST API.</span></span> <span data-ttu-id="d3955-128">Обычно для этого используется логика "первого запуска" в надстройке или обработчике события надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-128">This task is typically done in "first run" logic in the add-in or in a handler for an add-in event.</span></span> <span data-ttu-id="d3955-129">(Обзор событий надстройки см. в разделе [Обработка событий надстройки](#HandlingAppEvents) этой статьи.) Пример кода, который программно регистрирует событие списка, см. на странице [SharePoint/PnP/Samples/Core.EventReceivers](https://github.com/SharePoint/PnP/tree/master/Samples/Core.EventReceivers).</span><span class="sxs-lookup"><span data-stu-id="d3955-129">(For an overview of add-in events, see [Handle add-in events](#HandlingAppEvents) later in this article.) For a code sample that programmatically registers a list event, see [SharePoint/PnP/Samples/Core.EventReceivers](https://github.com/SharePoint/PnP/tree/master/Samples/Core.EventReceivers).</span></span>

- <span data-ttu-id="d3955-130">События на сайте надстройки обычно регистрируются в компоненте сайта с помощью простой разметки XML.</span><span class="sxs-lookup"><span data-stu-id="d3955-130">Events in the add-in web are usually registered in a feature of the add-in web with some simple XML markup.</span></span> <span data-ttu-id="d3955-131">Подробные сведения о создании разметки и службы представлены в статье [Создание удаленного приемника событий в надстройках SharePoint](create-a-remote-event-receiver-in-sharepoint-add-ins.md). Кроме того, события на сайте надстройки можно регистрировать программным способом.</span><span class="sxs-lookup"><span data-stu-id="d3955-131">Events in the add-in web are usually registered in a Feature of the add-in web with some simple XML markup. Details of how to create the markup and the service are in [Create a remote event receiver in SharePoint Add-ins](create-a-remote-event-receiver-in-sharepoint-add-ins.md). It is also possible to register add-in web events programmatically.</span></span>
    
> [!NOTE] 
> <span data-ttu-id="d3955-132">Удаленные приемники событий служат для того же, что и приемники событий в фермах. Но последние содержат специальный код, выполняемый на серверах SharePoint, поэтому их нельзя использовать в надстройках SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-132">Note  RERs have the same purpose as event receivers in farm solutions; but event receivers have custom code that runs on the SharePoint servers, so they cannot be used in SharePoint Add-ins.</span></span>
 
<span data-ttu-id="d3955-133">Надстройка может обрабатывать приведенные ниже **события списков и события библиотеки документов**.</span><span class="sxs-lookup"><span data-stu-id="d3955-133">Your add-in can handle the following **list and document library events**.</span></span> <span data-ttu-id="d3955-134">События с окончанием "ing" выполняются до события (синхронно), а события с окончанием "ed" — после (асинхронно).</span><span class="sxs-lookup"><span data-stu-id="d3955-134">Your add-in can handle the following list and document library events. Events ending in "ing" are before (synchronous) events and those ending in "ed" are after (asynchronous) events.</span></span>

|<span data-ttu-id="d3955-135">До (синхронно)</span><span class="sxs-lookup"><span data-stu-id="d3955-135">Before (synchronous)</span></span> |<span data-ttu-id="d3955-136">После (асинхронно)</span><span class="sxs-lookup"><span data-stu-id="d3955-136">After (asynchronous)</span></span> |
|:-----|:-----|
|<span data-ttu-id="d3955-137">ListAdding</span><span class="sxs-lookup"><span data-stu-id="d3955-137">ListAdding</span></span>|<span data-ttu-id="d3955-138">ListAdded</span><span class="sxs-lookup"><span data-stu-id="d3955-138">ListAdded</span></span>|
|<span data-ttu-id="d3955-139">ListDeleting</span><span class="sxs-lookup"><span data-stu-id="d3955-139">ListDeleting</span></span>|<span data-ttu-id="d3955-140">ListDeleted</span><span class="sxs-lookup"><span data-stu-id="d3955-140">ListDeleted</span></span>|
|<span data-ttu-id="d3955-141">FieldAdding</span><span class="sxs-lookup"><span data-stu-id="d3955-141">FieldAdding</span></span>|<span data-ttu-id="d3955-142">FieldAdded</span><span class="sxs-lookup"><span data-stu-id="d3955-142">FieldAdded</span></span>|
|<span data-ttu-id="d3955-143">FieldDeleting</span><span class="sxs-lookup"><span data-stu-id="d3955-143">FieldDeleting</span></span>|<span data-ttu-id="d3955-144">FieldDeleted</span><span class="sxs-lookup"><span data-stu-id="d3955-144">FieldDeleted</span></span>|
|<span data-ttu-id="d3955-145">FieldUpdating</span><span class="sxs-lookup"><span data-stu-id="d3955-145">FieldUpdating</span></span>|<span data-ttu-id="d3955-146">FieldUpdated</span><span class="sxs-lookup"><span data-stu-id="d3955-146">FieldUpdated</span></span>|

<span data-ttu-id="d3955-147">События обновления полей связаны с изменением свойств поля (столбца) в списке, например возможности сортировки, а не с изменением данных в поле.</span><span class="sxs-lookup"><span data-stu-id="d3955-147">The field update events are about changing the properties of a field (column) on a list, such as whether it is sortable, not about changing the data in the field.</span></span>

<span data-ttu-id="d3955-148">Надстройка может обрабатывать следующие **события элементов списков**:</span><span class="sxs-lookup"><span data-stu-id="d3955-148">Your add-in can handle the following list item events.</span></span> 

|<span data-ttu-id="d3955-149">До (синхронно)</span><span class="sxs-lookup"><span data-stu-id="d3955-149">Before (synchronous)</span></span> |<span data-ttu-id="d3955-150">После (асинхронно)</span><span class="sxs-lookup"><span data-stu-id="d3955-150">After (asynchronous)</span></span> |
|:-----|:-----|
|<span data-ttu-id="d3955-151">ItemAdding</span><span class="sxs-lookup"><span data-stu-id="d3955-151">ItemAdding</span></span>|<span data-ttu-id="d3955-152">ItemAdded</span><span class="sxs-lookup"><span data-stu-id="d3955-152">ItemAdded</span></span>|
|<span data-ttu-id="d3955-153">ItemUpdating</span><span class="sxs-lookup"><span data-stu-id="d3955-153">ItemUpdating</span></span>|<span data-ttu-id="d3955-154">ItemUpdated</span><span class="sxs-lookup"><span data-stu-id="d3955-154">ItemUpdated</span></span>|
|<span data-ttu-id="d3955-155">ItemDeleting</span><span class="sxs-lookup"><span data-stu-id="d3955-155">ItemDeleting</span></span>|<span data-ttu-id="d3955-156">ItemDeleted</span><span class="sxs-lookup"><span data-stu-id="d3955-156">ItemDeleted</span></span>|
|<span data-ttu-id="d3955-157">ItemCheckingOut</span><span class="sxs-lookup"><span data-stu-id="d3955-157">ItemCheckingOut</span></span>|<span data-ttu-id="d3955-158">ItemCheckedOut</span><span class="sxs-lookup"><span data-stu-id="d3955-158">ItemCheckedOut</span></span>|
|<span data-ttu-id="d3955-159">ItemCheckingIn</span><span class="sxs-lookup"><span data-stu-id="d3955-159">ItemCheckingIn</span></span>|<span data-ttu-id="d3955-160">ItemCheckedIn</span><span class="sxs-lookup"><span data-stu-id="d3955-160">ItemCheckedIn</span></span>|
|<span data-ttu-id="d3955-161">ItemUncheckingOut</span><span class="sxs-lookup"><span data-stu-id="d3955-161">ItemUncheckingOut</span></span>|<span data-ttu-id="d3955-162">ItemUncheckedOut</span><span class="sxs-lookup"><span data-stu-id="d3955-162">ItemUncheckedOut</span></span>|
|<span data-ttu-id="d3955-163">ItemAttachmentAdding</span><span class="sxs-lookup"><span data-stu-id="d3955-163">ItemAttachmentAdding</span></span>|<span data-ttu-id="d3955-164">ItemAttachmentAdded</span><span class="sxs-lookup"><span data-stu-id="d3955-164">ItemAttachmentAdded</span></span>|
|<span data-ttu-id="d3955-165">ItemAttachmentDeleting</span><span class="sxs-lookup"><span data-stu-id="d3955-165">ItemAttachmentDeleting</span></span>|<span data-ttu-id="d3955-166">ItemAttachmentDeleted</span><span class="sxs-lookup"><span data-stu-id="d3955-166">ItemAttachmentDeleted</span></span>|
|<span data-ttu-id="d3955-167">ItemFileMoving</span><span class="sxs-lookup"><span data-stu-id="d3955-167">ItemFileMoving</span></span>|<span data-ttu-id="d3955-168">ItemFileMoved</span><span class="sxs-lookup"><span data-stu-id="d3955-168">ItemFileMoved</span></span>|
|<span data-ttu-id="d3955-169">ItemVersionDeleting\*</span><span class="sxs-lookup"><span data-stu-id="d3955-169">ItemVersionDeleting*\*</span></span>|<span data-ttu-id="d3955-170">ItemVersionDeleted\*</span><span class="sxs-lookup"><span data-stu-id="d3955-170">ItemVersionDeleted\*</span></span>|
||<span data-ttu-id="d3955-171">ItemFileConverted</span><span class="sxs-lookup"><span data-stu-id="d3955-171">ItemFileConverted</span></span>|

> [!NOTE] 
> <span data-ttu-id="d3955-172">\*Эти два новых события могут быть недоступны в пользовательском интерфейсе Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d3955-172">\*These two new events may not be available in the Visual Studio UI.</span></span> <span data-ttu-id="d3955-173">Если это так, выберите событие ItemDeleting или ItemDeleted и измените имена вручную.</span><span class="sxs-lookup"><span data-stu-id="d3955-173">\*These two new events may not be available in the vsnv UI. If not, pick ItemDeleting or ItemDeleted and then manually change the names.</span></span>

<span data-ttu-id="d3955-174">При работе в Visual Studio и добавлении RER в проект надстройки SharePoint Инструменты разработчика Office для Visual Studio делают следующее:</span><span class="sxs-lookup"><span data-stu-id="d3955-174">When you are working in Visual Studio, and you add a RER to a SharePoint Add-in project, the Office Developer Tools for Visual Studio do the following:</span></span>

- <span data-ttu-id="d3955-p109">Файл веб-службы, например RemoteEventReceiver1.svc, добавляется в веб-приложение для обработки событий, указанных при добавлении удаленного приемника событий в надстройку SharePoint. Веб-служба содержит файл с кодом для обработки удаленных событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-p109">A web service file, such as RemoteEventReceiver1.svc, is added to the web application to handle the events that you specified when you added the remote event receiver to the SharePoint Add-in. The web service contains a code file to handle the remote events.</span></span>
    
    <span data-ttu-id="d3955-p110">После создания приемника удаленных событий следует добавить код в файл, используемый службой веб-приложения для обработки событий. По умолчанию файл кода содержит два метода, к которым добавляется код обработки:</span><span class="sxs-lookup"><span data-stu-id="d3955-p110">After you create the remote event receiver, you add code to the code file for the web application service to handle the events. By default, the code file contains two methods to which you add your handling code:</span></span> 
    
    - <span data-ttu-id="d3955-179">`ProcessEvent()` обрабатывает события до операции (такие, как в левых столбцах выше) и возвращает в SharePoint объект, сообщающий, отменять ли событие.</span><span class="sxs-lookup"><span data-stu-id="d3955-179">`ProcessEvent()` handles "before" events (such as those in the left-hand columns in the tables earlier in the article) and it returns an object to SharePoint that reports on whether it should cancel the event or let it proceed.</span></span>
    
    - <span data-ttu-id="d3955-p111">`ProcessOneWayEvent()` обрабатывает события после операции. Он выполняется асинхронно и не возвращает никаких объектов в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-p111">`ProcessOneWayEvent()` handles "after" events. It runs asynchronously and does not return anything to SharePoint.</span></span>

    <span data-ttu-id="d3955-182">Когда происходит зарегистрированное событие, SharePoint вызывает соответствующий метод в службе и передает объект, который предоставляет контекстные сведения для кода.</span><span class="sxs-lookup"><span data-stu-id="d3955-182">When a registered event occurs, SharePoint calls the appropriate method in your service and passes an object that provides some context information for your code. For example, the event type (from one of the two tables earlier in the article) is identified, so that your code can branch to the logic that is appropriate for the event.</span></span> <span data-ttu-id="d3955-183">Например, определяется тип события (указанный в одной из двух таблиц выше), чтобы код мог перейти к логике, соответствующей этому событию.</span><span class="sxs-lookup"><span data-stu-id="d3955-183">When a registered event occurs, SharePoint calls the appropriate method in your service and passes an object that provides some context information for your code. For example, the event type (from one of the two tables earlier in the article) is identified, so that your code can branch to the logic that is appropriate for the event.</span></span>

- <span data-ttu-id="d3955-p113">Элемент проекта для удаленного приемника событий добавляется в проект надстройки SharePoint. Файл Elements.xml для удаленного приемника событий ссылается на веб-службу в веб-приложении и указанные удаленные события. В следующем примере показано, как файл Elements.xml обрабатывает добавление или удаление элемента списка.</span><span class="sxs-lookup"><span data-stu-id="d3955-p113">A project item for the remote event receiver is added to the SharePoint Add-in project. The Elements.xml file for the remote event receiver references the web service in the web application and the remote events that you specified. The following example shows an Elements.xml file that handles the addition or deletion of a list item.</span></span>
    
    ```XML
    <?xml version="1.0" encoding="utf-8"?>
    <Elements xmlns="http://schemas.microsoft.com/sharepoint/">
    <Receivers ListTemplateId="104">
        <Receiver>
            <Name>RemoteEventReceiver1ItemAdding</Name>
            <Type>ItemAdding</Type>
            <SequenceNumber>10000</SequenceNumber>
            <Url>~remoteAppUrl/RemoteEventReceiver1.svc</Url>
        </Receiver>
        <Receiver>
            <Name>RemoteEventReceiver1ItemDeleting</Name>
            <Type>ItemDeleting</Type>
            <SequenceNumber>10000</SequenceNumber>
            <Url>~remoteAppUrl/RemoteEventReceiver1.svc</Url>
        </Receiver>
    </Receivers>
    </Elements>
    ```

<span data-ttu-id="d3955-187">Чтобы изменить события, обрабатываемые удаленным приемником событий, откройте **обозреватель решений**, затем окно **Свойства** для удаленного приемника событий, разверните узел **События SharePoint** и задайте для нужных событий значения **True**.</span><span class="sxs-lookup"><span data-stu-id="d3955-187">To change the events that the remote event receiver handles, open  **Solution Explorer**, open the  **Properties** window for the remote event receiver, expand the **SharePoint Events** node, and then set only the events that you want to handle to **True**.</span></span>
 
> [!NOTE] 
> <span data-ttu-id="d3955-188">Дополнительные сведения об удаленных приемниках событий, в том числе сведения об устранении неполадок, см. в разделе [Удаленные приемники событий: вопросы и ответы](#RERFAQ).</span><span class="sxs-lookup"><span data-stu-id="d3955-188">For additional information about RERs, including some troubleshooting information, see [Remote event receivers FAQ](#RERFAQ).</span></span>
 
<span data-ttu-id="d3955-189"><a name="HandlingAppEvents"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-189"></span></span>

## <a name="handle-add-in-events"></a><span data-ttu-id="d3955-190">Обработка событий надстройки</span><span class="sxs-lookup"><span data-stu-id="d3955-190">Handle add-in events</span></span>

<span data-ttu-id="d3955-191">События надстройки также обрабатываются удаленными веб-службами, но настраиваются в пакете надстройки не так, как удаленные приемники событий списков и событий элементов списков, поэтому рассматриваются как отдельная категория компонента.</span><span class="sxs-lookup"><span data-stu-id="d3955-191">Add-in events are also handled by remote web services, but they are configured differently in the add-in package from list and list item RERs, so they are treated as a separate category of component. For an add-in event, the remote web service is registered in the add-in manifest, not in an add-in web Feature. The add-in doesn't even have to have an add-in web. There are three add-in events as described in the next sections.</span></span> <span data-ttu-id="d3955-192">В этом случае удаленная веб-служба регистрируется в манифесте надстройки, а не в компоненте сайта надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-192">For an add-in event, the remote web service is registered in the add-in manifest, not in an add-in web feature.</span></span> <span data-ttu-id="d3955-193">Для надстройки даже не нужен сайт.</span><span class="sxs-lookup"><span data-stu-id="d3955-193">The add-in doesn't even have to have an add-in web.</span></span> <span data-ttu-id="d3955-194">Существует три события надстройки, которые описаны в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="d3955-194">There are three add-in events as described in the next sections.</span></span>

### <a name="appinstalled-event"></a><span data-ttu-id="d3955-195">Событие AppInstalled</span><span class="sxs-lookup"><span data-stu-id="d3955-195">AppInstalled event</span></span>

<span data-ttu-id="d3955-196">Событие AppInstalled выполняется сразу после установки надстройки, но до отправки пользователю уведомления о ее завершении.</span><span class="sxs-lookup"><span data-stu-id="d3955-196">The AppInstalled event runs immediately after SharePoint has finished everything that it needs to do when the add-in is installed, but before the user is notified that installation is complete.</span></span> <span data-ttu-id="d3955-197">Хотя это событие и выполняется *после* операции, SharePoint запускает обработчик *синхронно*.</span><span class="sxs-lookup"><span data-stu-id="d3955-197">Although this is an *after*  event, SharePoint runs your handler *synchronously*.</span></span> <span data-ttu-id="d3955-198">Надстройка не доступна для использования до завершения работы обработчика, он может отменить установку (в результате чего SharePoint отменит все выполненные действия).</span><span class="sxs-lookup"><span data-stu-id="d3955-198">The add-in is not available for use until after your handler has completed, and your handler can cancel the installation (which causes SharePoint to roll back everything it has done as part of the installation).</span></span> <span data-ttu-id="d3955-199">Рекомендуется для выявления ошибок в обработчике и уведомления SharePoint об отмене установки.</span><span class="sxs-lookup"><span data-stu-id="d3955-199">In fact, it is a best practice to catch any errors in your handler and instruct SharePoint to roll back the installation.</span></span> <span data-ttu-id="d3955-200">Дополнительные сведения см. в разделе [Включение логики отката и логики проверки выполненных действий в обработчики событий надстроек](#Rollback).</span><span class="sxs-lookup"><span data-stu-id="d3955-200">Include rollback logic and "already done" logic in your add-in event handlers</span></span>
 
> [!NOTE] 
> <span data-ttu-id="d3955-201">При установке надстройки на [уровне клиента](tenancies-and-deployment-scopes-for-sharepoint-add-ins.md) она устанавливается в семействе веб-сайтов каталога надстроек, и событие AppInstalled запускается только после этого.</span><span class="sxs-lookup"><span data-stu-id="d3955-201">When you install an add-in with [Tenant scope](tenancies-and-deployment-scopes-for-sharepoint-add-ins.md), it is installed to the add-in catalog site collection and the AppInstalled event runs then and only then. The add-in is visible in multiple web sites in the tenancy, but the event does not run separately for each of  these.</span></span> <span data-ttu-id="d3955-202">Надстройка видима на нескольких веб-сайтах в клиентской организации, но событие не запускается для каждого из них отдельно.</span><span class="sxs-lookup"><span data-stu-id="d3955-202">The add-in is visible in multiple websites in the tenancy, but the event does not run separately for each of these.</span></span>

<span data-ttu-id="d3955-203">Помимо отмены установки надстройки, это событие можно использовать для других целей, в том числе:</span><span class="sxs-lookup"><span data-stu-id="d3955-203">Besides canceling an add-in installation, this event can be used for many other purposes including:</span></span>

- <span data-ttu-id="d3955-204">Установки на хост-сайте компонентов SharePoint, которые невозможно декларативно установить с помощью компонента хост-сайта, например списков и дочерних веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="d3955-204">Install SharePoint components to the host web that cannot be declaratively installed with the host web Feature, such as lists or subwebs.</span></span>

- <span data-ttu-id="d3955-205">Программной регистрации обработчиков событий списков и их элементов на хост-сайте или сайте надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-205">Programmatically register list and list item event handlers with the host web or add-in web.</span></span>
    
- <span data-ttu-id="d3955-206">Установки параметров инициализации, зависящих от экземпляра надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-206">Setting app-instance-relative initialization settings.</span></span> <span data-ttu-id="d3955-207">Например, у надстройки может быть контейнер свойств для хранения параметров, которые отличаются для разных экземпляров надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-207">Set app-instance-relative initialization settings. For example, your add-in can have an add-in web property bag for holding settings that vary from one instance of the add-in to another. Your AppInstalled handler can write varying values to the property bag, based on, say, the site type of the host web (such as Team Site or Blog site).</span></span> <span data-ttu-id="d3955-208">Обработчик AppInstalled может записывать в контейнер свойств разные значения, зависящие, к примеру, от типа хост-сайта (например, сайта группы или блога).</span><span class="sxs-lookup"><span data-stu-id="d3955-208">Set app-instance-relative initialization settings. For example, your add-in can have an add-in web property bag for holding settings that vary from one instance of the add-in to another. Your AppInstalled handler can write varying values to the property bag, based on, say, the site type of the host web (such as Team Site or Blog site).</span></span>
    
    > [!NOTE] 
    > <span data-ttu-id="d3955-209">Проверив, является ли хост-сайт сайтом каталога надстроек, можно определить, установлена ли надстройка на уровне клиента.</span><span class="sxs-lookup"><span data-stu-id="d3955-209">Note  Checking to see if the host web is an AppCatalog site is a good way to detect whether the add-in has been installed with tenant scope. See  Tenancies and deployment scopes for SharePoint Add-ins.</span></span> <span data-ttu-id="d3955-210">См. статью [Области клиентов и области развертывания для надстроек SharePoint](tenancies-and-deployment-scopes-for-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="d3955-210">Tenancies and deployment scopes for SharePoint Add-ins</span></span>

- <span data-ttu-id="d3955-211">Выполнения в удаленном веб-приложении настройки, зависящей от экземпляра надстройки, например добавления таблицы в базу данных.</span><span class="sxs-lookup"><span data-stu-id="d3955-211">Perform app-instance-relative configuration in the add-in's remote web application, such as adding a table to a database.</span></span>
    
 
> [!IMPORTANT] 
> <span data-ttu-id="d3955-212">Ваша реализация события AppInstalled должна завершаться в течение 30 секунд, иначе инфраструктура установки SharePoint посчитает, что произошел сбой.</span><span class="sxs-lookup"><span data-stu-id="d3955-212">Your implementation of the AppInstalled event must complete within 30 seconds or the SharePoint installation infrastructure thinks it has failed.</span></span> <span data-ttu-id="d3955-213">Инфраструктура перезапустит событие *и повторит ваш код с начала* (еще три раза).</span><span class="sxs-lookup"><span data-stu-id="d3955-213">The infrastructure reruns the event *and repeats your code from the beginning*, up to three additional times.</span></span> <span data-ttu-id="d3955-214">Если время ожидания истечет четыре раза, SharePoint выполнит полный откат установки надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-214">After four timeouts, SharePoint rolls back the entire add-in installation.</span></span> <span data-ttu-id="d3955-215">Подробное описание последствий представлено в разделе [Включение логики отката и логики проверки выполненных действий в обработчики событий надстроек](#Rollback).</span><span class="sxs-lookup"><span data-stu-id="d3955-215">The full implications of these facts are discussed in [Include rollback logic and "already done" logic in your add-in event handlers](#Rollback).</span></span>

### <a name="appuninstalling-event"></a><span data-ttu-id="d3955-216">Событие AppUninstalling</span><span class="sxs-lookup"><span data-stu-id="d3955-216">AppUninstalling event</span></span>

<span data-ttu-id="d3955-217">Событие AppUninstalling *не* запускается при удалении надстройки с хост-сайта.</span><span class="sxs-lookup"><span data-stu-id="d3955-217">The AppUninstalling event does *not*  run when the add-in is removed from the host web.</span></span> <span data-ttu-id="d3955-218">Надстройка всего лишь перемещается в корзину пользователя.</span><span class="sxs-lookup"><span data-stu-id="d3955-218">Removal of an add-in only moves the add-in to the user's recycle bin.</span></span> <span data-ttu-id="d3955-219">Перед вызовом события AppUninstalling необходимо выполнить два действия.</span><span class="sxs-lookup"><span data-stu-id="d3955-219">Two more steps are required before the AppUninstalling event is triggered.</span></span> <span data-ttu-id="d3955-220">Во-первых, пользователь должен удалить надстройку из корзины, что приведет к перемещению надстройки во вторую корзину.</span><span class="sxs-lookup"><span data-stu-id="d3955-220">First, a user must remove the add-in from the recycle bin, which moves it to the second stage recycle bin.</span></span> <span data-ttu-id="d3955-221">Во-вторых, **пользователь должен удалить надстройку из второй корзины.**</span><span class="sxs-lookup"><span data-stu-id="d3955-221">Second, a **user must remove the add-in from the second stage recycle bin.**</span></span> <span data-ttu-id="d3955-222">Последнее действие вызовет событие AppUninstalling.</span><span class="sxs-lookup"><span data-stu-id="d3955-222">This last task triggers the AppUninstalling event.</span></span> <span data-ttu-id="d3955-223">Событие AppUninstalling является синхронным, его можно использовать для отмены удаления, чтобы надстройка осталась во второй корзине.</span><span class="sxs-lookup"><span data-stu-id="d3955-223">The AppUninstalling event is synchronous and you can use it to cancel the uninstallation, which would leave the add-in in the second stage recycle bin.</span></span>

<span data-ttu-id="d3955-224">Основное назначение обработчика этого события — удаление или перемещение в корзину элементов, развернутых обработчиком события AppInstalled (или AppUpdated).</span><span class="sxs-lookup"><span data-stu-id="d3955-224">The main purpose of a handler for this event is to delete or recycle things that were deployed with an AppInstalled (or an AppUpdated) handler.</span></span> <span data-ttu-id="d3955-225">SharePoint не может удалить эти элементы или переместить их в корзину, так как не располагает данными о них, по крайней мере не как о компонентах надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-225">SharePoint cannot delete these things, or move them to the recycle bin, because it doesn't know about them, at least not as components of the add-in.</span></span> <span data-ttu-id="d3955-226">Эти элементы рекомендуется удалять.</span><span class="sxs-lookup"><span data-stu-id="d3955-226">It is usually a good practice to remove these things.</span></span> <span data-ttu-id="d3955-227">Но вы можете оставить элементы, которые будут использоваться после удаления надстройки. Если список или веб-сайт, созданный обработчиком события AppInstalled, еще будет использоваться, не удаляйте его в обработчике события AppUninstalling.</span><span class="sxs-lookup"><span data-stu-id="d3955-227">But you don't want to delete things that still have a useful life after the add-in is gone: if a list or website created by your AppInstalled handler is still going to be used, don't delete it in your AppUninstalling handler.</span></span>

### <a name="appupgraded-event"></a><span data-ttu-id="d3955-228">Событие AppUpgraded</span><span class="sxs-lookup"><span data-stu-id="d3955-228">AppUpgraded event</span></span>

<span data-ttu-id="d3955-229">Событие AppUpgraded запускается сразу после обновления надстройки до новой версии, но до отправки пользователю уведомления о его завершении.</span><span class="sxs-lookup"><span data-stu-id="d3955-229">The  AppUpgraded event runs immediately after SharePoint has finished everything that it needs to do when the add-in is updated to a new version, but before the user is notified that updating is complete. Like the AppInstalled event, it is an after event, but is essentially synchronous and it is a best practice to catch errors and notify SharePoint to roll back the update.</span></span> <span data-ttu-id="d3955-230">Как и событие AppInstalled, оно выполняется после операции, но, по сути, является синхронным и рекомендуется для выявления ошибок и уведомления SharePoint об откате обновления.</span><span class="sxs-lookup"><span data-stu-id="d3955-230">The  AppUpgraded event runs immediately after SharePoint has finished everything that it needs to do when the add-in is updated to a new version, but before the user is notified that updating is complete. Like the AppInstalled event, it is an after event, but is essentially synchronous and it is a best practice to catch errors and notify SharePoint to roll back the update.</span></span>

<span data-ttu-id="d3955-231">Некоторые примеры того, что может делать обработчик этого события:</span><span class="sxs-lookup"><span data-stu-id="d3955-231">Some examples of what a handler for this event can do:</span></span>

- <span data-ttu-id="d3955-232">Добавление, изменение или удаление компонентов надстройки с хост-сайта.</span><span class="sxs-lookup"><span data-stu-id="d3955-232">Add, change, or remove add-in components from the host web.</span></span>

- <span data-ttu-id="d3955-233">Действия в надстройке, которые невозможно выполнить с помощью описательной семантики обновления в компоненте сайта надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-233">Do things in the add-in web that aren't possible with the declarative update semantics in an add-in web Feature. For example, you cannot delete anything with the declarative update markup, but you can do so programmatically in an AppUpgraded handler.</span></span> <span data-ttu-id="d3955-234">Например, с помощью декларативной разметки обновления невозможно удалять элементы, но это можно сделать программно в обработчике события AppUpgraded.</span><span class="sxs-lookup"><span data-stu-id="d3955-234">Do things in the add-in web that aren't possible with the declarative update semantics in an add-in web Feature. For example, you cannot delete anything with the declarative update markup, but you can do so programmatically in an AppUpgraded handler.</span></span>

- <span data-ttu-id="d3955-235">Изменение компонентов, зависящих от экземпляра надстройки, в веб-приложении или удаленной базе данных надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-235">Make changes to app-instance-relative components in the add-in's web application or remote database.</span></span>

<span data-ttu-id="d3955-236">Подробные инструкции по созданию обработчиков событий надстроек см. в статье [Создание приемника событий надстройки в надстройках для SharePoint](create-an-add-in-event-receiver-in-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="d3955-236">Detailed instructions for creating add-in event handlers is in  Create an add-in event receiver in SharePoint Add-ins   .</span></span>

<span data-ttu-id="d3955-237"><a name="Rollback"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-237"></span></span>

### <a name="include-rollback-logic-and-already-done-logic-in-your-add-in-event-handlers"></a><span data-ttu-id="d3955-238">Включение логики отката и логики проверки выполненных действий в обработчики событий надстроек</span><span class="sxs-lookup"><span data-stu-id="d3955-238">Include rollback logic and "already done" logic in your add-in event handlers</span></span>

<span data-ttu-id="d3955-239">Если при обработке любого из трех событий надстройки возникает ошибка, SharePoint отменяет событие и откатывает все связанные с ним изменения.</span><span class="sxs-lookup"><span data-stu-id="d3955-239">If SharePoint encounters an error when processing any of the three add-in events, it cancels the event and rolls back any changes it has made in connection with the event.</span></span> <span data-ttu-id="d3955-240">Обработчики событий надстроек должны учитывать эту систему, так как при сбое части реализуемого события нужно откатить все событие, а не продолжать работу, рискуя оставить надстройку в поврежденном состоянии.</span><span class="sxs-lookup"><span data-stu-id="d3955-240">If SharePoint encounters an error when processing any of the three add-in events, it will cancel the event and roll back any changes it has made in connection with the event. Your add-in event handlers have to integrate with this system because if the part of the event that you are implementing fails, you want the whole event to roll back, rather than continue and leave things in a possibly corrupt state. Here's what your handler usually has to do:</span></span> <span data-ttu-id="d3955-241">Как правило, обработчик должен сделать следующее:</span><span class="sxs-lookup"><span data-stu-id="d3955-241">Here's what your handler usually has to do:</span></span>

- <span data-ttu-id="d3955-242">Сообщить SharePoint об ошибке.</span><span class="sxs-lookup"><span data-stu-id="d3955-242">Tell SharePoint that an error has occurred.</span></span> <span data-ttu-id="d3955-243">Сообщение SOAP, которое веб-служба обработки событий надстроек возвращает в SharePoint, содержит свойство **Status** со значением **Continue**, **CancelWithError** или **CancelWithoutError**.</span><span class="sxs-lookup"><span data-stu-id="d3955-243">Tell SharePoint that an error has occurred. The SOAP message that your add-in event handling web service returns to SharePoint will have a  **Status** property that can have the values of **Continue**,  **CancelWithError**, or  **CancelWithoutError**. Either  Cancel\* status tells SharePoint to roll back the event.</span></span> <span data-ttu-id="d3955-244">Оба состояния **Cancel** сообщают SharePoint, что необходимо откатить событие.</span><span class="sxs-lookup"><span data-stu-id="d3955-244">Either **Cancel** status tells SharePoint to roll back the event.</span></span>

- <span data-ttu-id="d3955-245">Выполнить откат действий, уже выполненных обработчиком до обнаружения ошибки.</span><span class="sxs-lookup"><span data-stu-id="d3955-245">Roll back what the handler has already done before the handler encounters the error.</span></span> <span data-ttu-id="d3955-246">Как правило, среда SharePoint не может это сделать, поскольку ей неизвестно, какие действия выполнил обработчик.</span><span class="sxs-lookup"><span data-stu-id="d3955-246">SharePoint can't usually do this for you because it doesn't know what your handler did.</span></span> <span data-ttu-id="d3955-247">Это правило не является универсальным.</span><span class="sxs-lookup"><span data-stu-id="d3955-247">This isn't a universal rule.</span></span> <span data-ttu-id="d3955-248">Например, если произошла отмена установки надстройки, SharePoint полностью удалит сайт надстройки, поэтому обработчику события AppInstalled нет смысла отменять все действия, выполненные с этим сайтом.</span><span class="sxs-lookup"><span data-stu-id="d3955-248">For example, if an add-in installation is canceled, SharePoint deletes the entire add-in web, so there's no point in an AppInstalled event handler reverting anything it has done to the add-in web.</span></span> <span data-ttu-id="d3955-249">Тем не менее, обычно он должен отменять действия, выполненные с хост-сайтом или удаленными компонентами надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-249">But it usually should roll back things it did to the host web or to remote components of the add-in.</span></span> 
    
> [!NOTE] 
> <span data-ttu-id="d3955-250">Указанное выше относится как к событию AppUninstalling, так и к двум другим событиям надстроек.</span><span class="sxs-lookup"><span data-stu-id="d3955-250">The preceding points apply to the AppUninstalling event as much as to the other two add-in events.</span></span> <span data-ttu-id="d3955-251">Например, если после удаления строки из удаленной базы данных возникает ошибка, строку необходимо восстановить.</span><span class="sxs-lookup"><span data-stu-id="d3955-251">For example, if your handler for the uninstalling event deletes a row in a remote database, and then encounters an error, the row needs to be restored.</span></span> <span data-ttu-id="d3955-252">Так как служба отправляет в SharePoint сообщение об отмене, надстройка не удаляется из корзины.</span><span class="sxs-lookup"><span data-stu-id="d3955-252">Because your service sends a cancel message to SharePoint, the add-in is not removed from the recycle bin.</span></span> <span data-ttu-id="d3955-253">При восстановлении и повторном использовании она может не работать без этой записи в базе данных.</span><span class="sxs-lookup"><span data-stu-id="d3955-253">If it is restored from there and used again, it may fail to work without that database entry.</span></span> <span data-ttu-id="d3955-254">Однако обработчик AppUninstalling завершает работу *до* удаления надстройки из корзины.</span><span class="sxs-lookup"><span data-stu-id="d3955-254">However, your AppUninstalling handler completes *before* SharePoint removes the add-in from the recycle bin.</span></span> <span data-ttu-id="d3955-255">Таким образом, при возникновении ошибки в самом SharePoint и отмене удаления обработчик не может отменить выполненные действия.</span><span class="sxs-lookup"><span data-stu-id="d3955-255">However, your AppUninstalling handler completes before SharePoint removes the add-in from the recycle bin. So, if SharePoint itself encounters an error and needs to cancel the removal, there is no way for your handler to undo what it has done.</span></span>
 
<span data-ttu-id="d3955-256">Если среда SharePoint не получает сообщение от обработчика в течение 30 секунд, она снова вызывает обработчик.</span><span class="sxs-lookup"><span data-stu-id="d3955-256">If SharePoint doesn't receive a results message from your handler in 30 seconds, it calls the handler again.</span></span> <span data-ttu-id="d3955-257">После трех повторных попыток (всего четырех) выполняется полный откат события.</span><span class="sxs-lookup"><span data-stu-id="d3955-257">It gives up entirely and rolls back the event after three retries (four tries in all).</span></span> <span data-ttu-id="d3955-258">При каждом вызове обработчика код запускается сначала.</span><span class="sxs-lookup"><span data-stu-id="d3955-258">Each time it calls the handler, your code starts again from the beginning.</span></span> <span data-ttu-id="d3955-259">Как правило, вам не нужно, чтобы обработчик повторял уже выполненные действия, например создание списка на хост-сайте, и вам неизвестно, завершила ли логика отката свою работу, или вообще запустилась, до истечения времени ожидания обработчика. По этой причине логика вашего обработчика не должна предпринимать никаких действий, не проверив, не совершено ли уже какое-либо действие, кроме случаев, когда повторение действий является безопасным.</span><span class="sxs-lookup"><span data-stu-id="d3955-259">If SharePoint doesn't receive a results message from your handler in 30 seconds, it will call the handler again. It gives up entirely, and rolls back the event, after three retries (four tries in all). Each time it calls the handler, your code starts again from the beginning. But you generally don't want your handler to redo things it has already done, such as create a list on the host web, and you can't know if your rollback logic was completed, or even triggered, before the handler timed out. For this reason, your handler logic should not take any action without first checking whether the action has already been done, unless it would be harmless to do it again.</span></span> 

<span data-ttu-id="d3955-260">Ошибки установки и обновления отображаются в пользовательском интерфейсе SharePoint, как показано на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="d3955-260">Installation and updating errors can be seen in the SharePoint UI, as shown in the following graphic.</span></span>

<span data-ttu-id="d3955-261">**Получение сведений об ошибке установки**</span><span class="sxs-lookup"><span data-stu-id="d3955-261">**Figure 1. Getting details for install error.**</span></span>

![Действия для просмотра ошибок при установке надстройки в SharePoint](../images/1edb644e-b3d4-4a9b-b92e-4ae2c07341c2.png)

<span data-ttu-id="d3955-263"><a name="Strategies"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-263"></span></span>

### <a name="add-in-event-handler-architecture-strategies"></a><span data-ttu-id="d3955-264">Стратегии архитектуры обработчиков событий надстройки</span><span class="sxs-lookup"><span data-stu-id="d3955-264">Add-in event handler architecture strategies</span></span>

<span data-ttu-id="d3955-p129">Если представить обработчик в псевдокоде, он должен иметь примерно следующую структуру. Если в разделе Try возникнет ошибка, должны вызываться разделы Catch и Rollback (это может происходить автоматически, в зависимости от языка и платформы).</span><span class="sxs-lookup"><span data-stu-id="d3955-p129">Expressed in pseudo-code, your handler should usually be structured something like the following. If an error occurs in the Try section, the Catch and Rollback section should be invoked. (This may happen automatically depending on the language and framework.)</span></span>

```
Try
    If X not already done,
        Do X.
Catch
    Send cancel message to SharePoint.
    If X not already undone,
        Undo X.

```

<span data-ttu-id="d3955-268">Однако логика отката и проверки выполненных действий в веб-службе может замедлить работу обработчика.</span><span class="sxs-lookup"><span data-stu-id="d3955-268">However, implementing your rollback and "already done" logic in your web service can slow down the handler.</span></span> <span data-ttu-id="d3955-269">Логика установки и отката обычно изменяет объекты, более или менее удаленные от веб-службы, например хост-сайт SharePoint или внутреннюю базу данных.</span><span class="sxs-lookup"><span data-stu-id="d3955-269">Both your installation and rollback logic usually make changes to something more or less remote from the web service, such as the SharePoint host web or a back-end database.</span></span> <span data-ttu-id="d3955-270">Если код установки и отката поделен между разделами Try и Catch, то служба вызывает удаленные компоненты по отдельности, часто несколько раз в каждом разделе.</span><span class="sxs-lookup"><span data-stu-id="d3955-270">If your installation and rollback code is split between the Try and Catch sections, the service is making separate calls to the remote components, often several such calls in each section.</span></span> 

<span data-ttu-id="d3955-271">Рекомендуется реализовать логику установки и отката непосредственно в удаленном компоненте с помощью процедуры, которая может вызываться из раздела Try обработчика.</span><span class="sxs-lookup"><span data-stu-id="d3955-271">The best practice is usually to implement the installation and rollback logic on the remote component itself in a procedure that can be called from your handler in your Try section.</span></span> <span data-ttu-id="d3955-272">Процедура должна возвращать сообщение об успешном завершении или сбое. В последнем случае код из раздела Try вызывает раздел Catch (например, сообщив об исключении).</span><span class="sxs-lookup"><span data-stu-id="d3955-272">The procedure should return a success or failure message, and if it reports failure, code in your Try section invokes the Catch section (by, say, throwing an exception).</span></span> <span data-ttu-id="d3955-273">Раздел Catch лишь уведомляет SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-273">The only thing the Catch section does is notify SharePoint.</span></span> <span data-ttu-id="d3955-274">Назовем это стратегией делегирования обработчика.</span><span class="sxs-lookup"><span data-stu-id="d3955-274">We'll call this the handler delegation strategy.</span></span> <span data-ttu-id="d3955-275">Она проиллюстрирована следующим псевдокодом:</span><span class="sxs-lookup"><span data-stu-id="d3955-275">The following pseudo-code illustrates the strategy:</span></span>

```
Try
    Call the "Do X" procedure on remote platform.
    If remote platform reports failure, call Catch.
Catch
    Send cancel message to SharePoint.

```

<span data-ttu-id="d3955-276">Процедура "Do X", которая выполняется в удаленной системе, содержит логику отката и проверки выполненных действий, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="d3955-276">The "Do X" procedure, that executes on the remote system, would itself contain the rollback and "already done" logic like the following.</span></span>

```
Try
    If X not already done,
        Do X.
        Set success flag to true.
Catch
    If X was done before error,
        Undo X.
    Set success flag to false.
Send
    Return success flag to the event handler.

```

<span data-ttu-id="d3955-277">Например, если обработчик должен выполнить действие с базой данных SQL Server, вы можете установить на сервере SQL Server хранимую процедуру, которая использует блок [TRY-CATCH](https://docs.microsoft.com/ru-RU/sql/t-sql/language-elements/try-catch-transact-sql) для реализации логики отката, с блоками [IF-ELSE](https://docs.microsoft.com/ru-RU/sql/t-sql/language-elements/if-else-transact-sql) для реализации логики проверки выполненных действий.</span><span class="sxs-lookup"><span data-stu-id="d3955-277">For example, if your handler needs to take action on an SQL Server database, you can install a stored procedure on the SQL Server that uses a  [TRY-CATCH](https://docs.microsoft.com/ru-RU/sql/t-sql/language-elements/try-catch-transact-sql) block to implement installation-rollback logic. with [IF-ELSE](https://docs.microsoft.com/ru-RU/sql/t-sql/language-elements/if-else-transact-sql) blocks to implement "already done" logic.</span></span>

<span data-ttu-id="d3955-278">Модель надстроек SharePoint не позволяет хранить пользовательский серверный код в SharePoint и вызывать его из клиентской объектной модели (CSOM).</span><span class="sxs-lookup"><span data-stu-id="d3955-278">The SharePoint add-in model doesn't provide a way to store custom server-side code on SharePoint and invoke it from the CSOM (client-side object model).</span></span> <span data-ttu-id="d3955-279">Но CSOM позволяет объединить логику try-catch и if-then-else и отправить ее на сервер для выполнения.</span><span class="sxs-lookup"><span data-stu-id="d3955-279">But the CSOM does provide a way to bundle try-catch and if-then-else logic and send it to the server for execution.</span></span> 

<span data-ttu-id="d3955-280">Подробный пример обработчика событий надстройки, который использует стратегию делегирования для добавления списка на хост-сайт, см. в статье [Создание приемника событий надстройки в надстройках для SharePoint](create-an-add-in-event-receiver-in-sharepoint-add-ins.md). Пример кода см. на странице [SharePoint/PnP/Samples/Core.AppEvents.HandlerDelegation](https://github.com/SharePoint/PnP/tree/master/Samples/Core.AppEvents.HandlerDelegation).</span><span class="sxs-lookup"><span data-stu-id="d3955-280">The SharePoint add-in model doesn't provide a way to store custom server-side code on SharePoint and invoke it from the CSOM (client-side object model). But the CSOM does provide a way to bundle try-catch and if-then-else logic and send it to the server for execution. For a detailed example of a add-in event handler that uses the handler delegation strategy to add a list to a host web, see  [Create an add-in event receiver in SharePoint Add-ins](create-an-add-in-event-receiver-in-sharepoint-add-ins.md). For a code sample, see  [OfficeDev/PnP/Samples/Core.AppEvents.HandlerDelegation](https://github.com/SharePoint/PnP/tree/master/Samples/Core.AppEvents.HandlerDelegation).</span></span>

<span data-ttu-id="d3955-281">Стратегию делегирования обработчика можно использовать не всегда.</span><span class="sxs-lookup"><span data-stu-id="d3955-281">You cannot always use the handler delegation strategy.</span></span> <span data-ttu-id="d3955-282">Например, если обработчик вызывает несколько компонентов, например базу данных и хост-сайт SharePoint, один из вызовов может завершиться успешно, а другой — с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="d3955-282">For example, when your handler is calling out to more than one component, such as to a database and the SharePoint host web, there is a chance that one could complete successfully and the other fail.</span></span> <span data-ttu-id="d3955-283">В этом случае логика отката для первого компонента не выполняется, если она реализована согласно стратегии делегирования обработчика.</span><span class="sxs-lookup"><span data-stu-id="d3955-283">In this scenario, the rollback logic for the first component doesn't run if you designed it with the handler delegation strategy.</span></span> <span data-ttu-id="d3955-284">По этой причине при синхронном вызове компонентов только последний из них может использовать эту стратегию.</span><span class="sxs-lookup"><span data-stu-id="d3955-284">For this reason, if you are calling to the components synchronously, only the last one called can use the handler delegation strategy.</span></span> <span data-ttu-id="d3955-285">При асинхронном вызове эту стратегию нельзя использовать ни в одном из них.</span><span class="sxs-lookup"><span data-stu-id="d3955-285">If they are called asynchronously, you can't use that strategy in any of them.</span></span> 

<span data-ttu-id="d3955-286">Пример обработчика событий надстроек, который не использует стратегию делегирования обработчика, см. на странице [SharePoint/PnP/Samples/Core.AppEvents](https://github.com/SharePoint/PnP/tree/master/Samples/Core.AppEvents).</span><span class="sxs-lookup"><span data-stu-id="d3955-286">For a sample of an add-in event handler that does not use the handler delegation strategy, see  [SharePoint/PnP/Samples/Core.AppEvents](https://github.com/SharePoint/PnP/tree/master/Samples/Core.AppEvents).</span></span>
 
> [!TIP] 
> <span data-ttu-id="d3955-287">Если происходит сбой события AppInstalled, SharePoint удаляет сайт надстройки (если он существует), если же происходит сбой события AppUpated, SharePoint восстанавливает состояние надстройки до обновления.</span><span class="sxs-lookup"><span data-stu-id="d3955-287">If the AppInstalled event fails, SharePoint deletes the add-in web if there is one; and if the AppUpated event fails, SharePoint restores the add-in web to its pre-update state.</span></span> <span data-ttu-id="d3955-288">По этой причине обработчикам никогда не нужно отменять действия, выполненные на сайте надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-288">For this reason, your handlers never need to roll back actions they take on the add-in web.</span></span> <span data-ttu-id="d3955-289">Если обработчик выполняет действия как на хост-сайте, так и на сайте надстройки, то начать следует с сайта надстройки.</span><span class="sxs-lookup"><span data-stu-id="d3955-289">If your handler performs actions on both the host web and the add-in web, it should deal with the add-in web first.</span></span> <span data-ttu-id="d3955-290">Это позволит использовать стратегию делегирования обработчика для хост-сайта.</span><span class="sxs-lookup"><span data-stu-id="d3955-290">Doing so makes it safe to use the handler delegation strategy for the host web.</span></span> <span data-ttu-id="d3955-291">Даже если действия с сайтом надстройки выполняются успешно, а действия с хост-сайтом завершаются с ошибкой, выполняется вся логика отката.</span><span class="sxs-lookup"><span data-stu-id="d3955-291">Even if the add-in web actions succeed and the host web actions fail, no rollback logic goes unexecuted.</span></span>

## <a name="remote-event-receivers-in-add-ins-that-support-multiple-security-zones"></a><span data-ttu-id="d3955-292">Удаленные приемники событий в надстройках, поддерживающих несколько зон безопасности</span><span class="sxs-lookup"><span data-stu-id="d3955-292">Remote Event Receivers in add-ins that support multiple security zones</span></span>

<span data-ttu-id="d3955-293">Некоторые ограничения на разработку надстроек поддерживают несколько зон безопасности и имеют удаленный приемник событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-293">Some restrictions on how you design an add-in support multiple security zones and have a remote event receiver.</span></span> <span data-ttu-id="d3955-294">Дополнительные сведения см. в статье базы знаний kb3135876: [Нельзя добавить поставщика размещения надстройки для сайта SharePoint 2013 в зонах не по умолчанию](https://support.microsoft.com/ru-RU/help/3135876/you-can-t-add-a-provider-hosted-add-in-to-a-sharepoint-2013-site-in-no).</span><span class="sxs-lookup"><span data-stu-id="d3955-294">For more information, see Knowledge Base article kb3135876 [You can't add a provider-hosted add-in to a SharePoint 2013 site in non-default zones](https://support.microsoft.com/ru-RU/help/3135876/you-can-t-add-a-provider-hosted-add-in-to-a-sharepoint-2013-site-in-no).</span></span>
 
<span data-ttu-id="d3955-295"><a name="RERFAQ"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-295"></span></span>

## <a name="remote-event-receivers-faq"></a><span data-ttu-id="d3955-296">Удаленные приемники событий: вопросы и ответы</span><span class="sxs-lookup"><span data-stu-id="d3955-296">Remote event receivers FAQ</span></span>

<span data-ttu-id="d3955-297">Ниже приведены распространенные вопросы, которые могут возникнуть при использовании удаленных приемников событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-297">The following are common questions you may have when using remote event receivers.</span></span>

<span data-ttu-id="d3955-298"><a name="RER_HowRERDifferentfrom2010"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-298"></span></span>

### <a name="how-are-remote-event-receivers-different-from-event-receivers-in-sharepoint-2010"></a><span data-ttu-id="d3955-299">Чем удаленные приемники событий отличаются от приемников событий в SharePoint 2010?</span><span class="sxs-lookup"><span data-stu-id="d3955-299">How are remote event receivers different from event receivers in SharePoint 2010?</span></span>

<span data-ttu-id="d3955-300">В SharePoint 2010 приемники событий обрабатывают события, которые происходят в списках, сайтах и других объектах SharePoint, выполняя код на сервере SharePoint (с полным доверием или в песочнице).</span><span class="sxs-lookup"><span data-stu-id="d3955-300">In SharePoint 2010, event receivers handle events that occur on SharePoint lists, sites, and other SharePoint objects by running the code on the SharePoint server (either full-trust or in a sandbox).</span></span> <span data-ttu-id="d3955-301">Этот тип приемника событий по-прежнему существует в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-301">This type of event receiver still exists in SharePoint.</span></span> <span data-ttu-id="d3955-302">Однако SharePoint также поддерживает *удаленные* приемники событий, в которых код, выполняющийся при вызове события, размещается в веб-службе.</span><span class="sxs-lookup"><span data-stu-id="d3955-302">However, SharePoint also supports *remote* event receivers in which the code that runs when the event is triggered is hosted by a web service.</span></span> <span data-ttu-id="d3955-303">Это означает, что при регистрации удаленного приемника событий также необходимо сообщить SharePoint, какую веб-службу вызывать.</span><span class="sxs-lookup"><span data-stu-id="d3955-303">This means that if you register a remote event receiver, you also need to tell SharePoint which web service to invoke.</span></span> 

<span data-ttu-id="d3955-304">В следующих примерах кода первый пример (решения SharePoint) реализует функции с помощью обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-304">In the following code samples, the first example (SharePoint solutions) implements functionality by using an event handler.</span></span> <span data-ttu-id="d3955-305">Второй пример (надстройки SharePoint) реализует те же функции с помощью удаленного приемника событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-305">The second example (SharePoint Add-ins) implements the same functionality by using a remote event receiver.</span></span>

#### <a name="sharepoint-solutions"></a><span data-ttu-id="d3955-306">Решения SharePoint</span><span class="sxs-lookup"><span data-stu-id="d3955-306">SharePoint solutions</span></span>

```C#
    // Trigger an event when an item is added to the SharePoint list.
    Public class OnPlantUpdated : SPItemEventReceiver
    {
    Public override void ItemAdding (SPItemEventProperties properties)
    {
    Properties.After.Properties.ChangedProperties.Add("Image",CreateLink(properties));
    Properties.status =SPEventReceiverStatus.Continue;
    }

    /// When an item updates, run the following.
    Public override void ItemUpdating(SPItemEventProperties properties)
    {
    Properties.AfterProperties.ChangedProperties.Add("Image",CreateLink9properties));
    Properties.Status= SPEventReceiverStatus.Continue;
    }
```

#### <a name="sharepoint-add-ins"></a><span data-ttu-id="d3955-307">Надстройки SharePoint</span><span class="sxs-lookup"><span data-stu-id="d3955-307">SharePoint Add-ins</span></span>   
    
```C#
    /* Trigger an event when an item is added to the SharePoint list*/
    Public class OnPlantUpdated : IRemoteEventService
    {
    public SPRemoteEventResult ProcessEvent (SPRemoteEventProperties properties)
    {
    SPRemoteEventResult result =new SPRemoteEventResult();
    If (properties.EventType == SPRemoteEventType.ItemAdding ||  
                properties.EventType == SPRemoteEventType.ItemUpdating)
    {
    // Add code that runs when an item is added or updated.
    }
```

<span data-ttu-id="d3955-308">Полный пример кода см. в статье [Добавление свойств элементов списков с помощью приемника удаленных событий](https://code.msdn.microsoft.com/office/SharePoint-2013-Add-list-2c6e71e0).</span><span class="sxs-lookup"><span data-stu-id="d3955-308">For the complete code sample, see [Add list item properties with a remote event receiver](https://code.msdn.microsoft.com/office/SharePoint-2013-Add-list-2c6e71e0).</span></span> 

<span data-ttu-id="d3955-309">Подробную демонстрацию примера кода см. в видео [Перенос приемника событий SharePoint в удаленный приемник событий](https://channel9.msdn.com/Series/Reimagine-SharePoint-Development/Migrating-a-SharePoint-Event-Receiver-to-a-Remote-Event-Receiver).</span><span class="sxs-lookup"><span data-stu-id="d3955-309">For a detailed demo of the code sample, see [Migrating a SharePoint event receiver to a remote event receiver](https://channel9.msdn.com/Series/Reimagine-SharePoint-Development/Migrating-a-SharePoint-Event-Receiver-to-a-Remote-Event-Receiver).</span></span>

<span data-ttu-id="d3955-310">Дополнительные сведения см. в статье [Перечисление SPRemoteEventType](https://msdn.microsoft.com/ru-RU/library/microsoft.sharepoint.client.eventreceivers.spremoteeventtype.aspx).</span><span class="sxs-lookup"><span data-stu-id="d3955-310">For information, see  [SPRemoteEventType enumeration](https://msdn.microsoft.com/ru-RU/library/microsoft.sharepoint.client.eventreceivers.spremoteeventtype.aspx)</span></span>
 
<span data-ttu-id="d3955-311"><a name="RER_HowDoRERWork"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-311"></span></span>
 
### <a name="how-do-remote-event-receivers-work"></a><span data-ttu-id="d3955-312">Как работают удаленные приемники событий?</span><span class="sxs-lookup"><span data-stu-id="d3955-312">How do remote event receivers work?</span></span>

<span data-ttu-id="d3955-313">На следующем рисунке показано, как работают удаленные приемники событий:</span><span class="sxs-lookup"><span data-stu-id="d3955-313">The following figure shows how remote event receivers work:</span></span>

- <span data-ttu-id="d3955-314">Пользователь выполняет действие в SharePoint (например, изменяет элемент списка).</span><span class="sxs-lookup"><span data-stu-id="d3955-314">The user performs an action on SharePoint (for example, edits a list item).</span></span>

- <span data-ttu-id="d3955-315">Затем SharePoint обращается к зарегистрированной веб-службе.</span><span class="sxs-lookup"><span data-stu-id="d3955-315">SharePoint then talks to the registered web service.</span></span> <span data-ttu-id="d3955-316">Вы можете выполнять некоторые операции, например обновлять свойство элемента списка или серверную систему.</span><span class="sxs-lookup"><span data-stu-id="d3955-316">SharePoint then talks to the registered web service. You could perform some operations???for example, update a list item property, or update a backend system.</span></span>

- <span data-ttu-id="d3955-p139">Веб-служба также может обратиться к службе контроля доступа, чтобы запросить собственный подписанный маркер для обратного вызова SharePoint. С помощью этого маркера можно выполнять удаленные действия из веб-службы в результате предыдущей операции над элементом списка или серверной системой.</span><span class="sxs-lookup"><span data-stu-id="d3955-p139">The web service can also talk to the Access Control Service (ACS) to request its own signed token to do a call back to SharePoint. Using this token, you can perform remote actions from within the web service as a result of the earlier operation on the list item or in the backend system.</span></span>

   <span data-ttu-id="d3955-319">**Принцип действия удаленных приемников событий в SharePoint**</span><span class="sxs-lookup"><span data-stu-id="d3955-319">**How remote event receivers work in SharePoint**</span></span>

   ![Принцип действия удаленных приемников событий в SharePoint](../images/SP15Con_Remote_Event_Receivers_FAQ_fig1.png)

<span data-ttu-id="d3955-321"><a name="RER_DebugRER"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-321"></span></span>

### <a name="how-do-i-debug-remote-event-receivers"></a><span data-ttu-id="d3955-322">Как отлаживать удаленные приемники событий?</span><span class="sxs-lookup"><span data-stu-id="d3955-322">How do I debug remote event receivers?</span></span>

<span data-ttu-id="d3955-323">См. статью [Устранение неполадок и отладка удаленного приемника событий в надстройке SharePoint](debug-and-troubleshoot-a-remote-event-receiver-in-a-sharepoint-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="d3955-323">See  [Debug and troubleshoot a remote event receiver in a SharePoint Add-in](debug-and-troubleshoot-a-remote-event-receiver-in-a-sharepoint-add-in.md).</span></span> 

<span data-ttu-id="d3955-324"><a name="RER_ClientsideCodeFromRER"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-324"></span></span>

### <a name="can-i-run-client-side-javascript-code-from-remote-event-receivers"></a><span data-ttu-id="d3955-325">Можно ли запускать клиентский код (JavaScript) из удаленных приемников событий?</span><span class="sxs-lookup"><span data-stu-id="d3955-325">Can I run client-side (JavaScript) code from remote event receivers?</span></span>

<span data-ttu-id="d3955-326">Нет, вы не можете запускать клиентский код (JavaScript) из удаленных приемников событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-326">No, you cannot run client-side (JavaScript) code from remote event receivers.</span></span>

### <a name="are-there-any-restrictions-on-where-a-remote-event-receiver-can-be-hosted-on-its-url"></a><span data-ttu-id="d3955-327">Существуют ли ограничения на размещение удаленного приемника событий или его URL-адрес?</span><span class="sxs-lookup"><span data-stu-id="d3955-327">Are there any restrictions on where a remote event receiver can be hosted or on its URL?</span></span>

<span data-ttu-id="d3955-328">Удаленный приемник событий может быть размещен в облаке или на локальном сервере, который не используется в качестве сервера SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d3955-328">The remote event receiver can be hosted in the cloud or on an on-premises server that is not also being used as a SharePoint server.</span></span> <span data-ttu-id="d3955-329">URL-адрес производственного приемника не может использовать определенный порт.</span><span class="sxs-lookup"><span data-stu-id="d3955-329">The URL of a production receiver cannot specify a particular port.</span></span> <span data-ttu-id="d3955-330">Это значит, что вам необходимо использовать порт 443 для протокола HTTPS (рекомендовано) или порт 80 для HTTP.</span><span class="sxs-lookup"><span data-stu-id="d3955-330">SharePoint requires that there be no explicit port in the URL of the handler in production. This means that you must use either port 443 for HTTPS, which we recommend, or port 80 for HTTP.</span></span> <span data-ttu-id="d3955-331">Если вы используете HTTPS, приемник размещен локально, а надстройка находится в SharePoint Online, сервер размещения должен иметь доверенный сертификат, выданный центром сертификации.</span><span class="sxs-lookup"><span data-stu-id="d3955-331">If you are using HTTPS and the receiver service is hosted on-premises, but the add-in is on SharePoint Online, the hosting server must have a publicly trusted certificate from a certificate authority.</span></span> <span data-ttu-id="d3955-332">(Самозаверяющий сертификат подходит, только если надстройка расположена в локальной ферме SharePoint.)</span><span class="sxs-lookup"><span data-stu-id="d3955-332">(A self-signed certificate works only if the add-in is on an on-premises SharePoint farm.)</span></span>
 
<span data-ttu-id="d3955-333"><a name="RER_Will2020EventHandlerWillWorkOn2013"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-333"></span></span>
 
### <a name="will-a-sharepoint-2010-event-handler-work-on-sharepoint-after-i-upgrade"></a><span data-ttu-id="d3955-334">Будет ли обработчик событий SharePoint 2010 работать в SharePoint после обновления?</span><span class="sxs-lookup"><span data-stu-id="d3955-334">Will a SharePoint 2010 event handler work on SharePoint after I upgrade?</span></span>

<span data-ttu-id="d3955-335">Если пакет решения SharePoint 2010, содержащий обработчик событий, обновляется до SharePoint, то, в зависимости от ваших настроек, пакет решения может работать без изменений.</span><span class="sxs-lookup"><span data-stu-id="d3955-335">If a SharePoint 2010 solution package containing an event handler is upgraded to SharePoint, depending on your customizations, the solution package may work without any modifications.</span></span> <span data-ttu-id="d3955-336">Это касается и обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-336">This includes the event handler too.</span></span> <span data-ttu-id="d3955-337">Если решение SharePoint 2010 преобразуется в надстройку SharePoint, обработчик событий должен быть переписан как удаленный приемник событий.</span><span class="sxs-lookup"><span data-stu-id="d3955-337">If the SharePoint 2010 solution is remodeled into a SharePoint Add-in in SharePoint, the event handler should be rewritten as a remote event receiver.</span></span> <span data-ttu-id="d3955-338">См. видео [Перенос приемника событий SharePoint в удаленный приемник событий](https://channel9.msdn.com/Series/Reimagine-SharePoint-Development/Migrating-a-SharePoint-Event-Receiver-to-a-Remote-Event-Receiver).</span><span class="sxs-lookup"><span data-stu-id="d3955-338">See [Migrating a SharePoint event receiver to a remote event receiver](https://channel9.msdn.com/Series/Reimagine-SharePoint-Development/Migrating-a-SharePoint-Event-Receiver-to-a-Remote-Event-Receiver).</span></span>

## <a name="see-also"></a><span data-ttu-id="d3955-339">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="d3955-339">See also</span></span>
<span data-ttu-id="d3955-340"><a name="SP15handleevents_addlresources"> </a></span><span class="sxs-lookup"><span data-stu-id="d3955-340"></span></span>

- [<span data-ttu-id="d3955-341">Создание удаленного приемника событий в надстройках SharePoint</span><span class="sxs-lookup"><span data-stu-id="d3955-341">Create a remote event receiver in SharePoint Add-ins</span></span>](create-a-remote-event-receiver-in-sharepoint-add-ins.md)
- [<span data-ttu-id="d3955-342">Создание приемника событий в надстройках SharePoint</span><span class="sxs-lookup"><span data-stu-id="d3955-342">Create an add-in event receiver in SharePoint Add-ins</span></span>](create-an-add-in-event-receiver-in-sharepoint-add-ins.md)
- [<span data-ttu-id="d3955-343">Устранение неполадок и отладка удаленного приемника событий в надстройке SharePoint</span><span class="sxs-lookup"><span data-stu-id="d3955-343">Debug and troubleshoot a remote event receiver in a SharePoint Add-in</span></span>](debug-and-troubleshoot-a-remote-event-receiver-in-a-sharepoint-add-in.md) 
- [<span data-ttu-id="d3955-344">Разработка надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="d3955-344">Develop SharePoint Add-ins</span></span>](develop-sharepoint-add-ins.md)
    
 

