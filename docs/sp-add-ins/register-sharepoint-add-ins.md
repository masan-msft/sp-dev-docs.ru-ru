---
title: Регистрация надстроек SharePoint
description: Зарегистрируйте надстройку SharePoint в Azure ACS, используя Visual Studio, Панель мониторинга продаж или страницу AppRegNew.aspx, и получите регистрационную информацию.
ms.date: 12/26/2017
ms.prod: sharepoint
ms.openlocfilehash: 2b2296c29c5470b532054b74ee60f73eac2b680e
ms.sourcegitcommit: 6bc4c8e43c260deabc60d41d633586bfa3e6024a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/28/2017
---
# <a name="register-sharepoint-add-ins"></a><span data-ttu-id="ca4dc-103">Регистрация надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="ca4dc-103">Register SharePoint Add-ins</span></span>

<span data-ttu-id="ca4dc-104">Зарегистрируйте надстройку SharePoint в Azure ACS, используя Visual Studio, Панель мониторинга продаж или страницу AppRegNew.aspx, и получите регистрационную информацию.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-104">Register your SharePoint Add-ins in Azure ACS by using Visual Studio, the Seller Dashboard, or an AppRegNew.aspx page, and retrieve registration information.</span></span>

<span data-ttu-id="ca4dc-105">Чтобы удаленные компоненты надстройки SharePoint с размещением у поставщика могли взаимодействовать с SharePoint, используя OAuth, необходимо зарегистрировать надстройку в облачной службе [Azure ACS](https://msdn.microsoft.com/ru-RU/library/azure/gg429788.aspx) и службе управления приложениями SharePoint клиента или фермы.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-105">For the remote components of a provider-hosted SharePoint Add-in to interact with SharePoint using OAuth, the add-in must first register with the  [Azure ACS](https://msdn.microsoft.com/ru-RU/library/azure/gg429788.aspx) cloud-based service and the SharePoint App Management Service of the tenancy or farm. (It is called "App Management Service" because SharePoint Add-ins were originally called "apps for SharePoint".)</span></span> <span data-ttu-id="ca4dc-106">(Она называется службой управления приложениями, так как изначально надстройки SharePoint назывались "приложения для SharePoint".)</span><span class="sxs-lookup"><span data-stu-id="ca4dc-106">Ensure that the App Management Service and user profile application are configured. (It is called "App Management Service" because SharePoint Add-ins were originally named "apps for SharePoint".) The steps are as follows:</span></span>
 
> [!NOTE] 
> <span data-ttu-id="ca4dc-107">Это не требуется для надстроек с размещением в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-107">Note  This is not required for SharePoint-hosted add-ins.</span></span>
 

<span data-ttu-id="ca4dc-108">Чтобы зарегистрировать надстройку в Azure ACS, укажите следующие сведения:</span><span class="sxs-lookup"><span data-stu-id="ca4dc-108">To register your add-in with Azure ACS, you specify the following information:</span></span>

- <span data-ttu-id="ca4dc-109">GUID надстройки, называемый идентификатором клиента;</span><span class="sxs-lookup"><span data-stu-id="ca4dc-109">A GUID for the add-in, called a client ID.</span></span>

- <span data-ttu-id="ca4dc-110">пароль для надстройки, называемый секретом клиента;</span><span class="sxs-lookup"><span data-stu-id="ca4dc-110">A password for the add-in, called a client secret.</span></span>

- <span data-ttu-id="ca4dc-111">отображаемое имя надстройки, используемое на странице согласия, на которой пользователь указывает, доверяет ли он надстройке;</span><span class="sxs-lookup"><span data-stu-id="ca4dc-111">A display name of the add-in that is used on the consent page where the user is prompted to trust the add-in.</span></span>

- <span data-ttu-id="ca4dc-112">URL-адрес домена, в котором размещена удаленная надстройка;</span><span class="sxs-lookup"><span data-stu-id="ca4dc-112">A URL for the domain where the remote add-in is hosted.</span></span>

- <span data-ttu-id="ca4dc-113">URL-адрес перенаправления.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-113">A redirect URL.</span></span>
    
 
<span data-ttu-id="ca4dc-114">Зарегистрированная надстройка имеет идентификатор и является *субъектом безопасности*.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-114">After you register your add-in, it has an add-in identity and is a  security principal  , referred to as anadd-in principal. When you install your add-in, SharePoint administrators can retrieve information about that particular add-in principal.</span></span> <span data-ttu-id="ca4dc-115">При установке надстройки администраторы SharePoint могут получать информацию об этом субъекте.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-115">After you register your add-in, it has an add-in identity and is a  security principal  , referred to as anadd-in principal. When you install your add-in, SharePoint administrators can retrieve information about that particular add-in principal.</span></span>
 
<span data-ttu-id="ca4dc-116">Когда пользователь в первый раз предоставляет надстройке разрешения на доступ к ресурсам SharePoint (что может произойти как на этапе установки, так и во время выполнения в зависимости от конструкции надстройки), SharePoint получает информацию о надстройке из Azure ACS.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-116">When a user first grants an add-in permissions to access SharePoint resources (which can happen either at installation or runtime, depending on the design of the app), SharePoint gets information about the add-in from Azure ACS.</span></span> <span data-ttu-id="ca4dc-117">Затем SharePoint сохраняет эту информацию в базе данных службы управления приложениями клиентской организации или фермы SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-117">SharePoint then stores this information in the App Management Service database of the SharePoint tenancy or farm.</span></span> <span data-ttu-id="ca4dc-118">Секрет клиента хранится только в Azure ACS.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-118">The client secret is stored only with Azure ACS.</span></span> <span data-ttu-id="ca4dc-119">SharePoint никогда не запоминает секрет надстройки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-119">SharePoint never knows the add-in's secret.</span></span> <span data-ttu-id="ca4dc-120">Служба базы данных контента и другие компоненты, например служба профилей пользователей, могут получать отображаемое имя и другие основные сведения о надстройке непосредственно из общей службы управления приложениями.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-120">The content database service and other components, such as the user profile service, can get the display name and other basic information about the add-in directly from the app management shared service.</span></span> <span data-ttu-id="ca4dc-121">Дополнительные сведения см. в разделе [Получение информации о регистрации и субъекте](#Retrieve) этой статьи.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-121">For more information, see [Retrieve add-in registration and add-in principal information](#Retrieve) in this article.</span></span>
 
> [!NOTE] 
> <span data-ttu-id="ca4dc-122">В этой статье предполагается, что вы знакомы с основными понятиями и принципами платформы OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-122">Note  This article assumes that you are familiar with the basic concepts and principles behind the OAuth 2.0 Framework. For more information, see  OAuth.net and Web Authorization Protocol (oauth).</span></span> <span data-ttu-id="ca4dc-123">Дополнительные сведения см. на сайте [OAuth.net](http://oauth.net/) и на веб-странице [Протокол веб-авторизации (OAuth)](http://datatracker.ietf.org/doc/active/).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-123">For more information, see [OAuth.net](http://oauth.net/) and [Web Authorization Protocol (oauth)](http://datatracker.ietf.org/doc/active/).</span></span>

## <a name="register-your-sharepoint-add-in-in-azure-acs"></a><span data-ttu-id="ca4dc-124">Регистрация надстройки SharePoint в Azure ACS</span><span class="sxs-lookup"><span data-stu-id="ca4dc-124">Register your SharePoint Add-in in Azure ACS</span></span>

<span data-ttu-id="ca4dc-125">Вы можете зарегистрировать вашу надстройку тремя способами в зависимости от текущего этапа ее разработки, ее архитектуры и от того, где вы собираетесь ее публиковать.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-125">You can register your add-in in one of three ways, depending on where you are in the add-in development life cycle, the architecture of your add-in, and how you plan to market it.</span></span>

|<span data-ttu-id="ca4dc-126">**Метод регистрации**</span><span class="sxs-lookup"><span data-stu-id="ca4dc-126">**Registration method**</span></span>|<span data-ttu-id="ca4dc-127">**Сведения**</span><span class="sxs-lookup"><span data-stu-id="ca4dc-127">**Details**</span></span>|
|:-----|:-----|
|<span data-ttu-id="ca4dc-128">Создание временного удостоверения надстройки с помощью Visual Studio и Инструментов разработчика Microsoft Office для Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-128">Use Visual Studio and Microsoft Office Developer Tools for Visual Studio to create a temporary add-in identity.</span></span> |<span data-ttu-id="ca4dc-129">Мастер Инструментов разработчика Office для Visual Studio создает временную регистрацию для надстройки в ACS и службе управления приложениями вашего тестового веб-сайта SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-129">The Office Developer Tools for Visual Studio wizard creates a temporary registration for your add-in with ACS and the App Management Service of your SharePoint test website. When you run the add-in from Visual Studio (F5), this identity is used. The tools also insert the client ID and secret in the web.config and AppManifest.xml files.</span></span><br/><br/><span data-ttu-id="ca4dc-130">Когда вы запускаете надстройку в Visual Studio (F5), используется это удостоверение.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-130">When you run the add-in from Visual Studio (F5), this identity is used.</span></span> <span data-ttu-id="ca4dc-131">Инструменты также вставляют идентификатор и секрет клиента в файлы web.config и AppManifest.xml.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-131">The tools also insert the client ID and secret in the web.config and AppManifest.xml files.</span></span><br/><br/><span data-ttu-id="ca4dc-132">Когда вы будете готовы к публикации надстройки, воспользуйтесь мастером публикации Visual Studio, чтобы перейти на Панель мониторинга продаж и зарегистрировать надстройку.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-132">When you're ready to publish your add-in, you can use the Visual Studio publish wizard to go to the Seller Dashboard to register it. If you are not marketing your SharePoint Add-in in the Office Store, use AppRegNew.aspx to register it. (Exact steps are below.)</span></span> <span data-ttu-id="ca4dc-133">Если вы не хотите продавать свою надстройку SharePoint в Магазине Office, зарегистрируйте ее с помощью страницы AppRegNew.aspx.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-133">If you are not marketing your SharePoint Add-in in the Office Store, use AppRegNew.aspx to register it.</span></span> <span data-ttu-id="ca4dc-134">(Действия, которые необходимо выполнить, см. ниже.)</span><span class="sxs-lookup"><span data-stu-id="ca4dc-134">(Exact steps are in the next section.)</span></span><br/><br/><span data-ttu-id="ca4dc-135">**Примечание**. Если ваша надстройка запрашивает разрешение на доступ к ресурсам SharePoint динамически во время выполнения, а не при установке, вы не сможете создать удостоверение, используя Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-135">If your add-in requests permission to access SharePoint resources dynamically at run time, instead of on add-in installation, you cannot use Visual Studio to create add-in identities.</span></span> |
|<span data-ttu-id="ca4dc-136">Зарегистрируйте надстройку на Панели мониторинга продаж.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-136">Register the add-in through the Seller Dashboard.</span></span> |<span data-ttu-id="ca4dc-137">Если вы собираетесь использовать надстройку в нескольких клиентах или фермах SharePoint, используйте Панель мониторинга продаж для регистрации надстройки независимо от канала распространения (Магазин Office или каталог надстроек).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-137">If you're going to use your add-in in more than one SharePoint tenant or farm, use the Seller Dashboard to register your add-in, regardless of whether you market it in the Office Store or make it available via the add-in catalog.</span></span><br/><br/><span data-ttu-id="ca4dc-138">После регистрации на Панели мониторинга продаж вы можете сделать надстройку мультитенантной, не требуя от администраторов клиента или фермы регистрировать ее отдельно.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-138">When you register in the Seller Dashboard, you can design your add-in with a multitenant architecture without requiring tenant or farm administrators to register it separately.</span></span><br/><br/><span data-ttu-id="ca4dc-139">Кроме того, если вы планируете публиковать надстройку в Магазине Office, для регистрации надстройки необходимо использовать Панель мониторинга продаж.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-139">Also, if you plan to publish your add-in in the Office Store, you have to use the Seller Dashboard to register your add-in.</span></span> <span data-ttu-id="ca4dc-140">Надстройку, зарегистрированную на Панели мониторинга продаж, не обязательно публиковать в Магазине.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-140">You don't have to use the store to publish an add-in that is registered with the Seller Dashboard.</span></span> <span data-ttu-id="ca4dc-141">Дополнительные сведения см. в статье [Создание или обновление идентификаторов и секретов клиентов на Панели мониторинга продаж](https://docs.microsoft.com/ru-RU/office/dev/store/create-or-update-client-ids-and-secrets).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-141">For more information, see [Create or update client IDs and secrets in the Seller Dashboard](https://docs.microsoft.com/ru-RU/office/dev/store/create-or-update-client-ids-and-secrets).</span></span>|
|<span data-ttu-id="ca4dc-142">Использование страницы AppRegNew.aspx.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-142">Use the AppRegNew.aspx page.</span></span> |<span data-ttu-id="ca4dc-143">Если вы собираетесь использовать надстройку SharePoint только в одной клиентской организации или ферме, используйте для регистрации форму AppRegNew.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-143">Use the AppRegNew form to register your SharePoint Add-in if you are using the add-in only in one tenant or farm.</span></span><br/><br/><span data-ttu-id="ca4dc-144">Например, если вы создаете надстройки для одной организации и собираетесь распространять их через каталог надстроек организации, то для их регистрации можно использовать страницу AppRegNew.aspx любого веб-сайта в клиентской организации или ферме.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-144">Use the AppRegNew form to register your SharePoint Add-in if you are going to use the add-in only in one tenant or farm. For example, if you're creating add-ins for a single organization and you're going to distribute them via the organization add-in catalog, you can use the AppRegNew.aspx page of any website in a tenancy or farm to register the add-in.</span></span><br/><br/><span data-ttu-id="ca4dc-p108">Надстройку, зарегистрированную с помощью страницы AppRegNew.aspx, невозможно опубликовать в Магазин Office. Для надстроек, опубликованных в Магазин Office, необходимо получить удостоверение из Панель мониторинга продаж.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-p108">You cannot publish an add-in that is registered with AppRegNew.aspx to the Office Store. For add-ins that are published to the Office Store, you must get an identity from the Seller Dashboard.</span></span>|

### <a name="to-register-by-using-appregnewaspx"></a><span data-ttu-id="ca4dc-147">Регистрация с использованием страницы AppRegNew.aspx</span><span class="sxs-lookup"><span data-stu-id="ca4dc-147">To register by using AppRegNew.aspx</span></span>

1. <span data-ttu-id="ca4dc-148">Перейдите на страницу `<site collection url>/_layouts/15/AppRegNew.aspx` в веб-браузере.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-148">Go to `<site collection url>/_layouts/15/AppRegNew.aspx` by using a web browser.</span></span>
    
  <span data-ttu-id="ca4dc-149">**Форма на странице AppRegNew**</span><span class="sxs-lookup"><span data-stu-id="ca4dc-149">**AppRegNew page form**</span></span>

  ![Форма на странице AppRegNew с полями для идентификатора клиента, его секрета, названия, домена приложения и URL-адреса перенаправления.](../images/9a38d876-2189-418c-9314-ae493a4cab61.PNG)
 

2. <span data-ttu-id="ca4dc-153">Введите значения для указанных ниже полей формы.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-153">Enter values for the follow form fields:</span></span>
    
  - <span data-ttu-id="ca4dc-154">**Идентификатор надстройки**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-154">**Add-in ID**.</span></span> <span data-ttu-id="ca4dc-155">Он также называется идентификатором клиента и представляет собой GUID, который можно создать (нажав кнопку **Создать**) или вставить на странице AppRegNew.aspx.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-155">Add-in ID - Also known as client ID, is a GUID that can be generated (when you choose **Generate**) or pasted into AppRegNew.aspx. The value must be unique for each add-in, and  must be lower case  .</span></span> <span data-ttu-id="ca4dc-156">Значение должно быть уникальным для каждой надстройки и *содержать только строчные символы*.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-156">The value must be unique for each add-in, and *must be lowercase*.</span></span>
    
  - <span data-ttu-id="ca4dc-157">**Секрет надстройки**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-157">**Add-in Secret**.</span></span> <span data-ttu-id="ca4dc-158">Он также называется секретом клиента и представляет собой непрозрачную строку.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-158">Also known as the client secret, an opaque string.</span></span> <span data-ttu-id="ca4dc-159">Он создается на странице AppRegNew.aspx с помощью кнопки **Создать**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-159">It is generated on the AppRegNew.aspx page by using the **Generate** button.</span></span> <span data-ttu-id="ca4dc-160">Вот пример секрета надстройки: `xvVpG0AgVIJfch6ldu4dLUlcZyysmGqBRbpFDu6AfJw=`.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-160">The following is an example of an add-in secret: `xvVpG0AgVIJfch6ldu4dLUlcZyysmGqBRbpFDu6AfJw=`.</span></span>
    
    > [!IMPORTANT] 
    > <span data-ttu-id="ca4dc-161">Секреты надстроек имеют ограниченный срок действия.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-161">Add-in secrets expire.</span></span> <span data-ttu-id="ca4dc-162">Если вы регистрируете надстройку на Панели мониторинга продаж, срок действия можно указать (не более трех лет).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-162">If you register the add-in on the Seller Dashboard, you can set the expiration for up to three years.</span></span> <span data-ttu-id="ca4dc-163">Кроме того, по мере истечения срока действия старых секретов на панели мониторинга можно добавлять новые секреты.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-163">In the dashboard, you can also add new secrets when the old ones reach their expiration date.</span></span> <span data-ttu-id="ca4dc-164">Новый секрет будет включен во всех экземплярах надстройки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-164">The new secret will be enabled in all instances of the add-in.</span></span> <span data-ttu-id="ca4dc-165">Если вы регистрируете надстройку с помощью страницы AppRegNew.aspx, срок действия секрета составляет один год.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-165">If you register the add-in with AppRegNew.aspx, the secret expires in one year.</span></span> <span data-ttu-id="ca4dc-166">Подробные сведения см. в статье [Замена секрета клиента с истекающим сроком действия в надстройке SharePoint](replace-an-expiring-client-secret-in-a-sharepoint-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-166">The add-in secret must be replaced every 12 months. For details, see  [Replace an expiring client secret in a SharePoint Add-in](replace-an-expiring-client-secret-in-a-sharepoint-add-in.md).</span></span>
  
  - <span data-ttu-id="ca4dc-167">**Название**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-167">Title</span></span> <span data-ttu-id="ca4dc-168">Понятное название; например **Надстройка для фотопечати Contoso**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-168">A user-friendly title; for example, **Contoso photo printing add-in**.</span></span> <span data-ttu-id="ca4dc-169">Пользователям предлагается предоставить разрешения, необходимые надстройке.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-169">Users are prompted to grant or deny the add-in the permissions that the add-in is requesting.</span></span> <span data-ttu-id="ca4dc-170">Это название появляется в запросе разрешений.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-170">This title appears as the name of the add-in on the consent prompt.</span></span> 
  
  - <span data-ttu-id="ca4dc-171">**Домен надстройки**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-171">Add-in domain</span></span> <span data-ttu-id="ca4dc-172">Имя узла удаленного компонента, входящего в надстройку SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-172">The host name of the remote component of the SharePoint Add-in.</span></span> <span data-ttu-id="ca4dc-173">Если удаленное приложение не использует порт 443, то домен надстройки должен включать номер порта.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-173">If the remote application isn't using port 443, the add-in domain must also include the port number.</span></span> <span data-ttu-id="ca4dc-174">Домен надстройки должен совпадать с привязками URL-адресов, используемыми для веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-174">The add-in domain must match the URL bindings you use for your web application.</span></span> <span data-ttu-id="ca4dc-175">Не включайте в это значение протокол (https:) или символы "/".</span><span class="sxs-lookup"><span data-stu-id="ca4dc-175">Do not include protocol ("https:") or "/" characters in this value.</span></span> <span data-ttu-id="ca4dc-176">Если для узла веб-приложения используется псевдоним DNS CNAME, используйте его.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-176">If your web application host is using a DNS CNAME alias, use the alias.</span></span> <span data-ttu-id="ca4dc-177">Примеры:</span><span class="sxs-lookup"><span data-stu-id="ca4dc-177">Some examples:</span></span>
    
    - <span data-ttu-id="ca4dc-178">www.contoso.com:3333</span><span class="sxs-lookup"><span data-stu-id="ca4dc-178">www.contoso.com:3333</span></span>
    
    - <span data-ttu-id="ca4dc-179">www.fabrikam.com</span><span class="sxs-lookup"><span data-stu-id="ca4dc-179">www.fabrikam.com</span></span>
  
  - <span data-ttu-id="ca4dc-180">**URI перенаправления**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-180">Redirect URI</span></span> <span data-ttu-id="ca4dc-181">Конечная точка в удаленном приложении или службе, на которую ACS отправляет код аутентификации.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-181">The endpoint in your remote application or service to which ACS sends an authentication code.</span></span> <span data-ttu-id="ca4dc-182">Строго говоря, надстройки SharePoint не используют это значение.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-182">Strictly speaking, SharePoint Add-ins don't use this value.</span></span> <span data-ttu-id="ca4dc-183">URI перенаправления требуется для веб-приложений, запускаемых за пределами SharePoint и использующих [поток кода аутентификации](creating-sharepoint-add-ins-that-use-low-trust-authorization.md#Flows) для получения авторизованного доступа к данным SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-183">The redirect URI is required for web applications that are launched outside of SharePoint and that use the [Authentication Code flow](creating-sharepoint-add-ins-that-use-low-trust-authorization.md#Flows) to get authorized access to SharePoint data.</span></span> 
  
    <span data-ttu-id="ca4dc-184">URI перенаправления игнорируется для настоящих надстроек SharePoint (которые запускаются из SharePoint и используют [поток маркера контекста](creating-sharepoint-add-ins-that-use-low-trust-authorization.md#Flows)).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-184">The Redirect URI is ignored for true SharePoint Add-ins (which are launched from SharePoint and use the [Context Token flow](creating-sharepoint-add-ins-that-use-low-trust-authorization.md#Flows)).</span></span> 
    
    <span data-ttu-id="ca4dc-185">Обычно URI перенаправления представляет собой ту же страницу, метод контроллера или метод веб-службы, которые запрашивали код аутентификации у ACS, но он может быть другой конечной точкой.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-185">The Redirect URI is usually the same page, controller method, or web service method that requested the authentication code from ACS, but it can be a different endpoint.</span></span> <span data-ttu-id="ca4dc-186">У конечной точки должна быть логика, получающая код авторизации из ответа HTTP, отправляемого ACS, а затем использующая этот код для запроса доступа и обновления маркера.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-186">The endpoint must have logic that gets the authorization code from the HTTP Response that is sent by ACS and then uses that code to request an access and refresh token.</span></span> <span data-ttu-id="ca4dc-187">Дополнительные сведения см. в разделе [Поток кода авторизации OAuth для надстроек SharePoint](authorization-code-oauth-flow-for-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-187">For more information, see [Context Token OAuth flow for SharePoint Add-ins and Authorization Code OAuth flow for SharePoint Add-ins](authorization-code-oauth-flow-for-sharepoint-add-ins.md).</span></span> 
    
    <span data-ttu-id="ca4dc-188">В форму необходимо ввести допустимое значение (даже для настоящих надстроек SharePoint), хотя оно и не используется.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-188">The form requires that you enter a valid value even for true SharePoint Add-ins, although it is not used.</span></span> <span data-ttu-id="ca4dc-189">Значение должно представлять собой полный URL-адрес конечной точки, включая протокол (*обязательно HTTPS*).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-189">The value must be a complete endpoint URL including the protocol,  *which must be HTTPS*  . For example:</span></span> <span data-ttu-id="ca4dc-190">Например:</span><span class="sxs-lookup"><span data-stu-id="ca4dc-190">For example:</span></span>
    
    - <span data-ttu-id="ca4dc-191">https://www.contoso.com/Default.aspx</span><span class="sxs-lookup"><span data-stu-id="ca4dc-191">https://www.contoso.com/Default.aspx</span></span>
 
    - <span data-ttu-id="ca4dc-192">https://www.fabrikam.com/RedirectAccept.aspx</span><span class="sxs-lookup"><span data-stu-id="ca4dc-192">https://www.fabrikam.com/RedirectAccept.aspx</span></span>
 
    - <span data-ttu-id="ca4dc-193">https://www.northwindtraders.com/home/index</span><span class="sxs-lookup"><span data-stu-id="ca4dc-193">https://www.northwindtraders.com/home/index</span></span>
 
    - <span data-ttu-id="ca4dc-194">https://adventureworks.com/vacationdata.svc</span><span class="sxs-lookup"><span data-stu-id="ca4dc-194">https://adventureworks.com/vacationdata.svc</span></span>
 
3. <span data-ttu-id="ca4dc-195">В форме нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-195">Select **Create** on the form.</span></span> <span data-ttu-id="ca4dc-196">Страница перезагрузится, и на ней будут показаны введенные значения.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-196">The page reloads and shows a confirmation of the values that you entered.</span></span> <span data-ttu-id="ca4dc-197">Сохраните эти значения в виде, удобном для копирования и вставки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-197">Make a record of these values in a form that is easy to copy and paste.</span></span> <span data-ttu-id="ca4dc-198">Вам потребуется указать эти значения в файлах web.config и AppManifest.xml или в мастере публикации Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-198">You need to enter the values in web.config and AppManifest.xml files or in the Visual Studio Publish wizard.</span></span>   
 
<span data-ttu-id="ca4dc-199">Независимо от способа регистрации, когда вы будете готовы развернуть надстройку в промежуточной или рабочей среде, вам потребуется [ввести регистрационные значения в файлы web.config и AppManifest.xml](#EditConfigFiles).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-199">Regardless of how you register your SharePoint Add-in, when you are ready to deploy the add-in to staging or production, you'll need to  [Enter the registration values into the web.config and AppManifest.xml files](#EditConfigFiles). If you are using Visual Studio, the Microsoft Office Developer Tools for Visual Studio do this configuration for you.</span></span> <span data-ttu-id="ca4dc-200">Если вы используете Visual Studio, Инструменты разработчика Microsoft Office для Visual Studio сделают это автоматически.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-200">If you are using Visual Studio, the Microsoft Office Developer Tools for Visual Studio do this configuration for you.</span></span>

<span data-ttu-id="ca4dc-201"><a name="EditConfigFiles"> </a></span><span class="sxs-lookup"><span data-stu-id="ca4dc-201"></span></span> 

## <a name="enter-the-registration-values-into-the-webconfig-and-appmanifestxml-files"></a><span data-ttu-id="ca4dc-202">Ввод регистрационных значений в файлы web.config и AppManifest.xml</span><span class="sxs-lookup"><span data-stu-id="ca4dc-202">Enter the registration values into the web.config and AppManifest.xml files</span></span>

<span data-ttu-id="ca4dc-203">Прежде чем упаковывать надстройку SharePoint и развертывать ее удаленные компоненты, необходимо указать некоторые регистрационные данные в файлах AppManifest.xml и web.config.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-203">Before you package the SharePoint Add-in and before you deploy its remote components, enter some of the registration values in the AppManifest.xml and the web.config file.</span></span>

> [!TIP] 
> <span data-ttu-id="ca4dc-204">Если вы публикуете свою надстройку SharePoint, используя мастер публикации Visual Studio, Visual Studio запрашивает идентификатор и секрет клиента и автоматически помещает эту информацию в нужные места.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-204">TIP If you publish your SharePoint Add-in by using the Visual Studio publish wizard, Visual Studio will prompt you for a client ID and client secret during the publishing process, and it will put the information in the correct places for you.</span></span>

1. <span data-ttu-id="ca4dc-205">В файле Web.config проекта Visual Studio укажите значение идентификатора надстройки в качестве значения **ClientId** (заменив временное значение, введенное средством).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-205">In the Web.config file in your Visual Studio project, enter the add-in ID value as the **ClientId** value (replacing the temporary value that the tools entered).</span></span>
    
  > [!IMPORTANT] 
  > <span data-ttu-id="ca4dc-206">Все буквы в GUID идентификатора клиента должны быть строчными.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-206">All the letters in the client ID GUID must be lowercase.</span></span>

  <span data-ttu-id="ca4dc-207">Ниже приведен пример.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-207">The following is an example.</span></span>

  ```XML
    <appSettings>
      <add key="ClientId" value="a044e184-7de2-4d05-aacf-52118008c44e " />
      .  .  .
    </appSettings>
  ```

2. <span data-ttu-id="ca4dc-208">В качестве значения **ClientSecret** введите секрет надстройки (заменив временное значение, введенное средством).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-208">Enter the add-in secret value as the **ClientSecret** value (replacing the temporary value that the tools entered).</span></span>
    
  <span data-ttu-id="ca4dc-209">В примере ниже показано, как используются значения в файле Web.config или в веб-приложении.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-209">The following is an example of how the values are used in the Web.config file of a web application.</span></span>

  ```XML
    <appSettings>
      <add key="ClientId" value="a044e184-7de2-4d05-aacf-52118008c44e " />
      <add key="ClientSecret" value="l0z/8TzWN0yQBzMBSEZtYts2Vt3Eo/oE3rfCdPaogKQ= " />
    </appSettings>
  ```

3. <span data-ttu-id="ca4dc-210">В файле AppManifest.xml в проекте Visual Studio введите значение идентификатора надстройки в качестве значения параметра **ClientId**, *используя строчные буквы*.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-210">In the AppManifest.xml file in your Visual Studio project, enter the add-in ID value as the  **ClientId** value, *with lower case letters*  .</span></span>
    
  > [!NOTE] 
  > <span data-ttu-id="ca4dc-211">Манифест надстройки не применяется к веб-приложениям, которые запрашивают разрешение на доступ к ресурсам SharePoint во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-211">The add-in manifest does not apply to web applications that request permission to access SharePoint resources on the fly.</span></span> <span data-ttu-id="ca4dc-212">Они не являются настоящими надстройками SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-212">These are not really "SharePoint Add-ins".</span></span> <span data-ttu-id="ca4dc-213">Они не устанавливаются в SharePoint, и у них нет манифеста надстройки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-213">They are not installed on SharePoint and do not have an add-in manifest.</span></span> <span data-ttu-id="ca4dc-214">Дополнительные сведения см. в разделе [Поток кода авторизации OAuth для надстроек SharePoint](authorization-code-oauth-flow-for-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-214">For more information, see [Context Token OAuth flow for SharePoint Add-ins and Authorization Code OAuth flow for SharePoint Add-ins](authorization-code-oauth-flow-for-sharepoint-add-ins.md).</span></span>

  <span data-ttu-id="ca4dc-215">В примере ниже показано, как использовать значение **ClientId** в файле AppManifest.xml.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-215">The following example shows how the **ClientId** value is used in the AppManifest.xml file.</span></span>

  ```XML
    <AppPrincipal>
      <RemoteWebApplication ClientId="a044e184-7de2-4d05-aacf-52118008c44e "/>
    </AppPrincipal>
  ```

4. <span data-ttu-id="ca4dc-216">Инструменты разработчика Office для Visual Studio используют маркер `~remoteAppUrl` в элементе **StartPage**.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-216">The Office Developer Tools for Visual Studio use the token `~remoteAppUrl` in the **StartPage** element.</span></span> <span data-ttu-id="ca4dc-217">(Например, `<StartPage>~remoteAppUrl/Pages/Default.aspx?{StandardTokens}</StartPage>`.) Если вы используете мастер публикации в Visual Studio, то этот маркер сопоставляется с URL-адресом удаленного компонента.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-217">(For example, `<StartPage>~remoteAppUrl/Pages/Default.aspx?{StandardTokens}</StartPage>`.) This token resolves to the URL of the remote component if you are using the Publish wizard in Visual Studio.</span></span> <span data-ttu-id="ca4dc-218">Если вы не используете мастер (или если используете его, но публикуете удаленный компонент в Azure), вам нужно вручную заменить маркер значением **Домен надстройки**, которое вы использовали при регистрации надстройки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-218">If you don't use the wizard (or if you do but you are publishing the remote component to Azure), you have to manually replace the token with the **Add-in Domain** value that you used when registering the add-in.</span></span> <span data-ttu-id="ca4dc-219">Это должно быть *точно такое же* значение, включающее помимо протокола HTTPS номер порта (если он имеется).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-219">It must be *exactly* the same value, including port number, if any, except that you include the HTTPS protocol as well.</span></span> <span data-ttu-id="ca4dc-220">Ниже приведен пример.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-220">The following is an example.</span></span>
    
  ```XML
    <StartPage>https://www.contoso.com/Pages/Default.aspx?{StandardTokens}</StartPage>
  ```

5. <span data-ttu-id="ca4dc-p122">Для элемента **Title** в файле AppManifest.xml рекомендуется использовать то же значение, которое вы указывали в поле **Название** на странице AppRegNew.aspx. Значение элемента **Title** представляет собой имя надстройки, которое отображается для пользователей после ее установки. Если в диалоговом окне согласия надстройка будет иметь имя, отличающееся от ее имени в пользовательском интерфейсе SharePoint, это может ввести пользователя в заблуждение.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-p122">Consider using the same value for the **Title** element in the AppManifest.xml file that you used for the **Title** field in AppRegNew.aspx. The **Title** element value is the name of the add-in that users see after it is installed. It might be confusing to users for the add-in to have a different name in the consent dialog than it has in the SharePoint UI.</span></span>
    
  <span data-ttu-id="ca4dc-224">В примере ниже показаны эти значения в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-224">The following example shows these values in the add-in manifest.</span></span>

  ```XML
    <Properties>
      <Title>Contoso photo printing app</Title>
      <StartPage>https://www.contoso.com/Pages/Default.aspx?{StandardTokens}</StartPage>
    </Properties>
  ```

<span data-ttu-id="ca4dc-225"><a name="UseRedirectUrl"> </a></span><span class="sxs-lookup"><span data-stu-id="ca4dc-225"></span></span>

## <a name="use-the-redirect-url-in-an-add-in-that-asks-for-permissions-on-the-fly"></a><span data-ttu-id="ca4dc-226">Использование URL-адреса перенаправления в надстройке, запрашивающей разрешения во время выполнения</span><span class="sxs-lookup"><span data-stu-id="ca4dc-226">Use the redirect URL in an add-in that asks for permissions on the fly</span></span>

<span data-ttu-id="ca4dc-227">Если веб-приложение запускается за пределами SharePoint (и, таким образом, не является настоящей надстройкой SharePoint), оно должно запрашивать разрешения у SharePoint во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-227">If your web application is launched from outside SharePoint (and is, thus, not a true SharePoint Add-in), it has to be designed to ask for permissions from SharePoint at runtime.</span></span> <span data-ttu-id="ca4dc-228">Оно должно содержать код, использующий URI перенаправления и другие сведения, для получения маркера доступа от ACS.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-228">It has to have code that uses the redirect URI, along with other information, to obtain an access token from ACS.</span></span> <span data-ttu-id="ca4dc-229">Найдите место, в котором указан этот URI, и используйте *именно* то значение, которое вы ввели в поле **URI перенаправления** на странице AppRegNew.aspx или на Панели мониторинга продаж.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-229">Find the place where this URI is set and use the *exact*  value that you used for the **Redirect URI** field on AppRegNew.aspx or in the Seller Dashboard.</span></span> <span data-ttu-id="ca4dc-230">Это может быть файл кода или файл конфигурации.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-230">This might be in a code file or a configuration file.</span></span>

<span data-ttu-id="ca4dc-231"><a name="Retrieve"> </a></span><span class="sxs-lookup"><span data-stu-id="ca4dc-231"></span></span>

## <a name="retrieve-add-in-registration-and-add-in-principal-information"></a><span data-ttu-id="ca4dc-232">Получение информации о регистрации и субъекте</span><span class="sxs-lookup"><span data-stu-id="ca4dc-232">Retrieve add-in registration and add-in principal information</span></span>

<span data-ttu-id="ca4dc-233">Вы можете получить информацию о регистрации и субъекте для надстроек, которые вы установили или зарегистрировали в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-233">You can retrieve add-in registration information and add-in principal information for the add-ins you've installed or registered on SharePoint.</span></span> 
 
<span data-ttu-id="ca4dc-234">Чтобы найти информацию о регистрации надстройки, перейдите по адресу `http://<SharePointWebsite>/_layouts/15/AppInv.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-234">To look up registration information for an add-in that you have registered, go to  `http://<SharePointWebsite>/_layouts/15/AppInv.aspx`.</span></span>

<span data-ttu-id="ca4dc-p124">Для поиска необходимо использовать идентификатор клиента (идентификатор надстройки), указанный при регистрации надстройки. Результаты поиска будут содержать указанные ниже сведения для заданного идентификатора клиента.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-p124">To do a lookup, you have to remember the client ID (also known as the add-in ID) that was used to register the add-in. The lookup returns the following information for a particular client ID:</span></span>

- <span data-ttu-id="ca4dc-237">Название</span><span class="sxs-lookup"><span data-stu-id="ca4dc-237">Title</span></span>

- <span data-ttu-id="ca4dc-238">Домен надстройки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-238">Add-in domain</span></span>

- <span data-ttu-id="ca4dc-239">URL-адрес перенаправления (то же, что и URI перенаправления).</span><span class="sxs-lookup"><span data-stu-id="ca4dc-239">Redirect URL (this is the same as the redirect URI.)</span></span>
    
 
<span data-ttu-id="ca4dc-240">При поиске не будет возвращено значение секрета надстройки.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-240">The lookup does not return the add-in secret value.</span></span>

<span data-ttu-id="ca4dc-241">Чтобы посмотреть список зарегистрированных субъектов, перейдите по следующему адресу: `http://<SharePointWebsite>/_layouts/15/AppPrincipals.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ca4dc-241">To see a list of registered add-in principals, go to:</span></span>
 

## <a name="see-also"></a><span data-ttu-id="ca4dc-242">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="ca4dc-242">See also</span></span>
<span data-ttu-id="ca4dc-243"><a name="AR"> </a></span><span class="sxs-lookup"><span data-stu-id="ca4dc-243"></span></span>

- [<span data-ttu-id="ca4dc-244">Три системы авторизации для надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="ca4dc-244">Three authorization systems for SharePoint Add-ins</span></span>](three-authorization-systems-for-sharepoint-add-ins.md)
- [<span data-ttu-id="ca4dc-245">Знакомство с созданием надстроек SharePoint с размещением у поставщика</span><span class="sxs-lookup"><span data-stu-id="ca4dc-245">Get started creating provider-hosted SharePoint Add-ins</span></span>](get-started-creating-provider-hosted-sharepoint-add-ins.md)
- [<span data-ttu-id="ca4dc-246">Авторизация и проверка подлинности для надстроек в SharePoint</span><span class="sxs-lookup"><span data-stu-id="ca4dc-246">Authorization and authentication of SharePoint Add-ins</span></span>](authorization-and-authentication-of-sharepoint-add-ins.md)
    
 
