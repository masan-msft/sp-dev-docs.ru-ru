---
title: "Добавление настраиваемых столбцов в надстройку SharePoint, размещаемую в SharePoint"
description: "Создание настраиваемых типов столбцов, запуск надстройки и тестирование столбцов."
ms.date: 12/04/2017
ms.prod: sharepoint
ms.openlocfilehash: d2ac6a7455aaceb0490c74efbcb3cb47e2099d36
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="add-custom-columns-to-a-sharepoint-hosted-sharepoint-add-in"></a>Добавление собственных столбцов в надстройки с размещением в SharePoint

Это третья часть серии статей, посвященной основам разработки надстроек SharePoint, размещаемых в SharePoint. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями этой серии, представленными в разделе [Знакомство с созданием надстроек SharePoint, размещаемых в SharePoint](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md#Nextsteps). 
    
> [!NOTE]
> Если вы изучали предыдущие статьи этой серии о надстройках, размещаемых в SharePoint, то у вас уже есть решение для Visual Studio, которое можно использовать для работы с этой статьей. Кроме того, вы можете скачать репозиторий на веб-странице [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) и открыть файл BeforeColumns.sln.

В этой статье мы вернемся к программированию и добавим несколько столбцов сайта в надстройку SharePoint Employee Orientation (Адаптация сотрудников).
 
## <a name="create-custom-column-types"></a>Создание настраиваемых типов столбцов

1. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункты **Добавить** > **Новая папка**. Присвойте папке имя **Site Columns** (Столбцы сайта).    
 
2. Щелкните правой кнопкой мыши новую папку и выберите пункты **Добавить** > **Новый элемент**. В узле **Office/SharePoint** откроется диалоговое окно **Добавление нового элемента**.
     
3. Выберите пункт **Site Column** (Столбец сайта), присвойте столбцу имя **Division** (Подразделение) и нажмите кнопку**Добавить**.
    
4. В файле elements.xml нового столбца сайта измените элемент **Field** так, чтобы он содержал атрибуты и значения, указанные в примере ниже. ***Не** следует изменять идентификатор GUID* атрибута **ID** (т. е удалять значение, созданное Visual Studio), *поэтому будьте внимательны при копировании и вставке*.
    
    ```
      <Field ID="{generated GUID}" 
           Name="Division" 
           Title="Division" 
           DisplayName="Division" 
           Description="The division of the company where the employee works." 
           Group="Employee Orientation" 
           Type="Text" 
           Required ="FALSE">
    </Field>
    ```
    
    <br/>

5. Добавьте другой **столбец сайта** с именем **OrientationStage** (Этап адаптации) в ту же папку.
    
6. В файле elements.xml нового столбца сайта измените элемент **Field** так, чтобы он содержал атрибуты и значения, указанные в примере ниже, однако не меняйте GUID атрибута **ID**. Оставьте для него значение, созданное Visual Studio.
    
    ```
      <Field ID="{generated GUID}" 
           Name="OrientationStage" 
           Title="OrientationStage"
           DisplayName="Orientation Stage" 
           Group="Employee Orientation" 
           Description="The current orientation stage of the employee." 
           Type="Choice"
           Required ="TRUE">
    </Field>
    ```
    
    <br/>

7. Так как это поле является полем выбора (Choice), необходимо указать возможные варианты и порядок их отображения в раскрывающемся списке перед пользователем, который должен сделать выбор. Так как это поле обязательно для заполнения, необходимо указать значение по умолчанию. Добавьте приведенную ниже дочернюю разметку в элемент **Field**, а затем сохраните все файлы.
    
    ```
      <CHOICES>
          <CHOICE>Not Started</CHOICE>
          <CHOICE>Tour of building</CHOICE>
          <CHOICE>HR paperwork</CHOICE>
          <CHOICE>Corporate network access</CHOICE>
          <CHOICE>Completed</CHOICE>
    </CHOICES>
    <MAPPINGS>
          <MAPPING Value="1">Not Started</MAPPING>
          <MAPPING Value="2">Tour of building</MAPPING>
          <MAPPING Value="3">HR paperwork</MAPPING>
          <MAPPING Value="4">Corp network access</MAPPING>
          <MAPPING Value="5">Completed</MAPPING>
    </MAPPINGS>
    <Default>Not Started</Default>
    ```

    </br>
    
## <a name="run-the-add-in-and-test-the-columns"></a>Запуск надстройки и тестирование столбцов

1. Нажмите клавишу F5, чтобы развернуть и запустить надстройку. Visual Studio выполнит временную установку надстройки на тестовом сайте SharePoint и сразу же запустит ее.  
 
2. Когда откроется страница надстройки по умолчанию, щелкните ссылку **New Employees in Seattle** (Новые сотрудники в Сиэтле), чтобы открыть экземпляр настраиваемого списка.
 
3. Откройте страницу **Параметры** списка и добавьте в него два столбца, выполнив указанные ниже действия.
    
    1. Нажмите кнопку выноски **· · ·** сразу над списком и выберите пункт **Создать представление**.
    2. Откроется страница **Тип представления** со структурой строки навигации **Параметры > Тип представления** рядом с верхней границей страницы. Выберите **Параметры**.
    
        *Рис. 1. Открытие страницы параметров списка*

        ![Список новых сотрудников в Сиэтле с кнопкой выноски и элементом создания представления, выделенным как первый шаг. Еще указана стрелка на страницу создания представления с выделенной строкой навигации "Параметры".](../images/6c119cae-adf8-42ff-9890-f3aa1e11719d.png)
 
    3. На странице **Параметры** щелкните ссылку **Добавить из существующих столбцов сайта** слева, примерно посередине страницы.
    
        *Рис. 2. Страница "Параметры списка"*

        ![Страница параметров экземпляра списка с выделенной ссылкой "Добавление столбцов из столбцов сайта".](../images/a8698b77-b9d2-40f6-89f6-ccc3c6e06073.png)

    4. На странице **Добавление столбцов из столбцов веб-сайта** в раскрывающемся списке **Выбрать столбцы сайта из** щелкните **Employee Orientation** (Адаптация сотрудников).
    
        *Рис. 3. Добавление столбцов из столбцов веб-сайта*

        ![Элемент управления для выбора столбцов SharePoint. В раскрывающемся списке "Выбрать столбцы сайта" выбран пункт Employee Orientation (Адаптация сотрудников).](../images/3b33c622-c52a-45fd-8ea1-d7f307539753.png)

    5. Добавьте столбцы **Division** (Подразделение) и **OrientationStage** (Этап адаптации) в поле **Столбцы для добавления**.

    6. Нажмите кнопку **ОК**, чтобы вернуться на страницу **Параметры**, а затем щелкните **New Employees in Seattle** (Новые сотрудники в Сиэтле) в верхней части страницы.
    
4. Новые столбцы теперь находятся в списке. Добавление нового элемента в список. В форме редактирования поле **Этап адаптации** будет иметь значение по умолчанию **Не начато**. (Существующие элементы в этом поле будут пустыми, так как они были созданы до того, как поле появилось в списке.)
    
    *Рис. 4. Список с новыми столбцами*

    ![Список с новыми столбцами Division (Подразделение) и Orientation Stage (Этап адаптации).](../images/d4e17424-c06b-4635-aab8-4912cee5fe35.png)
 
5. Чтобы завершить сеанс отладки, закройте окно браузера или остановите отладку в Visual Studio. При каждом нажатии клавиши F5 Visual Studio будет отзывать предыдущую версию надстройки и устанавливать последнюю.
    
6. Вы будете работать с этой надстройкой и решением Visual Studio при изучении других статей, поэтому при перерывах в работе рекомендуется отзывать надстройку. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Отозвать**.
    

## <a name="next-steps"></a>Дальнейшие действия
<a name="Nextsteps"> </a>

На самом деле пользователям будет не очень удобно вручную добавлять настраиваемые столбцы в список, поэтому в следующей статье ([Добавление настраиваемого типа контента в надстройку, размещаемую в SharePoint](add-a-custom-content-type-to-a-sharepoint-hosted-sharepoint-add-in.md)) этой серии описано, как создать настраиваемый тип контента, который включает в себя настраиваемые столбцы и автоматически сопоставляется с шаблоном списка New Employees (Новые сотрудники). 
 

 

