---
title: "Добавление рабочего процесса в надстройку с размещением в SharePoint"
description: "Добавьте рабочий процесс в надстройку, сформируйте его, а затем запустите и протестируйте надстройку."
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: 31773951351ec718e5ce7826d5382ae1dbea72c0
ms.sourcegitcommit: 655e325aec73c8b7c6b5e3aaf71fbb4d2d223b5d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2017
---
# <a name="add-a-workflow-to-a-sharepoint-hosted-sharepoint-add-in"></a><span data-ttu-id="20c7a-103">Добавление рабочего процесса в надстройку SharePoint, размещаемую в SharePoint</span><span class="sxs-lookup"><span data-stu-id="20c7a-103">Add a workflow to a SharePoint-hosted SharePoint Add-in</span></span>

<span data-ttu-id="20c7a-104">Это шестая статья серии статей, посвященных основам разработки надстроек SharePoint, размещаемых в SharePoint. Для начала вам следует ознакомиться со статьей [Надстройки SharePoint](sharepoint-add-ins.md) и предыдущими статьями из этой серии.</span><span class="sxs-lookup"><span data-stu-id="20c7a-104">This is the sixth in a series of articles about the basics of developing SharePoint-hosted SharePoint Add-ins. You should first be familiar with  [SharePoint Add-ins](sharepoint-add-ins.md) and the previous articles in this series:</span></span>
 
- [<span data-ttu-id="20c7a-105">Начало работы по созданию надстроек SharePoint, размещаемых в SharePoint</span><span class="sxs-lookup"><span data-stu-id="20c7a-105">Get started creating SharePoint-hosted SharePoint Add-ins</span></span>](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md)
- [<span data-ttu-id="20c7a-106">Развертывание и установка надстроек SharePoint, размещаемых в SharePoint</span><span class="sxs-lookup"><span data-stu-id="20c7a-106">Deploy and install a SharePoint-hosted SharePoint Add-in</span></span>](deploy-and-install-a-sharepoint-hosted-sharepoint-add-in.md)
- [<span data-ttu-id="20c7a-107">Добавление настраиваемых столбцов в надстройку SharePoint, размещаемую в SharePoint</span><span class="sxs-lookup"><span data-stu-id="20c7a-107">Add custom columns to a SharePoint-hosted SharePoint Add-in</span></span>](add-custom-columns-to-a-sharepoint-hosted-sharepoint-add-in.md)
- [<span data-ttu-id="20c7a-108">Добавление пользовательского типа контента в надстройку SharePoint, размещаемую в SharePoint</span><span class="sxs-lookup"><span data-stu-id="20c7a-108">Add a custom content type to a SharePoint-hosted SharePoint Add-in</span></span>](add-a-custom-content-type-to-a-sharepoint-hosted-sharepoint-add-in.md)
- [<span data-ttu-id="20c7a-109">Добавление веб-части на страницу в надстройке SharePoint, размещаемой в SharePoint</span><span class="sxs-lookup"><span data-stu-id="20c7a-109">Add a Web Part to a page in a SharePoint-hosted SharePoint Add-in</span></span>](add-a-web-part-to-a-page-in-a-sharepoint-hosted-sharepoint-add-in.md)


> [!NOTE]
> <span data-ttu-id="20c7a-110">Если вы изучали предыдущие статьи этой серии о надстройках, размещаемых в SharePoint, то у вас уже есть решение для Visual Studio, которое можно использовать для работы с этой статьей.</span><span class="sxs-lookup"><span data-stu-id="20c7a-110">Note  If you have been working through this series about SharePoint-hosted add-ins, then you have a Visual Studio solution that you can use to continue with this topic. You can also download the repository at  SharePoint_SP-hosted_Add-Ins_Tutorials and open the BeforeClientRenderedControl.sln file.</span></span> <span data-ttu-id="20c7a-111">Кроме того, вы можете скачать репозиторий на веб-странице [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) и открыть файл BeforeWorkflow.sln.</span><span class="sxs-lookup"><span data-stu-id="20c7a-111">You can also download the repository at [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) and open the BeforeWorkflow.sln file.</span></span>

<span data-ttu-id="20c7a-112">Работая с этой статьей, вы добавите рабочий процесс в надстройку SharePoint "Employee Orientation" (Обучение сотрудников). Этот рабочий процесс уведомляет отдел кадров, что новый сотрудник готов заполнить документы, необходимые для отдела кадров.</span><span class="sxs-lookup"><span data-stu-id="20c7a-112">In this article you add a workflow the Employee Orientation SharePoint Add-in that notifies the Human Resources (HR) department that a new employee is ready to fill out the HR paperwork.</span></span>

## <a name="add-a-workflow-to-an-add-in"></a><span data-ttu-id="20c7a-113">Добавление рабочего процесса в надстройку</span><span class="sxs-lookup"><span data-stu-id="20c7a-113">Add a workflow to an add-in</span></span>

1. <span data-ttu-id="20c7a-114">В **обозревателе решений** щелкните правой кнопкой мыши проект и пункты **Добавить** > **Новая папка**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-114">In **Solution Explorer**, right-click the project, and select **Add** > **New Folder**.</span></span> <span data-ttu-id="20c7a-115">Присвойте папке имя **Workflows** (Рабочие процессы).</span><span class="sxs-lookup"><span data-stu-id="20c7a-115">Name the folder **Workflows**.</span></span>
    
2. <span data-ttu-id="20c7a-116">Щелкните правой кнопкой мыши новую папку и выберите пункты **Добавить** > **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-116">Right-click the new folder, and select **Add** > **New Item**.</span></span> <span data-ttu-id="20c7a-117">Откроется диалоговое окно **Добавление нового элемента** для узла **Office/SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-117">Right-click the new folder and choose  AddNew Item. The  **Add New Item** dialog opens to the **Office/SharePoint** node.</span></span>
    
3. <span data-ttu-id="20c7a-118">Выберите **рабочий процесс** и присвойте ему имя **HR_Intake**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-118">Select **Workflow** and give it the name **HR_Intake**.</span></span> <span data-ttu-id="20c7a-119">Когда отобразится соответствующий запрос, выберите тип рабочего процесса, щелкните **Рабочий процесс списка**, а затем нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-119">When prompted to select the type of workflow, select **List Workflow**, and then select **Next**.</span></span> 
 
4. <span data-ttu-id="20c7a-120">На следующей странице мастера включите параметр **Да, связать…** и выберите в раскрывающихся списках указанные ниже значения.</span><span class="sxs-lookup"><span data-stu-id="20c7a-120">On the next page of the wizard, enable the  **Yes, associate ...** option and then set the drop down controls to the following values:</span></span>
    
   -  <span data-ttu-id="20c7a-121">**Библиотека или список, связываемые с рабочим процессом**: New Employees in Seattle (Новые сотрудники в Сиэтле).</span><span class="sxs-lookup"><span data-stu-id="20c7a-121">**The library or list to associate your workflow with**</span></span>
   -  <span data-ttu-id="20c7a-122">**Список журнала**: `<create new>`.</span><span class="sxs-lookup"><span data-stu-id="20c7a-122">**The history list ...**</span></span>
   -  <span data-ttu-id="20c7a-123">**Список задач**: `<create new>`.</span><span class="sxs-lookup"><span data-stu-id="20c7a-123">**The Task list ...**</span></span>

5. <span data-ttu-id="20c7a-124">Нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-124">Select **Next**.</span></span>
    
6. <span data-ttu-id="20c7a-125">На последней странице мастера выберите *только* вариант автоматического запуска рабочего процесса при *изменении* элемента.</span><span class="sxs-lookup"><span data-stu-id="20c7a-125">On the last page of the wizard, enable *only* the option to start the workflow automatically when an item is *changed*.</span></span>
    
7. <span data-ttu-id="20c7a-126">Нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-126">Select **Finish**.</span></span>
    
   <span data-ttu-id="20c7a-127">После этого набор "Инструменты разработчика Office для Visual Studio" выполнит указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="20c7a-127">The Office Developer Tools for Visual Studio then do the following:</span></span>
      - <span data-ttu-id="20c7a-128">Создаст рабочий процесс HR_Intake в папке **Workflow** (Рабочий процесс) с дочерним файлом Workflow.xaml, который открыт в конструкторе рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="20c7a-128">Create an HR_Intake workflow in the **Workflow** folder, with a child Workflow.xaml file that is open in the workflow designer.</span></span>
      - <span data-ttu-id="20c7a-129">Создаст экземпляр списка **WorkflowTaskList**, в котором создаются и обновляются задачи, входящие в рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="20c7a-129">Create a  **WorkflowTaskList** list instance where tasks that are part of the workflow are created and updated.</span></span>
      - <span data-ttu-id="20c7a-130">Создаст экземпляр списка **WorkflowHistoryList**, в который записываются различные действия при выполнении рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="20c7a-130">Create a  **WorkflowHistoryList** list instance, which is a log of the various steps in each execution of the workflow as they occur.</span></span>
    
8. <span data-ttu-id="20c7a-131">Перетащите два новых экземпляра списка в папку **Lists** (Списки).</span><span class="sxs-lookup"><span data-stu-id="20c7a-131">Drag the two new list instances into the  **Lists** folder.</span></span>
    
## <a name="design-the-workflow"></a><span data-ttu-id="20c7a-132">Разработка рабочего процесса</span><span class="sxs-lookup"><span data-stu-id="20c7a-132">Design the workflow</span></span>

<span data-ttu-id="20c7a-133">Рабочий процесс отправляет электронное письмо, чтобы уведомить сотрудника отдела кадров о том, что новый сотрудник прошел этап обучения **Tour of building** (Тур по зданию) и готов заполнить необходимые бумаги для отдела кадров.</span><span class="sxs-lookup"><span data-stu-id="20c7a-133">The workflow sends an email to notify an HR staffer that the new employee has finished the **Tour of building** stage of orientation and is ready to fill out the HR intake paperwork.</span></span> <span data-ttu-id="20c7a-134">Любое изменение существующего элемента в списке **New Employees in Seattle** (Новые сотрудники в Сиэтле) активирует рабочий процесс, но рабочий процесс не делает ничего за исключением случаев, когда в поле **Orientation Stage** (Этап обучения) элемента списка указано значение **HR paperwork** (Документы для отдела кадров).</span><span class="sxs-lookup"><span data-stu-id="20c7a-134">Any change in an existing item on the **New Employees in Seattle** list triggers the workflow, but the workflow does nothing unless the **Orientation Stage** field of the list item is set to **HR paperwork**.</span></span> <span data-ttu-id="20c7a-135">Если указано это значение, электронное письмо будет отправлено сотруднику отдела кадров, и задача для этого сотрудника будет добавлена в объект **WorkflowTaskList**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-135">If it is, an email is sent to an HR staffer and a task for that employee is added to the **WorkflowTaskList**.</span></span> 

 > [!NOTE]
 > <span data-ttu-id="20c7a-136">При создании рабочего процесса на одном или нескольких элементах в конструкторе рабочих процессов будет появляться синий ромб с восклицательным знаком (![небольшой синий ромб с восклицательным знаком](../images/f7b82a70-80fe-4e7e-a0f5-5a78cd12b367.PNG)</span><span class="sxs-lookup"><span data-stu-id="20c7a-136">At various times when designing your workflow, a blue diamond symbol with an exclamation mark in it ( ![A small blue diamond shape with a white exclamation mark in it.](../images/f7b82a70-80fe-4e7e-a0f5-5a78cd12b367.PNG)</span></span> <span data-ttu-id="20c7a-137">).</span><span class="sxs-lookup"><span data-stu-id="20c7a-137">) will appear on one or more items in the workflow designer.</span></span> <span data-ttu-id="20c7a-138">Он свидетельствует о временных ошибках.</span><span class="sxs-lookup"><span data-stu-id="20c7a-138">These report temporary errors.</span></span> <span data-ttu-id="20c7a-139">(Наведите курсор на символ, чтобы отобразить краткое сообщение, или просмотрите подробные сведения в **списке ошибок** в Visual Studio.) Это побочные эффекты незавершенности рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="20c7a-139">, will appear on one or more items in the workflow designer. These report temporary errors. (Hover the cursor over the symbol to see a brief message, or look in the Visual Studio  **Error List** for details.) These are side effects of the incompleteness of the workflow. They should all be gone when you have finished this procedure.</span></span> <span data-ttu-id="20c7a-140">Они должны исчезнуть, когда вы полностью выполните эту процедуру.</span><span class="sxs-lookup"><span data-stu-id="20c7a-140">They should all be gone when you have finished this procedure.</span></span>

1. <span data-ttu-id="20c7a-141">Откройте область **Панель элементов** в Visual Studio, разверните узел **SP — Список**, а затем перетащите элемент **LookupSPListItem** в элемент **Последовательность** в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="20c7a-141">Open the  **Toolbox** pane in Visual Studio, expand the **SP - List** node, and then drag **LookupSPListItem** into the **Sequence** in the designer.</span></span>
    
2. <span data-ttu-id="20c7a-142">Выберите элемент **LookupSPListItem**. Его свойства отобразятся в области **Свойства** в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="20c7a-142">Select the  **LookupSPListItem** so that its properties appear in the Visual Studio **Properties** pane. Set the following properties to these values:</span></span> <span data-ttu-id="20c7a-143">Задайте для свойств указанные ниже значения.</span><span class="sxs-lookup"><span data-stu-id="20c7a-143">Set the following properties to these values:</span></span>
    
   -  <span data-ttu-id="20c7a-144">**ItemID:** (текущий элемент).</span><span class="sxs-lookup"><span data-stu-id="20c7a-144">**ItemID:** (current item)</span></span>
   -  <span data-ttu-id="20c7a-145">**ListID:** (текущий список)</span><span class="sxs-lookup"><span data-stu-id="20c7a-145">**ListID:** (current list)</span></span>
   -  <span data-ttu-id="20c7a-146">**DisplayName:** LookupCurrentNewEmployee.</span><span class="sxs-lookup"><span data-stu-id="20c7a-146">**DisplayName:** LookupCurrentNewEmployee</span></span>

   <span data-ttu-id="20c7a-147">Теперь область**Свойства** должна выглядеть так, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="20c7a-147">The  **Properties** pane should now look like the following:</span></span>
   
    <span data-ttu-id="20c7a-148">*Рис. 1. Область "Свойства" для элемента LookupSPListItem*</span><span class="sxs-lookup"><span data-stu-id="20c7a-148">*Figure 1. Properties pane of LookupSPListItem*</span></span>

    ![Область "Свойства" действия рабочего процесса списка "Lookup" (Подстановка) с заданными свойствами ItemID, ListID и DisplayName](../images/60f3302e-ca9c-45be-b785-0c9f636181da.PNG)
 

3. <span data-ttu-id="20c7a-150">Чтобы сохранить внесенные изменения, щелкните в любом месте за пределами области.</span><span class="sxs-lookup"><span data-stu-id="20c7a-150">Select anywhere outside the pane to save your changes.</span></span> <span data-ttu-id="20c7a-151">Теперь рабочая область конструктора должна выглядеть так, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="20c7a-151">Choose  OK. The designer surface should now look like the following:</span></span>
    
    <span data-ttu-id="20c7a-152">*Рис. 2. Поле "Последовательность" в конструкторе рабочих процессов*</span><span class="sxs-lookup"><span data-stu-id="20c7a-152">*Sequence in the workflow designer*</span></span>

    ![Конструктор рабочих процессов с полем "Последовательность" и действием "Lookup Current New Employee" (Поиск текущего нового сотрудника)](../images/c8fbf801-e8e4-444a-9d2e-c14e29f537de.PNG)

4. <span data-ttu-id="20c7a-154">Щелкните ссылку **Получить свойства** для недавно переименованного действия **LookupCurrentNewEmployee** в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="20c7a-154">Click the **Get Properties** link inside the (newly renamed) **LookupCurrentNewEmployee** activity in the designer. This adds a GetDynamicValueProperties activity to the sequence.</span></span> <span data-ttu-id="20c7a-155">В результате в последовательность будет добавлено действие **GetDynamicValueProperties**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-155">This adds a **GetDynamicValueProperties** activity to the sequence.</span></span>
    
5. <span data-ttu-id="20c7a-156">Щелкните текст **Определить…**</span><span class="sxs-lookup"><span data-stu-id="20c7a-156">Select the **Define…**</span></span> <span data-ttu-id="20c7a-157">в действии **GetDynamicValueProperties**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-157">text in the **GetDynamicValueProperties** activity.</span></span> <span data-ttu-id="20c7a-158">Откроется диалоговое окно **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-158">This will open the **Office Add-ins** dialog box.</span></span>
    
6. <span data-ttu-id="20c7a-159">Присвойте параметру **Тип сущности** значение **Элемент списка** _имя_экземпляра_списка_, где _имя_экземпляра_списка_ — текст **New Employees in Seattle** (Новые сотрудники в Сиэтле).</span><span class="sxs-lookup"><span data-stu-id="20c7a-159">Set the **Entity Type** to **List Item of ** _list_instance_name_, where _list_instance_name_ is **New Employees in Seattle**.</span></span>
    
7. <span data-ttu-id="20c7a-160">В столбце **Путь** щелкните верхнюю ячейку и в раскрывающемся списке выберите пункт **Orientation Stage** (Этап обучения).</span><span class="sxs-lookup"><span data-stu-id="20c7a-160">In the **Path** column, click the top cell and then choose **Orientation Stage** from the drop down.</span></span>
 
8. <span data-ttu-id="20c7a-161">Щелкните ячейку, расположенную ниже, и в раскрывающемся списке выберите пункт **Title (Title)** (Название).</span><span class="sxs-lookup"><span data-stu-id="20c7a-161">Select the cell under it, and then select **Title (Title)** from the drop-down.</span></span>
 
9. <span data-ttu-id="20c7a-162">Щелкните ссылку **Populate Variables** (Заполнить переменные).</span><span class="sxs-lookup"><span data-stu-id="20c7a-162">Select **Populate Variables**.</span></span> <span data-ttu-id="20c7a-163">В результате будут созданы переменные с именами **OrientationStage** и **Title** (Название). Кроме того, все значения будут назначены соответствующим полям в текущем элементе списка **New Employees in Seattle** (Новые сотрудники в Сиэтле).</span><span class="sxs-lookup"><span data-stu-id="20c7a-163">Click **Populate Variables**. This will create a variables named **OrientationStage** and Title and assign each of the value of corresponding fields in the current item of the **New Employees in Seattle** list. The Properties dialog should now look like the following:</span></span> <span data-ttu-id="20c7a-164">Теперь диалоговое окно **Свойства** должно выглядеть так, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="20c7a-164">The  **Properties** pane should now look like the following:</span></span>
    
   <span data-ttu-id="20c7a-165">*Рис. 3. Диалоговое окно "Свойства" действия рабочего процесса*</span><span class="sxs-lookup"><span data-stu-id="20c7a-165">*Properties dialog of workflow activity*</span></span>

   ![Диалоговое окно "Свойства" для действия получения динамических значений, в котором значение типа сущности задано для элементов списка новых сотрудников, а переменные Title и OrientationStage присвоены полям с теми же названиями.](../images/36a841e7-ce1b-444c-9bfe-7cdc56399ec1.PNG)
 

10. <span data-ttu-id="20c7a-167">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-167">Select **OK**.</span></span> <span data-ttu-id="20c7a-168">Теперь рабочая область конструктора должна выглядеть так, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="20c7a-168">Choose  OK. The designer surface should now look like the following:</span></span>
    
    <span data-ttu-id="20c7a-169">*Рис. 4. Конструктор рабочих процессов*</span><span class="sxs-lookup"><span data-stu-id="20c7a-169">*Figure 4. Workflow designer*</span></span>

    ![Конструктор рабочих процессов с двумя действиями: поиск элемента списка и получение динамических значений.](../images/cd8eb456-d883-491a-b171-38c1b9f64018.PNG)

11. <span data-ttu-id="20c7a-171">Откройте область **Панель элементов** в Visual Studio, разверните узел **Поток управления**, а затем перетащите элемент **If** в нижнюю часть поля **Последовательность** под элементом **GetDynamicValueProperties**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-171">Open the  **Toolbox** pane in Visual Studio, expand the **Control Flow** node, and then drag **If** into the bottom of the **Sequence** below the **GetDynamicValueProperties**.</span></span>
 
12. <span data-ttu-id="20c7a-172">В поле **Условие** элемента **If** введите **OrientationStage=="HR paperwork"**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-172">In the  **Condition** box of the **If**, enter OrientationStage=="HR paperwork".</span></span>
    
13. <span data-ttu-id="20c7a-173">Откройте область **Панель элементов** в Visual Studio, разверните узел **SP — Utilities**, а затем перетащите элемент **Электронная почта** в поле **Then** действия **If**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-173">Open the  **Toolbox** pane in Visual Studio, expand the **SP - Utilities** node, and then drag **Email** into the **Then** box of the **If** activity.</span></span>
    
14. <span data-ttu-id="20c7a-174">Выберите действие **Электронная почта**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-174">Select the **Email** activity.</span></span> <span data-ttu-id="20c7a-175">В области **Свойства** области задайте необходимые значения для свойств **Основной текст**, **Тема** и **Кому**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-175">In the **Properties** pane, set the values of the **Body**, **Subject**, and **To** properties.</span></span> <span data-ttu-id="20c7a-176">В любом случае нажмите кнопку **. . .** на выноске</span><span class="sxs-lookup"><span data-stu-id="20c7a-176">In each case, choose the callout button **. . .**</span></span> <span data-ttu-id="20c7a-177">для свойства и с помощью открывшегося **редактора выражений** задайте значения свойств, как показано в таблице ниже.</span><span class="sxs-lookup"><span data-stu-id="20c7a-177">for the property and use the **Expression Editor** that opens to set the property's value as in the following table.</span></span> <span data-ttu-id="20c7a-178">Ниже указаны строковые выражения для языка C#, поэтому используйте кавычки, точно так, как показано в таблице.</span><span class="sxs-lookup"><span data-stu-id="20c7a-178">These are C# string expressions, so use quotation marks exactly as shown.</span></span> <span data-ttu-id="20c7a-179">Здесь `Title` — переменная, которую вы назначили ранее полю **Title** (Название) элемента списка (в котором содержится имя сотрудника).</span><span class="sxs-lookup"><span data-stu-id="20c7a-179">The `Title` here is a variable that you assigned earlier to the **Title** field of the list item (which holds the name of the employee).</span></span>
    
    -  <span data-ttu-id="20c7a-180">**Основной текст:** `Title + " is waiting in the lobby to fill out benefits and employment forms."`.</span><span class="sxs-lookup"><span data-stu-id="20c7a-180">**Body:** `Title + " is waiting in the lobby to fill out benefits and employment forms."`</span></span>
    -  <span data-ttu-id="20c7a-181">**Тема:** `Title + " is ready for HR paperwork"`</span><span class="sxs-lookup"><span data-stu-id="20c7a-181">**Subject:** `Title + " is ready for HR paperwork"`</span></span>
    -  <span data-ttu-id="20c7a-182">**Кому:** `new System.Collections.ObjectModel.Collection<string>() {"your_O365_email"}`.</span><span class="sxs-lookup"><span data-stu-id="20c7a-182">**To:** `new System.Collections.ObjectModel.Collection<string>() {"your_O365_email"}`</span></span>
    
    <span data-ttu-id="20c7a-183">Замените заполнитель *your_O365_email* идентификатором, который вы используете для входа в свою учетную запись разработчика в Office 365, например `*alias*@*O365domain*.sharepoint.com`.</span><span class="sxs-lookup"><span data-stu-id="20c7a-183">Replace the placeholder,  your_O365_email  , with the identity that you use to login to your Office 365 developer account, such as alias  O365domain  .sharepoint.com. This is a C# string so it must be in quotation marks.</span></span> <span data-ttu-id="20c7a-184">Это строка на языке C#, поэтому она должна быть заключена в кавычки.</span><span class="sxs-lookup"><span data-stu-id="20c7a-184">This is a C# string so it must be in quotation marks.</span></span>
    
15. <span data-ttu-id="20c7a-185">Откройте область **Панель элементов** в Visual Studio, разверните узел **Среда выполнения**, а затем перетащите элемент **TerminateWorkflow** в поле **Else** действия **If**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-185">Open the  **Toolbox** pane in Visual Studio, expand the **Runtime** node, and then drag **TerminateWorkflow** into the **Else** box of the **If** activity.</span></span>
    
16. <span data-ttu-id="20c7a-186">Выберите действие **TerminateWorkflow** и в области **Свойства** введите в поле **Причина** следующее значение (*включая кавычки*): `"Not at HR paperwork stage."`.</span><span class="sxs-lookup"><span data-stu-id="20c7a-186">Select the  TerminateWorkflow activity and in the Properties pane, set the Reason to the following, * including the quotation marks*  :"Not at HR paperwork stage.". The designer should now look the following:</span></span> <span data-ttu-id="20c7a-187">Теперь конструктор должен выглядеть так, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="20c7a-187">Choose  OK. The designer surface should now look like the following:</span></span>
    
    <span data-ttu-id="20c7a-188">*Рис. 5. Конструктор рабочих процессов после завершения рабочего процесса*</span><span class="sxs-lookup"><span data-stu-id="20c7a-188">*Workflow designer when the workflow is complete*</span></span>

    ![Конструктор рабочих процессов с действиями поиска элемента списка, получения динамических значений, а также структурой "If Then Else". Действие обработки электронной почты относится к части с Then, а действие завершения рабочего процесса — к части с Else.](../images/c1230e3b-d149-413c-aa66-d258250a4512.PNG)
 

## <a name="run-and-test-the-add-in"></a><span data-ttu-id="20c7a-191">Запуск и тестирование надстройки</span><span class="sxs-lookup"><span data-stu-id="20c7a-191">Run and test the add-in</span></span>

1. <span data-ttu-id="20c7a-192">Нажмите клавишу F5, чтобы развернуть и запустить надстройку.</span><span class="sxs-lookup"><span data-stu-id="20c7a-192">Use the F5 key to deploy and run your add-in.</span></span> <span data-ttu-id="20c7a-193">Visual Studio выполняет временную установку надстройки на вашем тестовом сайте SharePoint и сразу же запускает ее.</span><span class="sxs-lookup"><span data-stu-id="20c7a-193">Use the F5 key to deploy and run your add-in. Visual Studio makes a temporary installation of the add-in on your test SharePoint site and immediately runs the add-in.</span></span> <span data-ttu-id="20c7a-194">Кроме того, откроется консоль **Узел тестовой службы** диспетчера рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="20c7a-194">The Workflow Manager's **Test Service Host** console also opens.</span></span>
    
2. <span data-ttu-id="20c7a-195">Когда откроется страница надстройки, используемая по умолчанию, откройте один из элементов для редактирования и присвойте параметру **Orientation Stage** (Этап обучения) значение **HR paperwork** (Оформление документов для отдела кадров).</span><span class="sxs-lookup"><span data-stu-id="20c7a-195">When the add-in's default page opens,  open one of the items for editing, and set the value of **Orientation Stage** to **HR paperwork**.</span></span> 
    
   <span data-ttu-id="20c7a-196">На консоли **Узел службы тестирования** отобразится индикатор того, что рабочий процесс запущен.</span><span class="sxs-lookup"><span data-stu-id="20c7a-196">In the  **Test Service Host** console, an indication appears that the workflow has started. Shortly after, there is an indication that the workflow has completed. The following is an example:</span></span> <span data-ttu-id="20c7a-197">Вскоре после этого отобразится индикатор того, что рабочий процесс завершен.</span><span class="sxs-lookup"><span data-stu-id="20c7a-197">Shortly after, there is an indication that the workflow has completed.</span></span> <span data-ttu-id="20c7a-198">Ниже приведен пример.</span><span class="sxs-lookup"><span data-stu-id="20c7a-198">The following is an example:</span></span>
 
   <span data-ttu-id="20c7a-199">*Рис. 6. Консоль "Узел службы тестирования"*</span><span class="sxs-lookup"><span data-stu-id="20c7a-199">*Figure 6. Test Service Host console*</span></span>

   ![Окно "Узел службы тестирования" рабочего процесса со строкой о начале рабочего процесса и строкой о его завершении. GUID экземпляра рабочего процесса указан в начале каждой строки.](../images/2422936d-7ef6-4c90-a03f-30053fbb9743.PNG)
 
    > [!NOTE]
    > <span data-ttu-id="20c7a-202">Если консоль **Узел службы тестирования** не откроется, вам, возможно, потребуется включить функцию отладки рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="20c7a-202">If the  **Test Service Host** console does not open, you may need to enable workflow debugging.</span></span> <span data-ttu-id="20c7a-203">Щелкните правой кнопкой мыши имя проекта в **обозревателе решений** и выберите пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-203">Right-click the project name in **Solution Explorer** and select **Properties**.</span></span> <span data-ttu-id="20c7a-204">Откройте вкладку **SharePoint** в области **Свойства** и установите флажок **Включить отладку рабочего процесса**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-204">Open the **SharePoint** tab on the **Properties** pane and select the **Enable Workflow debugging** check box.</span></span>

3. <span data-ttu-id="20c7a-205">Перейдите в папку "Входящие" (Outlook) вашей учетной записи разработчика в Office 365.</span><span class="sxs-lookup"><span data-stu-id="20c7a-205">Go to the email inbox (Outlook) of your Office 365 developer account.</span></span> <span data-ttu-id="20c7a-206">В ней будет электронное письмо с темой "*Employee* is ready for HR paperwork" (Сотрудник готов к оформлению документов для отдела кадров), в котором вместо слова *Employee* (Сотрудник) будет имя сотрудника, элемент которого вы изменили.</span><span class="sxs-lookup"><span data-stu-id="20c7a-206">There is an email with the subject "*Employee* is ready for HR paperwork" where *Employee* is the name of the employee whose item you edited.</span></span> <span data-ttu-id="20c7a-207">Текст электронного письма с фразой "*Employee* is waiting in the lobby to fill out benefits and employment forms" (Сотрудник ожидает в холле, чтобы заполнить формы для трудоустройства).</span><span class="sxs-lookup"><span data-stu-id="20c7a-207">The body of the email says "*Employee* is waiting in the lobby to fill out benefits and employment forms."</span></span> <span data-ttu-id="20c7a-208">Ниже приведен пример.</span><span class="sxs-lookup"><span data-stu-id="20c7a-208">The following is an example:</span></span>
    
   <span data-ttu-id="20c7a-209">*Рис. 7. Электронное письмо, отправленное рабочим процессом*</span><span class="sxs-lookup"><span data-stu-id="20c7a-209">*Figure 7. Email sent by workflow*</span></span>

   ![Электронное сообщение в Outlook из рабочего процесса. Указано сообщение в теме о готовности пользователя к оформлению документов для отдела кадров, а также текст об ожидании пользователя в зале, который планирует заполнить формы зачисления и соцобеспечения.](../images/7b1d8f47-9c34-441e-af6a-3af4a8c65533.PNG)

   > [!TIP]
   > <span data-ttu-id="20c7a-211">Если рабочий процесс начинается, но никогда не завершается и не отправляет электронное письмо, попробуйте завершить сеанс отладки и нажмите клавишу F5 еще несколько раз, прежде чем сделать вывод, что в коде что-то не так.</span><span class="sxs-lookup"><span data-stu-id="20c7a-211">If the workflow begins but never completes, and the email is not sent, try ending the debugging session and trying F5 again a few times before you conclude there is something wrong in your code. Sometimes the problem is in sposhort.</span></span> <span data-ttu-id="20c7a-212">Иногда проблема заключается в SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="20c7a-212">Sometimes the problem is in SharePoint Online.</span></span> <span data-ttu-id="20c7a-213">Если у вас по-прежнему возникают проблемы, попробуйте добавить тип контента с именем **ListFieldsContentType**, если его еще не существует, в раздел **ContentTypes** файла schema.xml.</span><span class="sxs-lookup"><span data-stu-id="20c7a-213">If you are still having problems, try adding a content type called **ListFieldsContentType**, if there isn't one already, to the **ContentTypes** section of the schema.xml file. The following is an example of the markup.</span></span> <span data-ttu-id="20c7a-214">Ниже приведен пример части кода.</span><span class="sxs-lookup"><span data-stu-id="20c7a-214">The following is an example of the markup:</span></span> 
   
   > `<ContentType ID="0x0100781dd48170b94fdc9706313c82b3d04c" Name="ListFieldsContentType" Hidden="TRUE"></ContentType>`
   
   > <span data-ttu-id="20c7a-215">Скопируйте весь раздел **FieldRefs** типа контента **NewEmployee** в этот новый тип контента.</span><span class="sxs-lookup"><span data-stu-id="20c7a-215">Then copy the whole of the FieldRefs section of the NewEmployee content type into this new content type.</span></span> <span data-ttu-id="20c7a-216">Сохраните проект, отзовите его и еще раз нажмите клавишу F5.</span><span class="sxs-lookup"><span data-stu-id="20c7a-216">Save the project, retract, and try F5 again.</span></span>

4. <span data-ttu-id="20c7a-217">Чтобы завершить сеанс отладки, закройте окно браузера или остановите отладку в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="20c7a-217">To end the debugging session, close the browser window or stop debugging in Visual Studio. Each time that you press F5, Visual Studio will retract the previous version of the add-in and install the latest one.</span></span> <span data-ttu-id="20c7a-218">При каждом нажатии клавиши F5 Visual Studio будет отзывать предыдущую версию надстройки и устанавливать ее последнюю версию.</span><span class="sxs-lookup"><span data-stu-id="20c7a-218">Each time that you select F5, Visual Studio retracts the previous version of the add-in and installs the latest one.</span></span>
    
5. <span data-ttu-id="20c7a-219">Вы будете работать с этой надстройкой и решением Visual Studio при изучении других статей, поэтому при перерывах в работе рекомендуется отзывать надстройку.</span><span class="sxs-lookup"><span data-stu-id="20c7a-219">You will work with this add-in and Visual Studio solution in other articles, and it's a good practice to retract the add-in one last time when you are done working with it for a while. Right-click the project in  Solution Explorer and choose Retract.</span></span> <span data-ttu-id="20c7a-220">В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Отозвать**.</span><span class="sxs-lookup"><span data-stu-id="20c7a-220">Right-click the project in  **Solution Explorer** and choose **Retract**.</span></span>
    

## <a name="next-steps"></a><span data-ttu-id="20c7a-221">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="20c7a-221">Next steps</span></span>
<span data-ttu-id="20c7a-222"><a name="Nextsteps"> </a></span><span class="sxs-lookup"><span data-stu-id="20c7a-222"></span></span>

<span data-ttu-id="20c7a-223">В следующей статье этой серии вы [добавите пользовательскую страницу в надстройку SharePoint, размещаемую в SharePoint](add-a-custom-page-and-style-to-a-sharepoint-hosted-sharepoint-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="20c7a-223">In the next article in this series, you'll add a custom page and style to the SharePoint Add-in:  [Add a custom page and style to a SharePoint-hosted SharePoint Add-in](add-a-custom-page-and-style-to-a-sharepoint-hosted-sharepoint-add-in.md).</span></span>
 

 

