---
title: "Выделение контента и расширение функций надстроек SharePoint с размещением в SharePoint при помощи элемента управления вызовом"
description: "Создайте элемент управления SharePoint \"Выноска\", добавьте его на свою страницу и настройте его внешний вид и поведение, чтобы привлечь внимание пользователей и продемонстрировать функции надстройки."
ms.date: 12/20/2017
ms.prod: sharepoint
ms.openlocfilehash: 147b77ad1dc58f205b7507d08c221ebabfd9336d
ms.sourcegitcommit: 6f2b3b5bd81c2de4f761e10ed5e2f0b9c3c485bf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2017
---
# <a name="highlight-content-and-enhance-the-functionality-of-sharepoint-hosted-sharepoint-add-ins-with-the-callout-control"></a>Выделение контента и расширение функций надстроек SharePoint с размещением в SharePoint с помощью выноски

Элемент "Выноска" в SharePoint помогает привлечь внимание пользователя и продемонстрировать функции надстройки, размещенной в SharePoint. Вы можете адаптировать его под пользовательский интерфейс надстройки. Вы можете создать этот элемент управления, добавить его на страницу, а также настроить его внешний вид и поведение.
 
Вы можете увидеть выноску в действии, выполнив поиск на сайте SharePoint и наведя указатель на один из результатов. 

На приведенном ниже рисунке показана выноска для одного результата поиска, а также представлено несколько типичных аспектов элемента управления контентом: заголовок, сведения об элементе на странице и действия (**Открыть** и **Отправить**), которые вы можете выполнить с этим элементом. 

В этом случае информация и действия относительно простые, но преимущества использования выноски все равно заметны. Во-первых, она позволяет показывать дополнительную информацию об элементах на странице, когда это необходимо, а во-вторых, предоставляет элегантный способ добавления функций на страницу. 

**Пример выноски на странице результатов поиска в SharePoint**

![Пример выноски на странице результатов поиска в SharePoint](../images/S15_CalloutControlExample.png)
 
<a name="GettingStarted"> </a>

## <a name="make-the-control-available-to-your-html-page-by-including-the-calloutjs-file"></a>Предоставление HTML-странице доступа к элементу управления путем добавления файла callout.js

Используйте метод `SP.SOD.executeFunc`, чтобы файл сценария всегда загружался до выполнения зависящего от него кода.

```js
SP.SOD.executeFunc("callout.js", "Callout", function () {
    });
```

Функция, которую вы передаете в функцию `SP.SOD.executeFunc`, содержит код, который нужно выполнить после загрузки файла callout.js. После загрузки этих файлов вы создаете объект `Callout` для каждого элемента страницы, с которым необходимо связать выноску, используя объект `CalloutManager`. 

`CalloutManager` — это одноэлементный объект, хранящий ссылки на каждый объект `Callout` на странице в массиве ассоциативных элементов. 

Объект `Callout` имеет всего два обязательных элемента: `ID` и `launchPoint`. Элемент `ID` — это ключ, сопоставленный с объектом `Callout` в `CalloutManager` (`CalloutManager["value of the callout's ID member"]`). Элемент `launchPoint` — это элемент HTML-страницы. 

Например, вы можете создать или получить элемент `div` на своей странице и передать его в качестве элемента объекта `Callout`. По умолчанию выноска появляется, когда пользователь выбирает элемент `launchPoint`. 

В этом примере показано, как создать простейшую выноску с двумя обязательными элементами и строкой заголовка.

```js
var calloutPageElement = document.createElement("div");
var callout = CalloutManager.createNew({
   ID: "unique identifier",
   launchPoint: calloutPageElement,
   title: "callout title"
});

```

Эта выноска появляется и показывает заголовок в верхней части элемента управления, когда пользователь выбирает элемент страницы. Для настройки внешнего вида, поведения, положения и действий элемента управления используются необязательные элементы. Выноска также имеет метод set, с помощью которого можно задать значение любого параметра после создания экземпляра элемента управления.

```js
callout.set({openOptions:{event: "hover"}});
```

Вы также можете задать значения для всех элементов выноски в объекте `CalloutOptions`, а затем передать этот объект методу `createNew`.

```js
var calloutPageElement = document.createElement("div");
var calloutOptions = new CalloutOptions();
calloutOptions.ID = unique identifier;
calloutOptions.launchPoint = calloutPageElement;
calloutOptions.title = callout title;
var callout = CalloutManager.createNew(calloutOptions);
```

<a name="Appearance"> </a>

## <a name="customize-the-appearance-of-the-callout-control"></a>Настройка внешнего вида выноски


Управлять внешним видом выноски можно с помощью указанных ниже элементов.

|**Элемент**|**Назначение**|**Допустимые значения (полужирным шрифтом выделено значение по умолчанию)**|
|:-----|:-----|:-----|
|title|Отображение заголовка в верхней части элемента управления.|строка, **NULL**, строка с HTML-кодом|
|content|Отображение HTML в элементе управления в случае отсутствия значения для элемента `contentElement`.|строка с HTML-кодом, **NULL**, должен быть равен NULL, если `contentElement` имеет какое-либо значение.|
|contentElement|Отображение элемента HTML внутри элемента управления в случае отсутствия значения для элемента `content`.|Любой элемент HTML, **NULL**, должен быть равен NULL, если для элемента `content` задано значение.|
|contentWidth|Указание ширины (в пикселях) контейнера основной части выноски.<br/><br/>Этот контейнер также имеет границу шириной 1 пиксель и отбивку шириной 15 пикселей с каждой стороны, поэтому итоговый элемент управления на 32 пикселя шире указанной вами ширины.<br/><br/>Свойство `overflow` CSS элемента управления имеет значение `hidden`, поэтому контент, который не помещается в указанную вами ширину, обрезается.<br/><br/>Если настроить этот элемент для открытой выноски, изменение вступит в силу немедленно.<br/><br/>С другими элементами дело обстоит по-другому.|Любое число от 240 до 610, **350** (то есть по умолчанию элемент управления имеет ширину в 382 пикселя)|
|beakOrientation|Задает ориентацию стрелки или указателя выноски.|**Ориентация topBottom**<br/><br/>![Место, где отображается заостренная часть выноски с ориентацией topbottom](../images/SP15_CalloutTopBottom.png)<br/><br/>**Ориентация leftRight**<br/><br/>![Место, где отображается заостренная часть выноски с ориентацией leftRight](../images/SP15_CalloutLeftRight.png)|

<a name="Behavior"> </a>

## <a name="customize-the-behavior-of-the-callout-control"></a>Настройка поведения выноски

Вы можете настроить поведение выноски, используя указанные ниже элементы. Начните с элемента `openOptions`, так как он позволяет указать, как элемент управления открывается и закрывается, когда пользователь взаимодействует с ним на странице.

|**Значения элемента `openOptions`**|**Назначение**|
|:-----|:-----|
| `{event: "click", closeCalloutOnBlur: true}`|Выноска появляется, когда пользователь наводит указатель на элемент `launchPoint`, и закрывается, когда пользователь убирает указатель с элемента `launchPoint`.<br/><br/>Так как свойству `event` присвоено значение `click`, параметр `showCloseButton` имеет значение **true**, его нельзя изменить.<br/><br/>Это сочетание значений используется по умолчанию.|
| `{event: "hover", showCloseButton: true}`|Выноска появляется, когда пользователь наводит указатель на элемент `launchPoint`, и закрывается, когда пользователь нажимает кнопку **X** в верхнем правом углу элемента управления.<br/><br/>Так как свойству `event` присвоено значение `hover`, значение `closeCalloutOnBlur` не применимо, его нельзя задать.|
| `{event: "click", closeCalloutOnBlur: false}`|Выноска появляется, когда пользователь наводит указатель на элемент `launchPoint`, и закрывается, только когда пользователь нажимает кнопку **X** в верхнем правом углу элемента управления.<br/><br/>Так как свойству `event` присвоено значение `click`, параметр `showClosebutton` имеет значение **true**, его нельзя изменить.|

<br/>

Ниже показаны другие элементы, с помощью которых можно управлять поведением выноски.

|**Элемент**|**Назначение**|**Допустимые значения (полужирным шрифтом выделено значение по умолчанию)**|
|:-----|:-----|:-----|
|onOpeningCallback|Выполнение действий, которые должны произойти до отрисовки выноски на странице.<br/><br/>Так как объект `Callout` должен передаваться в виде параметра в добавляемую функцию, вы можете использовать этот элемент, чтобы задать значение любого из свойств элемента управления до его отрисовки.<br/><br/>Вы также можете использовать этот элемент для запуска асинхронных действий, которые добавляют или изменяют содержимое элемента управления.<br/><br/>Задать значение для этого элемента можно только один раз.| `function(callout /*=Callout*/) {...}`<br/><br/>**null**|
|onOpenedCallback|Выполнение действий, которые должны произойти после отрисовки выноски на странице и ее полной анимации.<br/><br/>Вы можете использовать этот элемент для работы с моделью DOM элемента управления.<br/><br/>Задать значение для этого элемента можно только один раз.| `function(callout /*=Callout*/) {...}`<br/><br/>**null**|
|onClosingCallback|Выполнение действий, которые должны произойти во время закрытия выноски, но до ее полного удаления со страницы.<br/><br/>Задать значение для этого элемента можно только один раз.| `function(callout /*=Callout*/) {...}` <br/><br/>**null**|
|onClosedCallback|Выполнение действий, которые должны произойти после закрытия выноски и ее удаления со страницы.<br/><br/>Задать значение для этого элемента можно только один раз.| `function(callout /*=Callout*/) {...}`<br/><br/>**null**|

<a name="CalloutMethods"> </a>

## <a name="use-the-callout-control-methods"></a>Использование методов выноски

Вы можете настраивать поведение выноски, используя указанные ниже методы.

|**Метод**|**Назначение**|**Допустимые значения параметров**|
|:-----|:-----|:-----|
|set({member:value})|Задает значения элементов после того, как вы создадите экземпляр элемента управления.|Пара имя-значение, которая определяет значение любого члена элемента управления выносками<br/><br/>`var callout = new Callout({openOptions:{event: "click"}});callout.set({openOptions:{event: "hover"}});`|
|getOrientation()|Возвращает объект `CalloutOrientation`, указывающий направление выноски.<br/><br/>Этот объект имеет четыре логических элемента: `up`, `down`, `left` и `right`.<br/><br/>Пока элемент управления открыт, для двух из этих значений задано значение **true**, а для двух других — **false** (например, `up` и `right`).|Нет параметров|
|addEventCallback(string eventName, CalloutCallback callback|Регистрация функции обратного вызова, которая выполняется при переходе выноски в состояние, указанное параметром `eventName`.|Параметр `eventName` должен иметь одно из следующих значений: `opening`, `open`, `closing`, `closed`.<br/><br/>Параметр `callback` должен быть функцией, которая принимает экземпляр выноски в качестве своего первого параметра.|
|open()|Отображение элемента управления.<br/><br/>Если элемент управления уже открыт или находится в процессе открытия, этот метод возвращает значение **false**, не выполняется никаких действий.|Нет параметров|
|close(bool useAnimation)|Скрытие элемента управления.<br/><br/>Если элемент управления уже закрыт или находится в процессе закрытия, этот метод возвращает значение **false**, не выполняется никаких действий.|Логическое значение, указывающее, сопровождается ли закрытие элемента управления анимацией.<br/><br/>По умолчанию анимация отключена.|
|toggle()|Переключение открытого/закрытого состояния элемента управления|Нет параметров|
|addAction(CallOutAction calloutAction)|Добавление нового объекта `CalloutAction` в массив объектов `CalloutAction` выноски.<br/><br/>Эти объекты определяют действия, отображаемые в нижнем колонтитуле элемента управления.<br/><br/>Инструкции по созданию этих объектов см. в разделе [Добавление действий в выноску](#AddActions).<br/><br/>Вы можете добавлять действия только после создания экземпляра элемента управления.<br/><br/>В элемент управления нельзя добавить больше трех действий, иначе возникнет исключение.|Объект `CalloutAction`.|
|refreshActions()|Перезагрузка всех действий, добавленных в элемент управления.<br/><br/>Вы можете использовать этот метод для изменения, включения или отключения действий при открытом элементе управления.|Нет параметров|

<a name="AddActions"> </a>

## <a name="add-actions-to-the-callout-control"></a>Добавление действий в выноску

Действия добавляются после создания экземпляра выноски. Действие выноски может представлять собой одно действие или меню действий. В выноску можно добавить не более трех действий. Действие выноски добавляется в объект `CalloutControl` с помощью метода `addAction`. Показанное ниже действие открывает новое окно в браузере, когда пользователь выбирает текст.
 
```js
//Create CalloutAction
var calloutAction = new CalloutAction({
            text: "Open window"
            onClickCallback: function() {                
                window.open(url);
            }
        });

//Add Action to an instance of the CalloutControl        
        myCalloutControl.addAction(calloutAction);
```

<br/>

Вы также можете задать значения для всех элементов `CalloutAction` в объекте `CalloutActionOptions` и передать этот объект конструктору `CalloutAction`.

```js
//Create CalloutAction
var calloutActionOptions = new CalloutActionOptions();
calloutActionOptions.text = "Open window";
actionOptions.onClickCallback = function() {
    window.open(url);
};
var calloutAction = new CalloutAction(calloutActionOptions);

//Add Action to an instance of the CalloutControl        
        myCalloutControl.addAction(calloutAction);
```

<br/>

Вы можете управлять поведением действия выноски, используя указанные ниже элементы.

|**Элемент**|**Назначение**|**Допустимые значения (полужирным шрифтом выделено значение по умолчанию)**|
|:-----|:-----|:-----|
|text (обязательный)|Отображение текстовой подписи действия.|строка, **NULL**|
|onClickCallback|Определение действия, выполняемого, когда пользователь выбирает подпись действия выноски.| `function(calloutAction /*=CalloutAction*/) {...}`<br/><br/>**null**|
|isEnabledCallback|Определение функции обратного вызова, которая выполняется до отображения выноски и определяет, включено ли действие.<br/><br/>Если эта функция возвращает значение **true**, на выноске отображается активное действие.<br/><br/>Если она возвращает значение **false**, на выноске отображается текст действия, но само действие отключается. | `function(calloutAction /*=CalloutAction*/) {...}` <br/><br/>**null**|
|isVisibleCallback|Определение функции обратного вызова, которая выполняется до отображения выноски и определяет, отображается ли текст действия.<br/><br/>Если эта функция возвращает значение **true**, на выноске отображается текст действия.<br/><br/>Если она возвращает значение **false**, текст действия скрывается.<br/><br/>Другие действия смещаются влево, занимая место скрытого действия.| `function(calloutAction /*=CalloutAction*/) {...}`<br/><br/>**null**|
|tooltip|Отображение текста при наведении указателя на текст действия выноски.|строка, **NULL**|
|disabledTooltip|Отображение текста при наведении указателя на текст отключенного действия выноски (если функция `isEnabledCallback` возвращает значение **false**).|string, **null**|
|menuEntries|Определение меню действий вместо отдельного действия. | `[ CalloutActionMenuEntry, ...]`<br/><br/>**null**|

В следующем разделе описано, как создать класс `CalloutActionMenuEntry` и добавить его в объект `CalloutAction`.

### <a name="add-action-menus-to-the-callout-control"></a>Добавление меню действий в выноску

Когда действие выноски содержит не одно действие, а меню, пользователь видит рядом с текстом действия выноски стрелку вниз, как показано ниже.

**Меню, отображаемое в действии выноски, когда пользователь нажимает стрелку возле подписи действия**

![Меню, отображаемое в действии выноски, когда пользователь нажимает стрелку возле подписи действия.](../images/SP15_CalloutMenu.png)
 
Вы можете создать любое число элементов меню и добавить их в действие выноски, передав их в массиве в виде значения элемента `menuEntries` объекта `CalloutAction`.

```js
//Create two menu entries.
var menuEntry1 = new CalloutActionMenuEntry("Entry One", calloutActionCallbackFunction, "/_layouts/images/DOC16.GIF");
var menuEntry2 = new CalloutActionMenuEntry("Some Other Entry", calloutActionCallbackFunction, "/_layouts/images/XLS16.GIF");

//Add the menu entries to the callout action.
var calloutAction = new CalloutAction({
   text: "MENU W/ ICONS",
   menuEntries: [menuEntry1, menuEntry2]
})

//Add the callout action to the callout control.
callout.addAction(calloutAction);

```

<br/>

Конструктор `CalloutActionMenuEntry` принимает три параметра. Первые два из них являются обязательными. Третий необязателен, но может пригодиться, так как позволяет отобразить значок рядом с текстом.

- Передайте в качестве первого параметра строку для отображения текстовой подписи каждого пункта меню.

- Передайте функцию в качестве второго параметра, чтобы определить действие, которое выполняется при щелчке пользователем текста элемента меню.

- Передайте строку, содержащую URL-адрес для значка, который вы хотите отобразить слева от текстовой подписи.


<a name="UseCalloutManager"> </a> 

## <a name="use-the-calloutmanager-to-create-and-manage-instances-of-the-callout-control"></a>Создание экземпляров выноски и управление ими с помощью CalloutManager

Одноэлементный объект `CalloutManager` хранит ссылки на все объекты `Callout` на странице. Он хранит все экземпляры выноски в массиве ассоциативных элементов, где значение `ID` каждого элемента управления — это ключ. Объект `CalloutManager` содержит методы, помогающие создавать хранимые им объекты `Callout` и управлять ими.

|**Метод**|**Назначение**|**Допустимые значения параметров**|
|:-----|:-----|:-----|
|createNew()|Создание нового объекта `Callout`.<br/><br/>Когда вы делаете это, `CalloutManager` добавляет запись для элемента управления в свой массив ассоциативных элементов, используя значение обязательного элемента `ID` в качестве ключа.|Массив ассоциативных элементов, назначающий значения каждому элементу.<br/><br/>Элементы `ID` и `launchPoint` являются обязательными.|
|createNewIfNecessary()|Создание объекта `Callout`, если объекту `launchPoint`, переданному в качестве параметра, еще не назначена выноска.|Массив ассоциативных элементов, назначающий значения каждому элементу.<br/><br/>Элементы `ID` и `launchPoint` являются обязательными.|
|getFromLaunchPoint: function (/*@type(HTMLElement)*/launchPoint)|Получение объекта `Callout`, связанного с элементом `launchPoint`, указанным в функции.<br/><br/>Этот метод выдает исключение, если с элементом `launchPoint` не связан объект `Callout`.|Нет параметров|
|getFromLaunchPointIfExists: function (/*@type(HTMLElement)*/launchPoint)|Получение объекта `Callout`, связанного с элементом `launchPoint`, указанным в функции.<br/><br/>Этот метод возвращает значение NULL, если с элементом `launchPoint` не связан объект `Callout`.|Нет параметров|
|getFromCalloutDescendant: function (/*@type(HTMLElement)*/descendant)|Получение объекта `Callout`, связанного с HTML-элементом, указанным в функции.<br/><br/>Этим элементом может быть любой потомок элемента выноски.<br/><br/>Например, вы можете передать значение элемента `contentElement`, назначенное при создании объекта `Callout`.<br/><br/>Этот метод выдает исключение, если с потомком не связан объект `Callout`.|Нет параметров|
|closeAll()|Закрывает все открытые объекты `Callout`.<br/><br/>Этот метод возвращает значение true, если он закрывает хотя бы одну выноску.|Нет параметров|
|isAtLeastOneCalloutOpen()|Проверяет наличие хотя бы одной открытой выноски.|Нет параметров|

<a name="Positioning"> </a>

## <a name="position-the-callout-control-on-the-page"></a>Размещение выноски на странице

|**Элемент**|**Назначение**|**Допустимые значения (полужирным шрифтом выделено значение по умолчанию)**|
|:-----|:-----|:-----|
|boundingBox|Указание HTML-элемента, который будет выступать в качестве эквивалента `offsetParent` выноски.<br/><br/>По умолчанию используется `offsetParent` выноски, но вы можете использовать этот элемент для правильного расположения элемента управления.<br/><br/>Выноска пытается расположиться так, чтобы находиться внутри этой рамки. Она изменяет направление, чтобы оставаться в этой рамке. (Вниз вместо вверх, а также вправо вместо влево в зависимости от ориентации указателя.)|Любой HTML-элемент, **offsetParent HTML-элемента, содержащего выноску**|
|positionAlgorithm|Переопределение стандартного алгоритма размещения выноски. |**CalloutOptions.prototype.defaultPositionAlgorithm**<br/><br/>`function(calloutPositioningProxy) { ... }`|

В следующем разделе описано, как использовать объект `calloutPositioningProxy` для создания алгоритма размещения выноски.

### <a name="write-positioning-algorithms-with-calloutpositioningproxy"></a>Создание алгоритмов размещения с помощью calloutPositioningProxy

Объект `calloutPositioningProxy` содержит методы и свойства, которые можно использовать для переопределения стандартной логики размещения выноски. Например, чтобы этот элемент все время отображался ниже и правее элемента `launchPoint`, напишите алгоритм размещения, похожий на такой:

```js
function alwaysGoDownAndRight(calloutPositioningProxy)  {
    calloutPositioningProxy.moveDownAndRight();
} 

```

Затем вы передаете эту функцию в качестве значения члена  `positionAlgorithm` объекта `Callout`. Вы можете сделать это при создании  `Callout` или позднее, просто задав это значение.

```js
callout.set({positionAlgorithm: alwaysGoDownAndRight});

```

Вы всегда можете взглянуть на логическую схему размещения по умолчанию, запустив консоль JavaScript браузера (например, инструменты разработчика по F12 в Internet Explorer).

```js
CalloutOptions.prototype.positionAlgorithm.toString()
```

Вы можете программировать логику размещения с помощью указанных ниже методов объекта `CalloutPositioningProxy`.

|**Метод**|**Описание**|
|:-----|:-----|
|isCalloutTooFarTop()|Возвращает логическое значение.|
|isCalloutTooFarRight()|Возвращает логическое значение.|
|isCalloutTooFarBottom()|Возвращает логическое значение.|
|isCalloutTooFarLeft()|Возвращает логическое значение.|
|isCalloutLeftOfHardBoundingBox()|Возвращает логическое значение.<br/><br/>Если значение — **true**, левая часть элемента управления выходит за границы элемента контейнера. Она не видна, и пользователь не может получить к ней доступ с помощью прокрутки.|
|isCalloutRightOfHardBoundingBox()|Возвращает логическое значение.<br/><br/>Если значение — **true**, правая часть элемента управления выходит за границы элемента контейнера. Она не видна, и пользователь не может получить к ней доступ с помощью прокрутки.|
|isCalloutAboveHardBoundingBox()|Возвращает логическое значение.<br/><br/>Если значение — **true**, верхняя часть элемента управления выходит за границы элемента контейнера. Она не видна, и пользователь не может получить к ней доступ с помощью прокрутки.|
|isCalloutBelowHardBoundingBox()|Возвращает логическое значение.<br/><br/>Если значение — **true**, нижняя часть элемента управления выходит за границы элемента контейнера. Она не видна, и пользователь не может получить к ней доступ с помощью прокрутки.|
|isOrientedUp()|Возвращает логическое значение.|
|isOrientedDown()|Возвращает логическое значение.|
|isOrientedLeft()|Возвращает логическое значение.|
|isOrientedRight()|Возвращает логическое значение.|
|moveUpAndRight()|Ничего не возвращает.<br/><br/>Изменяет направление элемента управления.|
|moveUpAndLeft()|Ничего не возвращает.<br/><br/>Изменяет направление элемента управления.|
|moveDownAndRight()|Ничего не возвращает.<br/><br/>Изменяет направление элемента управления.|
|moveDownAndLeft()|Ничего не возвращает.<br/><br/>Изменяет направление элемента управления.|
|moveTowardsOppositeQuadrant()|Ничего не возвращает.<br/><br/>Изменяет направление элемента управления.|
|flipHorizontal()|Ничего не возвращает.<br/><br/>Изменяет направление элемента управления.|
|flipVertical()|Ничего не возвращает.<br/><br/>Изменяет направление элемента управления.|
|numberOfEdgesCollidingWithBoundingBox()|Возвращает целое число от 0 до 4, обозначающее число краев, которыми выноска соприкасается с видимым ограничивающим прямоугольником.<br/><br/>Например, если верхняя часть элемента управления обрезается верхним краем основной части документа после вызова метода `moveUpAndRight()`, метод `numberOfEdgesCollidingWithBoundingBox()` возвращает число, которое больше 1.|

Этот алгоритм размещения вынуждает элемент управления располагаться над текстом или под ним. Свойство  `isRTL` объекта `CalloutPositioningProxy` указывает, читается ли отображаемый текст справа налево. Проверяйте значение этого свойства, чтобы обеспечить правильное размещение элемента управления относительно текста на странице.

```js
function examplePositionAlgorithm(calloutPositioningProxy) {
    if (!calloutPositioningProxy.isRTL) {
        calloutPositioningProxy.moveDownAndRight();
        if (calloutPositioningProxy.isCalloutTooFarBottom()) {
            calloutPositioningProxy.moveUpAndRight();
        }
    }
    else {
        calloutPositioningProxy.moveDownAndLeft();
        if (calloutPositioningProxy.isCalloutTooFarBottom()) {
            calloutPositioningProxy.moveUpAndLeft();
        }
    }
}
callout.set({positionAlgorithm: examplePositionAlgorithm});

```

Этот алгоритм размещения изменяет стандартное направление элемента управления, указывая `downAndRight` вместо `upAndRight`, но при наличии конфликтов он использует стандартный алгоритм.

```js
function tryDownAndRightThenGoDefault(calloutPositioningProxy) {
    if (!calloutPositioningProxy.isRTL)
        calloutPositioningProxy.moveDownAndRight();
    else
        calloutPositioningProxy.moveDownAndLeft();
    
    if (calloutPositioningProxy.numberOfEdgesCollidingWithBoundingBox() > 0)
        return CalloutOptions.prototype.positionAlgorithm.apply(this, arguments);
};
callout.set({positionAlgorithm: tryDownAndRightThenGoDefault});

```


## <a name="see-also"></a>См. также
<a name="bk_addresources"> </a>

-  [Создание компонентов взаимодействия с пользователем в SharePoint](create-ux-components-in-sharepoint.md)
-  [Пример кода: использование представлений списков, выносок и диалоговых окон в надстройках с размещением в SharePoint](https://code.msdn.microsoft.com/office/SharePoint-2013-Use-list-cb3e4e14)
-  [Создание надстроек SharePoint с размещением в SharePoint](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md)
    
 

 

 
