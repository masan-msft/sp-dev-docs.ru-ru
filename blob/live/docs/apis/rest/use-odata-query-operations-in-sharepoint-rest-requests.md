---
title: "Использование операций запросов OData в запросах SharePoint REST"
ms.date: 09/25/2017
ms.prod: sharepoint
ms.openlocfilehash: 03cdeaa7015fa18d929f85e726723a0f522d158e
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2017
---
# <a name="use-odata-query-operations-in-sharepoint-rest-requests"></a><span data-ttu-id="183a7-102">Использование операций запросов OData в запросах SharePoint REST</span><span class="sxs-lookup"><span data-stu-id="183a7-102">Use OData query operations in SharePoint REST requests</span></span>
<span data-ttu-id="183a7-103">Узнайте, как использовать широкий спектр операторов строки запроса OData для выбора, фильтрации и упорядочивания данных, запрашиваемых у службы REST SharePoint.</span><span class="sxs-lookup"><span data-stu-id="183a7-103">Learn how to use a wide range of OData query string operators to select, filter, and order the data you request from the SharePoint REST service.</span></span> 
 
 <span data-ttu-id="183a7-104">**Перед началом работы**</span><span class="sxs-lookup"><span data-stu-id="183a7-104">**Before you start**</span></span>
-  [<span data-ttu-id="183a7-105">Знакомство со службой REST в SharePoint</span><span class="sxs-lookup"><span data-stu-id="183a7-105">Get to know the SharePoint REST service</span></span>](get-to-know-the-sharepoint-rest-service.md)
-  [<span data-ttu-id="183a7-106">Навигация по структуре данных SharePoint, представленной в службе REST</span><span class="sxs-lookup"><span data-stu-id="183a7-106">Navigate the SharePoint data structure represented in the REST service</span></span>](navigate-the-sharepoint-data-structure-represented-in-the-rest-service.md)
-  [<span data-ttu-id="183a7-107">Определение универсальных кодов ресурсов (URI) конечных точек службы SharePoint REST</span><span class="sxs-lookup"><span data-stu-id="183a7-107">Determine SharePoint REST service endpoint URIs</span></span>](determine-sharepoint-rest-service-endpoint-uris.md)
    
<span data-ttu-id="183a7-108">Служба REST SharePoint поддерживает широкий диапазон операторов строки запроса OData, который позволяет выбирать, фильтровать и упорядочивать запрашиваемые данные.</span><span class="sxs-lookup"><span data-stu-id="183a7-108">The SharePoint REST service supports a wide range of OData query string operators that enable you to select, filter, and order the data you request.</span></span>
 
 <span data-ttu-id="183a7-p101">**Совет.** Служба REST в SharePoint Online (а также в локальной среде SharePoint 2016 или более поздней версии) поддерживает объединение нескольких запросов в один вызов с помощью параметра запроса OData `$batch`. Подробные сведения и ссылки на примеры кода см. в статье [Создание пакетного запроса с помощью интерфейсов REST API](make-batch-requests-with-the-rest-apis.md).</span><span class="sxs-lookup"><span data-stu-id="183a7-p101">**Tip**  The SharePoint Online (and on-premise SharePoint 2016 and later) REST service supports combining multiple requests into a single call to the service by using the OData  `$batch` query option. For details and links to code samples, see [Make batch requests with the REST APIs](make-batch-requests-with-the-rest-apis.md).</span></span>
 
## <a name="select-fields-to-return"></a><span data-ttu-id="183a7-111">Выбор полей для возврата</span><span class="sxs-lookup"><span data-stu-id="183a7-111">Select fields to return</span></span>
<span data-ttu-id="183a7-p102">С помощью параметра запроса [$select](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#SelectSystemQueryOption) укажите, какие поля необходимо возвращать для списка, элемента списка или другого объекта SharePoint, представленного набором сущностей. Для возврата всех доступных полей используйте запрос `$select=*`</span><span class="sxs-lookup"><span data-stu-id="183a7-p102">Use the  [$select](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#SelectSystemQueryOption) query option to specify which fields to return for a given list, list item, or other SharePoint object represented by an entity set. You can use `$select=*` to return all available fields.</span></span>
 
> [!NOTE]
> <span data-ttu-id="183a7-114">Как правило, если вы не указываете параметр запроса `$select`, служба REST по умолчанию возвращает все доступные поля.</span><span class="sxs-lookup"><span data-stu-id="183a7-114">In general, if you do not specify the  `$select` query option, the REST service returns all available fields by default.</span></span> <span data-ttu-id="183a7-115">Но иногда некоторые объекты SharePoint включают свойства, для получения которых требуется очень много ресурсов. Чтобы оптимизировать работу службы REST, эти свойства не включаются в запрос по умолчанию. Их следует запрашивать специально. Например, свойство **SPWeb.EffectiveBasePermissions** по умолчанию не возвращается, его необходимо запросить с помощью параметра запроса `$select`.</span><span class="sxs-lookup"><span data-stu-id="183a7-115">Note  In general, if you do not specify the   query option, the REST service returns all available fields by default. However, in a few cases, some SharePoint objects include properties that are very resource intensive to retrieve; to optimize REST service performance, these properties are not included in the default query, and must be explicitly requested.For example, the  **SPWeb.EffectiveBasePermissions** property is not returned by default, and must be explicitly requested using the `$select` query option.</span></span>
 
<span data-ttu-id="183a7-p104">Кроме того, можно сделать так, чтобы возвращались планируемые поля из других списков и значения подстановки. Для этого укажите имя поля в параметрах запроса `$select` и `$expand`. Пример:</span><span class="sxs-lookup"><span data-stu-id="183a7-p104">In addition, you can specify that the request returns projected fields from other lists and the values of lookups. To do this, specify the field name in both the  `$select` and `$expand` query options. For example:</span></span>
 
 `http://server/site/_api/web/lists('guid')/items?$select=Title,Products/Name&amp;$expand=Products/Name`
 
<span data-ttu-id="183a7-119">Массовое расширение и выбор связанных элементов не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="183a7-119">Bulk expansion and selection of related items is not supported.</span></span>
 
## <a name="select-items-to-return"></a><span data-ttu-id="183a7-120">Выбор элементов для возврата</span><span class="sxs-lookup"><span data-stu-id="183a7-120">Select items to return</span></span>
<span data-ttu-id="183a7-p105">С помощью параметра запроса [$filter](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#FilterSystemQueryOption) укажите, какие элементы необходимо возвращать. В разделе [Операторы запросов OData, поддерживаемые в службе SharePoint REST](#bk_supported) указаны параметры сравнения и функции для фильтрации запросов, которые можно использовать в службе SharePoint REST.</span><span class="sxs-lookup"><span data-stu-id="183a7-p105">Use the  [$filter](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#FilterSystemQueryOption) query option to select which items to return. [OData query operators supported in the SharePoint REST service](#bk_supported) lists the filter query comparison options and functions you can use with the SharePoint REST service.</span></span>

## <a name="query-for-single-value-lookup-fields"></a><span data-ttu-id="183a7-123">Запрос полей подстановки с одним значением</span><span class="sxs-lookup"><span data-stu-id="183a7-123">Query for single value lookup fields</span></span>
<span data-ttu-id="183a7-p106">Поля подстановки одиночного значения представлены двумя отдельными полями в службе REST SharePoint: одно поле представляет фактическое значение поля, а другое — имя поля. Вы можете выполнять запросы значения поля подстановки так же, как для любого другого поля этого типа данных. Например, если значением поля подстановки является строка, вы можете использовать в вашем запросе параметры сравнения строк.</span><span class="sxs-lookup"><span data-stu-id="183a7-p106">Single value lookup fields are represented by two separate fields in the SharePoint REST service: one field representing the actual field value, and another representing the field name. You can perform queries against the lookup field value as you would any other field of that data type. For example, if the lookup field value is a string, you can use string comparison options in your query.</span></span>

## <a name="query-for-users"></a><span data-ttu-id="183a7-127">Запрос пользователей</span><span class="sxs-lookup"><span data-stu-id="183a7-127">Query for users</span></span>
<span data-ttu-id="183a7-p107">В службе REST SharePoint пользователи представлены понятным (отображаемым) именем пользователя, а не их псевдонимами или комбинацией домена и псевдонима. Следовательно, вам необходимо сформировать запросы к понятным именам пользователей.</span><span class="sxs-lookup"><span data-stu-id="183a7-p107">In the SharePoint REST service, users are represented by the user's friendly (display) name, and not their alias or domain\alias combination. Therefore, you must construct user queries against users' friendly names.</span></span>

> [!NOTE]
> <span data-ttu-id="183a7-130">Запросы пользователей с учетом членства не поддерживаются. Указание оператора **Current** для выполнения запросов с применением идентификатора текущего пользователя не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="183a7-130">Note  Membership-based user queries are not supported.Usage of the  **Current** operator to do queries using the ID of the current user is not supported.</span></span>

## <a name="query-for-multi-value-lookup-fields-and-users"></a><span data-ttu-id="183a7-131">Запрашивание полей подстановки с несколькими значениями и пользователей</span><span class="sxs-lookup"><span data-stu-id="183a7-131">Query for multi-value lookup fields and users</span></span>
<span data-ttu-id="183a7-132">Так как поля подстановки с несколькими значениями возвращаются в виде строки из нескольких значений, то их нельзя запросить (например, эквивалент элемента **Includes** или элемента **NotIncludes** не поддерживается).</span><span class="sxs-lookup"><span data-stu-id="183a7-132">Because multi-value lookup fields are returned as a string of multiple values, there is no way to query for them (for example, the equivalent of an  **Includes** element or **NotIncludes** element is not supported).</span></span>

## <a name="sort-returned-items"></a><span data-ttu-id="183a7-133">Сортировка результатов</span><span class="sxs-lookup"><span data-stu-id="183a7-133">Sort returned items</span></span>
<span data-ttu-id="183a7-p108">Используйте параметр [$orderby](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#OrderBySystemQueryOption), чтобы указать, как сортировать результаты запроса. Чтобы сортировать результаты по нескольким полям, укажите список полей через запятую. Вы также можете указать, в каком порядке нужно сортировать элементы (по возрастанию или по убыванию), добавив к запросу ключевое слово **asc** или **desc**.</span><span class="sxs-lookup"><span data-stu-id="183a7-p108">Use the  [$orderby](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#OrderBySystemQueryOption) query option to specify how to sort the items in your query return set. To sort by multiple fields, specify a comma-separated list of fields. You can also specify whether to sort the items in ascending or descending order by appending the **asc** or **desc** keyword to your query.</span></span>

## <a name="page-through-returned-items"></a><span data-ttu-id="183a7-137">Постраничное разбиение результатов</span><span class="sxs-lookup"><span data-stu-id="183a7-137">Page through returned items</span></span>
<span data-ttu-id="183a7-138">С помощью параметров запроса [$top](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#TopSystemQueryOption) и [$skiptoken](http://msdn.microsoft.com/library/dd942121.aspx) выберите часть элементов, которую нужно исключить из результатов запроса.</span><span class="sxs-lookup"><span data-stu-id="183a7-138">Use the  [$top](http://www.odata.org/documentation/odata-version-2-0/uri-conventions#TopSystemQueryOption) and [$skiptoken](http://msdn.microsoft.com/library/dd942121.aspx) query options to select a subset of the items that would otherwise be returned by your query.</span></span>

> [!NOTE]
> <span data-ttu-id="183a7-139">Параметр запроса $skip не работает с запросами для элементов списков SharePoint.</span><span class="sxs-lookup"><span data-stu-id="183a7-139">The $skip query option does not work with queries for SharePoint list items.</span></span>

<span data-ttu-id="183a7-p109">Параметр  `$top` позволяет выбрать первые *n*  элементов набора возврата для получения. Например, следующий URI запрашивает возврат только первых десяти элементов из потенциального набора результатов:</span><span class="sxs-lookup"><span data-stu-id="183a7-p109">The  `$top` option enables you to select the first *n*  items of the return set for return. For example, the following URI requests that only the first ten items in the prospective return set actually be returned:</span></span>
 
 `http://server/site/_api/web/lists('<guid>')/items$top=10`
 
<span data-ttu-id="183a7-142">Параметр $skiptoken позволяет пропустить указанное количество элементов и получить остальные.</span><span class="sxs-lookup"><span data-stu-id="183a7-142">The $skiptoken option enables you to skip over items until the specified item is reached and return the rest.</span></span>
 
 `$skiptoken=Paged=TRUE&amp;p_ID=5`

> [!NOTE]
> <span data-ttu-id="183a7-p110">При использовании этих параметров запроса следует учитывать, что постраничное разбиение в OData выполняется по порядку. Предположим, что вы реализуете кнопку следующей страницы для отображения элементов списка SharePoint. Вы используете службу REST, чтобы кнопка возвращала элементы с 1 по 20, затем элементы с 21 по 40 и так далее. Однако, предположим, что другой пользователь удаляет элемент 4 и 18 между нажатиями кнопки "Далее". В этом случае порядковое размещение остающихся элементов сбрасывается и при отображении элементов с 21 по 40 фактически пропускаются два элемента.</span><span class="sxs-lookup"><span data-stu-id="183a7-p110">When using these query options, take into account that paging in OData is ordinal. For example, suppose you are implementing a next page button to display SharePoint list items. You use the REST service to enable the button to return items 1 through 20 when clicked, then items 21 through 40, and so on. However, suppose another user deletes items 4 and 18 between clicks of the next button. In such a case, the ordinal positioning of the remaining items is reset, and displaying items 21 through 40 actually skips over two items.</span></span>
 
## <a name="odata-query-operators-supported-in-the-sharepoint-rest-service"></a><span data-ttu-id="183a7-148">Операторы запросов OData, поддерживаемые в службе SharePoint REST</span><span class="sxs-lookup"><span data-stu-id="183a7-148">OData query operators supported in the SharePoint REST service</span></span>
<span data-ttu-id="183a7-149"><a name="bk_supported"> </a></span><span class="sxs-lookup"><span data-stu-id="183a7-149"></span></span>

|<span data-ttu-id="183a7-150">**Поддерживаются**</span><span class="sxs-lookup"><span data-stu-id="183a7-150">**Supported**</span></span>|<span data-ttu-id="183a7-151">**Не поддерживаются**</span><span class="sxs-lookup"><span data-stu-id="183a7-151">**Not supported**</span></span>|
|:-----|:-----|
|<span data-ttu-id="183a7-152">**Числовые сравнения** Lt Le Gt Ge Eq Ne</span><span class="sxs-lookup"><span data-stu-id="183a7-152">**Numeric comparisons** Lt Le Gt Ge Eq Ne</span></span>| <span data-ttu-id="183a7-153">Арифметические операторы (Add, Sub, Mul, Div, Mod) Базовые математические функции (округление, пол, потолок)</span><span class="sxs-lookup"><span data-stu-id="183a7-153">Arithmetic operators  (Add, Sub, Mul, Div, Mod) Basic math functions (round, floor, ceiling)</span></span> |
|<span data-ttu-id="183a7-154">**Сравнение строк** startsWith substringof Eq Ne</span><span class="sxs-lookup"><span data-stu-id="183a7-154">**String comparisons** startsWith substringof Eq Ne</span></span>| <span data-ttu-id="183a7-155">endsWith replace substring tolower toupper trim concat</span><span class="sxs-lookup"><span data-stu-id="183a7-155">endsWith replace substring tolower toupper trim concat</span></span>|
|<span data-ttu-id="183a7-156">**Функции даты и времени** day() month() year() hour() minute() second()</span><span class="sxs-lookup"><span data-stu-id="183a7-156">**Date and time functions** day() month() year() hour() minute() second()</span></span>| <span data-ttu-id="183a7-157">Оператор DateTimeRangesOverlap Запросы относительно того, относится ли дата и время к временному шаблону</span><span class="sxs-lookup"><span data-stu-id="183a7-157">DateTimeRangesOverlap operator Querying as to whether a date time falls inside a recurrent date time pattern</span></span>|
<span data-ttu-id="183a7-158">На следующем рисунке показаны поддерживаемые параметры запроса OData.</span><span class="sxs-lookup"><span data-stu-id="183a7-158">The figure below shows the supported OData query options.</span></span>
 
<span data-ttu-id="183a7-159">**Поддерживаемые параметры запроса OData**</span><span class="sxs-lookup"><span data-stu-id="183a7-159">**Supported OData query options**</span></span>

![Синтаксис параметров запроса для службы REST SharePoint](../../images/REST_queryOptionSyntax.png)

## <a name="see-also"></a><span data-ttu-id="183a7-161">См. также</span><span class="sxs-lookup"><span data-stu-id="183a7-161">See also</span></span>
<span data-ttu-id="183a7-162"><a name="bk_addresources"> </a></span><span class="sxs-lookup"><span data-stu-id="183a7-162"></span></span>

-  [<span data-ttu-id="183a7-163">Знакомство со службой REST в SharePoint</span><span class="sxs-lookup"><span data-stu-id="183a7-163">Get to know the SharePoint REST service</span></span>](get-to-know-the-sharepoint-rest-service.md)
-  [<span data-ttu-id="183a7-164">Выполнение базовых операций с использованием конечных точек SharePoint REST</span><span class="sxs-lookup"><span data-stu-id="183a7-164">Complete basic operations using SharePoint REST endpoints</span></span>](complete-basic-operations-using-sharepoint-rest-endpoints.md)
-  [<span data-ttu-id="183a7-165">Работа со списками и элементами списков в интерфейсе REST</span><span class="sxs-lookup"><span data-stu-id="183a7-165">Working with lists and list items with REST</span></span>](working-with-lists-and-list-items-with-rest.md)
-  [<span data-ttu-id="183a7-166">Работа с папками и файлами в службе REST</span><span class="sxs-lookup"><span data-stu-id="183a7-166">Working with folders and files with REST</span></span>](working-with-folders-and-files-with-rest.md)
-  [<span data-ttu-id="183a7-167">Навигация по структуре данных SharePoint, представленной в службе REST</span><span class="sxs-lookup"><span data-stu-id="183a7-167">Navigate the SharePoint data structure represented in the REST service</span></span>](navigate-the-sharepoint-data-structure-represented-in-the-rest-service.md)
-  [<span data-ttu-id="183a7-168">Определение универсальных кодов ресурсов (URI) конечных точек службы SharePoint REST</span><span class="sxs-lookup"><span data-stu-id="183a7-168">Determine SharePoint REST service endpoint URIs</span></span>](determine-sharepoint-rest-service-endpoint-uris.md)
-  [<span data-ttu-id="183a7-169">Справочные материалы по интерфейсу API службы REST и примеры</span><span class="sxs-lookup"><span data-stu-id="183a7-169">REST API reference and samples</span></span>](http://msdn.microsoft.com/library/02128c70-9d27-4388-9374-a11bce68fdb8%28Office.15%29.aspx)