---
title: "Изолированная преобразования руководство по решениям для-InfoPath"
ms.date: 11/03/2017
ms.openlocfilehash: 62a6d4015cbfba99468d47ac11aa1a8cd8271fb0
ms.sourcegitcommit: 65e885f547ca9055617fe0871a13c7fc85086032
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2017
---
# <a name="sandbox-solution-transformation-guidance---infopath"></a><span data-ttu-id="1ad0d-102">Изолированная преобразования руководство по решениям для-InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-102">Sandbox solution transformation guidance - InfoPath</span></span>
<span data-ttu-id="1ad0d-103">При использовании форм InfoPath с кодом, а затем зависят от этих форм InfoPath на основе кода изолированных решений для выполнения кода.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-103">When you're using InfoPath forms with code-behind then these InfoPath forms do depend on code-based sandbox solutions for executing the code-behind.</span></span> <span data-ttu-id="1ad0d-104">Эта статья поможет вам устранить или преобразования формы InfoPath, чтобы больше не зависимости решения не изолированной среды.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-104">This article will help you to either fix or transform your InfoPath forms so that there's no sandbox solution dependency anymore.</span></span>

<span data-ttu-id="1ad0d-105">_**Применимо к:** Формы InfoPath для SharePoint Online | SharePoint 2013 | SharePoint 2016_</span><span class="sxs-lookup"><span data-stu-id="1ad0d-105">_**Applies to:** InfoPath forms for SharePoint Online | SharePoint 2013 | SharePoint 2016_</span></span>

<span data-ttu-id="1ad0d-106">SharePoint online и изолированной среды на основе кода решения, [рекомендуется использовать](https://blogs.msdn.microsoft.com/sharepointdev/2014/01/14/deprecation-of-custom-code-in-sandboxed-solutions/) обратно в 2014 г запущен процесс, чтобы полностью удалить эту возможность.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-106">Code-based sandbox solutions [were deprecated](https://blogs.msdn.microsoft.com/sharepointdev/2014/01/14/deprecation-of-custom-code-in-sandboxed-solutions/) back in 2014 and SharePoint online has started the process to completely remove this capability.</span></span> <span data-ttu-id="1ad0d-107">На основе кода изолированных решений также являются устаревшими в SharePoint 2013 и в SharePoint 2016.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-107">Code-based sandbox solutions are also deprecated in SharePoint 2013 and in SharePoint 2016.</span></span>

## <a name="analyze-and-if-possible-fix-your-infopath-forms"></a><span data-ttu-id="1ad0d-108">Анализ и по возможности исправить формы InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-108">Analyze and if possible fix your InfoPath forms</span></span>
<span data-ttu-id="1ad0d-109"><a name="sectionSection1"> </a></span><span class="sxs-lookup"><span data-stu-id="1ad0d-109"></span></span>

<span data-ttu-id="1ad0d-110">В этом разделе мы покажем анализ и устранение модель, можно применить к формы InfoPath.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-110">In this section we show you an analysis and fixing model that you can apply to your InfoPath forms.</span></span> <span data-ttu-id="1ad0d-111">В зависимости от формы можно просто **исправить** формы и снова развернуть ее или при необходимости **переместить вне InfoPath** и использовать альтернативный подход в полной мере реализовать необходимые функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-111">Depending on your form you can simply **fix** the form and redeploy it or you need to **move away from InfoPath** and use an alternative approach to realize the needed functionality.</span></span> <span data-ttu-id="1ad0d-112">Однако перед выполнением этих действий **необходимо Оценка потребности бизнеса в форме**: мы часто увидеть часто старых форм, которые не являются бизнес-соответствующих больше и в этих случаях проще просто удалить форму.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-112">However before taking those actions **it's important to assess the business need for your form**: we often see a lot of old forms which are not business relevant anymore and in those cases it's easier to simply drop the form.</span></span> 

### <a name="how-do-i-know-that-ive-infopath-forms-with-code-behind"></a><span data-ttu-id="1ad0d-113">Как узнать, что у меня есть форм InfoPath с выделенным кодом</span><span class="sxs-lookup"><span data-stu-id="1ad0d-113">How do I know that I've InfoPath forms with code behind?</span></span>
<span data-ttu-id="1ad0d-114">Рекомендуется, для использования **[средства сканера изолированные решения SharePoint](https://github.com/SharePoint/PnP-Tools/tree/master/Solutions/SharePoint.SandBoxTool)** в качестве отчета из этой программы появится сообщение о том Если изолированные решения поступает из файла InfoPath.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-114">The recommended option is to use the **[SharePoint SandBox Solution scanner tool](https://github.com/SharePoint/PnP-Tools/tree/master/Solutions/SharePoint.SandBoxTool)** as the report from this tool will indicate if the sandbox solution is coming from an InfoPath file.</span></span> <span data-ttu-id="1ad0d-115">Кроме того средство также сообщит вам, если используемые сборки в решении «бесполезная», как описано далее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-115">Additionally the tool will also tell you if the used assembly in the solution is "useless" as described later on in this article.</span></span>

### <a name="are-my-forms-still-relevant"></a><span data-ttu-id="1ad0d-116">Относятся Мои формы по-прежнему?</span><span class="sxs-lookup"><span data-stu-id="1ad0d-116">Are my forms still relevant?</span></span>
<span data-ttu-id="1ad0d-117">Перед освоение рабочих исправлению или преобразования важно вопрос: важна эту форму по-прежнему для бизнес.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-117">Before diving into the remediation/transformation work it's important to ask the question: is this form still critical for my business.</span></span> <span data-ttu-id="1ad0d-118">Если та, перейдите к следующей главе, если не вы должны помнить о данных, созданных с помощью этой формы.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-118">If so then please continue to the next chapter, if not you need to think about the data created using this form.</span></span> <span data-ttu-id="1ad0d-119">Обычно данных был создан как InfoPath XML-файлы которого live в списке SharePoint.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-119">Typically the data was created as InfoPath XML files which live in a SharePoint list.</span></span> <span data-ttu-id="1ad0d-120">При удалении формы вы не сможете больше визуализировать данные: в некоторых случаях это нормально, поскольку формы и данные не учитываются больше, но в случае, если требуется разрешить доступ к данным можно преобразовать InfoPath XML-файлы данных списка (элементы) SharePoint.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-120">If you remove the form you'll not be able to visualize the data anymore: sometimes that's fine since form and data are not relevant anymore but in case you want to ensure access to the data you can convert the InfoPath XML files to SharePoint list (items) data.</span></span> <span data-ttu-id="1ad0d-121">[Репозиторий PnP модернизации содержит пример, в котором показано, как это можно сделать](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Migration/EmpRegConsole "образец, показывающих, как для преобразования из InfoPath из XML в данные списка").</span><span class="sxs-lookup"><span data-stu-id="1ad0d-121">The [PnP-Transformation repository contains a sample showing how you can achieve this](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Migration/EmpRegConsole "Sample showing how to transform from InfoPath XML to list data").</span></span>

### <a name="downloading-the-infopath-form-xsn-file-for-inspection"></a><span data-ttu-id="1ad0d-122">Загрузка форм InfoPath (XSN-файл) для проверки</span><span class="sxs-lookup"><span data-stu-id="1ad0d-122">Downloading the InfoPath form (XSN file) for inspection</span></span>
<span data-ttu-id="1ad0d-123">В шаге раздела, подтверждения, что у вас есть форм InfoPath, которые требуют работы в этом разделе вы научитесь загрузить эти формы.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-123">In the section step you've confirmed that you have InfoPath forms that require work, in this section you'll learn how to download these forms.</span></span> <span data-ttu-id="1ad0d-124">Формы InfoPath с кодом программной части, либо развернуты как «Библиотека форм» или «Тип содержимого узла».</span><span class="sxs-lookup"><span data-stu-id="1ad0d-124">InfoPath forms with code behind are either deployed as "Form Library" or as "Site Content Type".</span></span> <span data-ttu-id="1ad0d-125">В зависимости от выбранного модель публикации вы можете загрузить форм следующим образом.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-125">Depending on the chosen publishing model you can download the forms as follows.</span></span>

#### <a name="download-form-library-deployed-infopath-forms"></a><span data-ttu-id="1ad0d-126">Файл для загрузки «библиотека форм» развертывание форм InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-126">Download "Form Library" deployed InfoPath forms</span></span>
<span data-ttu-id="1ad0d-127">В этом случае файла XSN находится внутри папки форм библиотеки форм, в который был развернут форм InfoPath.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-127">In this case the XSN file is inside the Forms folder of the form library to which the InfoPath form was deployed.</span></span> <span data-ttu-id="1ad0d-128">Знакомство с библиотекой форм может занять внимание на имя пакета WSP как если бы образом это соглашение о: «InfoPath Form_**LibName**_id».</span><span class="sxs-lookup"><span data-stu-id="1ad0d-128">To know the form library you can take a look at the WSP package name as if follows this convention: "InfoPath Form_**LibName**_id".</span></span> <span data-ttu-id="1ad0d-129">Поэтому при наличии библиотеки необходимо загрузить файл template.xsn из папки форм библиотеки.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-129">So once you have the library you need to download the template.xsn file from the Forms folder of the library.</span></span> <span data-ttu-id="1ad0d-130">Это можно сделать, создав url-адресу следующего вида: **URL-адрес библиотеки + «Forms/template.xsn»** , как показано в этом примере `https://contoso.sharepoint.com/sites/infopath1/IHaveCodeBehind/Forms/template.xsn` и использование браузера для загрузки файла.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-130">You can do so by constructing an url like this: **library url + "Forms/template.xsn"** like shown in this sample `https://contoso.sharepoint.com/sites/infopath1/IHaveCodeBehind/Forms/template.xsn` and using the browser to download the file.</span></span>

#### <a name="download-site-content-type-deployed-infopath-forms"></a><span data-ttu-id="1ad0d-131">Файл для загрузки «тип содержимого узла» развертывание форм InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-131">Download "Site Content Type" deployed InfoPath forms</span></span>
<span data-ttu-id="1ad0d-132">Формы InfoPath, развернутые в виде типа контента имеют их XSN файлов, хранящихся в библиотеке форм, который был подключен к типу контента, как время развертывания формы.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-132">InfoPath forms deployed as content type do have their XSN file stored in a form library which was connected to the content type as form deployment time.</span></span> <span data-ttu-id="1ad0d-133">Как и в предыдущем разделе может получить имя библиотеки из WSP имя пакета.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-133">Like in the previous section you can obtain the library name from the WSP package name.</span></span> <span data-ttu-id="1ad0d-134">Каковы отличия, настоящее время —, что форма хранится в виде файла в библиотеке обнаруженного так просто можно загрузить из библиотеки форм.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-134">What's different this time is that the form is actually stored as a file in the found library, so you can simply download it from the form library.</span></span> 

### <a name="fixing-your-infopath-forms"></a><span data-ttu-id="1ad0d-135">Исправление форм InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-135">Fixing your InfoPath forms</span></span>
<span data-ttu-id="1ad0d-136">Предыдущих разделах показано записи с учетом форм InfoPath с выделенным кодом, но они действительно содержат полезные кода?</span><span class="sxs-lookup"><span data-stu-id="1ad0d-136">Previous sections have shown and given you the InfoPath forms with code behind but do they really contain useful code behind?</span></span> <span data-ttu-id="1ad0d-137">Что мы указано, что существует много форм, для которых автор формы случайно нажатии на кнопке **Редактор кода** в ленте **для разработчиков** InfoPath:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-137">What we see is that there's quite a lot of forms for which the form author accidentally clicked on the **Code Editor** button in the **Developer** ribbon of InfoPath:</span></span>

![Фоновый код InfoPath](media/Sandbox-Solution-Transformation-Guidance-InfoPath/InfoPathCodeBehind.png)

<span data-ttu-id="1ad0d-139">После этого вам придется фоновый код..., но этот код за не делает ничего и путем удаления можно преобразовать форму InfoPath с кодом программной части регулярного форму InfoPath, которая не имеет кода фонового и таким образом не зависимости на изолированные решения!</span><span class="sxs-lookup"><span data-stu-id="1ad0d-139">Once you've done this you'll have code behind...but this code behind is not doing anything and by removing it you can convert your InfoPath form with code behind to a regular InfoPath form which has no code behind and as such no dependency on sandbox solutions!</span></span>

#### <a name="how-do-i-know-the-code-behind-is-useless"></a><span data-ttu-id="1ad0d-140">Как узнать, что с выделенным кодом «бесполезная»?</span><span class="sxs-lookup"><span data-stu-id="1ad0d-140">How do I know the code behind is "useless"?</span></span>
<span data-ttu-id="1ad0d-141">[Изолированные решения SharePoint сканера](https://github.com/SharePoint/PnP-Tools/tree/master/Solutions/SharePoint.SandBoxTool) сообщит вам, если InfoPath имеет смысла кода, но если вы хотите Дополнительные сведения и продолжите чтение.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-141">The [SharePoint Sandbox Solution scanner](https://github.com/SharePoint/PnP-Tools/tree/master/Solutions/SharePoint.SandBoxTool) will tell you if your InfoPath has useless code, but if you want to learn more then continue reading.</span></span> <span data-ttu-id="1ad0d-142">Могут возникнуть как для различения фоновый код бесполезная и необходимые как может устранять только первой категории.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-142">You might wonder how to distinguish between useless and needed code behind as you can only fix the first category.</span></span> <span data-ttu-id="1ad0d-143">При наличии исходного развернутое формы (поэтому не по одному, загруженный в предыдущих действиях) по-прежнему можно создать взглянуть на код.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-143">If you still have the original deployed form (so not the one you've downloaded in previous steps) you can simply have a peek at the code.</span></span> <span data-ttu-id="1ad0d-144">Ниже показан пустой кода по умолчанию, и те, кто следующего кода нажмите эту форму можно устранить, удалив код:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-144">The default empty code is shown below and if you've similar code then this form can be fixed by dropping the code:</span></span>

```C#
using Microsoft.Office.InfoPath;
using System;
using System.Xml;
using System.Xml.XPath;

namespace Form1
{
    public partial class FormCode
    {
        // Member variables are not supported in browser-enabled forms.
        // Instead, write and read these values from the FormState
        // dictionary using code such as the following:
        //
        // private object _memberVariable
        // {
        //     get
        //     {
        //         return FormState["_memberVariable"];
        //     }
        //     set
        //     {
        //         FormState["_memberVariable"] = value;
        //     }
        // }

        // NOTE: The following procedure is required by Microsoft InfoPath.
        // It can be modified using Microsoft InfoPath.
        public void InternalStartup()
        {
        }
    }
}
```

<span data-ttu-id="1ad0d-145">В случае, если имеется только файл XSN, который загружена во время предыдущего действия, которые можно переименовать файл XSN CAB-файлу (например template.cab), извлечение сборки и с помощью средств отражения .net (как и открытым кодом [ILSpy](http://ilspy.net/ "ILSpy .NET открытым исходным кодом браузер сборки и декомпилятор")) для проверки кода.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-145">In case you only have the XSN file which you've downloaded in the previous step you can rename your XSN file to a cab file (e.g. template.cab), extract the assembly and use .Net reflection tools (like the open source [ILSpy](http://ilspy.net/ "ILSpy is the open-source .NET assembly browser and decompiler")) to inspect the code.</span></span> <span data-ttu-id="1ad0d-146">Стандартные представления бесполезная фоновый код выглядит следующим образом в ILSpy:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-146">A typical view of useless code behind looks like this in ILSpy:</span></span>

![Бесполезная кода по результатам ILSpy](media/Sandbox-Solution-Transformation-Guidance-InfoPath/ilspyoutput.png)

#### <a name="dropping-code-behind-from-infopath-forms-to-fix-them"></a><span data-ttu-id="1ad0d-148">Удаление фоновый код из формы InfoPath их устранения</span><span class="sxs-lookup"><span data-stu-id="1ad0d-148">Dropping code behind from InfoPath forms to fix them</span></span>
<span data-ttu-id="1ad0d-149">Если подтверждает, что ваш код не имеет смысла можно легко поместите его:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-149">If you've confirmed your code behind is useless you can easily drop it by:</span></span>
- <span data-ttu-id="1ad0d-150">Открытие формы в **InfoPath designer** (щелкните правой кнопкой мыши-структуры)</span><span class="sxs-lookup"><span data-stu-id="1ad0d-150">Opening up the form in **InfoPath designer** (right-click - Design)</span></span>
- <span data-ttu-id="1ad0d-151">Перейдите на **Параметры формы** с помощью файла - Info</span><span class="sxs-lookup"><span data-stu-id="1ad0d-151">Go to **Form Options** via File - Info</span></span>
- <span data-ttu-id="1ad0d-152">Выберите категорию **по программированию** и выберите команду **Удалить код**</span><span class="sxs-lookup"><span data-stu-id="1ad0d-152">Select the **Programming** category and click on **Remove Code**</span></span>
- <span data-ttu-id="1ad0d-153">**Публикация формы еще раз** с помощью файла - Info - Быстрая публикация</span><span class="sxs-lookup"><span data-stu-id="1ad0d-153">**Publish the form again** via File - Info - Quick Publish</span></span>
- <span data-ttu-id="1ad0d-154">**Отключение связанных изолированные решения** с помощью параметров веб - решений</span><span class="sxs-lookup"><span data-stu-id="1ad0d-154">**Deactivate the linked sandbox solution** via Site Settings - Solutions</span></span>
- <span data-ttu-id="1ad0d-155">**Подтверждение** формы работает, как ожидалось</span><span class="sxs-lookup"><span data-stu-id="1ad0d-155">**Confirm** the form works as expected</span></span>
- <span data-ttu-id="1ad0d-156">**Удаление** изолированного решения</span><span class="sxs-lookup"><span data-stu-id="1ad0d-156">**Delete** the sandbox solution</span></span>

<span data-ttu-id="1ad0d-157">Если у вас нет доступа к InfoPath XSN файла и исходный код больше **по-прежнему можно устранить эти формы посредством просто отключения изолированные решения, которые имеют только код «бесполезная»**.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-157">If you don't have access to the InfoPath XSN file and source code anymore **you can still fix these forms by simply deactivating the sandbox solutions that have "useless" code only**.</span></span> <span data-ttu-id="1ad0d-158">Делать это только для из них, упомянутые в выходные данные отчета решения изолированной среды с IsEmptyInfoPathAssembly = true.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-158">Only do this for the ones mentioned in the sandbox solution report output with IsEmptyInfoPathAssembly = true.</span></span>

## <a name="migrate-your-infopath-forms"></a><span data-ttu-id="1ad0d-159">Перенос форм InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-159">Migrate your InfoPath forms</span></span>
<span data-ttu-id="1ad0d-160"><a name="sectionSection2"></a> Инструкции в предыдущей главе не применима для формы InfoPath его по сути означает, что форма будет по-прежнему business соответствующих и содержит код, который нельзя удалить.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-160"><a name="sectionSection2"> </a> If the guidance in the previous chapter was not applicable for your InfoPath form it essentially means your form is still business relevant and contains code behind that you cannot drop.</span></span> <span data-ttu-id="1ad0d-161">Если это так типичное решение удаляется от InfoPath, который может выполняться разными способами:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-161">If that's the case the typical solution is moving away from InfoPath which can be done in various ways:</span></span>
- <span data-ttu-id="1ad0d-162">Создание приложения с помощью [Azure PowerApps](https://powerapps.microsoft.com/en-us/ "Azure PowerApps") или [Microsoft поток](https://flow.microsoft.com/en-us/search/?q=sharepoint "Поток Microsoft")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-162">Create an app using [Azure PowerApps](https://powerapps.microsoft.com/en-us/ "Azure PowerApps") or [Microsoft Flow](https://flow.microsoft.com/en-us/search/?q=sharepoint "Microsoft Flow")</span></span> 

![Microsoft потока и Azure PowerApps](media/Sandbox-Solution-Transformation-Guidance-InfoPath/powerappsflow.png)

- <span data-ttu-id="1ad0d-164">Создание надстройки SharePoint, которая использует удаленного интерфейса API для чтения и записи данных SharePoint</span><span class="sxs-lookup"><span data-stu-id="1ad0d-164">Build a SharePoint Add-In that leverages remote API's to read/write SharePoint data</span></span>

### <a name="building-sharepoint-add-ins-to-replace-your-infopath-forms"></a><span data-ttu-id="1ad0d-165">Создание надстройки SharePoint's замена форм InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-165">Building SharePoint Add-In's to replace your InfoPath forms</span></span>
<span data-ttu-id="1ad0d-166">Если вы решили использовать регулярное SharePoint надстройки для замены формы InfoPath имеется несколько вариантов.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-166">When you opt to use regular SharePoint Add-In's to replace your InfoPath forms you do have several options.</span></span> <span data-ttu-id="1ad0d-167">Ниже приведены три варианта, которые мы работали в работе более подробно, но как указанного вполне варианты можно использовать эти.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-167">Below are three options we've worked out in more detail, but as said you can perfectly use variations of these.</span></span> <span data-ttu-id="1ad0d-168">Три варианта, которые мы хотели углубленно являются:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-168">The three options we would like to dive into are:</span></span>
- <span data-ttu-id="1ad0d-169">[На knockout.js основе одной страницы приложения (SPA)] (https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Samples/EmployeeRegistration.KnockOut.SinglePageApp "Пример SPA, использующий knockout.js")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-169">[A Single Page Application (SPA) based on knockout.js](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Samples/EmployeeRegistration.KnockOut.SinglePageApp "SPA sample using knockout.js")</span></span>

![Пример выход](media/Sandbox-Solution-Transformation-Guidance-InfoPath/knockoutsample.png)

- <span data-ttu-id="1ad0d-171">[ASP.Net MVC SharePoint надстройке] (https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Samples/EmployeeRegistration.MVC "Добавить в SharePoint с помощью ASP.Net MVC")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-171">[An ASP.Net MVC SharePoint Add-In](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Samples/EmployeeRegistration.MVC "SharePoint Add-In using ASP.Net MVC")</span></span>
- <span data-ttu-id="1ad0d-172">[Надстройка SharePoint форм ASP.Net] (https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Samples/EmployeeRegistration.Forms "Добавить в SharePoint с помощью форм ASP.Net")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-172">[An ASP.Net Forms SharePoint Add-In](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Samples/EmployeeRegistration.Forms "SharePoint Add-In using ASP.Net Forms")</span></span>

<span data-ttu-id="1ad0d-173">Для улучшения вы с преобразование InfoPath форм **мы приведены 11 Общие шаблоны для программирования InfoPath и показано, как реализовать эти шаблоны, с использованием выше 3 упомянутый SharePoint параметры надстройки**.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-173">To better help you with converting your InfoPath form **we've listed 11 common InfoPath coding patterns and show you how you can implement those patterns using the above 3 mentioned SharePoint Add-In options**.</span></span> <span data-ttu-id="1ad0d-174">Для этого сначала разработанный [ссылку формы InfoPath](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Reference/EmployeeRegistration "формы InfoPath ссылку") использует наиболее распространенные InfoPath, шаблоны кода и затем перенесены данной форме в версии 3 добавить в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-174">To do so we've first developed a [reference InfoPath form](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Reference/EmployeeRegistration "Reference InfoPath form") which uses the most common InfoPath coding patterns and then we've migrated that form to 3 SharePoint Add-In flavors.</span></span> <span data-ttu-id="1ad0d-175">Следующие ссылки покажите этих общих шаблонов:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-175">Below links show these common patterns:</span></span>
- <span data-ttu-id="1ad0d-176">[Заполнение полей при загрузке формы - набор сведений о пользователе] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Populating%20fields%20on%20form%20load-set%20user%20information.md "Заполнение полей при загрузке формы - набор сведений о пользователе")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-176">[Populating fields on form load - set user information](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Populating%20fields%20on%20form%20load-set%20user%20information.md "Populating fields on form load - set user information")</span></span>
- <span data-ttu-id="1ad0d-177">[Заполнение полей при загрузке формы — чтение сведения о списке] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Populating%20fields%20on%20form%20load-read%20list%20information.md "Заполнение полей при загрузке формы — чтение сведения о списке")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-177">[Populating fields on form load - read list information](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Populating%20fields%20on%20form%20load-read%20list%20information.md "Populating fields on form load - read list information")</span></span>
- <span data-ttu-id="1ad0d-178">[Заполнение полей при загрузке формы — чтение данных списка] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Populating%20fields%20on%20form%20load-read%20list%20data.md "Заполнение полей при загрузке формы — чтение данных списка")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-178">[Populating fields on form load - read list data](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Populating%20fields%20on%20form%20load-read%20list%20data.md "Populating fields on form load - read list data")</span></span>
- <span data-ttu-id="1ad0d-179">[Отправка формы с помощью кода] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Submit%20the%20form%20via%20code.md "Отправка формы с помощью кода")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-179">[Submit the form via code](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Submit%20the%20form%20via%20code.md "Submit the form via code")</span></span>
- <span data-ttu-id="1ad0d-180">[Переключение представления после отправки формы] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Switching%20view%20after%20form%20submission.md "Переключение представления после отправки формы")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-180">[Switching view after form submission](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Switching%20view%20after%20form%20submission.md "Switching view after form submission")</span></span>
- <span data-ttu-id="1ad0d-181">[Извлечение пользовательских данных] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Retrieving%20user%20data.md "Извлечение пользовательских данных")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-181">[Retrieving user data](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Retrieving%20user%20data.md "Retrieving user data")</span></span>
- <span data-ttu-id="1ad0d-182">[Прочитайте сбора данных и настройка нескольких элементов управления] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Read%20data%20collection%20and%20set%20multiple%20controls.md "Прочитайте сбора данных и настройка нескольких элементов управления")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-182">[Read data collection and set multiple controls](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Read%20data%20collection%20and%20set%20multiple%20controls.md "Read data collection and set multiple controls")</span></span>
- <span data-ttu-id="1ad0d-183">[Загрузить каскадные таблицы данных] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Cascading%20data%20load.md "Загрузить каскадные таблицы данных")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-183">[Cascading data load](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Cascading%20data%20load.md "Cascading data load")</span></span>
- <span data-ttu-id="1ad0d-184">[Передача или удалить вложения.] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Upload%20or%20Delete%20Attachments.md "Передача или удалить вложения.")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-184">[Upload or delete attachments](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Upload%20or%20Delete%20Attachments.md "Upload or delete attachments")</span></span>
- <span data-ttu-id="1ad0d-185">[Добавить или удалить пользователя из группы сайтов] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Add%20or%20remove%20user%20from%20site%20groups.md "Добавить или удалить пользователя из группы сайтов")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-185">[Add or remove user from site groups](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Add%20or%20remove%20user%20from%20site%20groups.md "Add or remove user from site groups")</span></span>
- <span data-ttu-id="1ad0d-186">[Загрузка существующего элемента в форме] (https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Load%20existing%20item%20in%20form.md "Загрузка существующего элемента в форме")</span><span class="sxs-lookup"><span data-stu-id="1ad0d-186">[Load existing item in form](https://github.com/SharePoint/PnP-Transformation/blob/master/InfoPath/Guidance/Patterns/Load%20existing%20item%20in%20form.md "Load existing item in form")</span></span>


### <a name="migrating-your-infopath-data"></a><span data-ttu-id="1ad0d-187">Перенос данных InfoPath</span><span class="sxs-lookup"><span data-stu-id="1ad0d-187">Migrating your InfoPath data</span></span>
<span data-ttu-id="1ad0d-188">После перемещения формы InfoPath для нового решения может потребоваться перенос данных из InfoPath XML для регулярного данных списка SharePoint или на уровне данных почтой.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-188">Once you've moved over your InfoPath form to a new solution you might also want to migrate your data from InfoPath XML to regular SharePoint list data or to the data layer of your choice.</span></span> <span data-ttu-id="1ad0d-189">Поскольку файлы InfoPath, XML-файлов довольно прост в чтение и тех, преобразование.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-189">Since InfoPath files are XML files it's fairly easy to read and transform those.</span></span> <span data-ttu-id="1ad0d-190">[Репозиторий PnP модернизации содержит пример, в котором показано, как это можно сделать](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Migration/EmpRegConsole "образец, показывающих, как для преобразования из InfoPath из XML в данные списка").</span><span class="sxs-lookup"><span data-stu-id="1ad0d-190">The [PnP-Transformation repository contains a sample showing how you can achieve this](https://github.com/SharePoint/PnP-Transformation/tree/master/InfoPath/Migration/EmpRegConsole "Sample showing how to transform from InfoPath XML to list data").</span></span>

### <a name="code-based-operations-are-disabled-and-now-my-existing-forms-dont-open-anymore"></a><span data-ttu-id="1ad0d-191">Операции с на основе кода и теперь Мои существующей формы не закрыт</span><span class="sxs-lookup"><span data-stu-id="1ad0d-191">Code-based operations are disabled and now my existing forms don't open anymore</span></span>
<span data-ttu-id="1ad0d-192">Сразу же операции с кодом на основе это означает, что код не может больше выполняются в изолированной среде.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-192">As soon as code based operations are disabled it means that no code can run anymore in the sandbox.</span></span> <span data-ttu-id="1ad0d-193">Если вы добавили форм, в которых выполнения кода это также означает, что не будет больше работать открытия существующих форм.</span><span class="sxs-lookup"><span data-stu-id="1ad0d-193">If you've forms that execute code it also means that opening of existing forms will not work anymore.</span></span> <span data-ttu-id="1ad0d-194">Шаги, описанные ниже поможет вам обрабатывать это:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-194">Below steps will help you handle this:</span></span>
 - <span data-ttu-id="1ad0d-195">Если перенесены формы InfoPath в новое решение затем вероятнее всего уже преобразования данных и таким образом вы готовы</span><span class="sxs-lookup"><span data-stu-id="1ad0d-195">If you've migrated your InfoPath form to a new solution then you've most likely already converted your data and as such you're good</span></span>
 -  <span data-ttu-id="1ad0d-196">Если подписано сохранить форму как (например, поскольку она не бизнес-больше критические), но по-прежнему требуется открытия существующих форм, затем можно выполнить одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="1ad0d-196">If you opted to keep the form as is (e.g. since it's not business critical anymore) but you still want to open the existing forms then you can take one of the following steps:</span></span>
    - <span data-ttu-id="1ad0d-197">Удалите с выделенным кодом из формы и повторной публикации (обратитесь к разделу **Удаление фоновый код из формы InfoPath, чтобы исправить их** )</span><span class="sxs-lookup"><span data-stu-id="1ad0d-197">Remove the code behind from your form and republish it (see the **Dropping code behind from InfoPath forms to fix them** section above)</span></span>
    - <span data-ttu-id="1ad0d-198">Используйте для открытия формы InfoPath клиента</span><span class="sxs-lookup"><span data-stu-id="1ad0d-198">Use InfoPath Client to open the forms</span></span>
    - <span data-ttu-id="1ad0d-199">Выполнение миграции данных формы в простых данных списка SharePoint (обратитесь к разделу **переносе данных InfoPath** )</span><span class="sxs-lookup"><span data-stu-id="1ad0d-199">Migrate the form data to plain SharePoint list data (see the **Migrating your InfoPath data** section above)</span></span>

