---
title: "Обновление компонентов хост-сайта в SharePoint"
description: "Обновление дополнительных действий и частей надстроек на хост-сайте надстройки SharePoint."
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: 5f7c24eb69e1107f9b3271edce6e6f07ae7db059
ms.sourcegitcommit: 655e325aec73c8b7c6b5e3aaf71fbb4d2d223b5d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2017
---
# <a name="update-host-web-components-in-sharepoint"></a><span data-ttu-id="c2c90-103">Обновление компонентов хост-сайта в SharePoint</span><span class="sxs-lookup"><span data-stu-id="c2c90-103">Update host web components in SharePoint</span></span>

<span data-ttu-id="c2c90-104">Прежде чем приступать, ознакомьтесь со статьей [Обновление надстроек SharePoint](update-sharepoint-add-ins.md), в том числе с перечисленными в ней предварительными требованиями и основными понятиями.</span><span class="sxs-lookup"><span data-stu-id="c2c90-104">Be familiar with  [Update SharePoint Add-ins](update-sharepoint-add-ins.md) and the prerequisites and core concepts listed in it.</span></span>

<span data-ttu-id="c2c90-105">Ваша надстройка может установить два типа компонентов на хост-сайт с описательной разметкой в надстройке SharePoint: **дополнительные действия** и **части надстроек**.</span><span class="sxs-lookup"><span data-stu-id="c2c90-105">Your add-in can install two kinds of components on a host web with descriptive markup in the SharePoint Add-in: **custom actions** and **add-in parts**.</span></span> <span data-ttu-id="c2c90-106">Обновлять эти компоненты проще на хост-сайте, чем на сайте надстройки.</span><span class="sxs-lookup"><span data-stu-id="c2c90-106">Updating these components is easier in the host web than in the add-in web.</span></span> <span data-ttu-id="c2c90-107">Не нужно обновлять семантику.</span><span class="sxs-lookup"><span data-stu-id="c2c90-107">You don't need any update semantics.</span></span> <span data-ttu-id="c2c90-108">Просто добавьте или измените дополнительные действия или части надстройки.</span><span class="sxs-lookup"><span data-stu-id="c2c90-108">Just add/change the custom actions and add-in parts.</span></span> <span data-ttu-id="c2c90-109">Когда обновляется надстройка SharePoint, SharePoint всегда применяет файлы манифеста новых элементов и повторно применяет файлы манифеста измененных элементов для последней версии.</span><span class="sxs-lookup"><span data-stu-id="c2c90-109">When the SharePoint Add-in is updated, SharePoint always applies any new element manifest files and reapplies any changed element manifest files with the most recent version.</span></span> <span data-ttu-id="c2c90-110">При повторном применении ничего страшного не произойдет. Не будет, например, несколько раз добавлена кнопка ленты для дополнительного действия на ленту.</span><span class="sxs-lookup"><span data-stu-id="c2c90-110">No harm is done in reapplying; for example, a ribbon button for a custom action will not be added multiple times to the ribbon.</span></span>

<span data-ttu-id="c2c90-p102">Когда вы обновляете часть надстройки, SharePoint заменяет старую версию на новую в коллекции веб-частей. Убедитесь в изменении свойства **Name** объекта **ClientWebPart** при обновлении части надстройки. Это гарантирует, что после обновления надстройки SharePoint удалит старую версию части надстройки (которая больше не является частью приложения) со всех страниц, на которые она была добавлена. Пользователи должны повторно добавить на страницы новую версию.</span><span class="sxs-lookup"><span data-stu-id="c2c90-p102">When you update an add-in part, SharePoint replaces the old version with the new version in the Web Part gallery. Be sure to change the **Name** property of the **ClientWebPart** object when you update an add-in part. Doing this ensures that, when the add-in is updated, SharePoint will remove the old version of the add-in part (which is no longer part of the app) from all pages to which it was added. Users will need to re-add the new version to pages.</span></span>

<span data-ttu-id="c2c90-p103">Если вы оставите свойство **Name** без изменений, то старая версия останется на страницах, куда она была добавлена, и маловероятно, что пользователи будут знать о доступности новой версии части надстройки. Кроме того, когда часть надстройки добавляется на другие страницы, то добавляется новая версия, так что одна и та же версия надстройки SharePoint будет иметь различные части надстройки на различных страницах.</span><span class="sxs-lookup"><span data-stu-id="c2c90-p103">If you leave the **Name** property unchanged, the old version remains on pages where it was added, which makes it unlikely that users will be aware that a new version of the add-in part is available. Also, when the add-in part is added to other pages, it is the new version that is added, so the same version of a SharePoint Add-in would have different add-in parts on different pages.</span></span>

<span data-ttu-id="c2c90-117">Вы можете развернуть другие типы компонентов хост-сайта программно, используя приемник удаленных событий, который вы зарегистрировали в манифесте надстройки с помощью элемента [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="c2c90-117">You can deploy other kinds of host web components programmatically using a remote event receiver that you register in the app manifest with an [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx) element. You should use an UpgradedEventEndpoint receiver to update components that were originally deployed with an InstalledEventEndpoint receiver. UpgradedEventEndpoint receivers are described in Using an UpdatedEventEndpoint receiver.</span></span> <span data-ttu-id="c2c90-118">Следует использовать приемник [UpgradedEventEndpoint](http://msdn.microsoft.com/library/09a93d44-d295-47bb-f91c-d243178b0f53%28Office.15%29.aspx) для обновления компонентов, развертывание которых изначально выполнялось с использованием приемника **InstalledEventEndpoint**.</span><span class="sxs-lookup"><span data-stu-id="c2c90-118">You should use an [UpgradedEventEndpoint](http://msdn.microsoft.com/library/09a93d44-d295-47bb-f91c-d243178b0f53%28Office.15%29.aspx) receiver to update components that were originally deployed with an **InstalledEventEndpoint** receiver.</span></span> <span data-ttu-id="c2c90-119">Приемники [UpgradedEventEndpoint](http://msdn.microsoft.com/library/09a93d44-d295-47bb-f91c-d243178b0f53%28Office.15%29.aspx) описаны в статье [Создание обработчика для события обновления в надстройках SharePoint](create-a-handler-for-the-update-event-in-sharepoint-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="c2c90-119">[UpgradedEventEndpoint](http://msdn.microsoft.com/library/09a93d44-d295-47bb-f91c-d243178b0f53%28Office.15%29.aspx) receivers are described in [Create a handler for the update event in SharePoint Add-ins](create-a-handler-for-the-update-event-in-sharepoint-add-ins.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="c2c90-120">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="c2c90-120">Next steps</span></span>
<span data-ttu-id="c2c90-121"><a name="Next"> </a></span><span class="sxs-lookup"><span data-stu-id="c2c90-121"></span></span>

<span data-ttu-id="c2c90-122">Перейдите к разделу [Основные действия при обновлении надстройки](update-sharepoint-add-ins.md#MajorAppUpgradeSteps) или непосредственно к одной из следующих статей, чтобы узнать, как обновить очередной основной компонент надстройки SharePoint.</span><span class="sxs-lookup"><span data-stu-id="c2c90-122">Go to  [Major steps in updating an add-in](update-sharepoint-add-ins.md#MajorAppUpgradeSteps), or go directly to one of the following articles to learn how to update the next major component of your SharePoint Add-in.</span></span>

-  [<span data-ttu-id="c2c90-123">Обновление компонентов сайта надстройки в SharePoint</span><span class="sxs-lookup"><span data-stu-id="c2c90-123">Update add-in web components in SharePoint</span></span>](update-add-in-web-components-in-sharepoint.md)
-  [<span data-ttu-id="c2c90-124">Создание обработчика событий обновления для надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="c2c90-124">Create a handler for the update event in SharePoint Add-ins</span></span>](create-a-handler-for-the-update-event-in-sharepoint-add-ins.md)
-  <span data-ttu-id="c2c90-125">[Обновление удаленных компонентов в надстройках SharePoint](update-remote-components-in-sharepoint-add-ins.md) </span><span class="sxs-lookup"><span data-stu-id="c2c90-125">[Update remote components in SharePoint Add-ins](update-remote-components-in-sharepoint-add-ins.md)</span></span>
 
## <a name="additional-resources"></a><span data-ttu-id="c2c90-126">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="c2c90-126">Additional resources</span></span>
<span data-ttu-id="c2c90-127"><a name="bk_addresources"> </a></span><span class="sxs-lookup"><span data-stu-id="c2c90-127"></span></span>

-  [<span data-ttu-id="c2c90-128">Обновление надстроек SharePoint</span><span class="sxs-lookup"><span data-stu-id="c2c90-128">Update SharePoint Add-ins</span></span>](update-sharepoint-add-ins.md)
-  [<span data-ttu-id="c2c90-129">Хост-сайты, сайты надстроек и компоненты SharePoint в SharePoint</span><span class="sxs-lookup"><span data-stu-id="c2c90-129">Host webs, add-in webs, and SharePoint components in SharePoint</span></span>](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint.md) 
    
 

